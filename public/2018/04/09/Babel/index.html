<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="Cara,zzxxcclloopp@gmail.com"><title>Babelç”Ÿæ€ Â· Cara's Blog</title><meta name="description" content="å¯¹äº babel çš„ä½¿ç”¨, ä¸€ç›´åœç•™åœ¨ä¸ webpack ç»“åˆä½¿ç”¨, ä»¥åŠåœ¨ Vue å¼€å‘ç¯å¢ƒä¸‹è„šæ‰‹æ¶åˆæ˜¯å¼€ç®±å³ç”¨. å¯¼è‡´å¾ˆå¤š babel çš„åŒ…, æˆ‘éƒ½ä¸æ¸…æ¥šä»–ä»¬æ˜¯å¹²ä»€ä¹ˆçš„. æ¯”å¦‚ babel-register/ babel-runtime/ helpers/ å„ç§ presets ä»¥åŠ trans"><meta name="keywords" content="hexo, HTML, CSS, Javascript, Node.js"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="http://ordjgqxuv.bkt.clouddn.com/nike-girl/IMG_2930.JPG" style="width:127px;"><h3 title=""><a href="/">Cara's Blog</a></h3><div class="description"><p>å’¸é±¼çš„åšå®¢å’Œå­¦ä¹ ç¬”è®°ğŸ“’ 'Lok-Tar Ogar!'.</p></div></div></div><ul class="social-links"><li><a href="http://github.com/Caraws"><i class="fa fa-github"></i></a></li></ul><div class="footer"></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">é¦–é¡µ</a></li><li><a href="/archives">å½’æ¡£</a></li><li><a href="/about">å…³äº</a></li><li><a href="/links">å‹é“¾</a></li></div><div class="information"><div class="back_btn"><li><a onclick="window.history.go(-1)" class="fa fa-chevron-left"> </a></li></div><div class="avatar"><img src="http://ordjgqxuv.bkt.clouddn.com/cara_30/WechatIMG8.jpeg"></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>Babelç”Ÿæ€</a></h3></div><div class="post-content"><p>å¯¹äº babel çš„ä½¿ç”¨, ä¸€ç›´åœç•™åœ¨ä¸ webpack ç»“åˆä½¿ç”¨, ä»¥åŠåœ¨ Vue å¼€å‘ç¯å¢ƒä¸‹è„šæ‰‹æ¶åˆæ˜¯å¼€ç®±å³ç”¨. å¯¼è‡´å¾ˆå¤š babel çš„åŒ…, æˆ‘éƒ½ä¸æ¸…æ¥šä»–ä»¬æ˜¯å¹²ä»€ä¹ˆçš„. æ¯”å¦‚ babel-register/ babel-runtime/ helpers/ å„ç§ presets ä»¥åŠ transform-runtime å’Œ babel-polyfill çš„åŒºåˆ«, æ‰€ä»¥æ€»ç»“ä¸€ä¸‹.</p>
<h3 id="babel-cli"><a href="#babel-cli" class="headerlink" title="babel-cli"></a>babel-cli</h3><p>æˆ‘ç†è§£ä¸º babel çš„ command å…¨å®¶æ¡¶, ç”¨äºåœ¨å‘½ä»¤è¡Œæ“ä½œçš„. é‡Œé¢åŒ…å«äº† <code>babel</code>/ <code>babel-external-helpers</code>/ <code>babel-node</code> 3ä¸ªå‘½ä»¤</p>
<ul>
<li>babel: ç”¨äºç¼–è¯‘ä»£ç </li>
<li>babel-external-helpers: ç”¨äºç”Ÿæˆä¸€äº› halper å‡½æ•°, åŒ…å« babel æ‰€æœ‰çš„ hepler å‡½æ•° (å¦‚: toArray å‡½æ•°, jsx è½¬åŒ–å‡½æ•°). è¿™äº›å‡½æ•°å®åœ¨ babel transform çš„æ—¶å€™ç”¨, éƒ½æ”¾åœ¨ <code>babel-helpers</code> è¿™ä¸ªåŒ…ä¸­, å½“è¿™äº› helpers è¢«ç”¨åˆ°å°±ä¼šè¢«æ”¾ç½®åœ¨ç”Ÿæˆä»£ç çš„é¡¶éƒ¨. ä½†æ˜¯å½“å¤šä¸ªæ–‡ä»¶éƒ½ç”¨åˆ°äº† helpers å‡½æ•°å°±ä¼šäº§ç”Ÿå†—ä½™ä»£ç , æ‰€ä»¥ babel æä¾›è¿™ä¸ªå‘½ä»¤ç”Ÿæˆä¸€ä¸ªåŒ…å«æ‰€æœ‰ helpers çš„ js æ–‡ä»¶ç”¨äºç›´æ¥å¼•ç”¨.(ç„¶åå¯ä»¥é€šè¿‡ plugin å»æ£€æŸ¥å…¨å±€æ—¶å€™å­˜åœ¨è¿™ä¸ªæ¨¡å—, å­˜åœ¨å°±ä¸å®šä¹‰)</li>
<li>babel-node: ä¸»è¦æ˜¯å®ç°åœ¨ node ä¸­å†™ä»£ç å’Œæ‰§è¡Œè„šæœ¬çš„èƒ½åŠ›, å¯ä»¥ç›´æ¥è¿è¡Œ ES6ä»£ç . æ¯”å¦‚ç›´æ¥åœ¨ node ä¸­å†™ jsx, é€šè¿‡è¿™ä¸ªå°±å¯ä»¥æ‰§è¡Œ. ä½†æ˜¯è¦æŠŠå®ƒç¼–è¯‘æˆå¯æ‰§è¡Œçš„è„šæœ¬è¿˜éœ€è¦ <code>babel-register</code></li>
</ul>
<p>å®‰è£…<br><code>npm install --global babel-cli</code></p>
<p>ç”¨æ³•<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">babel example.js</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> è½¬ç ç»“æœå†™å…¥æ–‡ä»¶</span><br><span class="line">babel example.js -o result.js</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> æ•´ä¸ªç›®å½•è½¬ç </span><br><span class="line">babel src -d lib</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> ç”Ÿæˆ source map æ–‡ä»¶</span><br><span class="line">babel src -d lib -s</span><br></pre></td></tr></table></figure></p>
<p>å…¨å±€ç¯å¢ƒä¸‹ babel æ— æ³•æ”¯æŒä¸åŒç‰ˆæœ¬çš„ babel, æ‰€ä»¥å®‰å…¨çš„åšæ³•è¿˜æ˜¯æŠŠ babel è£…åœ¨é¡¹ç›®ä¸­<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev babel-cli</span><br></pre></td></tr></table></figure></p>
<p>package.json æ”¹æˆ:<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"script"</span>: <span class="string">"babel src -d lib"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>babel-register</strong><br>å®ƒçš„ç‰¹ç‚¹å°±æ˜¯å®æ—¶ç¼–è¯‘, ä¸ä¼šè¾“å‡ºæ–‡ä»¶, ç”¨æ¥æ”¹å†™ <code>require</code> å‘½ä»¤ä¸ºå®ƒåŠ ä¸Šé’©å­. <code>require</code> è¿›æ¥çš„æ–‡ä»¶å°±ä¼šè¢«è½¬ç , ä½†æ˜¯å®ƒä¸ä¼šè½¬ç å½“å‰æ–‡ä»¶ä¸­çš„ä»£ç .</p>
<p>å®‰è£…<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev babel-register</span><br></pre></td></tr></table></figure></p>
<p>ä½¿ç”¨<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¿…é¡»å…ˆåŠ è½½ register</span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">'babel-register'</span>)</span><br><span class="line"><span class="comment">// ç„¶å register å°±ä¼šå¯¹ test.js æ–‡ä»¶è½¬ç </span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">'test.js'</span>)</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>ç”±äº <code>babel-register</code> æ˜¯å³æ—¶è½¬ç , æ‰€ä»¥åªé€‚ç”¨äºå¼€å‘ç¯å¢ƒä½¿ç”¨.</p>
</blockquote>
<h3 id="babel-core"><a href="#babel-core" class="headerlink" title="babel-core"></a>babel-core</h3><p><code>babel-core</code> å¯ä»¥è¯´æ˜¯ babel æœ€ä¸ºæ ¸å¿ƒçš„ä¸€ä¸ªåŒ…, å¯ä»¥æŠŠå®ƒçœ‹æˆä¸€ä¸ªç¼–è¯‘å™¨, babel æ ¸å¿ƒçš„ API éƒ½åœ¨é‡Œé¢. æ¯”å¦‚: transform å¤„ç†è½¬ç , å› ä¸º ES6 çš„è¯­æ³•è·Ÿè€è¯­æ³•ä¸åŒ, æ‰€ä»¥å…ˆå°†æˆ‘ä»¬çš„ä»£ç è½¬æ¢ä¸º AST(æŠ½è±¡è¯­æ³•æ ‘), ç„¶ååˆ†åˆ«åšå¤„ç†è½¬åŒ–ä¸º ES5. webpack çš„ babel-loader å°±æ˜¯è°ƒç”¨è¿™äº› API å®Œæˆè½¬è¯‘çš„. <a href="https://babeljs.cn/docs/usage/api/" target="_blank" rel="noopener">è¿™é‡Œæ˜¯è¯¦ç»†çš„ API</a></p>
<blockquote>
<p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯: <code>babel-core</code> ä»…å…³æ³¨ code transform, ä¹Ÿå°±æ˜¯è¯´å®ƒåªåšè¯­æ³•ä¸Šçš„è½¬æ¢, æ¯”å¦‚ç®­å¤´å‡½æ•°. æ‰€ä»¥å¹¶ä¸æ˜¯ä»€ä¹ˆéƒ½èƒ½ç”¨ babel æ¥è½¬æ¢çš„, å¦‚æœæ¶‰åŠåˆ°æ–°çš„ API å°±éœ€è¦ä½ ç”¨ polyfill æ¥è½¬è¯‘, æ¯”å¦‚ <code>Promise</code>.</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ•´å—å¼•å…¥</span></span><br><span class="line"><span class="keyword">var</span> babel = <span class="built_in">require</span>(<span class="string">'babel-core'</span>)</span><br><span class="line"><span class="comment">// ä¹Ÿå¯ä»¥é€‰æ‹©æŸä¸ª API å•ç‹¬ä½¿ç”¨</span></span><br><span class="line"><span class="keyword">import</span> &#123; transform &#125; <span class="keyword">from</span> <span class="string">'babel-core'</span></span><br></pre></td></tr></table></figure>
<p>ä¸»è¦çš„ API:</p>
<p><strong>babel.transform(code: string, options?: Object)</strong><br>å°†ä¼ å…¥çš„ code åšè½¬æ¢, è¿”å›å€¼ä¸ºä¸€ä¸ªå¯¹è±¡, å‚æ•°ä¸º: ç”Ÿæˆçš„å¯¹è±¡, source map å’Œ AST</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> result = babel.transform(<span class="string">"code();"</span>, options);</span><br><span class="line">result.code</span><br><span class="line">result.map</span><br><span class="line">result.ast</span><br></pre></td></tr></table></figure>
<p><strong>babel.transformFile(filename: string, options?: Object, callback: Function)</strong><br>å¼‚æ­¥è½¬è¯‘æ–‡ä»¶ä¸­çš„æ‰€æœ‰å†…å®¹</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">babel.transformFile(<span class="string">'filename.js'</span>, options, <span class="function"><span class="keyword">function</span> (<span class="params">err, result</span>) </span>&#123;</span><br><span class="line">  result <span class="comment">// &#123; code, map, ast &#125;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p><strong>babel.transformFileSync(filename: string, options?: Object)</strong><br><code>babel.transformFile</code> çš„åŒæ­¥ç‰ˆæœ¬, è¿”å›å€¼ä¸º <code>filename</code> æ–‡ä»¶ä¸­è½¬è¯‘åçš„ä»£ç </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">babel.transformFileSync(filename, options) <span class="comment">// &#123; code, map, ast &#125;</span></span><br></pre></td></tr></table></figure>
<p><strong>babel.transformFromAst(ast: Object, code?: string, options?: Object)</strong><br>åè½¬è¯‘, ç»™ä¸€ä¸ª AST è½¬ä¸º code</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> code = <span class="string">'if (true) return'</span></span><br><span class="line"><span class="keyword">const</span> ast = babylon.parse(code, &#123; <span class="attr">allowReturnOutsideFunction</span>: <span class="literal">true</span> &#125;)</span><br><span class="line"><span class="keyword">const</span> &#123; code, map, ast &#125; = babel.transformFormAst(ast, code, options)</span><br></pre></td></tr></table></figure>
<h3 id="babel-runtime"><a href="#babel-runtime" class="headerlink" title="babel-runtime"></a>babel-runtime</h3><p><a href="https://babeljs.cn/docs/plugins/transform-runtime/" target="_blank" rel="noopener"><code>babel-runtime</code></a> è¿™ä¸ªåŒ…å…¶å®å°±æ˜¯æŠŠ core-js å’Œ regenerator ç»„åˆèµ·æ¥ä¾›ä½¿ç”¨, å®ƒå’Œ <code>babel-polyfill</code> çš„éƒ½æ˜¯ä¸ºäº†æ¨¡æ‹Ÿ ES6 ç¯å¢ƒ. ä¹‹å‰æåˆ°çš„ <code>babel-core</code> åªå¯¹è¯­æ³•è¿›è¡Œè½¬æ¢, ä½†ä¸æ”¯æŒ Promise, Set, Map, array.reduce, Array.form, genertor, async è¿™äº›æ–° API çš„ç¼–è¯‘, æ‰€ä»¥æ‰ä¼šç”¨åˆ°è¿™ä¸¤ä¸ªä¸œè¥¿.</p>
<p><strong>core-js</strong>: ä¸»è¦å®ç°äº† Promise, Symbols, ES7ææ¡ˆç­‰ç­‰çš„ polyfill, åŒ…å«äº†å¤§éƒ¨åˆ†çš„ JavaScript æœ€æ–°æ ‡å‡†çš„å«ç‰‡.<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// éœ€è¦å•ä¸ªå¼•ç”¨åå†ä½¿ç”¨</span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">'core-js/array/reduce'</span>)</span><br></pre></td></tr></table></figure></p>
<p><strong>regenerator</strong>: ä¸»è¦å®ç° generator/yeild, async/await (ä¸çŸ¥é“ä¸ºå•¥ core-js ä¸æŠŠè¿™ä¸¤ä¸ªä¸€èµ·å®ç°äº†â€¦)</p>
<p><strong>helpers</strong>: <code>babel-runtime</code> é‡Œä¹Ÿæœ‰ helpers, å®ƒé‡Œé¢çš„ helpers ç›¸å½“äºä¹‹å‰æåˆ°çš„ <code>babel-external-helpers</code> ç”Ÿæˆçš„ helpers.js, åªä¸è¿‡æŠŠæ¯ä¸ª helpers å‡½æ•°éƒ½å•ç‹¬æ”¾åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹é‡Œè€Œå·². è¿™æ ·é…åˆ transform çš„æ—¶å€™, éœ€è¦ç”¨åˆ° helpers å‡½æ•°å°±å¯ä»¥ç›´æ¥ä» <code>babel-runtime</code> ä¸­å¼•ç”¨äº†.<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> _asyncToGenerator2 = <span class="built_in">require</span>(<span class="string">'babel-runtime/helpers/asyncToGenerator'</span>)</span><br></pre></td></tr></table></figure></p>
<p>åŒºåˆ«: </p>
<ul>
<li><a href="https://babeljs.cn/docs/usage/polyfill" target="_blank" rel="noopener">babel-polyfill</a>: æ˜¯é€šè¿‡å…¨å±€å¯¹è±¡å’Œå†…ç½®å¯¹è±¡çš„ prototype ä¸Šæ·»åŠ æ–¹æ³•æ¥è¾¾åˆ°ç›®çš„, æ‰€ä»¥ä¸€æ—¦å¼•å…¥ <code>babel-polyfill</code> å°±ä¼šæ±¡æŸ“å…¨å±€ç¯å¢ƒ.</li>
<li>babel-runtime: <code>babel-runtime</code> æ˜¯ä¸€ä¸ªæ¨¡å—, æ‰€ä»¥å®ƒä¸ä¼šæ±¡æŸ“å…¨å±€ç¯å¢ƒå’Œå†…ç½®å¯¹è±¡çš„åŸå‹. å®ƒçš„åšæ³•å¼•å…¥éœ€è¦çš„ helper å‡½æ•°(ç±»ä¼¼: <code>const Promise = require(&#39;babel-runtime/core-js/promise&#39;)</code> æ¥å¼•å…¥ Promise).</li>
</ul>
<p>ä¼˜ç¼ºç‚¹:</p>
<ul>
<li>babel-poly-fill: å¼•å…¥ä¸€åŠ³æ°¸é€¸, ä½†æ˜¯æ±¡æŸ“ç¯å¢ƒ.</li>
<li>babel-runtime: <ol>
<li>æ‰‹åŠ¨å¼•å…¥ä¸æ–¹ä¾¿</li>
<li>ç›´æ¥åœ¨ä»£ç ä¸­å¼•å…¥ helper å‡½æ•°æ„å‘³ç€ä¸èƒ½å…±äº«, æœ€ç»ˆæ‰“åŒ…å‡ºæ¥ä¼šæœ‰å¾ˆå¤šå†—ä½™ä»£ç (å¼•å…¥çš„éƒ½æ˜¯å…¨é‡çš„ polyfill). </li>
</ol>
</li>
</ul>
<p>æ‰€ä»¥è¦é…åˆ <code>babel-plugin-transform-runtime</code> (å¾ˆå¤šåœ°æ–¹éƒ½æ˜¯æŠŠ <code>babel-runtime</code> å’Œ <code>babel-plugin-transform-runtime</code> ç»Ÿç§°ä¸º transform-runtime, å› ä¸ºå®ƒä¿©å¾—åˆåœ¨ä¸€èµ·æ‰å¥½ç”¨) æ¥è¾¾åˆ°æŒ‰éœ€å¼•å…¥ helper é¿å…é‡å¤æ‰“åŒ…å’Œæ‰‹åŠ¨å¼•å…¥çš„ç—›è‹¦, å®ƒä¸»è¦æ˜¯åšä¸€å±‚æ˜ å°„: å°† <code>babel-runtime</code> å†…å¼•ç”¨åˆ°çš„ core-js æˆ– regenerator.js æ˜ å°„åˆ°å…·ä½“å¯¹åº”çš„ helper. </p>
<blockquote>
<p>æ³¨æ„: <code>babel-runtime</code> æ— æ³•è½¬ç å®ä¾‹æ–¹æ³•, å³å†…ç½®å¯¹è±¡åŸå‹ä¸Šçš„æ–¹æ³•, åªèƒ½é€šè¿‡ <code>babel-polyfill</code> æ¥è½¬ç . æ¯”å¦‚:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.find()</span><br><span class="line"><span class="string">'hello'</span>.includes(<span class="string">'h'</span>)</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>å¦å¤–, å…³äºä¸ºä»€ä¹ˆ <code>babel-runtime</code> æ˜¯ dependencies ä¾èµ–, å› ä¸ºä»–åªæ˜¯é›†åˆäº† polyfill çš„ä¸€ä¸ª library, å¯¹åº”éœ€è¦çš„ polyfill éƒ½æ˜¯è¦å¼•å…¥é¡¹ç›®ä¸­, å¹¶è·Ÿé¡¹ç›®ä»£ç ä¸€èµ·æ‰“åŒ…çš„.</p>
<h3 id="babel-preset-env"><a href="#babel-preset-env" class="headerlink" title="babel-preset-env"></a>babel-preset-env</h3><p>å®ƒèƒ½æ ¹æ®å½“å‰çš„è¿è¡Œç¯å¢ƒ, è‡ªåŠ¨ç¡®å®šä½ éœ€è¦çš„ plugins å’Œ polyfills, babel çš„é…ç½®å®˜æ–¹æ¨èæ˜¯å†™åˆ° <code>.babelrc</code> æ–‡ä»¶ä¸­, ä»¥ <code>Vue-cli</code> çš„ babel é…ç½®ä¸ºä¾‹.<a href="https://babeljs.cn/docs/plugins/preset-env/" target="_blank" rel="noopener">è¯¦ç»†å‚æ•°è®¾ç½®åŠè¯´æ˜</a></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"presets"</span>: [</span><br><span class="line">    [<span class="string">"env"</span>, </span><br><span class="line">      &#123; </span><br><span class="line">        "modules": false // è®¾ç½® ES6 æ¨¡å—è½¬è¯‘çš„æ¨¡å¼, é»˜è®¤æ˜¯ commonjs</span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    // éœ€è¦æ”¯æŒåˆ°å“ªä¸ªé˜¶æ®µçš„ JavaScript ç‰ˆæœ¬</span><br><span class="line">    <span class="string">"stage-2"</span></span><br><span class="line">  ],</span><br><span class="line">  // éœ€è¦çš„æ’ä»¶</span><br><span class="line">  "plugins": [</span><br><span class="line">    "transform-runtime", // è™½ç„¶è¿™é‡Œæ²¡æœ‰å†™ babel-runtime, ä½†æ˜¯ transform-runtime ä¾èµ–äºå®ƒ, æ‰€ä»¥è¿˜æ˜¯è¦å®‰è£…</span><br><span class="line">    <span class="string">"transform-vue-jsx"</span></span><br><span class="line">  ],</span><br><span class="line">  // ç¼–è¯‘è¿‡ç¨‹æ˜¯å¦ä¿ç•™æ³¨é‡Š</span><br><span class="line">  "comments": false,</span><br><span class="line">  "env": &#123;</span><br><span class="line">    "test": &#123;</span><br><span class="line">      "presets": ["env", "stage-2"],</span><br><span class="line">      "plugins": [ "istanbul"]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æœ¬æ¥ <code>babel-preset-env</code> ä¸­æœ‰ä¸€ä¸ª useBuiltIns é€‰é¡¹(é»˜è®¤å€¼æ˜¯ false), å°±æ˜¯å®ƒå®ç°çš„æ ¹æ®è¿è¡Œç¯å¢ƒå¹¶åˆ¤æ–­éœ€è¦ä»€ä¹ˆ polyfill, è¾¾åˆ°æŒ‰éœ€å¼•å…¥è€Œä¸æ˜¯æ•´ä¸ªå¼•å…¥, å¯¹äº <code>import &#39;babel-polyfill&#39;</code> å°±å¾ˆæ£’äº†. ä½†æ˜¯å¯ä»¥çœ‹åˆ° vue-template å¹¶æ²¡æœ‰ä½¿ç”¨è¿™ä¸ªé€‰é¡¹, è¿™æ˜¯å› ä¸º   <a href="javascript:" title="æˆ‘æ¶ˆä¸æ‰è¿™ä¸ªè¶…é“¾æ¥ğŸ˜‘" target="_blank" rel="noopener">babel-preset-env@1.x</a> çš„ç‰ˆæœ¬æ²¡æœ‰åŠæ³•å¾ˆå¥½æ¶ˆé™¤æœªä½¿ç”¨çš„ polyfill, åœ¨2.x ç‰ˆæœ¬ä¸‹å¯ä»¥ç”¨ <code>usebuiltIns: &#39;usage&#39;</code>è¾¾åˆ°ç›®çš„.</p>
<h3 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h3><p>babel è¿˜æœ‰å¾ˆå¤šç›¸å…³çš„ä¸œè¥¿æ²¡è¯´åˆ°, åªæŒ‘äº†å‡ ä¸ªæœ€é‡è¦çš„æ¥è¯´, å…·ä½“çš„ helpers/ plugins éƒ½å¯ä»¥åˆ°<a href="https://github.com/babel/babel/tree/master/packages" target="_blank" rel="noopener">å®˜æ–¹ä»“åº“</a>æŸ¥çœ‹</p>
<ul>
<li><a href="https://github.com/babel/babel/tree/master/packages/babylon" target="_blank" rel="noopener">badylon</a>: è¯æ³•è§£æå™¨</li>
<li><a href="https://github.com/babel/babel/tree/master/packages/babel-traverse" target="_blank" rel="noopener">babel-traverse</a>: ç”¨äºéå†, ç»´æŠ¤æ•´ä¸ª AST çš„çŠ¶æ€</li>
<li><a href="https://github.com/babel/babel/tree/master/packages/babel-generator" target="_blank" rel="noopener">babel-generator</a>: æ ¹æ® AST ç”Ÿæˆä»£ç </li>
</ul>
<h4 id="babel-çš„å·¥ä½œæµç¨‹"><a href="#babel-çš„å·¥ä½œæµç¨‹" class="headerlink" title="babel çš„å·¥ä½œæµç¨‹"></a>babel çš„å·¥ä½œæµç¨‹</h4><p>è¾“å…¥éœ€è¦è½¬ç çš„ä»£ç  -&gt; badylon è§£æ -&gt; å¾—åˆ° AST -&gt;<br>babel-traverse éå†è½¬è¯‘ -&gt; å¾—åˆ°æ–°çš„ AST -&gt;<br>æœ€å babel-generator æ ¹æ®æ–°çš„ AST ç”Ÿæˆä»£ç </p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>æ•´ä¸ªæ¥è¯´æˆ‘è§‰å¾—è¿˜æ˜¯ <code>babel-runtime</code> å’Œ <code>babel-polyfill</code> æ¯”è¾ƒéš¾åŒºåˆ†, å…¶å®ä¸¤è€…çš„æ ¸å¿ƒéƒ½åœ¨äº <a href="https://github.com/zloirock/core-js#basic" target="_blank" rel="noopener">core-js</a> åªæ˜¯å„æœ‰ä¼˜ç¼ºç‚¹è€Œå·², ä¸‹é¢ä¼šå†ç®€è¦æ€»ç»“ä¸€ä¸‹åŒºåˆ«. å…¶ä»–çš„è¯åªéœ€è¦çŸ¥é“æ¯ä¸ªä¸œè¥¿æ˜¯å¹²å•¥çš„å°±è¡Œäº†.</p>
<ul>
<li>babel-polyfill: æ±¡æŸ“ç¯å¢ƒ, æ”¯æŒå®ä¾‹æ–¹æ³•(å¦‚æœåªæƒ³å¼•å…¥ä¸€äº›ç‰¹å®šçš„polyfill, é‚£å°±å» <a href="https://github.com/zloirock/core-js#basic" target="_blank" rel="noopener">core-js</a> ä¸­æ‰¾ç›¸åº”çš„æ–¹æ³•è‡ªå·±æ‰‹åŠ¨ require è¿›æ¥); </li>
<li>runtime: æŒ‰éœ€å¼•ç”¨,ä¸æ”¯æŒå®ä¾‹æ–¹æ³•.</li>
</ul>
<p>Created on 2018-4-11 by Cara</p>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2018-04-09</span><i class="fa fa-tag"></i><a href="/tags/Babel/" title="Babel" class="tag">Babel </a></div></div></div></div><div class="share"><div class="evernote"><a href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank" class="fa fa-bookmark"></a></div><div class="weibo"><a href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));" class="fa fa-weibo"></a></div><div class="twitter"><a href="http://twitter.com/home?status=,https://yoursite.com/2018/04/09/Babel/,Cara's Blog,Babelç”Ÿæ€,;" class="fa fa-twitter"></a></div></div><div class="pagination"><ul class="clearfix"><li class="next pagbuttons"><a role="navigation" href="/2018/04/02/è·¨åŸŸ/" title="è·¨åŸŸ" class="btn">ä¸‹ä¸€ç¯‡</a></li></ul></div></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script></body></html>