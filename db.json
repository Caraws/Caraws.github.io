{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"source/img/config.png","path":"img/config.png","modified":1,"renderable":0},{"_id":"source/img/event-loop.gif","path":"img/event-loop.gif","modified":1,"renderable":0},{"_id":"source/img/Promiseæ‰§è¡Œè¿‡ç¨‹.png","path":"img/Promiseæ‰§è¡Œè¿‡ç¨‹.png","modified":1,"renderable":0},{"_id":"source/img/dns.jpg","path":"img/dns.jpg","modified":1,"renderable":0},{"_id":"source/img/http.jpg","path":"img/http.jpg","modified":1,"renderable":0},{"_id":"source/img/tcp.jpg","path":"img/tcp.jpg","modified":1,"renderable":0},{"_id":"themes/anatole/source/css/blog_basic.css","path":"css/blog_basic.css","modified":1,"renderable":1},{"_id":"themes/anatole/source/css/font-awesome.min.css","path":"css/font-awesome.min.css","modified":1,"renderable":1},{"_id":"themes/anatole/source/css/style.css","path":"css/style.css","modified":1,"renderable":1},{"_id":"themes/anatole/source/css/style.scss","path":"css/style.scss","modified":1,"renderable":1},{"_id":"themes/anatole/source/fonts/fontawesome-webfont.eot","path":"fonts/fontawesome-webfont.eot","modified":1,"renderable":1},{"_id":"themes/anatole/source/images/favicon.png","path":"images/favicon.png","modified":1,"renderable":1},{"_id":"themes/anatole/source/fonts/fontawesome-webfont.woff","path":"fonts/fontawesome-webfont.woff","modified":1,"renderable":1},{"_id":"themes/anatole/source/images/logo.png","path":"images/logo.png","modified":1,"renderable":1},{"_id":"themes/anatole/source/images/logo@2x.png","path":"images/logo@2x.png","modified":1,"renderable":1},{"_id":"themes/anatole/source/js/jquery-migrate-1.2.1.min.js","path":"js/jquery-migrate-1.2.1.min.js","modified":1,"renderable":1},{"_id":"themes/anatole/source/js/jquery.appear.js","path":"js/jquery.appear.js","modified":1,"renderable":1},{"_id":"source/img/ip.jpg","path":"img/ip.jpg","modified":1,"renderable":0},{"_id":"themes/anatole/source/fonts/fontawesome-webfont.ttf","path":"fonts/fontawesome-webfont.ttf","modified":1,"renderable":1},{"_id":"source/img/HTTP_IP_TCP_DNS.jpg","path":"img/HTTP_IP_TCP_DNS.jpg","modified":1,"renderable":0},{"_id":"themes/anatole/source/fonts/fontawesome-webfont.svg","path":"fonts/fontawesome-webfont.svg","modified":1,"renderable":1},{"_id":"themes/anatole/source/js/jquery.js","path":"js/jquery.js","modified":1,"renderable":1}],"Cache":[{"_id":"themes/anatole/LICENSE","hash":"359cb81298c1fdbccf531548fc097466b0151be4","modified":1525512183717},{"_id":"themes/anatole/.gitignore","hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc","modified":1525513322066},{"_id":"themes/anatole/README.md","hash":"75a3829b8a316249ec0b4fd8eae2d371de879494","modified":1525512183719},{"_id":"themes/anatole/_config.sample.yml","hash":"2710ebe717d210bc93ca228c54cef6e52e04d161","modified":1525512183720},{"_id":"themes/anatole/_config.yml","hash":"063738b226c712b7716975910baa3a2db3e16a0c","modified":1525513322067},{"_id":"themes/anatole/package.json","hash":"cf731a3ebf3913747fccb6c4c6615eba7d7e88a4","modified":1525512183739},{"_id":"source/_posts/3D-Tags.md","hash":"93e05dc09e0b1a5ca10b2e5d3d6a74a14b07451e","modified":1525512183649},{"_id":"source/_posts/Babel.md","hash":"949befdaf57d93fb841865b10a9723ca537fbb12","modified":1525512183650},{"_id":"source/_posts/CSS-å‚ç›´æ°´å¹³å±…ä¸­å¤§æ•´åˆ.md","hash":"7cff088ce3e84478e20bebee3f03b01f3b17dadd","modified":1525512183653},{"_id":"source/_posts/Flex-å¼¹æ€§ç›’å­.md","hash":"6e8b09d795f12d3b41b2c8e4acf84bcc0f8b4171","modified":1525512183654},{"_id":"source/_posts/HTTP-ä¸Š.md","hash":"18ed070998c3ec3346c70bba976242cde24b3df1","modified":1525512183655},{"_id":"source/_posts/Inheritance-ç»§æ‰¿.md","hash":"df45f4be28c84449a796614704744ba09f9c1268","modified":1525512183657},{"_id":"source/_posts/JavaScript-å…³äºè¿ç®—çš„å°æŠ€å·§.md","hash":"ba84011153394c8d7288d8e89635fdf4ff18e782","modified":1525512183658},{"_id":"source/_posts/JavaScript-æ–¹æ³•é›†.md","hash":"1838716d9e2983e6a94f2b58d4ad66bf9c9d7d8f","modified":1525512183659},{"_id":"source/_posts/JavaScript-æ¨¡å—åŒ–.md","hash":"6e45bba0e5aedfef57b84b4590d47fbafa3aad5e","modified":1525512183660},{"_id":"source/_posts/JavaScript-æ·±æµ…æ‹·è´.md","hash":"2258c36dbadafff3688414e6ff18ade6b1494762","modified":1525512183661},{"_id":"source/_posts/Promise-åˆ†æåŠå®ç°.md","hash":"97f236d58dbf3c467411c6a4e6954afde0c2ff38","modified":1525512183663},{"_id":"source/_posts/Quick-Sort.md","hash":"3970dc470664fca4b6eff1d066a7a857d611fc37","modified":1525512183664},{"_id":"source/_posts/base64-è½¬-blob.md","hash":"8fa3cf7977f55b4586c7c11ed0128bef2ec367f1","modified":1525512183665},{"_id":"source/_posts/cookie-localStorage-and-sessionStorage.md","hash":"cfbe6192c357372f52fd6ba29a70ae2257d2ba75","modified":1525512183667},{"_id":"source/_posts/iisNode.md","hash":"ed01a41b14b4159340b611362f1e2b20ce336596","modified":1525512183670},{"_id":"source/_posts/this-call-and-apply.md","hash":"e076e4af3d3274f7dea90f1282c46dbe716e6a80","modified":1525512183671},{"_id":"source/_posts/äº‹ä»¶ä»£ç†-å§”æ‰˜.md","hash":"19bc39a1b1e710a115363120a4763c5b1042f8c0","modified":1525512183673},{"_id":"source/_posts/ä½è¿ç®—ç¬¦.md","hash":"4478b42ea8f1b9e5e611a9870e2e707923898f63","modified":1525512183674},{"_id":"source/_posts/å…³äºç§»æ¤-HEXO.md","hash":"e025895d531e3ca24575974c618d08f7360b1fdb","modified":1525512183676},{"_id":"source/_posts/å£°æ˜æå‡.md","hash":"2a22e1bcbf765522c5abbce718cfa5394b59381e","modified":1525512183678},{"_id":"source/_posts/ç›’æ¨¡å‹.md","hash":"8dfa73bc87c4e09919834a6bb2e300a6394983e2","modified":1525512183679},{"_id":"source/_posts/è·¨åŸŸ.md","hash":"3ffd9aa73982d3f69eb7c32dd2564aca099f4230","modified":1525512183681},{"_id":"source/_posts/ç½‘ç»œæ‘„åƒæœºç›´æ’­.md","hash":"1ac51081268269710e56c09a3e801b2354f8c769","modified":1525608104018},{"_id":"source/_posts/é—­åŒ…å’Œé«˜é˜¶å‡½æ•°.md","hash":"af05e3fa890f4698b6f056e0688ee3a2cf9c7d16","modified":1525512183683},{"_id":"source/about/index.md","hash":"6c074b4613923a2c3019789467da442f0544d445","modified":1525512183690},{"_id":"source/img/config.png","hash":"30a30132362032ae1458b8f721fb8099c71e0273","modified":1525510810003},{"_id":"source/img/event-loop.gif","hash":"2bfdd4ce07a220efcf7c731a664b63425bb444bf","modified":1525512183703},{"_id":"source/links/index.md","hash":"ee37d42b60b8aaffcb71233484447b3795e81607","modified":1525512183715},{"_id":"themes/anatole/languages/zh-cn.yml","hash":"dab1823e036f4adb3b7ae9efe95a37a15e47bec2","modified":1525512183721},{"_id":"themes/anatole/layout/archive.jade","hash":"1a161404966000b25a84762f08da3ca60af146bc","modified":1525512183722},{"_id":"themes/anatole/layout/category.jade","hash":"ae894ef4baee4a0c7c8e66641166061e789f1fa7","modified":1525512183723},{"_id":"themes/anatole/layout/index.jade","hash":"53da3cfd498951148acb33de1574df80ae282dc5","modified":1525512183724},{"_id":"themes/anatole/layout/mixins.jade","hash":"bc9961b2ea6ecbd9f994b2aeebb3c8ee2e3cc968","modified":1525512183726},{"_id":"themes/anatole/layout/page.jade","hash":"15142c94e5c2247aba8efb64cffd695b3f133670","modified":1525512183727},{"_id":"themes/anatole/layout/post.jade","hash":"2f2b91b98d8f72d105211cdbf312d44ea3b1b145","modified":1525512183736},{"_id":"themes/anatole/layout/tag.jade","hash":"7017a8bae4f4a412dafb556772bdcf2cfddeb79f","modified":1525512183738},{"_id":"source/img/Promiseæ‰§è¡Œè¿‡ç¨‹.png","hash":"242190bdf9af47738db5b6e8f9ab831c3f3306af","modified":1525512183698},{"_id":"source/img/dns.jpg","hash":"c571ab5c508eec11612312d617d3f3563eca743d","modified":1525512183700},{"_id":"source/img/http.jpg","hash":"87501cb87dcf30a9d4964f79280a4b4d302ac140","modified":1525512183707},{"_id":"source/img/tcp.jpg","hash":"4b633b76046e204df6d9aa5eb4a50910f656cf4b","modified":1525512183713},{"_id":"themes/anatole/layout/partial/comments.jade","hash":"6d749e695e30ecfc0a2de2b443fd361f5f2a5cff","modified":1525512183729},{"_id":"themes/anatole/layout/partial/footer.jade","hash":"e709cebfc5dd5b449878496389a98c6221a9a4d2","modified":1525512183730},{"_id":"themes/anatole/layout/partial/head.jade","hash":"3d6126d0b53a889a46ad61eb8cc0ab1b35446c49","modified":1525512183732},{"_id":"themes/anatole/layout/partial/layout.jade","hash":"174050fa9ee919f5bcb2c5426224ec1968db672c","modified":1525512183733},{"_id":"themes/anatole/layout/partial/nav.jade","hash":"1542c32f633c09eb3fa05b828e2051c878e8606a","modified":1525512183734},{"_id":"themes/anatole/layout/partial/sidebar.jade","hash":"a08398d523b76c446ec52e0debab89588eb1ef4f","modified":1525512183736},{"_id":"themes/anatole/source/css/blog_basic.css","hash":"7db88f0873e858b21a4c981c8481708ad9117478","modified":1525512183741},{"_id":"themes/anatole/source/css/font-awesome.min.css","hash":"95d0b0c4d11105c81be1857b744076a1d2bed918","modified":1525512183742},{"_id":"themes/anatole/source/css/style.css","hash":"871a5c940cbc0ce5488a670f2285f2c3015cf71c","modified":1525512183743},{"_id":"themes/anatole/source/css/style.scss","hash":"175c9237798207f705c62777b5f51509adec6d0a","modified":1525512183745},{"_id":"themes/anatole/source/fonts/fontawesome-webfont.eot","hash":"0183979056f0b87616cd99d5c54a48f3b771eee6","modified":1525512183747},{"_id":"themes/anatole/source/images/favicon.png","hash":"d659236704308954da9d64b101c4f54cc3f3255c","modified":1525512183757},{"_id":"themes/anatole/source/fonts/fontawesome-webfont.woff","hash":"7d65e0227d0d7cdc1718119cd2a7dce0638f151c","modified":1525512183756},{"_id":"themes/anatole/source/images/logo.png","hash":"41bdf2ebd8cc193ad82a211758af827d891b1a90","modified":1525512183759},{"_id":"themes/anatole/source/images/logo@2x.png","hash":"49c3fa97724abf53861bf11356ea9ba5bcb11576","modified":1525512183761},{"_id":"themes/anatole/source/js/jquery-migrate-1.2.1.min.js","hash":"743052320809514fb788fe1d3df37fc87ce90452","modified":1525512183763},{"_id":"themes/anatole/source/js/jquery.appear.js","hash":"1f8067d7bd4c0bde30785e8016100f239e14394f","modified":1525512183764},{"_id":"source/img/ip.jpg","hash":"735428d2890f00ad0382dc4cf936db34f7c1ae53","modified":1525512183711},{"_id":"themes/anatole/source/fonts/fontawesome-webfont.ttf","hash":"6225ccc4ec94d060f19efab97ca42d842845b949","modified":1525512183754},{"_id":"source/img/HTTP_IP_TCP_DNS.jpg","hash":"10cdf7d1e760877625f6377e7e179db9a01190dd","modified":1525512183695},{"_id":"themes/anatole/source/fonts/fontawesome-webfont.svg","hash":"cd980eab6db5fa57db670cb2e4278e67e1a4d6c9","modified":1525512183751},{"_id":"themes/anatole/source/js/jquery.js","hash":"bfc05b695dfa4f23e11d04b84993585da7a764bf","modified":1525512183767},{"_id":"public/about/index.html","hash":"617ac8d56a0085e0b68d2268d0a423e008091422","modified":1525608119407},{"_id":"public/links/index.html","hash":"3bb825f5dc3556e131000de50fed3311cc356af9","modified":1525608119407},{"_id":"public/2018/01/03/HTTP-ä¸Š/index.html","hash":"60b71bc788f31cc92562d592bfb22b7549e632ef","modified":1525608119407},{"_id":"public/2017/12/20/å£°æ˜æå‡/index.html","hash":"49ed34f2d60e08e3027c83092b57b731a2c03a40","modified":1525608119407},{"_id":"public/2017/10/22/base64-è½¬-blob/index.html","hash":"6d30a726f162488ef524197b55a98085bf6957d3","modified":1525608119407},{"_id":"public/2017/10/21/ç›’æ¨¡å‹/index.html","hash":"3d6e2772fe0916c6374ac794b4bcf910892db6b5","modified":1525608119407},{"_id":"public/2017/10/18/ä½è¿ç®—ç¬¦/index.html","hash":"7bf40ff68ccc5bda091a8c1cd5fa32575309a249","modified":1525608119407},{"_id":"public/2017/10/17/JavaScript-å…³äºè¿ç®—çš„å°æŠ€å·§/index.html","hash":"0d4574412e60cec522d964cbf2914af3e203ba09","modified":1525608119408},{"_id":"public/2017/10/17/JavaScript-æ¨¡å—åŒ–/index.html","hash":"9a3c240d359c105bc04a499fd8169a1298e3e61f","modified":1525608119408},{"_id":"public/2017/10/17/Quick-Sort/index.html","hash":"68f686f2b9fe125c8401b2388b6362a6cc7cf295","modified":1525608119408},{"_id":"public/2017/10/14/å…³äºç§»æ¤-HEXO/index.html","hash":"a55f7190624c031624296b445325585caea3effa","modified":1525608119408},{"_id":"public/2017/06/11/cookie-localStorage-and-sessionStorage/index.html","hash":"67e556df4650e6875ea062e3b8833addd531e749","modified":1525608119408},{"_id":"public/archives/index.html","hash":"0af31307527c77ae629004c5f1d3e478afca63a8","modified":1525608119408},{"_id":"public/2017/05/28/iisNode/index.html","hash":"25d9485487317add7a3169b96875dcdebf76b925","modified":1525608119408},{"_id":"public/categories/ç¬”è®°ğŸ“’/index.html","hash":"e1b39ca5d340a66961513b0e675da12085ffb887","modified":1525608119408},{"_id":"public/categories/ç¬”è®°ğŸ“’/page/2/index.html","hash":"525b590043a4575e23425642377e09c4671eeedb","modified":1525608119408},{"_id":"public/categories/å¤ä¹ /index.html","hash":"86549e6a61eb93d1ea6d4ca85d665661b5e7d79e","modified":1525608119408},{"_id":"public/categories/ç¬”è®°ğŸ“’/å¤ä¹ /index.html","hash":"31b70adcb1038bbe4351ea6d72c7bc19b6b11b0a","modified":1525608119408},{"_id":"public/categories/å¤ä¹ /ç¬”è®°ğŸ“’/index.html","hash":"9990a4c6da15612d847fa2275c6288cf556b87d5","modified":1525608119408},{"_id":"public/categories/ç¬”è®°ğŸ“’/JavaScriptè®¾è®¡æ¨¡å¼/index.html","hash":"e586ca2a051c7e28dcaa27b97dc1f579dc19670f","modified":1525608119409},{"_id":"public/index.html","hash":"3ca616314a38ce2d55ad8380c9ed78b62c71e1d3","modified":1525608119409},{"_id":"public/page/2/index.html","hash":"cbb82b7786ecdffcac2a03686917eca2e6d9c7f8","modified":1525608119409},{"_id":"public/page/3/index.html","hash":"98ace427afed2d2d7491c1f049cb3b35f3954edd","modified":1525608119409},{"_id":"public/tags/JavaScript/index.html","hash":"c02c566b10724149af2bf5218db90db3232a26dd","modified":1525608119409},{"_id":"public/tags/JavaScript/page/2/index.html","hash":"5971d163ba1bf486928389cb4696e98f80ae0aab","modified":1525608119409},{"_id":"public/tags/Babel/index.html","hash":"e16068bb42d8339a0b4b002f06df96a37e230910","modified":1525608119409},{"_id":"public/tags/CSS/index.html","hash":"2e9f7cad8bbac89ee5611f891be207875b1b7715","modified":1525608119409},{"_id":"public/tags/HTTP/index.html","hash":"a08aba0d220aec344a3de0506a4c8c4aa8b622ab","modified":1525608119409},{"_id":"public/tags/Node-js/index.html","hash":"d9c019e98e0ee097535ead336f729a3b8564579e","modified":1525608119409},{"_id":"public/tags/hexo/index.html","hash":"a6890e23770386b9a75135d6401ac4bc852a5f32","modified":1525608119409},{"_id":"public/tags/FFmpeg/index.html","hash":"3f28bc57a1b73e2a899ac4698c47787309fe8c12","modified":1525608119409},{"_id":"public/2018/05/06/ç½‘ç»œæ‘„åƒæœºç›´æ’­/index.html","hash":"99bd7576aadbcd7dcd1188c32e8acd96a2950467","modified":1525608119409},{"_id":"public/2018/04/09/Babel/index.html","hash":"a8aa897770ca1c6bab5a0e81434123a7a2703c18","modified":1525608119410},{"_id":"public/2018/04/02/è·¨åŸŸ/index.html","hash":"e24e4ce6cc2e08e6b6a13328fe69ed5c4cc47363","modified":1525608119410},{"_id":"public/2018/01/04/Promise-åˆ†æåŠå®ç°/index.html","hash":"1bf100fb2d803b55ae3d1d3150a4e9b5fc641833","modified":1525608119410},{"_id":"public/2017/12/10/äº‹ä»¶ä»£ç†-å§”æ‰˜/index.html","hash":"2462937e61c47664cf5eb82854465472305e5e96","modified":1525608119410},{"_id":"public/2017/11/23/Flex-å¼¹æ€§ç›’å­/index.html","hash":"e5c5c77f574005bace2604b1735845f8cd26e41a","modified":1525608119410},{"_id":"public/2017/10/26/é—­åŒ…å’Œé«˜é˜¶å‡½æ•°/index.html","hash":"b8901fad6ff32287e0a689c2daf4f83b892cf0c2","modified":1525608119410},{"_id":"public/2017/10/17/this-call-and-apply/index.html","hash":"047223e0f95766e3dd361a8a556e60d5bb14c3c2","modified":1525608119410},{"_id":"public/2017/10/16/Inheritance-ç»§æ‰¿/index.html","hash":"a9aeddfda85ddf9bd6885733d79798a945ebe8f9","modified":1525608119410},{"_id":"public/2017/10/16/JavaScript-æ–¹æ³•é›†/index.html","hash":"0141c9677ff3b3f63412562333d1fe1dcdc552ff","modified":1525608119410},{"_id":"public/2017/10/16/JavaScript-æ·±æµ…æ‹·è´/index.html","hash":"61109942e2c90d4fe5a291aa955d45f6728ba240","modified":1525608119410},{"_id":"public/2017/10/15/3D-Tags/index.html","hash":"ebd3dd15c1fb3161879ebfbb3c508694226e866f","modified":1525608119410},{"_id":"public/2017/10/14/CSS-å‚ç›´æ°´å¹³å±…ä¸­å¤§æ•´åˆ/index.html","hash":"bfec164627c7720026cfdd20acf84f8dc0788f32","modified":1525608119411},{"_id":"public/img/config.png","hash":"30a30132362032ae1458b8f721fb8099c71e0273","modified":1525608119420},{"_id":"public/img/event-loop.gif","hash":"2bfdd4ce07a220efcf7c731a664b63425bb444bf","modified":1525608119420},{"_id":"public/css/style.scss","hash":"175c9237798207f705c62777b5f51509adec6d0a","modified":1525608119420},{"_id":"public/fonts/fontawesome-webfont.eot","hash":"0183979056f0b87616cd99d5c54a48f3b771eee6","modified":1525608119420},{"_id":"public/images/favicon.png","hash":"d659236704308954da9d64b101c4f54cc3f3255c","modified":1525608119420},{"_id":"public/fonts/fontawesome-webfont.woff","hash":"7d65e0227d0d7cdc1718119cd2a7dce0638f151c","modified":1525608119420},{"_id":"public/images/logo.png","hash":"41bdf2ebd8cc193ad82a211758af827d891b1a90","modified":1525608119420},{"_id":"public/images/logo@2x.png","hash":"49c3fa97724abf53861bf11356ea9ba5bcb11576","modified":1525608119421},{"_id":"public/fonts/fontawesome-webfont.ttf","hash":"6225ccc4ec94d060f19efab97ca42d842845b949","modified":1525608119424},{"_id":"public/css/blog_basic.css","hash":"7db88f0873e858b21a4c981c8481708ad9117478","modified":1525608119433},{"_id":"public/css/style.css","hash":"871a5c940cbc0ce5488a670f2285f2c3015cf71c","modified":1525608119433},{"_id":"public/js/jquery.appear.js","hash":"1f8067d7bd4c0bde30785e8016100f239e14394f","modified":1525608119433},{"_id":"public/js/jquery-migrate-1.2.1.min.js","hash":"743052320809514fb788fe1d3df37fc87ce90452","modified":1525608119433},{"_id":"public/css/font-awesome.min.css","hash":"95d0b0c4d11105c81be1857b744076a1d2bed918","modified":1525608119433},{"_id":"public/js/jquery.js","hash":"bfc05b695dfa4f23e11d04b84993585da7a764bf","modified":1525608119433},{"_id":"public/img/Promiseæ‰§è¡Œè¿‡ç¨‹.png","hash":"242190bdf9af47738db5b6e8f9ab831c3f3306af","modified":1525608119433},{"_id":"public/img/dns.jpg","hash":"c571ab5c508eec11612312d617d3f3563eca743d","modified":1525608119433},{"_id":"public/img/http.jpg","hash":"87501cb87dcf30a9d4964f79280a4b4d302ac140","modified":1525608119433},{"_id":"public/img/tcp.jpg","hash":"4b633b76046e204df6d9aa5eb4a50910f656cf4b","modified":1525608119433},{"_id":"public/img/ip.jpg","hash":"735428d2890f00ad0382dc4cf936db34f7c1ae53","modified":1525608119437},{"_id":"public/fonts/fontawesome-webfont.svg","hash":"cd980eab6db5fa57db670cb2e4278e67e1a4d6c9","modified":1525608119439},{"_id":"public/img/HTTP_IP_TCP_DNS.jpg","hash":"10cdf7d1e760877625f6377e7e179db9a01190dd","modified":1525608119441}],"Category":[{"name":"ç¬”è®°ğŸ“’","_id":"cjgurols40003klu02o1j9n49"},{"name":"å¤ä¹ ","_id":"cjgurols90008klu0z44o06zl"},{"name":"å¤ä¹ ","parent":"cjgurols40003klu02o1j9n49","_id":"cjgurolsi000lklu0kn8vukl0"},{"name":"ç¬”è®°ğŸ“’","parent":"cjgurols90008klu0z44o06zl","_id":"cjgurolsp0010klu0ba4jc3og"},{"name":"JavaScriptè®¾è®¡æ¨¡å¼","parent":"cjgurols40003klu02o1j9n49","_id":"cjgurolsv001hklu0d8gvjlqo"}],"Data":[],"Page":[{"title":"about","date":"2017-10-14T13:52:34.000Z","_content":"\nä¸€ä¸ªåæ ‡æˆéƒ½çš„å°å°å‰ç«¯å¼€å‘è€…ğŸ™‚\n\n#### Concat\nEmail: enp4eGNjbGxvb3BwQGxpdmUuY29t\n\nGitHub: [Caraws](https://github.com/Caraws)\n","source":"about/index.md","raw":"---\ntitle: about\ndate: 2017-10-14 21:52:34\n---\n\nä¸€ä¸ªåæ ‡æˆéƒ½çš„å°å°å‰ç«¯å¼€å‘è€…ğŸ™‚\n\n#### Concat\nEmail: enp4eGNjbGxvb3BwQGxpdmUuY29t\n\nGitHub: [Caraws](https://github.com/Caraws)\n","updated":"2018-05-05T09:23:03.690Z","path":"about/index.html","comments":1,"layout":"page","_id":"cjgurols10001klu0c2bhwd1a","content":"<p>ä¸€ä¸ªåæ ‡æˆéƒ½çš„å°å°å‰ç«¯å¼€å‘è€…ğŸ™‚</p>\n<h4 id=\"Concat\"><a href=\"#Concat\" class=\"headerlink\" title=\"Concat\"></a>Concat</h4><p>Email: enp4eGNjbGxvb3BwQGxpdmUuY29t</p>\n<p>GitHub: <a href=\"https://github.com/Caraws\" target=\"_blank\" rel=\"noopener\">Caraws</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p>ä¸€ä¸ªåæ ‡æˆéƒ½çš„å°å°å‰ç«¯å¼€å‘è€…ğŸ™‚</p>\n<h4 id=\"Concat\"><a href=\"#Concat\" class=\"headerlink\" title=\"Concat\"></a>Concat</h4><p>Email: enp4eGNjbGxvb3BwQGxpdmUuY29t</p>\n<p>GitHub: <a href=\"https://github.com/Caraws\" target=\"_blank\" rel=\"noopener\">Caraws</a></p>\n"},{"title":"links","date":"2017-10-14T14:22:15.000Z","_content":"\nå°ä¼™ä¼´ä»¬:\n\n[é˜¿ç§‘](https://fairfarren.github.io/)\n[å¤§ä½¬](https://blog.iihaiku.com/)\n","source":"links/index.md","raw":"---\ntitle: links\ndate: 2017-10-14 22:22:15\n---\n\nå°ä¼™ä¼´ä»¬:\n\n[é˜¿ç§‘](https://fairfarren.github.io/)\n[å¤§ä½¬](https://blog.iihaiku.com/)\n","updated":"2018-05-05T09:23:03.715Z","path":"links/index.html","comments":1,"layout":"page","_id":"cjgurom6z002oklu002qbu9nj","content":"<p>å°ä¼™ä¼´ä»¬:</p>\n<p><a href=\"https://fairfarren.github.io/\" target=\"_blank\" rel=\"noopener\">é˜¿ç§‘</a><br><a href=\"https://blog.iihaiku.com/\" target=\"_blank\" rel=\"noopener\">å¤§ä½¬</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p>å°ä¼™ä¼´ä»¬:</p>\n<p><a href=\"https://fairfarren.github.io/\" target=\"_blank\" rel=\"noopener\">é˜¿ç§‘</a><br><a href=\"https://blog.iihaiku.com/\" target=\"_blank\" rel=\"noopener\">å¤§ä½¬</a></p>\n"}],"Post":[{"title":"3D-Tags","date":"2017-10-15T10:25:44.000Z","_content":"3D æ ‡ç­¾äº‘\nç»ƒä¹ canvasçš„3Dæ•ˆæœ,  çƒä½“ç®—æ³•, æ­£å¥½IFE çš„é¡¹ç›®æœ‰å°±è®°å½•ä¸€ä¸‹å’¯.\n\n### å¤§æ¦‚æ€è·¯\né¦–å…ˆ3Däº‘å…¶å®å°±æ˜¯ä¸€ä¸ªçƒä½“, åœ¨è¿™ä¸ªçƒä½“ä¸Šå¹³å‡åˆ†å¸ƒå„ä¸ªç‚¹, å†æŠŠè¿™äº›ç‚¹\nçš„åæ ‡èµ‹ç»™æ ‡ç­¾,è®¡ç®—ä¸€ä¸‹ z è½´çš„å¤§å°, æœ€åé€šè¿‡æ”¹å˜å­—ä½“çš„å¤§å°/ é€æ˜åº¦\nå°±å¯ä»¥æ¨¡æ‹Ÿå‡ºç«‹ä½“çš„æ•ˆæœå•¦.\n\n### ç›¸å…³çš„ä¸€äº›å…¬å¼åŠè¯´æ˜\n\n1. çƒä½“ x/ y/ z è½´çš„åæ ‡ç‚¹ \nå·²çŸ¥åŠå¾„ R å’Œçƒå¿ƒ, æ–¹ä¾¿èµ·è§ä¸€èˆ¬éƒ½ä»¥åæ ‡è½´çš„åŸç‚¹ä½œä¸ºçƒå¿ƒ. æœ‰å¦‚ä¸‹ä¸‰ä¸ªæ–¹ç¨‹å¼:\n```javascript\nx = R * sinÎ¸ * cosÃ¸\ny = R * sinÎ¸ * sinÃ¸\nz = R * cosÎ¸\n```\n\nå…¶ä¸­Î¸ å’Œ Ã¸ å¯ä»¥å»éšæœºæ•°, æ¥è·å–åœ†ä¸Šçš„éšæœºç‚¹åæ ‡. ä½†æ˜¯3D äº‘çš„åæ ‡ç‚¹æ˜¯éœ€è¦å‡åŒ€åˆ†é…çš„åæ ‡ç‚¹, æ‰€ä»¥å…‰æ˜¯å»éšæœºç‚¹æ˜¯ä¸å¤Ÿçš„. æ‰€ä»¥åˆæœ‰äº†ä¸‹é¢çš„å…¬å¼:\n\n```javascript\n// index ä¸ºå½“å‰ç´¢å¼•, length ä¸ºæ ‡ç­¾é•¿åº¦\n// è¿™æ®µæˆ‘ä¹Ÿä¸æ‡‚åŸç†æ˜¯ä»€ä¹ˆ, åœ¨åˆ«äººçš„ä»£ç é‡Œçœ‹è§çš„...\nÎ¸ = acos((2 * (index + 1) - 1) / length - 1)\n// n å– Math.PI\nÃ¸ = Î¸ * sqrt(length * n)\n```\n\n#### å…³é”®ä»£ç \n```javascript\nconst setBall = _ => {\n\t// æ ‡ç­¾\n\tlet tagLabel = document.querySelector('.tag');\n\tfor (let i =0, len = tagLabel.length; i < len; i++) {\n\t\tlet k = (2 * (i + 1) - 1) / len - 1,\n\t\t\ta = acos(k), // ä¸Šè¿°Î¸ \n\t\t\tb = a * sqrt(len * Math.PI), // ä¸Šè¿°Ã¸\n\t\t\tx = radius * Math.sin(a) * Math.cos(b), \n\t\t\ty = radius * Math.sin(a) * Math.sin(b),\n\t\t\tz = radius * Math.cos(a);\n\t\t// è®©çƒä½“åŠ¨èµ·æ¥, æˆ‘ä»¬å…ˆæŠŠæ–¹æ³•æ”¾åœ¨è¿™å„¿\n\t\tlet t = new tag(tagLabel[i], x, y, z);\n\t\t\ttags.push(t);\n\t\t\tt.move()\n\t}\n}\n```\n\nä»¥ä¸Šå°±å¯ä»¥å–å¾—çƒä½“æ‰€éœ€çš„å¹³å‡åæ ‡ç‚¹, æ¥ä¸‹æ¥æˆ‘ä»¬å°±éœ€è¦å»æ“ä½œ DOM æ¯ä¸ªæ ‡ç­¾äº†.\n\n2. æ ‡ç­¾å­—ä½“åŠé€æ˜åº¦è®¡ç®—\n```javascript\n// fallLength ä¸ºç„¦è·\nlet scale = fallLength/ (fallLength - this.z),\n\t  opa = (this.z + radius) / (2 * radius);\n// æ¯ä¸ªæ ‡ç­¾æ·»åŠ æ ·å¼\nthis.element.style.cssText = `color: rgb(\n\t${parseInt(Math.random() * 255)}, \n\t${parseInt(Math.random() * 255)}, \n\t${parseInt(Math.random() * 255)});\n\tfont-size: ${parseInt(15 * scale)}px;\n\topacity: ${opa + 0.5};\n\tz-index: ${parseInt(scale * 100)};\n\tleft: ${this.x + CX - this.element.offsetWidth / 2}px;\n\ttop: ${this.y + CY - this.element.offsetHeight / 2}px`;\n```\n\nfallLength æ˜¯ç„¦è·, ä¹Ÿæ˜¯ä¸€ä¸ªå¸¸é‡, scale å’Œ opacity éƒ½è¦é€šè¿‡ z è½´æ¥è°ƒæ•´çš„. è¿™é‡Œä¹Ÿæ˜¯ä»åˆ«äººçš„ä»£ç é‡Œçœ‹åˆ°çš„, åº”è¯¥ä¹Ÿæ˜¯å…¬å¼å§; åé¢å°±æ˜¯è°ƒæ•´å­—ä½“å¤§å°/ é€æ˜åº¦, æ ‡ç­¾ä½ç½®çš„æ“ä½œäº†. ä»¥ä¸Šè®¡ç®—å°±æ˜¯`move()`å‡½æ•°ä¸­çš„å†…å®¹. ç°åœ¨çƒä½“å·²ç»å‡ºæ¥äº†, é‚£ä¹ˆå°±è¯¥è®©ä»–åŠ¨èµ·æ¥äº†.\n\n3. æ—‹è½¬ç®—æ³•\nä¸ºäº†è®©çƒä½“åŠ¨èµ·æ¥, æˆ‘ä»¬éœ€è¦çŸ¥é“ä¸‹é¢è¿™ä¸‰ä¸ªå…¬å¼: \n\n![æ—‹è½¬å…¬å¼](http://orf90agxq.bkt.clouddn.com/3d_tags/rotate.png)\n\nç„¶åæˆ‘ä»¬éœ€è¦ä¸¤ä¸ªå‡½æ•°, x è½´é€‰æ‹©å’Œ y è½´æ—‹è½¬, å…³é”®ä»£ç å¦‚ä¸‹:\n```javascript\nconst rotateX = _ => {\n\t// angleX æ˜¯äº‹å…ˆå®šä¹‰å¥½çš„è§’åº¦å€¼\n\tlet sin = Math.sin(angleX),\n\t\tcos = Math.cos(angleX);\n\ttags.forEach(function () {\n\t\tlet y1 = this.y * cos - this.z * sin,\n\t\t\tz1 = this.z * cos + this.y * sin;\n\t\tthis.y = y1;\n\t\tthis.z = z1;\n\t})\n}\n\nconst rotateY = _ =>{\n\t// angleY æ˜¯äº‹å…ˆå®šä¹‰å¥½çš„è§’åº¦å€¼\n\tlet cos = Math.cos(angleY),\n     \tsin = Math.sin(angleY);\n\ttags.forEach(function () {\n\t\tlet x1 = this.x * cos - this.z * sin,\n\t\t\tz1 = this.z * cos + this.x * sin;\n\t\tthis.x = x1;\n\t\tthis.z = z1;\n\t})\n}\n```\nè¿™é‡Œ angleX å’Œ angleY ä¸ºè§’åº¦å€¼, ç”¨æ¥æ§åˆ¶æ ‡ç­¾äº‘çš„æ—‹è½¬æ–¹å‘å’Œé€Ÿåº¦. è§’åº¦çš„æ­£è´Ÿå€¼æ§åˆ¶æ—‹è½¬æ–¹å‘; å¤§å°æ§åˆ¶æ—‹è½¬é€Ÿåº¦.\n\n4. é¼ æ ‡æ§åˆ¶\nè¿™é‡Œå°±æ˜¯æœ€åä¸€æ­¥äº†, é€šè¿‡é¼ æ ‡æ”¹å˜çƒä½“çš„æ—‹è½¬æ–¹å‘. è¿™é‡Œæˆ‘åšäº†ä¸€ç‚¹ç‚¹æ‰©å±•å‡ ä¸ªè¾“å…¥æ¡†, å¯ä»¥è®©ç”¨æˆ·è‡ªç”±å¡«å†™äº‘å†…å®¹/ æ•°é‡åŠæ—‹è½¬é€Ÿåº¦, ä¸‹é¢ç›´æ¥çœ‹ä»£ç å§.\n\n```javascript\n// æ¥ä¸ªäº‹ä»¶ç›‘å¬\nconst addEvent = function (element, event, fn) {\n\t\tif (element.addEventListener) {\n\t\t\telement.addEventListener(event, fn, false)\n\t\t}else if (element.attachEvent) {\n\t\t\telement.attachEvent('on' + event, fn)\n\t\t}else {\n\t\t\telement['on' + event] = fn\n\t\t}\n\t};\n\n// è·å–ç”¨æˆ·è¾“å…¥æ ‡ç­¾\naddEvent(content, 'blur', function () {\n\tif (!!this.value) {\n\t\tconsole.log(typeof this.value)\n\t\tdata = this.value.split(',');\n\t\tcreateLabel(data, num);\n\t\tlet item = document.querySelectorAll('.tag');\n\t\tsetBall(item)\n\t}\n});\n\n// è·å–ç”¨æˆ·è¾“å…¥æ•°é‡\naddEvent(numberLabel, 'blur', function () {\n\tif (+this.value < 0 || +this.value > 200) {\n\t\talert('è¯·å¡«å†™11 - 200ä¹‹é—´çš„æ•°å€¼')\n\t}else {\n\t\tnum = +this.value;\n\t\tcreateLabel(data, num);\n\t\tlet item = document.querySelectorAll('.tag');\n\t\tsetBall(item)\n\t}\n})\n\n// è·å–è½¬é€Ÿ\naddEvent(speedLabel, 'blur', function () {\n\tif (+this.value < 0) {\n\t\talert('è¯·è¾“å…¥å¤§äº0çš„æ•°å€¼')\n\t}else {\n\t\tspeed = +this.value;\n\t\tclearInterval(interval)\n\t\tanimate()\n\t}\n})\n\n// é¼ æ ‡ç§»åŠ¨\naddEvent(container, \"mousemove\", function (e) {\n\t// EX: å®½åº¦çš„ä¸€åŠ; CX: å·¦è¾¹è·\n\t// EY: é«˜åº¦çš„ä¸€åŠ; CY: ä¸Šè¾¹è·\n\tvar x = e.clientX - EX - CX;\n  \tvar y = e.clientY - EY - CY;\n  \tangleX = y * 0.0001;\n  \tangleY = x * 0.0001;\n});\n```\nåˆ°è¿™é‡Œ3D äº‘çš„æµç¨‹å·®ä¸å¤šå°±èµ°å®Œäº†, ä¸‹é¢æ”¾ä¸€ä¸ªå®Œæ•´çš„ js éƒ¨åˆ†ä»£ç å§.\n\n```javascript\n(function (global) {\n\tlet speedLabel = document.getElementById('speed'),\n\t\tnumberLabel = document.getElementById('number'),\n\t\tdata = [\"JavaScript\", \"Node.Js\", \"HTML\", \"CSS\", \"vue\", \"react\"\n\t\t\t\t, \"JQuery\", \"Webpack\", \"Babel\", \"ES6\", \"WebSocket\"],\n\t\tcontainer = document.querySelector('.container'),\n\t\tcontent = document.getElementById('content'),\n\t\tinterval,\n\t\tspeed = 100,\n\t\tnum = 120,\n\t\tradius = 300,\n\t\tfallLength = 500,\n\t\tangleX = Math.PI / 500,\n\t\tangleY = Math.PI / 500,\n\t\tCX = container.offsetWidth / 2,\n\t\tCY = container.offsetHeight / 2,\n\t\tEX = container.offsetLeft,\n\t\tEY = container.offsetTop;\n\n\n\t// åˆ›å»ºæ ‡ç­¾\n\tconst createLabel = (data, num) => {\n\t\tlet html = '', index;\n\t\tfor (let i = 0; i < num; i++) {\n\t\t\tindex = Math.floor(Math.random() * data.length);\n\t\t\thtml += `<label class='tag'>${data[index]}</label>`;\n\t\t}\n\t\tcontainer.innerHTML = html;\n\t};\n\n\t// äº‹ä»¶ç›‘å¬\n\tconst addEvent = function (element, event, fn) {\n\t\tif (element.addEventListener) {\n\t\t\telement.addEventListener(event, fn, false)\n\t\t}else if (element.attachEvent) {\n\t\t\telement.attachEvent('on' + event, fn)\n\t\t}else {\n\t\t\telement['on' + event] = fn\n\t\t}\n\t};\n\n\t// è·å–ç”¨æˆ·è¾“å…¥æ ‡ç­¾\n\taddEvent(content, 'blur', function () {\n\t\tif (!!this.value) {\n\t\t\tconsole.log(typeof this.value)\n\t\t\tdata = this.value.split(',');\n\t\t\tcreateLabel(data, num);\n\t\t\tlet item = document.querySelectorAll('.tag');\n\t\t\tsetBall(item)\n\t\t}\n\t});\n\n\t// è·å–ç”¨æˆ·è¾“å…¥æ•°é‡\n\taddEvent(numberLabel, 'blur', function () {\n\t\tif (+this.value < 0 || +this.value > 200) {\n\t\t\talert('è¯·å¡«å†™11 - 200ä¹‹é—´çš„æ•°å€¼')\n\t\t}else {\n\t\t\tnum = +this.value;\n\t\t\tcreateLabel(data, num);\n\t\t\tlet item = document.querySelectorAll('.tag');\n\t\t\tsetBall(item)\n\t\t}\n\t})\n\n\t// è·å–è½¬é€Ÿ\n\taddEvent(speedLabel, 'blur', function () {\n\t\tif (+this.value < 0) {\n\t\t\talert('è¯·è¾“å…¥å¤§äº0çš„æ•°å€¼')\n\t\t}else {\n\t\t\tspeed = +this.value;\n\t\t\tclearInterval(interval)\n\t\t\tanimate()\n\t\t}\n\t})\n\n\tlet tags = [];\n\n\t// setBall\n\tconst setBall = _ => {\n\t\tlet tagLabel = document.querySelectorAll('.tag');\n\t\tfor (let i = 0; i < tagLabel.length; i++) {\n\t\t\tlet k = (2 * (i + 1) - 1) / tagLabel.length - 1,\n\t\t\t\ta = Math.acos(k), // åä½™å¼¦\n\t\t\t\tb = a * Math.sqrt(tagLabel.length * Math.PI), // å¹³æ–¹æ ¹\n\t\t\t\tx = radius * Math.sin(a) * Math.cos(b),\n\t\t\t\ty = radius * Math.sin(a) * Math.sin(b),\n\t\t\t\tz = radius * Math.cos(a);\n\n\t\t\tlet t = new tag(tagLabel[i], x, y, z);\n\t\t\ttags.push(t);\n\t\t\tt.move()\n\t\t}\n\t};\n\n\tArray.prototype.forEach = function (callback) {\n        for(let i = 0; i < this.length; i++) {\n            callback.call(this[i]);\n        }\n    }\n\n\n\n\tfunction tag (el, x, y, z) {\n\n\t\tthis.element = el;\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.z = z;\n\t}\n\n\ttag.prototype = {\n\t\tmove: function () {\n\t\t\tlet scale = fallLength/ (fallLength - this.z),\n\t\t\t\topa = (this.z + radius) / (2 * radius);\n\t\t\tthis.element.style.cssText = `color: rgb(${parseInt(Math.random() * 255)}, \n\t\t\t\t${parseInt(Math.random() * 255)}, ${parseInt(Math.random() * 255)});\n\t\t\t\tfont-size: ${parseInt(15 * scale)}px;\n\t\t\t\topacity: ${opa + 0.5};\n\t\t\t\tz-index: ${parseInt(scale * 100)};\n\t\t\t\tleft: ${this.x + CX - this.element.offsetWidth / 2}px;\n\t\t\t\ttop: ${this.y + CY - this.element.offsetHeight / 2}px`;\n\t\t}\n\t}\n\n\tconst animate = _ => {\n\t\tinterval = setInterval(function () {\n\t\t\trotateX();\n\t\t\trotateY();\n\t\t\ttags.forEach(function () {\n\t\t\t\tthis.move()\n\t\t\t})\n\t\t}, speed)\n\t};\n\n\tconst rotateX = _ => {\n\t\tlet sin = Math.sin(angleX),\n\t\t\tcos = Math.cos(angleX);\n\t\ttags.forEach(function () {\n\t\t\tlet y1 = this.y * cos - this.z * sin,\n\t\t\t\tz1 = this.z * cos + this.y * sin;\n\t\t\tthis.y = y1;\n\t\t\tthis.z = z1;\n\t\t})\n\t}\n\n\tconst rotateY = _ =>{\n\t\tvar cos = Math.cos(angleY),\n        \tsin = Math.sin(angleY);\n        tags.forEach(function () {\n            var x1 = this.x * cos - this.z * sin;\n            var z1 = this.z * cos + this.x * sin;\n            this.x = x1;\n            this.z = z1;\n        })\n\t}\n\n\t// é¼ æ ‡ç§»åŠ¨\n\taddEvent(container, \"mousemove\", function (e) {\n        var x = e.clientX - EX - CX;\n        var y = e.clientY - EY - CY;\n        angleX = y * 0.0001;\n        angleY = x * 0.0001;\n    });\n\n\t// åˆå§‹åŒ–\n\tcreateLabel(data, num);\n\tvar tagLabel = document.querySelectorAll('.tag');\n\tsetBall(tagLabel);\n\tanimate()\n})(window)\n```\n\nCreated on 17-10-8 by Cara\n[åœ¨çº¿é¢„è§ˆ demo](https://caraws.github.io/IFE/IFE2017/3d-tags/index.html)\n","source":"_posts/3D-Tags.md","raw":"---\ntitle: 3D-Tags\ndate: 2017-10-15 18:25:44\ncategories:\n- ç¬”è®°ğŸ“’\ntags:\n- JavaScript\n---\n3D æ ‡ç­¾äº‘\nç»ƒä¹ canvasçš„3Dæ•ˆæœ,  çƒä½“ç®—æ³•, æ­£å¥½IFE çš„é¡¹ç›®æœ‰å°±è®°å½•ä¸€ä¸‹å’¯.\n\n### å¤§æ¦‚æ€è·¯\né¦–å…ˆ3Däº‘å…¶å®å°±æ˜¯ä¸€ä¸ªçƒä½“, åœ¨è¿™ä¸ªçƒä½“ä¸Šå¹³å‡åˆ†å¸ƒå„ä¸ªç‚¹, å†æŠŠè¿™äº›ç‚¹\nçš„åæ ‡èµ‹ç»™æ ‡ç­¾,è®¡ç®—ä¸€ä¸‹ z è½´çš„å¤§å°, æœ€åé€šè¿‡æ”¹å˜å­—ä½“çš„å¤§å°/ é€æ˜åº¦\nå°±å¯ä»¥æ¨¡æ‹Ÿå‡ºç«‹ä½“çš„æ•ˆæœå•¦.\n\n### ç›¸å…³çš„ä¸€äº›å…¬å¼åŠè¯´æ˜\n\n1. çƒä½“ x/ y/ z è½´çš„åæ ‡ç‚¹ \nå·²çŸ¥åŠå¾„ R å’Œçƒå¿ƒ, æ–¹ä¾¿èµ·è§ä¸€èˆ¬éƒ½ä»¥åæ ‡è½´çš„åŸç‚¹ä½œä¸ºçƒå¿ƒ. æœ‰å¦‚ä¸‹ä¸‰ä¸ªæ–¹ç¨‹å¼:\n```javascript\nx = R * sinÎ¸ * cosÃ¸\ny = R * sinÎ¸ * sinÃ¸\nz = R * cosÎ¸\n```\n\nå…¶ä¸­Î¸ å’Œ Ã¸ å¯ä»¥å»éšæœºæ•°, æ¥è·å–åœ†ä¸Šçš„éšæœºç‚¹åæ ‡. ä½†æ˜¯3D äº‘çš„åæ ‡ç‚¹æ˜¯éœ€è¦å‡åŒ€åˆ†é…çš„åæ ‡ç‚¹, æ‰€ä»¥å…‰æ˜¯å»éšæœºç‚¹æ˜¯ä¸å¤Ÿçš„. æ‰€ä»¥åˆæœ‰äº†ä¸‹é¢çš„å…¬å¼:\n\n```javascript\n// index ä¸ºå½“å‰ç´¢å¼•, length ä¸ºæ ‡ç­¾é•¿åº¦\n// è¿™æ®µæˆ‘ä¹Ÿä¸æ‡‚åŸç†æ˜¯ä»€ä¹ˆ, åœ¨åˆ«äººçš„ä»£ç é‡Œçœ‹è§çš„...\nÎ¸ = acos((2 * (index + 1) - 1) / length - 1)\n// n å– Math.PI\nÃ¸ = Î¸ * sqrt(length * n)\n```\n\n#### å…³é”®ä»£ç \n```javascript\nconst setBall = _ => {\n\t// æ ‡ç­¾\n\tlet tagLabel = document.querySelector('.tag');\n\tfor (let i =0, len = tagLabel.length; i < len; i++) {\n\t\tlet k = (2 * (i + 1) - 1) / len - 1,\n\t\t\ta = acos(k), // ä¸Šè¿°Î¸ \n\t\t\tb = a * sqrt(len * Math.PI), // ä¸Šè¿°Ã¸\n\t\t\tx = radius * Math.sin(a) * Math.cos(b), \n\t\t\ty = radius * Math.sin(a) * Math.sin(b),\n\t\t\tz = radius * Math.cos(a);\n\t\t// è®©çƒä½“åŠ¨èµ·æ¥, æˆ‘ä»¬å…ˆæŠŠæ–¹æ³•æ”¾åœ¨è¿™å„¿\n\t\tlet t = new tag(tagLabel[i], x, y, z);\n\t\t\ttags.push(t);\n\t\t\tt.move()\n\t}\n}\n```\n\nä»¥ä¸Šå°±å¯ä»¥å–å¾—çƒä½“æ‰€éœ€çš„å¹³å‡åæ ‡ç‚¹, æ¥ä¸‹æ¥æˆ‘ä»¬å°±éœ€è¦å»æ“ä½œ DOM æ¯ä¸ªæ ‡ç­¾äº†.\n\n2. æ ‡ç­¾å­—ä½“åŠé€æ˜åº¦è®¡ç®—\n```javascript\n// fallLength ä¸ºç„¦è·\nlet scale = fallLength/ (fallLength - this.z),\n\t  opa = (this.z + radius) / (2 * radius);\n// æ¯ä¸ªæ ‡ç­¾æ·»åŠ æ ·å¼\nthis.element.style.cssText = `color: rgb(\n\t${parseInt(Math.random() * 255)}, \n\t${parseInt(Math.random() * 255)}, \n\t${parseInt(Math.random() * 255)});\n\tfont-size: ${parseInt(15 * scale)}px;\n\topacity: ${opa + 0.5};\n\tz-index: ${parseInt(scale * 100)};\n\tleft: ${this.x + CX - this.element.offsetWidth / 2}px;\n\ttop: ${this.y + CY - this.element.offsetHeight / 2}px`;\n```\n\nfallLength æ˜¯ç„¦è·, ä¹Ÿæ˜¯ä¸€ä¸ªå¸¸é‡, scale å’Œ opacity éƒ½è¦é€šè¿‡ z è½´æ¥è°ƒæ•´çš„. è¿™é‡Œä¹Ÿæ˜¯ä»åˆ«äººçš„ä»£ç é‡Œçœ‹åˆ°çš„, åº”è¯¥ä¹Ÿæ˜¯å…¬å¼å§; åé¢å°±æ˜¯è°ƒæ•´å­—ä½“å¤§å°/ é€æ˜åº¦, æ ‡ç­¾ä½ç½®çš„æ“ä½œäº†. ä»¥ä¸Šè®¡ç®—å°±æ˜¯`move()`å‡½æ•°ä¸­çš„å†…å®¹. ç°åœ¨çƒä½“å·²ç»å‡ºæ¥äº†, é‚£ä¹ˆå°±è¯¥è®©ä»–åŠ¨èµ·æ¥äº†.\n\n3. æ—‹è½¬ç®—æ³•\nä¸ºäº†è®©çƒä½“åŠ¨èµ·æ¥, æˆ‘ä»¬éœ€è¦çŸ¥é“ä¸‹é¢è¿™ä¸‰ä¸ªå…¬å¼: \n\n![æ—‹è½¬å…¬å¼](http://orf90agxq.bkt.clouddn.com/3d_tags/rotate.png)\n\nç„¶åæˆ‘ä»¬éœ€è¦ä¸¤ä¸ªå‡½æ•°, x è½´é€‰æ‹©å’Œ y è½´æ—‹è½¬, å…³é”®ä»£ç å¦‚ä¸‹:\n```javascript\nconst rotateX = _ => {\n\t// angleX æ˜¯äº‹å…ˆå®šä¹‰å¥½çš„è§’åº¦å€¼\n\tlet sin = Math.sin(angleX),\n\t\tcos = Math.cos(angleX);\n\ttags.forEach(function () {\n\t\tlet y1 = this.y * cos - this.z * sin,\n\t\t\tz1 = this.z * cos + this.y * sin;\n\t\tthis.y = y1;\n\t\tthis.z = z1;\n\t})\n}\n\nconst rotateY = _ =>{\n\t// angleY æ˜¯äº‹å…ˆå®šä¹‰å¥½çš„è§’åº¦å€¼\n\tlet cos = Math.cos(angleY),\n     \tsin = Math.sin(angleY);\n\ttags.forEach(function () {\n\t\tlet x1 = this.x * cos - this.z * sin,\n\t\t\tz1 = this.z * cos + this.x * sin;\n\t\tthis.x = x1;\n\t\tthis.z = z1;\n\t})\n}\n```\nè¿™é‡Œ angleX å’Œ angleY ä¸ºè§’åº¦å€¼, ç”¨æ¥æ§åˆ¶æ ‡ç­¾äº‘çš„æ—‹è½¬æ–¹å‘å’Œé€Ÿåº¦. è§’åº¦çš„æ­£è´Ÿå€¼æ§åˆ¶æ—‹è½¬æ–¹å‘; å¤§å°æ§åˆ¶æ—‹è½¬é€Ÿåº¦.\n\n4. é¼ æ ‡æ§åˆ¶\nè¿™é‡Œå°±æ˜¯æœ€åä¸€æ­¥äº†, é€šè¿‡é¼ æ ‡æ”¹å˜çƒä½“çš„æ—‹è½¬æ–¹å‘. è¿™é‡Œæˆ‘åšäº†ä¸€ç‚¹ç‚¹æ‰©å±•å‡ ä¸ªè¾“å…¥æ¡†, å¯ä»¥è®©ç”¨æˆ·è‡ªç”±å¡«å†™äº‘å†…å®¹/ æ•°é‡åŠæ—‹è½¬é€Ÿåº¦, ä¸‹é¢ç›´æ¥çœ‹ä»£ç å§.\n\n```javascript\n// æ¥ä¸ªäº‹ä»¶ç›‘å¬\nconst addEvent = function (element, event, fn) {\n\t\tif (element.addEventListener) {\n\t\t\telement.addEventListener(event, fn, false)\n\t\t}else if (element.attachEvent) {\n\t\t\telement.attachEvent('on' + event, fn)\n\t\t}else {\n\t\t\telement['on' + event] = fn\n\t\t}\n\t};\n\n// è·å–ç”¨æˆ·è¾“å…¥æ ‡ç­¾\naddEvent(content, 'blur', function () {\n\tif (!!this.value) {\n\t\tconsole.log(typeof this.value)\n\t\tdata = this.value.split(',');\n\t\tcreateLabel(data, num);\n\t\tlet item = document.querySelectorAll('.tag');\n\t\tsetBall(item)\n\t}\n});\n\n// è·å–ç”¨æˆ·è¾“å…¥æ•°é‡\naddEvent(numberLabel, 'blur', function () {\n\tif (+this.value < 0 || +this.value > 200) {\n\t\talert('è¯·å¡«å†™11 - 200ä¹‹é—´çš„æ•°å€¼')\n\t}else {\n\t\tnum = +this.value;\n\t\tcreateLabel(data, num);\n\t\tlet item = document.querySelectorAll('.tag');\n\t\tsetBall(item)\n\t}\n})\n\n// è·å–è½¬é€Ÿ\naddEvent(speedLabel, 'blur', function () {\n\tif (+this.value < 0) {\n\t\talert('è¯·è¾“å…¥å¤§äº0çš„æ•°å€¼')\n\t}else {\n\t\tspeed = +this.value;\n\t\tclearInterval(interval)\n\t\tanimate()\n\t}\n})\n\n// é¼ æ ‡ç§»åŠ¨\naddEvent(container, \"mousemove\", function (e) {\n\t// EX: å®½åº¦çš„ä¸€åŠ; CX: å·¦è¾¹è·\n\t// EY: é«˜åº¦çš„ä¸€åŠ; CY: ä¸Šè¾¹è·\n\tvar x = e.clientX - EX - CX;\n  \tvar y = e.clientY - EY - CY;\n  \tangleX = y * 0.0001;\n  \tangleY = x * 0.0001;\n});\n```\nåˆ°è¿™é‡Œ3D äº‘çš„æµç¨‹å·®ä¸å¤šå°±èµ°å®Œäº†, ä¸‹é¢æ”¾ä¸€ä¸ªå®Œæ•´çš„ js éƒ¨åˆ†ä»£ç å§.\n\n```javascript\n(function (global) {\n\tlet speedLabel = document.getElementById('speed'),\n\t\tnumberLabel = document.getElementById('number'),\n\t\tdata = [\"JavaScript\", \"Node.Js\", \"HTML\", \"CSS\", \"vue\", \"react\"\n\t\t\t\t, \"JQuery\", \"Webpack\", \"Babel\", \"ES6\", \"WebSocket\"],\n\t\tcontainer = document.querySelector('.container'),\n\t\tcontent = document.getElementById('content'),\n\t\tinterval,\n\t\tspeed = 100,\n\t\tnum = 120,\n\t\tradius = 300,\n\t\tfallLength = 500,\n\t\tangleX = Math.PI / 500,\n\t\tangleY = Math.PI / 500,\n\t\tCX = container.offsetWidth / 2,\n\t\tCY = container.offsetHeight / 2,\n\t\tEX = container.offsetLeft,\n\t\tEY = container.offsetTop;\n\n\n\t// åˆ›å»ºæ ‡ç­¾\n\tconst createLabel = (data, num) => {\n\t\tlet html = '', index;\n\t\tfor (let i = 0; i < num; i++) {\n\t\t\tindex = Math.floor(Math.random() * data.length);\n\t\t\thtml += `<label class='tag'>${data[index]}</label>`;\n\t\t}\n\t\tcontainer.innerHTML = html;\n\t};\n\n\t// äº‹ä»¶ç›‘å¬\n\tconst addEvent = function (element, event, fn) {\n\t\tif (element.addEventListener) {\n\t\t\telement.addEventListener(event, fn, false)\n\t\t}else if (element.attachEvent) {\n\t\t\telement.attachEvent('on' + event, fn)\n\t\t}else {\n\t\t\telement['on' + event] = fn\n\t\t}\n\t};\n\n\t// è·å–ç”¨æˆ·è¾“å…¥æ ‡ç­¾\n\taddEvent(content, 'blur', function () {\n\t\tif (!!this.value) {\n\t\t\tconsole.log(typeof this.value)\n\t\t\tdata = this.value.split(',');\n\t\t\tcreateLabel(data, num);\n\t\t\tlet item = document.querySelectorAll('.tag');\n\t\t\tsetBall(item)\n\t\t}\n\t});\n\n\t// è·å–ç”¨æˆ·è¾“å…¥æ•°é‡\n\taddEvent(numberLabel, 'blur', function () {\n\t\tif (+this.value < 0 || +this.value > 200) {\n\t\t\talert('è¯·å¡«å†™11 - 200ä¹‹é—´çš„æ•°å€¼')\n\t\t}else {\n\t\t\tnum = +this.value;\n\t\t\tcreateLabel(data, num);\n\t\t\tlet item = document.querySelectorAll('.tag');\n\t\t\tsetBall(item)\n\t\t}\n\t})\n\n\t// è·å–è½¬é€Ÿ\n\taddEvent(speedLabel, 'blur', function () {\n\t\tif (+this.value < 0) {\n\t\t\talert('è¯·è¾“å…¥å¤§äº0çš„æ•°å€¼')\n\t\t}else {\n\t\t\tspeed = +this.value;\n\t\t\tclearInterval(interval)\n\t\t\tanimate()\n\t\t}\n\t})\n\n\tlet tags = [];\n\n\t// setBall\n\tconst setBall = _ => {\n\t\tlet tagLabel = document.querySelectorAll('.tag');\n\t\tfor (let i = 0; i < tagLabel.length; i++) {\n\t\t\tlet k = (2 * (i + 1) - 1) / tagLabel.length - 1,\n\t\t\t\ta = Math.acos(k), // åä½™å¼¦\n\t\t\t\tb = a * Math.sqrt(tagLabel.length * Math.PI), // å¹³æ–¹æ ¹\n\t\t\t\tx = radius * Math.sin(a) * Math.cos(b),\n\t\t\t\ty = radius * Math.sin(a) * Math.sin(b),\n\t\t\t\tz = radius * Math.cos(a);\n\n\t\t\tlet t = new tag(tagLabel[i], x, y, z);\n\t\t\ttags.push(t);\n\t\t\tt.move()\n\t\t}\n\t};\n\n\tArray.prototype.forEach = function (callback) {\n        for(let i = 0; i < this.length; i++) {\n            callback.call(this[i]);\n        }\n    }\n\n\n\n\tfunction tag (el, x, y, z) {\n\n\t\tthis.element = el;\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.z = z;\n\t}\n\n\ttag.prototype = {\n\t\tmove: function () {\n\t\t\tlet scale = fallLength/ (fallLength - this.z),\n\t\t\t\topa = (this.z + radius) / (2 * radius);\n\t\t\tthis.element.style.cssText = `color: rgb(${parseInt(Math.random() * 255)}, \n\t\t\t\t${parseInt(Math.random() * 255)}, ${parseInt(Math.random() * 255)});\n\t\t\t\tfont-size: ${parseInt(15 * scale)}px;\n\t\t\t\topacity: ${opa + 0.5};\n\t\t\t\tz-index: ${parseInt(scale * 100)};\n\t\t\t\tleft: ${this.x + CX - this.element.offsetWidth / 2}px;\n\t\t\t\ttop: ${this.y + CY - this.element.offsetHeight / 2}px`;\n\t\t}\n\t}\n\n\tconst animate = _ => {\n\t\tinterval = setInterval(function () {\n\t\t\trotateX();\n\t\t\trotateY();\n\t\t\ttags.forEach(function () {\n\t\t\t\tthis.move()\n\t\t\t})\n\t\t}, speed)\n\t};\n\n\tconst rotateX = _ => {\n\t\tlet sin = Math.sin(angleX),\n\t\t\tcos = Math.cos(angleX);\n\t\ttags.forEach(function () {\n\t\t\tlet y1 = this.y * cos - this.z * sin,\n\t\t\t\tz1 = this.z * cos + this.y * sin;\n\t\t\tthis.y = y1;\n\t\t\tthis.z = z1;\n\t\t})\n\t}\n\n\tconst rotateY = _ =>{\n\t\tvar cos = Math.cos(angleY),\n        \tsin = Math.sin(angleY);\n        tags.forEach(function () {\n            var x1 = this.x * cos - this.z * sin;\n            var z1 = this.z * cos + this.x * sin;\n            this.x = x1;\n            this.z = z1;\n        })\n\t}\n\n\t// é¼ æ ‡ç§»åŠ¨\n\taddEvent(container, \"mousemove\", function (e) {\n        var x = e.clientX - EX - CX;\n        var y = e.clientY - EY - CY;\n        angleX = y * 0.0001;\n        angleY = x * 0.0001;\n    });\n\n\t// åˆå§‹åŒ–\n\tcreateLabel(data, num);\n\tvar tagLabel = document.querySelectorAll('.tag');\n\tsetBall(tagLabel);\n\tanimate()\n})(window)\n```\n\nCreated on 17-10-8 by Cara\n[åœ¨çº¿é¢„è§ˆ demo](https://caraws.github.io/IFE/IFE2017/3d-tags/index.html)\n","slug":"3D-Tags","published":1,"updated":"2018-05-05T09:23:03.649Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjgurolrx0000klu0j8v00hdr","content":"<p>3D æ ‡ç­¾äº‘<br>ç»ƒä¹ canvasçš„3Dæ•ˆæœ,  çƒä½“ç®—æ³•, æ­£å¥½IFE çš„é¡¹ç›®æœ‰å°±è®°å½•ä¸€ä¸‹å’¯.</p>\n<h3 id=\"å¤§æ¦‚æ€è·¯\"><a href=\"#å¤§æ¦‚æ€è·¯\" class=\"headerlink\" title=\"å¤§æ¦‚æ€è·¯\"></a>å¤§æ¦‚æ€è·¯</h3><p>é¦–å…ˆ3Däº‘å…¶å®å°±æ˜¯ä¸€ä¸ªçƒä½“, åœ¨è¿™ä¸ªçƒä½“ä¸Šå¹³å‡åˆ†å¸ƒå„ä¸ªç‚¹, å†æŠŠè¿™äº›ç‚¹<br>çš„åæ ‡èµ‹ç»™æ ‡ç­¾,è®¡ç®—ä¸€ä¸‹ z è½´çš„å¤§å°, æœ€åé€šè¿‡æ”¹å˜å­—ä½“çš„å¤§å°/ é€æ˜åº¦<br>å°±å¯ä»¥æ¨¡æ‹Ÿå‡ºç«‹ä½“çš„æ•ˆæœå•¦.</p>\n<h3 id=\"ç›¸å…³çš„ä¸€äº›å…¬å¼åŠè¯´æ˜\"><a href=\"#ç›¸å…³çš„ä¸€äº›å…¬å¼åŠè¯´æ˜\" class=\"headerlink\" title=\"ç›¸å…³çš„ä¸€äº›å…¬å¼åŠè¯´æ˜\"></a>ç›¸å…³çš„ä¸€äº›å…¬å¼åŠè¯´æ˜</h3><ol>\n<li>çƒä½“ x/ y/ z è½´çš„åæ ‡ç‚¹<br>å·²çŸ¥åŠå¾„ R å’Œçƒå¿ƒ, æ–¹ä¾¿èµ·è§ä¸€èˆ¬éƒ½ä»¥åæ ‡è½´çš„åŸç‚¹ä½œä¸ºçƒå¿ƒ. æœ‰å¦‚ä¸‹ä¸‰ä¸ªæ–¹ç¨‹å¼:<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">x = R * sinÎ¸ * cosÃ¸</span><br><span class=\"line\">y = R * sinÎ¸ * sinÃ¸</span><br><span class=\"line\">z = R * cosÎ¸</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<p>å…¶ä¸­Î¸ å’Œ Ã¸ å¯ä»¥å»éšæœºæ•°, æ¥è·å–åœ†ä¸Šçš„éšæœºç‚¹åæ ‡. ä½†æ˜¯3D äº‘çš„åæ ‡ç‚¹æ˜¯éœ€è¦å‡åŒ€åˆ†é…çš„åæ ‡ç‚¹, æ‰€ä»¥å…‰æ˜¯å»éšæœºç‚¹æ˜¯ä¸å¤Ÿçš„. æ‰€ä»¥åˆæœ‰äº†ä¸‹é¢çš„å…¬å¼:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// index ä¸ºå½“å‰ç´¢å¼•, length ä¸ºæ ‡ç­¾é•¿åº¦</span></span><br><span class=\"line\"><span class=\"comment\">// è¿™æ®µæˆ‘ä¹Ÿä¸æ‡‚åŸç†æ˜¯ä»€ä¹ˆ, åœ¨åˆ«äººçš„ä»£ç é‡Œçœ‹è§çš„...</span></span><br><span class=\"line\">Î¸ = acos((<span class=\"number\">2</span> * (index + <span class=\"number\">1</span>) - <span class=\"number\">1</span>) / length - <span class=\"number\">1</span>)</span><br><span class=\"line\"><span class=\"comment\">// n å– Math.PI</span></span><br><span class=\"line\">Ã¸ = Î¸ * sqrt(length * n)</span><br></pre></td></tr></table></figure>\n<h4 id=\"å…³é”®ä»£ç \"><a href=\"#å…³é”®ä»£ç \" class=\"headerlink\" title=\"å…³é”®ä»£ç \"></a>å…³é”®ä»£ç </h4><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> setBall = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">// æ ‡ç­¾</span></span><br><span class=\"line\">\t<span class=\"keyword\">let</span> tagLabel = <span class=\"built_in\">document</span>.querySelector(<span class=\"string\">'.tag'</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i =<span class=\"number\">0</span>, len = tagLabel.length; i &lt; len; i++) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> k = (<span class=\"number\">2</span> * (i + <span class=\"number\">1</span>) - <span class=\"number\">1</span>) / len - <span class=\"number\">1</span>,</span><br><span class=\"line\">\t\t\ta = acos(k), <span class=\"comment\">// ä¸Šè¿°Î¸ </span></span><br><span class=\"line\">\t\t\tb = a * sqrt(len * <span class=\"built_in\">Math</span>.PI), <span class=\"comment\">// ä¸Šè¿°Ã¸</span></span><br><span class=\"line\">\t\t\tx = radius * <span class=\"built_in\">Math</span>.sin(a) * <span class=\"built_in\">Math</span>.cos(b), </span><br><span class=\"line\">\t\t\ty = radius * <span class=\"built_in\">Math</span>.sin(a) * <span class=\"built_in\">Math</span>.sin(b),</span><br><span class=\"line\">\t\t\tz = radius * <span class=\"built_in\">Math</span>.cos(a);</span><br><span class=\"line\">\t\t<span class=\"comment\">// è®©çƒä½“åŠ¨èµ·æ¥, æˆ‘ä»¬å…ˆæŠŠæ–¹æ³•æ”¾åœ¨è¿™å„¿</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> t = <span class=\"keyword\">new</span> tag(tagLabel[i], x, y, z);</span><br><span class=\"line\">\t\t\ttags.push(t);</span><br><span class=\"line\">\t\t\tt.move()</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ä»¥ä¸Šå°±å¯ä»¥å–å¾—çƒä½“æ‰€éœ€çš„å¹³å‡åæ ‡ç‚¹, æ¥ä¸‹æ¥æˆ‘ä»¬å°±éœ€è¦å»æ“ä½œ DOM æ¯ä¸ªæ ‡ç­¾äº†.</p>\n<ol start=\"2\">\n<li>æ ‡ç­¾å­—ä½“åŠé€æ˜åº¦è®¡ç®—<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// fallLength ä¸ºç„¦è·</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> scale = fallLength/ (fallLength - <span class=\"keyword\">this</span>.z),</span><br><span class=\"line\">\t  opa = (<span class=\"keyword\">this</span>.z + radius) / (<span class=\"number\">2</span> * radius);</span><br><span class=\"line\"><span class=\"comment\">// æ¯ä¸ªæ ‡ç­¾æ·»åŠ æ ·å¼</span></span><br><span class=\"line\"><span class=\"keyword\">this</span>.element.style.cssText = <span class=\"string\">`color: rgb(</span></span><br><span class=\"line\"><span class=\"string\">\t<span class=\"subst\">$&#123;<span class=\"built_in\">parseInt</span>(<span class=\"built_in\">Math</span>.random() * <span class=\"number\">255</span>)&#125;</span>, </span></span><br><span class=\"line\"><span class=\"string\">\t<span class=\"subst\">$&#123;<span class=\"built_in\">parseInt</span>(<span class=\"built_in\">Math</span>.random() * <span class=\"number\">255</span>)&#125;</span>, </span></span><br><span class=\"line\"><span class=\"string\">\t<span class=\"subst\">$&#123;<span class=\"built_in\">parseInt</span>(<span class=\"built_in\">Math</span>.random() * <span class=\"number\">255</span>)&#125;</span>);</span></span><br><span class=\"line\"><span class=\"string\">\tfont-size: <span class=\"subst\">$&#123;<span class=\"built_in\">parseInt</span>(<span class=\"number\">15</span> * scale)&#125;</span>px;</span></span><br><span class=\"line\"><span class=\"string\">\topacity: <span class=\"subst\">$&#123;opa + <span class=\"number\">0.5</span>&#125;</span>;</span></span><br><span class=\"line\"><span class=\"string\">\tz-index: <span class=\"subst\">$&#123;<span class=\"built_in\">parseInt</span>(scale * <span class=\"number\">100</span>)&#125;</span>;</span></span><br><span class=\"line\"><span class=\"string\">\tleft: <span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.x + CX - <span class=\"keyword\">this</span>.element.offsetWidth <span class=\"regexp\">/ 2&#125;px;</span></span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"subst\"><span class=\"regexp\">\ttop: $&#123;this.y + CY - this.element.offsetHeight /</span> <span class=\"number\">2</span>&#125;</span>px`</span>;</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<p>fallLength æ˜¯ç„¦è·, ä¹Ÿæ˜¯ä¸€ä¸ªå¸¸é‡, scale å’Œ opacity éƒ½è¦é€šè¿‡ z è½´æ¥è°ƒæ•´çš„. è¿™é‡Œä¹Ÿæ˜¯ä»åˆ«äººçš„ä»£ç é‡Œçœ‹åˆ°çš„, åº”è¯¥ä¹Ÿæ˜¯å…¬å¼å§; åé¢å°±æ˜¯è°ƒæ•´å­—ä½“å¤§å°/ é€æ˜åº¦, æ ‡ç­¾ä½ç½®çš„æ“ä½œäº†. ä»¥ä¸Šè®¡ç®—å°±æ˜¯<code>move()</code>å‡½æ•°ä¸­çš„å†…å®¹. ç°åœ¨çƒä½“å·²ç»å‡ºæ¥äº†, é‚£ä¹ˆå°±è¯¥è®©ä»–åŠ¨èµ·æ¥äº†.</p>\n<ol start=\"3\">\n<li>æ—‹è½¬ç®—æ³•<br>ä¸ºäº†è®©çƒä½“åŠ¨èµ·æ¥, æˆ‘ä»¬éœ€è¦çŸ¥é“ä¸‹é¢è¿™ä¸‰ä¸ªå…¬å¼: </li>\n</ol>\n<p><img src=\"http://orf90agxq.bkt.clouddn.com/3d_tags/rotate.png\" alt=\"æ—‹è½¬å…¬å¼\"></p>\n<p>ç„¶åæˆ‘ä»¬éœ€è¦ä¸¤ä¸ªå‡½æ•°, x è½´é€‰æ‹©å’Œ y è½´æ—‹è½¬, å…³é”®ä»£ç å¦‚ä¸‹:<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> rotateX = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">// angleX æ˜¯äº‹å…ˆå®šä¹‰å¥½çš„è§’åº¦å€¼</span></span><br><span class=\"line\">\t<span class=\"keyword\">let</span> sin = <span class=\"built_in\">Math</span>.sin(angleX),</span><br><span class=\"line\">\t\tcos = <span class=\"built_in\">Math</span>.cos(angleX);</span><br><span class=\"line\">\ttags.forEach(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> y1 = <span class=\"keyword\">this</span>.y * cos - <span class=\"keyword\">this</span>.z * sin,</span><br><span class=\"line\">\t\t\tz1 = <span class=\"keyword\">this</span>.z * cos + <span class=\"keyword\">this</span>.y * sin;</span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.y = y1;</span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.z = z1;</span><br><span class=\"line\">\t&#125;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> rotateY = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">// angleY æ˜¯äº‹å…ˆå®šä¹‰å¥½çš„è§’åº¦å€¼</span></span><br><span class=\"line\">\t<span class=\"keyword\">let</span> cos = <span class=\"built_in\">Math</span>.cos(angleY),</span><br><span class=\"line\">     \tsin = <span class=\"built_in\">Math</span>.sin(angleY);</span><br><span class=\"line\">\ttags.forEach(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> x1 = <span class=\"keyword\">this</span>.x * cos - <span class=\"keyword\">this</span>.z * sin,</span><br><span class=\"line\">\t\t\tz1 = <span class=\"keyword\">this</span>.z * cos + <span class=\"keyword\">this</span>.x * sin;</span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.x = x1;</span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.z = z1;</span><br><span class=\"line\">\t&#125;)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>è¿™é‡Œ angleX å’Œ angleY ä¸ºè§’åº¦å€¼, ç”¨æ¥æ§åˆ¶æ ‡ç­¾äº‘çš„æ—‹è½¬æ–¹å‘å’Œé€Ÿåº¦. è§’åº¦çš„æ­£è´Ÿå€¼æ§åˆ¶æ—‹è½¬æ–¹å‘; å¤§å°æ§åˆ¶æ—‹è½¬é€Ÿåº¦.</p>\n<ol start=\"4\">\n<li>é¼ æ ‡æ§åˆ¶<br>è¿™é‡Œå°±æ˜¯æœ€åä¸€æ­¥äº†, é€šè¿‡é¼ æ ‡æ”¹å˜çƒä½“çš„æ—‹è½¬æ–¹å‘. è¿™é‡Œæˆ‘åšäº†ä¸€ç‚¹ç‚¹æ‰©å±•å‡ ä¸ªè¾“å…¥æ¡†, å¯ä»¥è®©ç”¨æˆ·è‡ªç”±å¡«å†™äº‘å†…å®¹/ æ•°é‡åŠæ—‹è½¬é€Ÿåº¦, ä¸‹é¢ç›´æ¥çœ‹ä»£ç å§.</li>\n</ol>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// æ¥ä¸ªäº‹ä»¶ç›‘å¬</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> addEvent = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">element, event, fn</span>) </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (element.addEventListener) &#123;</span><br><span class=\"line\">\t\t\telement.addEventListener(event, fn, <span class=\"literal\">false</span>)</span><br><span class=\"line\">\t\t&#125;<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (element.attachEvent) &#123;</span><br><span class=\"line\">\t\t\telement.attachEvent(<span class=\"string\">'on'</span> + event, fn)</span><br><span class=\"line\">\t\t&#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\telement[<span class=\"string\">'on'</span> + event] = fn</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// è·å–ç”¨æˆ·è¾“å…¥æ ‡ç­¾</span></span><br><span class=\"line\">addEvent(content, <span class=\"string\">'blur'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (!!<span class=\"keyword\">this</span>.value) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">console</span>.log(<span class=\"keyword\">typeof</span> <span class=\"keyword\">this</span>.value)</span><br><span class=\"line\">\t\tdata = <span class=\"keyword\">this</span>.value.split(<span class=\"string\">','</span>);</span><br><span class=\"line\">\t\tcreateLabel(data, num);</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> item = <span class=\"built_in\">document</span>.querySelectorAll(<span class=\"string\">'.tag'</span>);</span><br><span class=\"line\">\t\tsetBall(item)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// è·å–ç”¨æˆ·è¾“å…¥æ•°é‡</span></span><br><span class=\"line\">addEvent(numberLabel, <span class=\"string\">'blur'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (+<span class=\"keyword\">this</span>.value &lt; <span class=\"number\">0</span> || +<span class=\"keyword\">this</span>.value &gt; <span class=\"number\">200</span>) &#123;</span><br><span class=\"line\">\t\talert(<span class=\"string\">'è¯·å¡«å†™11 - 200ä¹‹é—´çš„æ•°å€¼'</span>)</span><br><span class=\"line\">\t&#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\tnum = +<span class=\"keyword\">this</span>.value;</span><br><span class=\"line\">\t\tcreateLabel(data, num);</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> item = <span class=\"built_in\">document</span>.querySelectorAll(<span class=\"string\">'.tag'</span>);</span><br><span class=\"line\">\t\tsetBall(item)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// è·å–è½¬é€Ÿ</span></span><br><span class=\"line\">addEvent(speedLabel, <span class=\"string\">'blur'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (+<span class=\"keyword\">this</span>.value &lt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">\t\talert(<span class=\"string\">'è¯·è¾“å…¥å¤§äº0çš„æ•°å€¼'</span>)</span><br><span class=\"line\">\t&#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\tspeed = +<span class=\"keyword\">this</span>.value;</span><br><span class=\"line\">\t\tclearInterval(interval)</span><br><span class=\"line\">\t\tanimate()</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// é¼ æ ‡ç§»åŠ¨</span></span><br><span class=\"line\">addEvent(container, <span class=\"string\">\"mousemove\"</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">e</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">// EX: å®½åº¦çš„ä¸€åŠ; CX: å·¦è¾¹è·</span></span><br><span class=\"line\">\t<span class=\"comment\">// EY: é«˜åº¦çš„ä¸€åŠ; CY: ä¸Šè¾¹è·</span></span><br><span class=\"line\">\t<span class=\"keyword\">var</span> x = e.clientX - EX - CX;</span><br><span class=\"line\">  \t<span class=\"keyword\">var</span> y = e.clientY - EY - CY;</span><br><span class=\"line\">  \tangleX = y * <span class=\"number\">0.0001</span>;</span><br><span class=\"line\">  \tangleY = x * <span class=\"number\">0.0001</span>;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<p>åˆ°è¿™é‡Œ3D äº‘çš„æµç¨‹å·®ä¸å¤šå°±èµ°å®Œäº†, ä¸‹é¢æ”¾ä¸€ä¸ªå®Œæ•´çš„ js éƒ¨åˆ†ä»£ç å§.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">global</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">let</span> speedLabel = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'speed'</span>),</span><br><span class=\"line\">\t\tnumberLabel = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'number'</span>),</span><br><span class=\"line\">\t\tdata = [<span class=\"string\">\"JavaScript\"</span>, <span class=\"string\">\"Node.Js\"</span>, <span class=\"string\">\"HTML\"</span>, <span class=\"string\">\"CSS\"</span>, <span class=\"string\">\"vue\"</span>, <span class=\"string\">\"react\"</span></span><br><span class=\"line\">\t\t\t\t, <span class=\"string\">\"JQuery\"</span>, <span class=\"string\">\"Webpack\"</span>, <span class=\"string\">\"Babel\"</span>, <span class=\"string\">\"ES6\"</span>, <span class=\"string\">\"WebSocket\"</span>],</span><br><span class=\"line\">\t\tcontainer = <span class=\"built_in\">document</span>.querySelector(<span class=\"string\">'.container'</span>),</span><br><span class=\"line\">\t\tcontent = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'content'</span>),</span><br><span class=\"line\">\t\tinterval,</span><br><span class=\"line\">\t\tspeed = <span class=\"number\">100</span>,</span><br><span class=\"line\">\t\tnum = <span class=\"number\">120</span>,</span><br><span class=\"line\">\t\tradius = <span class=\"number\">300</span>,</span><br><span class=\"line\">\t\tfallLength = <span class=\"number\">500</span>,</span><br><span class=\"line\">\t\tangleX = <span class=\"built_in\">Math</span>.PI / <span class=\"number\">500</span>,</span><br><span class=\"line\">\t\tangleY = <span class=\"built_in\">Math</span>.PI / <span class=\"number\">500</span>,</span><br><span class=\"line\">\t\tCX = container.offsetWidth / <span class=\"number\">2</span>,</span><br><span class=\"line\">\t\tCY = container.offsetHeight / <span class=\"number\">2</span>,</span><br><span class=\"line\">\t\tEX = container.offsetLeft,</span><br><span class=\"line\">\t\tEY = container.offsetTop;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// åˆ›å»ºæ ‡ç­¾</span></span><br><span class=\"line\">\t<span class=\"keyword\">const</span> createLabel = <span class=\"function\">(<span class=\"params\">data, num</span>) =&gt;</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> html = <span class=\"string\">''</span>, index;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; num; i++) &#123;</span><br><span class=\"line\">\t\t\tindex = <span class=\"built_in\">Math</span>.floor(<span class=\"built_in\">Math</span>.random() * data.length);</span><br><span class=\"line\">\t\t\thtml += <span class=\"string\">`&lt;label class='tag'&gt;<span class=\"subst\">$&#123;data[index]&#125;</span>&lt;/label&gt;`</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\tcontainer.innerHTML = html;</span><br><span class=\"line\">\t&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// äº‹ä»¶ç›‘å¬</span></span><br><span class=\"line\">\t<span class=\"keyword\">const</span> addEvent = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">element, event, fn</span>) </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (element.addEventListener) &#123;</span><br><span class=\"line\">\t\t\telement.addEventListener(event, fn, <span class=\"literal\">false</span>)</span><br><span class=\"line\">\t\t&#125;<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (element.attachEvent) &#123;</span><br><span class=\"line\">\t\t\telement.attachEvent(<span class=\"string\">'on'</span> + event, fn)</span><br><span class=\"line\">\t\t&#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\telement[<span class=\"string\">'on'</span> + event] = fn</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// è·å–ç”¨æˆ·è¾“å…¥æ ‡ç­¾</span></span><br><span class=\"line\">\taddEvent(content, <span class=\"string\">'blur'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (!!<span class=\"keyword\">this</span>.value) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"keyword\">typeof</span> <span class=\"keyword\">this</span>.value)</span><br><span class=\"line\">\t\t\tdata = <span class=\"keyword\">this</span>.value.split(<span class=\"string\">','</span>);</span><br><span class=\"line\">\t\t\tcreateLabel(data, num);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">let</span> item = <span class=\"built_in\">document</span>.querySelectorAll(<span class=\"string\">'.tag'</span>);</span><br><span class=\"line\">\t\t\tsetBall(item)</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// è·å–ç”¨æˆ·è¾“å…¥æ•°é‡</span></span><br><span class=\"line\">\taddEvent(numberLabel, <span class=\"string\">'blur'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (+<span class=\"keyword\">this</span>.value &lt; <span class=\"number\">0</span> || +<span class=\"keyword\">this</span>.value &gt; <span class=\"number\">200</span>) &#123;</span><br><span class=\"line\">\t\t\talert(<span class=\"string\">'è¯·å¡«å†™11 - 200ä¹‹é—´çš„æ•°å€¼'</span>)</span><br><span class=\"line\">\t\t&#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\tnum = +<span class=\"keyword\">this</span>.value;</span><br><span class=\"line\">\t\t\tcreateLabel(data, num);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">let</span> item = <span class=\"built_in\">document</span>.querySelectorAll(<span class=\"string\">'.tag'</span>);</span><br><span class=\"line\">\t\t\tsetBall(item)</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// è·å–è½¬é€Ÿ</span></span><br><span class=\"line\">\taddEvent(speedLabel, <span class=\"string\">'blur'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (+<span class=\"keyword\">this</span>.value &lt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">\t\t\talert(<span class=\"string\">'è¯·è¾“å…¥å¤§äº0çš„æ•°å€¼'</span>)</span><br><span class=\"line\">\t\t&#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\tspeed = +<span class=\"keyword\">this</span>.value;</span><br><span class=\"line\">\t\t\tclearInterval(interval)</span><br><span class=\"line\">\t\t\tanimate()</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">let</span> tags = [];</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// setBall</span></span><br><span class=\"line\">\t<span class=\"keyword\">const</span> setBall = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> tagLabel = <span class=\"built_in\">document</span>.querySelectorAll(<span class=\"string\">'.tag'</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; tagLabel.length; i++) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">let</span> k = (<span class=\"number\">2</span> * (i + <span class=\"number\">1</span>) - <span class=\"number\">1</span>) / tagLabel.length - <span class=\"number\">1</span>,</span><br><span class=\"line\">\t\t\t\ta = <span class=\"built_in\">Math</span>.acos(k), <span class=\"comment\">// åä½™å¼¦</span></span><br><span class=\"line\">\t\t\t\tb = a * <span class=\"built_in\">Math</span>.sqrt(tagLabel.length * <span class=\"built_in\">Math</span>.PI), <span class=\"comment\">// å¹³æ–¹æ ¹</span></span><br><span class=\"line\">\t\t\t\tx = radius * <span class=\"built_in\">Math</span>.sin(a) * <span class=\"built_in\">Math</span>.cos(b),</span><br><span class=\"line\">\t\t\t\ty = radius * <span class=\"built_in\">Math</span>.sin(a) * <span class=\"built_in\">Math</span>.sin(b),</span><br><span class=\"line\">\t\t\t\tz = radius * <span class=\"built_in\">Math</span>.cos(a);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">let</span> t = <span class=\"keyword\">new</span> tag(tagLabel[i], x, y, z);</span><br><span class=\"line\">\t\t\ttags.push(t);</span><br><span class=\"line\">\t\t\tt.move()</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"built_in\">Array</span>.prototype.forEach = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">callback</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"keyword\">this</span>.length; i++) &#123;</span><br><span class=\"line\">            callback.call(<span class=\"keyword\">this</span>[i]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">tag</span> (<span class=\"params\">el, x, y, z</span>) </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.element = el;</span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.x = x;</span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.y = y;</span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.z = z;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\ttag.prototype = &#123;</span><br><span class=\"line\">\t\tmove: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">let</span> scale = fallLength/ (fallLength - <span class=\"keyword\">this</span>.z),</span><br><span class=\"line\">\t\t\t\topa = (<span class=\"keyword\">this</span>.z + radius) / (<span class=\"number\">2</span> * radius);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">this</span>.element.style.cssText = <span class=\"string\">`color: rgb(<span class=\"subst\">$&#123;<span class=\"built_in\">parseInt</span>(<span class=\"built_in\">Math</span>.random() * <span class=\"number\">255</span>)&#125;</span>, </span></span><br><span class=\"line\"><span class=\"string\">\t\t\t\t<span class=\"subst\">$&#123;<span class=\"built_in\">parseInt</span>(<span class=\"built_in\">Math</span>.random() * <span class=\"number\">255</span>)&#125;</span>, <span class=\"subst\">$&#123;<span class=\"built_in\">parseInt</span>(<span class=\"built_in\">Math</span>.random() * <span class=\"number\">255</span>)&#125;</span>);</span></span><br><span class=\"line\"><span class=\"string\">\t\t\t\tfont-size: <span class=\"subst\">$&#123;<span class=\"built_in\">parseInt</span>(<span class=\"number\">15</span> * scale)&#125;</span>px;</span></span><br><span class=\"line\"><span class=\"string\">\t\t\t\topacity: <span class=\"subst\">$&#123;opa + <span class=\"number\">0.5</span>&#125;</span>;</span></span><br><span class=\"line\"><span class=\"string\">\t\t\t\tz-index: <span class=\"subst\">$&#123;<span class=\"built_in\">parseInt</span>(scale * <span class=\"number\">100</span>)&#125;</span>;</span></span><br><span class=\"line\"><span class=\"string\">\t\t\t\tleft: <span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.x + CX - <span class=\"keyword\">this</span>.element.offsetWidth <span class=\"regexp\">/ 2&#125;px;</span></span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"subst\"><span class=\"regexp\">\t\t\t\ttop: $&#123;this.y + CY - this.element.offsetHeight /</span> <span class=\"number\">2</span>&#125;</span>px`</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">const</span> animate = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t\tinterval = setInterval(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t\t\trotateX();</span><br><span class=\"line\">\t\t\trotateY();</span><br><span class=\"line\">\t\t\ttags.forEach(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">this</span>.move()</span><br><span class=\"line\">\t\t\t&#125;)</span><br><span class=\"line\">\t\t&#125;, speed)</span><br><span class=\"line\">\t&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">const</span> rotateX = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> sin = <span class=\"built_in\">Math</span>.sin(angleX),</span><br><span class=\"line\">\t\t\tcos = <span class=\"built_in\">Math</span>.cos(angleX);</span><br><span class=\"line\">\t\ttags.forEach(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">let</span> y1 = <span class=\"keyword\">this</span>.y * cos - <span class=\"keyword\">this</span>.z * sin,</span><br><span class=\"line\">\t\t\t\tz1 = <span class=\"keyword\">this</span>.z * cos + <span class=\"keyword\">this</span>.y * sin;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">this</span>.y = y1;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">this</span>.z = z1;</span><br><span class=\"line\">\t\t&#125;)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">const</span> rotateY = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">var</span> cos = <span class=\"built_in\">Math</span>.cos(angleY),</span><br><span class=\"line\">        \tsin = <span class=\"built_in\">Math</span>.sin(angleY);</span><br><span class=\"line\">        tags.forEach(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> x1 = <span class=\"keyword\">this</span>.x * cos - <span class=\"keyword\">this</span>.z * sin;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> z1 = <span class=\"keyword\">this</span>.z * cos + <span class=\"keyword\">this</span>.x * sin;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.x = x1;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.z = z1;</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// é¼ æ ‡ç§»åŠ¨</span></span><br><span class=\"line\">\taddEvent(container, <span class=\"string\">\"mousemove\"</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">e</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> x = e.clientX - EX - CX;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> y = e.clientY - EY - CY;</span><br><span class=\"line\">        angleX = y * <span class=\"number\">0.0001</span>;</span><br><span class=\"line\">        angleY = x * <span class=\"number\">0.0001</span>;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// åˆå§‹åŒ–</span></span><br><span class=\"line\">\tcreateLabel(data, num);</span><br><span class=\"line\">\t<span class=\"keyword\">var</span> tagLabel = <span class=\"built_in\">document</span>.querySelectorAll(<span class=\"string\">'.tag'</span>);</span><br><span class=\"line\">\tsetBall(tagLabel);</span><br><span class=\"line\">\tanimate()</span><br><span class=\"line\">&#125;)(<span class=\"built_in\">window</span>)</span><br></pre></td></tr></table></figure>\n<p>Created on 17-10-8 by Cara<br><a href=\"https://caraws.github.io/IFE/IFE2017/3d-tags/index.html\" target=\"_blank\" rel=\"noopener\">åœ¨çº¿é¢„è§ˆ demo</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p>3D æ ‡ç­¾äº‘<br>ç»ƒä¹ canvasçš„3Dæ•ˆæœ,  çƒä½“ç®—æ³•, æ­£å¥½IFE çš„é¡¹ç›®æœ‰å°±è®°å½•ä¸€ä¸‹å’¯.</p>\n<h3 id=\"å¤§æ¦‚æ€è·¯\"><a href=\"#å¤§æ¦‚æ€è·¯\" class=\"headerlink\" title=\"å¤§æ¦‚æ€è·¯\"></a>å¤§æ¦‚æ€è·¯</h3><p>é¦–å…ˆ3Däº‘å…¶å®å°±æ˜¯ä¸€ä¸ªçƒä½“, åœ¨è¿™ä¸ªçƒä½“ä¸Šå¹³å‡åˆ†å¸ƒå„ä¸ªç‚¹, å†æŠŠè¿™äº›ç‚¹<br>çš„åæ ‡èµ‹ç»™æ ‡ç­¾,è®¡ç®—ä¸€ä¸‹ z è½´çš„å¤§å°, æœ€åé€šè¿‡æ”¹å˜å­—ä½“çš„å¤§å°/ é€æ˜åº¦<br>å°±å¯ä»¥æ¨¡æ‹Ÿå‡ºç«‹ä½“çš„æ•ˆæœå•¦.</p>\n<h3 id=\"ç›¸å…³çš„ä¸€äº›å…¬å¼åŠè¯´æ˜\"><a href=\"#ç›¸å…³çš„ä¸€äº›å…¬å¼åŠè¯´æ˜\" class=\"headerlink\" title=\"ç›¸å…³çš„ä¸€äº›å…¬å¼åŠè¯´æ˜\"></a>ç›¸å…³çš„ä¸€äº›å…¬å¼åŠè¯´æ˜</h3><ol>\n<li>çƒä½“ x/ y/ z è½´çš„åæ ‡ç‚¹<br>å·²çŸ¥åŠå¾„ R å’Œçƒå¿ƒ, æ–¹ä¾¿èµ·è§ä¸€èˆ¬éƒ½ä»¥åæ ‡è½´çš„åŸç‚¹ä½œä¸ºçƒå¿ƒ. æœ‰å¦‚ä¸‹ä¸‰ä¸ªæ–¹ç¨‹å¼:<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">x = R * sinÎ¸ * cosÃ¸</span><br><span class=\"line\">y = R * sinÎ¸ * sinÃ¸</span><br><span class=\"line\">z = R * cosÎ¸</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<p>å…¶ä¸­Î¸ å’Œ Ã¸ å¯ä»¥å»éšæœºæ•°, æ¥è·å–åœ†ä¸Šçš„éšæœºç‚¹åæ ‡. ä½†æ˜¯3D äº‘çš„åæ ‡ç‚¹æ˜¯éœ€è¦å‡åŒ€åˆ†é…çš„åæ ‡ç‚¹, æ‰€ä»¥å…‰æ˜¯å»éšæœºç‚¹æ˜¯ä¸å¤Ÿçš„. æ‰€ä»¥åˆæœ‰äº†ä¸‹é¢çš„å…¬å¼:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// index ä¸ºå½“å‰ç´¢å¼•, length ä¸ºæ ‡ç­¾é•¿åº¦</span></span><br><span class=\"line\"><span class=\"comment\">// è¿™æ®µæˆ‘ä¹Ÿä¸æ‡‚åŸç†æ˜¯ä»€ä¹ˆ, åœ¨åˆ«äººçš„ä»£ç é‡Œçœ‹è§çš„...</span></span><br><span class=\"line\">Î¸ = acos((<span class=\"number\">2</span> * (index + <span class=\"number\">1</span>) - <span class=\"number\">1</span>) / length - <span class=\"number\">1</span>)</span><br><span class=\"line\"><span class=\"comment\">// n å– Math.PI</span></span><br><span class=\"line\">Ã¸ = Î¸ * sqrt(length * n)</span><br></pre></td></tr></table></figure>\n<h4 id=\"å…³é”®ä»£ç \"><a href=\"#å…³é”®ä»£ç \" class=\"headerlink\" title=\"å…³é”®ä»£ç \"></a>å…³é”®ä»£ç </h4><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> setBall = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">// æ ‡ç­¾</span></span><br><span class=\"line\">\t<span class=\"keyword\">let</span> tagLabel = <span class=\"built_in\">document</span>.querySelector(<span class=\"string\">'.tag'</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i =<span class=\"number\">0</span>, len = tagLabel.length; i &lt; len; i++) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> k = (<span class=\"number\">2</span> * (i + <span class=\"number\">1</span>) - <span class=\"number\">1</span>) / len - <span class=\"number\">1</span>,</span><br><span class=\"line\">\t\t\ta = acos(k), <span class=\"comment\">// ä¸Šè¿°Î¸ </span></span><br><span class=\"line\">\t\t\tb = a * sqrt(len * <span class=\"built_in\">Math</span>.PI), <span class=\"comment\">// ä¸Šè¿°Ã¸</span></span><br><span class=\"line\">\t\t\tx = radius * <span class=\"built_in\">Math</span>.sin(a) * <span class=\"built_in\">Math</span>.cos(b), </span><br><span class=\"line\">\t\t\ty = radius * <span class=\"built_in\">Math</span>.sin(a) * <span class=\"built_in\">Math</span>.sin(b),</span><br><span class=\"line\">\t\t\tz = radius * <span class=\"built_in\">Math</span>.cos(a);</span><br><span class=\"line\">\t\t<span class=\"comment\">// è®©çƒä½“åŠ¨èµ·æ¥, æˆ‘ä»¬å…ˆæŠŠæ–¹æ³•æ”¾åœ¨è¿™å„¿</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> t = <span class=\"keyword\">new</span> tag(tagLabel[i], x, y, z);</span><br><span class=\"line\">\t\t\ttags.push(t);</span><br><span class=\"line\">\t\t\tt.move()</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ä»¥ä¸Šå°±å¯ä»¥å–å¾—çƒä½“æ‰€éœ€çš„å¹³å‡åæ ‡ç‚¹, æ¥ä¸‹æ¥æˆ‘ä»¬å°±éœ€è¦å»æ“ä½œ DOM æ¯ä¸ªæ ‡ç­¾äº†.</p>\n<ol start=\"2\">\n<li>æ ‡ç­¾å­—ä½“åŠé€æ˜åº¦è®¡ç®—<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// fallLength ä¸ºç„¦è·</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> scale = fallLength/ (fallLength - <span class=\"keyword\">this</span>.z),</span><br><span class=\"line\">\t  opa = (<span class=\"keyword\">this</span>.z + radius) / (<span class=\"number\">2</span> * radius);</span><br><span class=\"line\"><span class=\"comment\">// æ¯ä¸ªæ ‡ç­¾æ·»åŠ æ ·å¼</span></span><br><span class=\"line\"><span class=\"keyword\">this</span>.element.style.cssText = <span class=\"string\">`color: rgb(</span></span><br><span class=\"line\"><span class=\"string\">\t<span class=\"subst\">$&#123;<span class=\"built_in\">parseInt</span>(<span class=\"built_in\">Math</span>.random() * <span class=\"number\">255</span>)&#125;</span>, </span></span><br><span class=\"line\"><span class=\"string\">\t<span class=\"subst\">$&#123;<span class=\"built_in\">parseInt</span>(<span class=\"built_in\">Math</span>.random() * <span class=\"number\">255</span>)&#125;</span>, </span></span><br><span class=\"line\"><span class=\"string\">\t<span class=\"subst\">$&#123;<span class=\"built_in\">parseInt</span>(<span class=\"built_in\">Math</span>.random() * <span class=\"number\">255</span>)&#125;</span>);</span></span><br><span class=\"line\"><span class=\"string\">\tfont-size: <span class=\"subst\">$&#123;<span class=\"built_in\">parseInt</span>(<span class=\"number\">15</span> * scale)&#125;</span>px;</span></span><br><span class=\"line\"><span class=\"string\">\topacity: <span class=\"subst\">$&#123;opa + <span class=\"number\">0.5</span>&#125;</span>;</span></span><br><span class=\"line\"><span class=\"string\">\tz-index: <span class=\"subst\">$&#123;<span class=\"built_in\">parseInt</span>(scale * <span class=\"number\">100</span>)&#125;</span>;</span></span><br><span class=\"line\"><span class=\"string\">\tleft: <span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.x + CX - <span class=\"keyword\">this</span>.element.offsetWidth <span class=\"regexp\">/ 2&#125;px;</span></span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"subst\"><span class=\"regexp\">\ttop: $&#123;this.y + CY - this.element.offsetHeight /</span> <span class=\"number\">2</span>&#125;</span>px`</span>;</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<p>fallLength æ˜¯ç„¦è·, ä¹Ÿæ˜¯ä¸€ä¸ªå¸¸é‡, scale å’Œ opacity éƒ½è¦é€šè¿‡ z è½´æ¥è°ƒæ•´çš„. è¿™é‡Œä¹Ÿæ˜¯ä»åˆ«äººçš„ä»£ç é‡Œçœ‹åˆ°çš„, åº”è¯¥ä¹Ÿæ˜¯å…¬å¼å§; åé¢å°±æ˜¯è°ƒæ•´å­—ä½“å¤§å°/ é€æ˜åº¦, æ ‡ç­¾ä½ç½®çš„æ“ä½œäº†. ä»¥ä¸Šè®¡ç®—å°±æ˜¯<code>move()</code>å‡½æ•°ä¸­çš„å†…å®¹. ç°åœ¨çƒä½“å·²ç»å‡ºæ¥äº†, é‚£ä¹ˆå°±è¯¥è®©ä»–åŠ¨èµ·æ¥äº†.</p>\n<ol start=\"3\">\n<li>æ—‹è½¬ç®—æ³•<br>ä¸ºäº†è®©çƒä½“åŠ¨èµ·æ¥, æˆ‘ä»¬éœ€è¦çŸ¥é“ä¸‹é¢è¿™ä¸‰ä¸ªå…¬å¼: </li>\n</ol>\n<p><img src=\"http://orf90agxq.bkt.clouddn.com/3d_tags/rotate.png\" alt=\"æ—‹è½¬å…¬å¼\"></p>\n<p>ç„¶åæˆ‘ä»¬éœ€è¦ä¸¤ä¸ªå‡½æ•°, x è½´é€‰æ‹©å’Œ y è½´æ—‹è½¬, å…³é”®ä»£ç å¦‚ä¸‹:<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> rotateX = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">// angleX æ˜¯äº‹å…ˆå®šä¹‰å¥½çš„è§’åº¦å€¼</span></span><br><span class=\"line\">\t<span class=\"keyword\">let</span> sin = <span class=\"built_in\">Math</span>.sin(angleX),</span><br><span class=\"line\">\t\tcos = <span class=\"built_in\">Math</span>.cos(angleX);</span><br><span class=\"line\">\ttags.forEach(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> y1 = <span class=\"keyword\">this</span>.y * cos - <span class=\"keyword\">this</span>.z * sin,</span><br><span class=\"line\">\t\t\tz1 = <span class=\"keyword\">this</span>.z * cos + <span class=\"keyword\">this</span>.y * sin;</span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.y = y1;</span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.z = z1;</span><br><span class=\"line\">\t&#125;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> rotateY = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">// angleY æ˜¯äº‹å…ˆå®šä¹‰å¥½çš„è§’åº¦å€¼</span></span><br><span class=\"line\">\t<span class=\"keyword\">let</span> cos = <span class=\"built_in\">Math</span>.cos(angleY),</span><br><span class=\"line\">     \tsin = <span class=\"built_in\">Math</span>.sin(angleY);</span><br><span class=\"line\">\ttags.forEach(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> x1 = <span class=\"keyword\">this</span>.x * cos - <span class=\"keyword\">this</span>.z * sin,</span><br><span class=\"line\">\t\t\tz1 = <span class=\"keyword\">this</span>.z * cos + <span class=\"keyword\">this</span>.x * sin;</span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.x = x1;</span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.z = z1;</span><br><span class=\"line\">\t&#125;)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>è¿™é‡Œ angleX å’Œ angleY ä¸ºè§’åº¦å€¼, ç”¨æ¥æ§åˆ¶æ ‡ç­¾äº‘çš„æ—‹è½¬æ–¹å‘å’Œé€Ÿåº¦. è§’åº¦çš„æ­£è´Ÿå€¼æ§åˆ¶æ—‹è½¬æ–¹å‘; å¤§å°æ§åˆ¶æ—‹è½¬é€Ÿåº¦.</p>\n<ol start=\"4\">\n<li>é¼ æ ‡æ§åˆ¶<br>è¿™é‡Œå°±æ˜¯æœ€åä¸€æ­¥äº†, é€šè¿‡é¼ æ ‡æ”¹å˜çƒä½“çš„æ—‹è½¬æ–¹å‘. è¿™é‡Œæˆ‘åšäº†ä¸€ç‚¹ç‚¹æ‰©å±•å‡ ä¸ªè¾“å…¥æ¡†, å¯ä»¥è®©ç”¨æˆ·è‡ªç”±å¡«å†™äº‘å†…å®¹/ æ•°é‡åŠæ—‹è½¬é€Ÿåº¦, ä¸‹é¢ç›´æ¥çœ‹ä»£ç å§.</li>\n</ol>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// æ¥ä¸ªäº‹ä»¶ç›‘å¬</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> addEvent = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">element, event, fn</span>) </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (element.addEventListener) &#123;</span><br><span class=\"line\">\t\t\telement.addEventListener(event, fn, <span class=\"literal\">false</span>)</span><br><span class=\"line\">\t\t&#125;<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (element.attachEvent) &#123;</span><br><span class=\"line\">\t\t\telement.attachEvent(<span class=\"string\">'on'</span> + event, fn)</span><br><span class=\"line\">\t\t&#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\telement[<span class=\"string\">'on'</span> + event] = fn</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// è·å–ç”¨æˆ·è¾“å…¥æ ‡ç­¾</span></span><br><span class=\"line\">addEvent(content, <span class=\"string\">'blur'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (!!<span class=\"keyword\">this</span>.value) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">console</span>.log(<span class=\"keyword\">typeof</span> <span class=\"keyword\">this</span>.value)</span><br><span class=\"line\">\t\tdata = <span class=\"keyword\">this</span>.value.split(<span class=\"string\">','</span>);</span><br><span class=\"line\">\t\tcreateLabel(data, num);</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> item = <span class=\"built_in\">document</span>.querySelectorAll(<span class=\"string\">'.tag'</span>);</span><br><span class=\"line\">\t\tsetBall(item)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// è·å–ç”¨æˆ·è¾“å…¥æ•°é‡</span></span><br><span class=\"line\">addEvent(numberLabel, <span class=\"string\">'blur'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (+<span class=\"keyword\">this</span>.value &lt; <span class=\"number\">0</span> || +<span class=\"keyword\">this</span>.value &gt; <span class=\"number\">200</span>) &#123;</span><br><span class=\"line\">\t\talert(<span class=\"string\">'è¯·å¡«å†™11 - 200ä¹‹é—´çš„æ•°å€¼'</span>)</span><br><span class=\"line\">\t&#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\tnum = +<span class=\"keyword\">this</span>.value;</span><br><span class=\"line\">\t\tcreateLabel(data, num);</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> item = <span class=\"built_in\">document</span>.querySelectorAll(<span class=\"string\">'.tag'</span>);</span><br><span class=\"line\">\t\tsetBall(item)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// è·å–è½¬é€Ÿ</span></span><br><span class=\"line\">addEvent(speedLabel, <span class=\"string\">'blur'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (+<span class=\"keyword\">this</span>.value &lt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">\t\talert(<span class=\"string\">'è¯·è¾“å…¥å¤§äº0çš„æ•°å€¼'</span>)</span><br><span class=\"line\">\t&#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\tspeed = +<span class=\"keyword\">this</span>.value;</span><br><span class=\"line\">\t\tclearInterval(interval)</span><br><span class=\"line\">\t\tanimate()</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// é¼ æ ‡ç§»åŠ¨</span></span><br><span class=\"line\">addEvent(container, <span class=\"string\">\"mousemove\"</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">e</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">// EX: å®½åº¦çš„ä¸€åŠ; CX: å·¦è¾¹è·</span></span><br><span class=\"line\">\t<span class=\"comment\">// EY: é«˜åº¦çš„ä¸€åŠ; CY: ä¸Šè¾¹è·</span></span><br><span class=\"line\">\t<span class=\"keyword\">var</span> x = e.clientX - EX - CX;</span><br><span class=\"line\">  \t<span class=\"keyword\">var</span> y = e.clientY - EY - CY;</span><br><span class=\"line\">  \tangleX = y * <span class=\"number\">0.0001</span>;</span><br><span class=\"line\">  \tangleY = x * <span class=\"number\">0.0001</span>;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<p>åˆ°è¿™é‡Œ3D äº‘çš„æµç¨‹å·®ä¸å¤šå°±èµ°å®Œäº†, ä¸‹é¢æ”¾ä¸€ä¸ªå®Œæ•´çš„ js éƒ¨åˆ†ä»£ç å§.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">global</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">let</span> speedLabel = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'speed'</span>),</span><br><span class=\"line\">\t\tnumberLabel = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'number'</span>),</span><br><span class=\"line\">\t\tdata = [<span class=\"string\">\"JavaScript\"</span>, <span class=\"string\">\"Node.Js\"</span>, <span class=\"string\">\"HTML\"</span>, <span class=\"string\">\"CSS\"</span>, <span class=\"string\">\"vue\"</span>, <span class=\"string\">\"react\"</span></span><br><span class=\"line\">\t\t\t\t, <span class=\"string\">\"JQuery\"</span>, <span class=\"string\">\"Webpack\"</span>, <span class=\"string\">\"Babel\"</span>, <span class=\"string\">\"ES6\"</span>, <span class=\"string\">\"WebSocket\"</span>],</span><br><span class=\"line\">\t\tcontainer = <span class=\"built_in\">document</span>.querySelector(<span class=\"string\">'.container'</span>),</span><br><span class=\"line\">\t\tcontent = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'content'</span>),</span><br><span class=\"line\">\t\tinterval,</span><br><span class=\"line\">\t\tspeed = <span class=\"number\">100</span>,</span><br><span class=\"line\">\t\tnum = <span class=\"number\">120</span>,</span><br><span class=\"line\">\t\tradius = <span class=\"number\">300</span>,</span><br><span class=\"line\">\t\tfallLength = <span class=\"number\">500</span>,</span><br><span class=\"line\">\t\tangleX = <span class=\"built_in\">Math</span>.PI / <span class=\"number\">500</span>,</span><br><span class=\"line\">\t\tangleY = <span class=\"built_in\">Math</span>.PI / <span class=\"number\">500</span>,</span><br><span class=\"line\">\t\tCX = container.offsetWidth / <span class=\"number\">2</span>,</span><br><span class=\"line\">\t\tCY = container.offsetHeight / <span class=\"number\">2</span>,</span><br><span class=\"line\">\t\tEX = container.offsetLeft,</span><br><span class=\"line\">\t\tEY = container.offsetTop;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// åˆ›å»ºæ ‡ç­¾</span></span><br><span class=\"line\">\t<span class=\"keyword\">const</span> createLabel = <span class=\"function\">(<span class=\"params\">data, num</span>) =&gt;</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> html = <span class=\"string\">''</span>, index;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; num; i++) &#123;</span><br><span class=\"line\">\t\t\tindex = <span class=\"built_in\">Math</span>.floor(<span class=\"built_in\">Math</span>.random() * data.length);</span><br><span class=\"line\">\t\t\thtml += <span class=\"string\">`&lt;label class='tag'&gt;<span class=\"subst\">$&#123;data[index]&#125;</span>&lt;/label&gt;`</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\tcontainer.innerHTML = html;</span><br><span class=\"line\">\t&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// äº‹ä»¶ç›‘å¬</span></span><br><span class=\"line\">\t<span class=\"keyword\">const</span> addEvent = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">element, event, fn</span>) </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (element.addEventListener) &#123;</span><br><span class=\"line\">\t\t\telement.addEventListener(event, fn, <span class=\"literal\">false</span>)</span><br><span class=\"line\">\t\t&#125;<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (element.attachEvent) &#123;</span><br><span class=\"line\">\t\t\telement.attachEvent(<span class=\"string\">'on'</span> + event, fn)</span><br><span class=\"line\">\t\t&#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\telement[<span class=\"string\">'on'</span> + event] = fn</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// è·å–ç”¨æˆ·è¾“å…¥æ ‡ç­¾</span></span><br><span class=\"line\">\taddEvent(content, <span class=\"string\">'blur'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (!!<span class=\"keyword\">this</span>.value) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"keyword\">typeof</span> <span class=\"keyword\">this</span>.value)</span><br><span class=\"line\">\t\t\tdata = <span class=\"keyword\">this</span>.value.split(<span class=\"string\">','</span>);</span><br><span class=\"line\">\t\t\tcreateLabel(data, num);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">let</span> item = <span class=\"built_in\">document</span>.querySelectorAll(<span class=\"string\">'.tag'</span>);</span><br><span class=\"line\">\t\t\tsetBall(item)</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// è·å–ç”¨æˆ·è¾“å…¥æ•°é‡</span></span><br><span class=\"line\">\taddEvent(numberLabel, <span class=\"string\">'blur'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (+<span class=\"keyword\">this</span>.value &lt; <span class=\"number\">0</span> || +<span class=\"keyword\">this</span>.value &gt; <span class=\"number\">200</span>) &#123;</span><br><span class=\"line\">\t\t\talert(<span class=\"string\">'è¯·å¡«å†™11 - 200ä¹‹é—´çš„æ•°å€¼'</span>)</span><br><span class=\"line\">\t\t&#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\tnum = +<span class=\"keyword\">this</span>.value;</span><br><span class=\"line\">\t\t\tcreateLabel(data, num);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">let</span> item = <span class=\"built_in\">document</span>.querySelectorAll(<span class=\"string\">'.tag'</span>);</span><br><span class=\"line\">\t\t\tsetBall(item)</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// è·å–è½¬é€Ÿ</span></span><br><span class=\"line\">\taddEvent(speedLabel, <span class=\"string\">'blur'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (+<span class=\"keyword\">this</span>.value &lt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">\t\t\talert(<span class=\"string\">'è¯·è¾“å…¥å¤§äº0çš„æ•°å€¼'</span>)</span><br><span class=\"line\">\t\t&#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\tspeed = +<span class=\"keyword\">this</span>.value;</span><br><span class=\"line\">\t\t\tclearInterval(interval)</span><br><span class=\"line\">\t\t\tanimate()</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">let</span> tags = [];</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// setBall</span></span><br><span class=\"line\">\t<span class=\"keyword\">const</span> setBall = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> tagLabel = <span class=\"built_in\">document</span>.querySelectorAll(<span class=\"string\">'.tag'</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; tagLabel.length; i++) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">let</span> k = (<span class=\"number\">2</span> * (i + <span class=\"number\">1</span>) - <span class=\"number\">1</span>) / tagLabel.length - <span class=\"number\">1</span>,</span><br><span class=\"line\">\t\t\t\ta = <span class=\"built_in\">Math</span>.acos(k), <span class=\"comment\">// åä½™å¼¦</span></span><br><span class=\"line\">\t\t\t\tb = a * <span class=\"built_in\">Math</span>.sqrt(tagLabel.length * <span class=\"built_in\">Math</span>.PI), <span class=\"comment\">// å¹³æ–¹æ ¹</span></span><br><span class=\"line\">\t\t\t\tx = radius * <span class=\"built_in\">Math</span>.sin(a) * <span class=\"built_in\">Math</span>.cos(b),</span><br><span class=\"line\">\t\t\t\ty = radius * <span class=\"built_in\">Math</span>.sin(a) * <span class=\"built_in\">Math</span>.sin(b),</span><br><span class=\"line\">\t\t\t\tz = radius * <span class=\"built_in\">Math</span>.cos(a);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">let</span> t = <span class=\"keyword\">new</span> tag(tagLabel[i], x, y, z);</span><br><span class=\"line\">\t\t\ttags.push(t);</span><br><span class=\"line\">\t\t\tt.move()</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"built_in\">Array</span>.prototype.forEach = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">callback</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"keyword\">this</span>.length; i++) &#123;</span><br><span class=\"line\">            callback.call(<span class=\"keyword\">this</span>[i]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">tag</span> (<span class=\"params\">el, x, y, z</span>) </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.element = el;</span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.x = x;</span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.y = y;</span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.z = z;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\ttag.prototype = &#123;</span><br><span class=\"line\">\t\tmove: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">let</span> scale = fallLength/ (fallLength - <span class=\"keyword\">this</span>.z),</span><br><span class=\"line\">\t\t\t\topa = (<span class=\"keyword\">this</span>.z + radius) / (<span class=\"number\">2</span> * radius);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">this</span>.element.style.cssText = <span class=\"string\">`color: rgb(<span class=\"subst\">$&#123;<span class=\"built_in\">parseInt</span>(<span class=\"built_in\">Math</span>.random() * <span class=\"number\">255</span>)&#125;</span>, </span></span><br><span class=\"line\"><span class=\"string\">\t\t\t\t<span class=\"subst\">$&#123;<span class=\"built_in\">parseInt</span>(<span class=\"built_in\">Math</span>.random() * <span class=\"number\">255</span>)&#125;</span>, <span class=\"subst\">$&#123;<span class=\"built_in\">parseInt</span>(<span class=\"built_in\">Math</span>.random() * <span class=\"number\">255</span>)&#125;</span>);</span></span><br><span class=\"line\"><span class=\"string\">\t\t\t\tfont-size: <span class=\"subst\">$&#123;<span class=\"built_in\">parseInt</span>(<span class=\"number\">15</span> * scale)&#125;</span>px;</span></span><br><span class=\"line\"><span class=\"string\">\t\t\t\topacity: <span class=\"subst\">$&#123;opa + <span class=\"number\">0.5</span>&#125;</span>;</span></span><br><span class=\"line\"><span class=\"string\">\t\t\t\tz-index: <span class=\"subst\">$&#123;<span class=\"built_in\">parseInt</span>(scale * <span class=\"number\">100</span>)&#125;</span>;</span></span><br><span class=\"line\"><span class=\"string\">\t\t\t\tleft: <span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.x + CX - <span class=\"keyword\">this</span>.element.offsetWidth <span class=\"regexp\">/ 2&#125;px;</span></span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"subst\"><span class=\"regexp\">\t\t\t\ttop: $&#123;this.y + CY - this.element.offsetHeight /</span> <span class=\"number\">2</span>&#125;</span>px`</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">const</span> animate = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t\tinterval = setInterval(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t\t\trotateX();</span><br><span class=\"line\">\t\t\trotateY();</span><br><span class=\"line\">\t\t\ttags.forEach(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">this</span>.move()</span><br><span class=\"line\">\t\t\t&#125;)</span><br><span class=\"line\">\t\t&#125;, speed)</span><br><span class=\"line\">\t&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">const</span> rotateX = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> sin = <span class=\"built_in\">Math</span>.sin(angleX),</span><br><span class=\"line\">\t\t\tcos = <span class=\"built_in\">Math</span>.cos(angleX);</span><br><span class=\"line\">\t\ttags.forEach(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">let</span> y1 = <span class=\"keyword\">this</span>.y * cos - <span class=\"keyword\">this</span>.z * sin,</span><br><span class=\"line\">\t\t\t\tz1 = <span class=\"keyword\">this</span>.z * cos + <span class=\"keyword\">this</span>.y * sin;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">this</span>.y = y1;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">this</span>.z = z1;</span><br><span class=\"line\">\t\t&#125;)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">const</span> rotateY = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">var</span> cos = <span class=\"built_in\">Math</span>.cos(angleY),</span><br><span class=\"line\">        \tsin = <span class=\"built_in\">Math</span>.sin(angleY);</span><br><span class=\"line\">        tags.forEach(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> x1 = <span class=\"keyword\">this</span>.x * cos - <span class=\"keyword\">this</span>.z * sin;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> z1 = <span class=\"keyword\">this</span>.z * cos + <span class=\"keyword\">this</span>.x * sin;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.x = x1;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.z = z1;</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// é¼ æ ‡ç§»åŠ¨</span></span><br><span class=\"line\">\taddEvent(container, <span class=\"string\">\"mousemove\"</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">e</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> x = e.clientX - EX - CX;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> y = e.clientY - EY - CY;</span><br><span class=\"line\">        angleX = y * <span class=\"number\">0.0001</span>;</span><br><span class=\"line\">        angleY = x * <span class=\"number\">0.0001</span>;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// åˆå§‹åŒ–</span></span><br><span class=\"line\">\tcreateLabel(data, num);</span><br><span class=\"line\">\t<span class=\"keyword\">var</span> tagLabel = <span class=\"built_in\">document</span>.querySelectorAll(<span class=\"string\">'.tag'</span>);</span><br><span class=\"line\">\tsetBall(tagLabel);</span><br><span class=\"line\">\tanimate()</span><br><span class=\"line\">&#125;)(<span class=\"built_in\">window</span>)</span><br></pre></td></tr></table></figure>\n<p>Created on 17-10-8 by Cara<br><a href=\"https://caraws.github.io/IFE/IFE2017/3d-tags/index.html\" target=\"_blank\" rel=\"noopener\">åœ¨çº¿é¢„è§ˆ demo</a></p>\n"},{"title":"Babelç”Ÿæ€","date":"2018-04-09T09:55:20.000Z","categorles":["ç¬”è®°ğŸ“’"],"_content":"å¯¹äº babel çš„ä½¿ç”¨, ä¸€ç›´åœç•™åœ¨ä¸ webpack ç»“åˆä½¿ç”¨, ä»¥åŠåœ¨ Vue å¼€å‘ç¯å¢ƒä¸‹è„šæ‰‹æ¶åˆæ˜¯å¼€ç®±å³ç”¨. å¯¼è‡´å¾ˆå¤š babel çš„åŒ…, æˆ‘éƒ½ä¸æ¸…æ¥šä»–ä»¬æ˜¯å¹²ä»€ä¹ˆçš„. æ¯”å¦‚ babel-register/ babel-runtime/ helpers/ å„ç§ presets ä»¥åŠ transform-runtime å’Œ babel-polyfill çš„åŒºåˆ«, æ‰€ä»¥æ€»ç»“ä¸€ä¸‹.\n\n### babel-cli\næˆ‘ç†è§£ä¸º babel çš„ command å…¨å®¶æ¡¶, ç”¨äºåœ¨å‘½ä»¤è¡Œæ“ä½œçš„. é‡Œé¢åŒ…å«äº† `babel`/ `babel-external-helpers`/ `babel-node` 3ä¸ªå‘½ä»¤\n\n- babel: ç”¨äºç¼–è¯‘ä»£ç \n- babel-external-helpers: ç”¨äºç”Ÿæˆä¸€äº› halper å‡½æ•°, åŒ…å« babel æ‰€æœ‰çš„ hepler å‡½æ•° (å¦‚: toArray å‡½æ•°, jsx è½¬åŒ–å‡½æ•°). è¿™äº›å‡½æ•°å®åœ¨ babel transform çš„æ—¶å€™ç”¨, éƒ½æ”¾åœ¨ `babel-helpers` è¿™ä¸ªåŒ…ä¸­, å½“è¿™äº› helpers è¢«ç”¨åˆ°å°±ä¼šè¢«æ”¾ç½®åœ¨ç”Ÿæˆä»£ç çš„é¡¶éƒ¨. ä½†æ˜¯å½“å¤šä¸ªæ–‡ä»¶éƒ½ç”¨åˆ°äº† helpers å‡½æ•°å°±ä¼šäº§ç”Ÿå†—ä½™ä»£ç , æ‰€ä»¥ babel æä¾›è¿™ä¸ªå‘½ä»¤ç”Ÿæˆä¸€ä¸ªåŒ…å«æ‰€æœ‰ helpers çš„ js æ–‡ä»¶ç”¨äºç›´æ¥å¼•ç”¨.(ç„¶åå¯ä»¥é€šè¿‡ plugin å»æ£€æŸ¥å…¨å±€æ—¶å€™å­˜åœ¨è¿™ä¸ªæ¨¡å—, å­˜åœ¨å°±ä¸å®šä¹‰)\n- babel-node: ä¸»è¦æ˜¯å®ç°åœ¨ node ä¸­å†™ä»£ç å’Œæ‰§è¡Œè„šæœ¬çš„èƒ½åŠ›, å¯ä»¥ç›´æ¥è¿è¡Œ ES6ä»£ç . æ¯”å¦‚ç›´æ¥åœ¨ node ä¸­å†™ jsx, é€šè¿‡è¿™ä¸ªå°±å¯ä»¥æ‰§è¡Œ. ä½†æ˜¯è¦æŠŠå®ƒç¼–è¯‘æˆå¯æ‰§è¡Œçš„è„šæœ¬è¿˜éœ€è¦ `babel-register`\n\nå®‰è£…\n`npm install --global babel-cli`\n\nç”¨æ³•\n```shell\nbabel example.js\n\n# è½¬ç ç»“æœå†™å…¥æ–‡ä»¶\nbabel example.js -o result.js\n\n# æ•´ä¸ªç›®å½•è½¬ç \nbabel src -d lib\n\n# ç”Ÿæˆ source map æ–‡ä»¶\nbabel src -d lib -s\n```\n\nå…¨å±€ç¯å¢ƒä¸‹ babel æ— æ³•æ”¯æŒä¸åŒç‰ˆæœ¬çš„ babel, æ‰€ä»¥å®‰å…¨çš„åšæ³•è¿˜æ˜¯æŠŠ babel è£…åœ¨é¡¹ç›®ä¸­\n```shell\nnpm install --save-dev babel-cli\n```\n\npackage.json æ”¹æˆ:\n```json\n{\n  \"script\": \"babel src -d lib\"\n}\n```\n\n**babel-register**\nå®ƒçš„ç‰¹ç‚¹å°±æ˜¯å®æ—¶ç¼–è¯‘, ä¸ä¼šè¾“å‡ºæ–‡ä»¶, ç”¨æ¥æ”¹å†™ `require` å‘½ä»¤ä¸ºå®ƒåŠ ä¸Šé’©å­. `require` è¿›æ¥çš„æ–‡ä»¶å°±ä¼šè¢«è½¬ç , ä½†æ˜¯å®ƒä¸ä¼šè½¬ç å½“å‰æ–‡ä»¶ä¸­çš„ä»£ç .\n\nå®‰è£…\n```js\nnpm install --save-dev babel-register\n```\n\nä½¿ç”¨\n```js\n// å¿…é¡»å…ˆåŠ è½½ register\nrequire('babel-register')\n// ç„¶å register å°±ä¼šå¯¹ test.js æ–‡ä»¶è½¬ç \nrequire('test.js')\n```\n\n> ç”±äº `babel-register` æ˜¯å³æ—¶è½¬ç , æ‰€ä»¥åªé€‚ç”¨äºå¼€å‘ç¯å¢ƒä½¿ç”¨.\n\n### babel-core\n`babel-core` å¯ä»¥è¯´æ˜¯ babel æœ€ä¸ºæ ¸å¿ƒçš„ä¸€ä¸ªåŒ…, å¯ä»¥æŠŠå®ƒçœ‹æˆä¸€ä¸ªç¼–è¯‘å™¨, babel æ ¸å¿ƒçš„ API éƒ½åœ¨é‡Œé¢. æ¯”å¦‚: transform å¤„ç†è½¬ç , å› ä¸º ES6 çš„è¯­æ³•è·Ÿè€è¯­æ³•ä¸åŒ, æ‰€ä»¥å…ˆå°†æˆ‘ä»¬çš„ä»£ç è½¬æ¢ä¸º AST(æŠ½è±¡è¯­æ³•æ ‘), ç„¶ååˆ†åˆ«åšå¤„ç†è½¬åŒ–ä¸º ES5. webpack çš„ babel-loader å°±æ˜¯è°ƒç”¨è¿™äº› API å®Œæˆè½¬è¯‘çš„. [è¿™é‡Œæ˜¯è¯¦ç»†çš„ API](https://babeljs.cn/docs/usage/api/)\n\n> è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯: `babel-core` ä»…å…³æ³¨ code transform, ä¹Ÿå°±æ˜¯è¯´å®ƒåªåšè¯­æ³•ä¸Šçš„è½¬æ¢, æ¯”å¦‚ç®­å¤´å‡½æ•°. æ‰€ä»¥å¹¶ä¸æ˜¯ä»€ä¹ˆéƒ½èƒ½ç”¨ babel æ¥è½¬æ¢çš„, å¦‚æœæ¶‰åŠåˆ°æ–°çš„ API å°±éœ€è¦ä½ ç”¨ polyfill æ¥è½¬è¯‘, æ¯”å¦‚ `Promise`.\n\n```js\n// æ•´å—å¼•å…¥\nvar babel = require('babel-core')\n// ä¹Ÿå¯ä»¥é€‰æ‹©æŸä¸ª API å•ç‹¬ä½¿ç”¨\nimport { transform } from 'babel-core'\n```\n\nä¸»è¦çš„ API:\n\n**babel.transform(code: string, options?: Object)**\nå°†ä¼ å…¥çš„ code åšè½¬æ¢, è¿”å›å€¼ä¸ºä¸€ä¸ªå¯¹è±¡, å‚æ•°ä¸º: ç”Ÿæˆçš„å¯¹è±¡, source map å’Œ AST\n\n```js\nvar result = babel.transform(\"code();\", options);\nresult.code\nresult.map\nresult.ast\n```\n\n**babel.transformFile(filename: string, options?: Object, callback: Function)**\nå¼‚æ­¥è½¬è¯‘æ–‡ä»¶ä¸­çš„æ‰€æœ‰å†…å®¹\n\n```js\nbabel.transformFile('filename.js', options, function (err, result) {\n  result // { code, map, ast }\n})\n```\n\n**babel.transformFileSync(filename: string, options?: Object)**\n`babel.transformFile` çš„åŒæ­¥ç‰ˆæœ¬, è¿”å›å€¼ä¸º `filename` æ–‡ä»¶ä¸­è½¬è¯‘åçš„ä»£ç \n\n```js\nbabel.transformFileSync(filename, options) // { code, map, ast }\n```\n\n**babel.transformFromAst(ast: Object, code?: string, options?: Object)**\nåè½¬è¯‘, ç»™ä¸€ä¸ª AST è½¬ä¸º code\n\n```js\nconst code = 'if (true) return'\nconst ast = babylon.parse(code, { allowReturnOutsideFunction: true })\nconst { code, map, ast } = babel.transformFormAst(ast, code, options)\n```\n\n### babel-runtime\n[`babel-runtime`](https://babeljs.cn/docs/plugins/transform-runtime/) è¿™ä¸ªåŒ…å…¶å®å°±æ˜¯æŠŠ core-js å’Œ regenerator ç»„åˆèµ·æ¥ä¾›ä½¿ç”¨, å®ƒå’Œ `babel-polyfill` çš„éƒ½æ˜¯ä¸ºäº†æ¨¡æ‹Ÿ ES6 ç¯å¢ƒ. ä¹‹å‰æåˆ°çš„ `babel-core` åªå¯¹è¯­æ³•è¿›è¡Œè½¬æ¢, ä½†ä¸æ”¯æŒ Promise, Set, Map, array.reduce, Array.form, genertor, async è¿™äº›æ–° API çš„ç¼–è¯‘, æ‰€ä»¥æ‰ä¼šç”¨åˆ°è¿™ä¸¤ä¸ªä¸œè¥¿.\n\n**core-js**: ä¸»è¦å®ç°äº† Promise, Symbols, ES7ææ¡ˆç­‰ç­‰çš„ polyfill, åŒ…å«äº†å¤§éƒ¨åˆ†çš„ JavaScript æœ€æ–°æ ‡å‡†çš„å«ç‰‡.\n```js\n// éœ€è¦å•ä¸ªå¼•ç”¨åå†ä½¿ç”¨\nrequire('core-js/array/reduce')\n```\n\n**regenerator**: ä¸»è¦å®ç° generator/yeild, async/await (ä¸çŸ¥é“ä¸ºå•¥ core-js ä¸æŠŠè¿™ä¸¤ä¸ªä¸€èµ·å®ç°äº†...)\n\n**helpers**: `babel-runtime` é‡Œä¹Ÿæœ‰ helpers, å®ƒé‡Œé¢çš„ helpers ç›¸å½“äºä¹‹å‰æåˆ°çš„ `babel-external-helpers` ç”Ÿæˆçš„ helpers.js, åªä¸è¿‡æŠŠæ¯ä¸ª helpers å‡½æ•°éƒ½å•ç‹¬æ”¾åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹é‡Œè€Œå·². è¿™æ ·é…åˆ transform çš„æ—¶å€™, éœ€è¦ç”¨åˆ° helpers å‡½æ•°å°±å¯ä»¥ç›´æ¥ä» `babel-runtime` ä¸­å¼•ç”¨äº†.\n```js\nconst _asyncToGenerator2 = require('babel-runtime/helpers/asyncToGenerator')\n```\n\nåŒºåˆ«: \n\n- [babel-polyfill](https://babeljs.cn/docs/usage/polyfill): æ˜¯é€šè¿‡å…¨å±€å¯¹è±¡å’Œå†…ç½®å¯¹è±¡çš„ prototype ä¸Šæ·»åŠ æ–¹æ³•æ¥è¾¾åˆ°ç›®çš„, æ‰€ä»¥ä¸€æ—¦å¼•å…¥ `babel-polyfill` å°±ä¼šæ±¡æŸ“å…¨å±€ç¯å¢ƒ.\n- babel-runtime: `babel-runtime` æ˜¯ä¸€ä¸ªæ¨¡å—, æ‰€ä»¥å®ƒä¸ä¼šæ±¡æŸ“å…¨å±€ç¯å¢ƒå’Œå†…ç½®å¯¹è±¡çš„åŸå‹. å®ƒçš„åšæ³•å¼•å…¥éœ€è¦çš„ helper å‡½æ•°(ç±»ä¼¼: `const Promise = require('babel-runtime/core-js/promise')` æ¥å¼•å…¥ Promise).\n\nä¼˜ç¼ºç‚¹:\n\n- babel-poly-fill: å¼•å…¥ä¸€åŠ³æ°¸é€¸, ä½†æ˜¯æ±¡æŸ“ç¯å¢ƒ.\n- babel-runtime: \n    1. æ‰‹åŠ¨å¼•å…¥ä¸æ–¹ä¾¿\n    2. ç›´æ¥åœ¨ä»£ç ä¸­å¼•å…¥ helper å‡½æ•°æ„å‘³ç€ä¸èƒ½å…±äº«, æœ€ç»ˆæ‰“åŒ…å‡ºæ¥ä¼šæœ‰å¾ˆå¤šå†—ä½™ä»£ç (å¼•å…¥çš„éƒ½æ˜¯å…¨é‡çš„ polyfill). \n    \næ‰€ä»¥è¦é…åˆ `babel-plugin-transform-runtime` (å¾ˆå¤šåœ°æ–¹éƒ½æ˜¯æŠŠ `babel-runtime` å’Œ `babel-plugin-transform-runtime` ç»Ÿç§°ä¸º transform-runtime, å› ä¸ºå®ƒä¿©å¾—åˆåœ¨ä¸€èµ·æ‰å¥½ç”¨) æ¥è¾¾åˆ°æŒ‰éœ€å¼•å…¥ helper é¿å…é‡å¤æ‰“åŒ…å’Œæ‰‹åŠ¨å¼•å…¥çš„ç—›è‹¦, å®ƒä¸»è¦æ˜¯åšä¸€å±‚æ˜ å°„: å°† `babel-runtime` å†…å¼•ç”¨åˆ°çš„ core-js æˆ– regenerator.js æ˜ å°„åˆ°å…·ä½“å¯¹åº”çš„ helper. \n\n> æ³¨æ„: `babel-runtime` æ— æ³•è½¬ç å®ä¾‹æ–¹æ³•, å³å†…ç½®å¯¹è±¡åŸå‹ä¸Šçš„æ–¹æ³•, åªèƒ½é€šè¿‡ `babel-polyfill` æ¥è½¬ç . æ¯”å¦‚:\n```js\nArray.prototype.find()\n'hello'.includes('h')\n```\n\nå¦å¤–, å…³äºä¸ºä»€ä¹ˆ `babel-runtime` æ˜¯ dependencies ä¾èµ–, å› ä¸ºä»–åªæ˜¯é›†åˆäº† polyfill çš„ä¸€ä¸ª library, å¯¹åº”éœ€è¦çš„ polyfill éƒ½æ˜¯è¦å¼•å…¥é¡¹ç›®ä¸­, å¹¶è·Ÿé¡¹ç›®ä»£ç ä¸€èµ·æ‰“åŒ…çš„.\n\n### babel-preset-env\nå®ƒèƒ½æ ¹æ®å½“å‰çš„è¿è¡Œç¯å¢ƒ, è‡ªåŠ¨ç¡®å®šä½ éœ€è¦çš„ plugins å’Œ polyfills, babel çš„é…ç½®å®˜æ–¹æ¨èæ˜¯å†™åˆ° `.babelrc` æ–‡ä»¶ä¸­, ä»¥ `Vue-cli` çš„ babel é…ç½®ä¸ºä¾‹.[è¯¦ç»†å‚æ•°è®¾ç½®åŠè¯´æ˜](https://babeljs.cn/docs/plugins/preset-env/)\n\n```json\n{\n  \"presets\": [\n    [\"env\", \n      { \n        \"modules\": false // è®¾ç½® ES6 æ¨¡å—è½¬è¯‘çš„æ¨¡å¼, é»˜è®¤æ˜¯ commonjs\n      }\n    ],\n    // éœ€è¦æ”¯æŒåˆ°å“ªä¸ªé˜¶æ®µçš„ JavaScript ç‰ˆæœ¬\n    \"stage-2\"\n  ],\n  // éœ€è¦çš„æ’ä»¶\n  \"plugins\": [\n    \"transform-runtime\", // è™½ç„¶è¿™é‡Œæ²¡æœ‰å†™ babel-runtime, ä½†æ˜¯ transform-runtime ä¾èµ–äºå®ƒ, æ‰€ä»¥è¿˜æ˜¯è¦å®‰è£…\n    \"transform-vue-jsx\"\n  ],\n  // ç¼–è¯‘è¿‡ç¨‹æ˜¯å¦ä¿ç•™æ³¨é‡Š\n  \"comments\": false,\n  \"env\": {\n    \"test\": {\n      \"presets\": [\"env\", \"stage-2\"],\n      \"plugins\": [ \"istanbul\"]\n    }\n  }\n}\n```\n\næœ¬æ¥ `babel-preset-env` ä¸­æœ‰ä¸€ä¸ª useBuiltIns é€‰é¡¹(é»˜è®¤å€¼æ˜¯ false), å°±æ˜¯å®ƒå®ç°çš„æ ¹æ®è¿è¡Œç¯å¢ƒå¹¶åˆ¤æ–­éœ€è¦ä»€ä¹ˆ polyfill, è¾¾åˆ°æŒ‰éœ€å¼•å…¥è€Œä¸æ˜¯æ•´ä¸ªå¼•å…¥, å¯¹äº `import 'babel-polyfill'` å°±å¾ˆæ£’äº†. ä½†æ˜¯å¯ä»¥çœ‹åˆ° vue-template å¹¶æ²¡æœ‰ä½¿ç”¨è¿™ä¸ªé€‰é¡¹, è¿™æ˜¯å› ä¸º   <a href='javascript:' title='æˆ‘æ¶ˆä¸æ‰è¿™ä¸ªè¶…é“¾æ¥ğŸ˜‘'>babel-preset-env@1.x</a> çš„ç‰ˆæœ¬æ²¡æœ‰åŠæ³•å¾ˆå¥½æ¶ˆé™¤æœªä½¿ç”¨çš„ polyfill, åœ¨2.x ç‰ˆæœ¬ä¸‹å¯ä»¥ç”¨ `usebuiltIns: 'usage'`è¾¾åˆ°ç›®çš„.\n\n### å…¶ä»–\nbabel è¿˜æœ‰å¾ˆå¤šç›¸å…³çš„ä¸œè¥¿æ²¡è¯´åˆ°, åªæŒ‘äº†å‡ ä¸ªæœ€é‡è¦çš„æ¥è¯´, å…·ä½“çš„ helpers/ plugins éƒ½å¯ä»¥åˆ°[å®˜æ–¹ä»“åº“](https://github.com/babel/babel/tree/master/packages)æŸ¥çœ‹\n\n- [badylon](https://github.com/babel/babel/tree/master/packages/babylon): è¯æ³•è§£æå™¨\n- [babel-traverse](https://github.com/babel/babel/tree/master/packages/babel-traverse): ç”¨äºéå†, ç»´æŠ¤æ•´ä¸ª AST çš„çŠ¶æ€\n- [babel-generator](https://github.com/babel/babel/tree/master/packages/babel-generator): æ ¹æ® AST ç”Ÿæˆä»£ç \n\n#### babel çš„å·¥ä½œæµç¨‹\n\nè¾“å…¥éœ€è¦è½¬ç çš„ä»£ç  -> badylon è§£æ -> å¾—åˆ° AST -> \nbabel-traverse éå†è½¬è¯‘ -> å¾—åˆ°æ–°çš„ AST -> \næœ€å babel-generator æ ¹æ®æ–°çš„ AST ç”Ÿæˆä»£ç \n\n### æ€»ç»“\næ•´ä¸ªæ¥è¯´æˆ‘è§‰å¾—è¿˜æ˜¯ `babel-runtime` å’Œ `babel-polyfill` æ¯”è¾ƒéš¾åŒºåˆ†, å…¶å®ä¸¤è€…çš„æ ¸å¿ƒéƒ½åœ¨äº [core-js](https://github.com/zloirock/core-js#basic) åªæ˜¯å„æœ‰ä¼˜ç¼ºç‚¹è€Œå·², ä¸‹é¢ä¼šå†ç®€è¦æ€»ç»“ä¸€ä¸‹åŒºåˆ«. å…¶ä»–çš„è¯åªéœ€è¦çŸ¥é“æ¯ä¸ªä¸œè¥¿æ˜¯å¹²å•¥çš„å°±è¡Œäº†.\n\n- babel-polyfill: æ±¡æŸ“ç¯å¢ƒ, æ”¯æŒå®ä¾‹æ–¹æ³•(å¦‚æœåªæƒ³å¼•å…¥ä¸€äº›ç‰¹å®šçš„polyfill, é‚£å°±å» [core-js](https://github.com/zloirock/core-js#basic) ä¸­æ‰¾ç›¸åº”çš„æ–¹æ³•è‡ªå·±æ‰‹åŠ¨ require è¿›æ¥); \n- runtime: æŒ‰éœ€å¼•ç”¨,ä¸æ”¯æŒå®ä¾‹æ–¹æ³•.\n\nCreated on 2018-4-11 by Cara","source":"_posts/Babel.md","raw":"---\ntitle: Babelç”Ÿæ€\ndate: 2018-04-09 17:55:20\ntags:\n- Babel\ncategorles:\n- ç¬”è®°ğŸ“’\n---\nå¯¹äº babel çš„ä½¿ç”¨, ä¸€ç›´åœç•™åœ¨ä¸ webpack ç»“åˆä½¿ç”¨, ä»¥åŠåœ¨ Vue å¼€å‘ç¯å¢ƒä¸‹è„šæ‰‹æ¶åˆæ˜¯å¼€ç®±å³ç”¨. å¯¼è‡´å¾ˆå¤š babel çš„åŒ…, æˆ‘éƒ½ä¸æ¸…æ¥šä»–ä»¬æ˜¯å¹²ä»€ä¹ˆçš„. æ¯”å¦‚ babel-register/ babel-runtime/ helpers/ å„ç§ presets ä»¥åŠ transform-runtime å’Œ babel-polyfill çš„åŒºåˆ«, æ‰€ä»¥æ€»ç»“ä¸€ä¸‹.\n\n### babel-cli\næˆ‘ç†è§£ä¸º babel çš„ command å…¨å®¶æ¡¶, ç”¨äºåœ¨å‘½ä»¤è¡Œæ“ä½œçš„. é‡Œé¢åŒ…å«äº† `babel`/ `babel-external-helpers`/ `babel-node` 3ä¸ªå‘½ä»¤\n\n- babel: ç”¨äºç¼–è¯‘ä»£ç \n- babel-external-helpers: ç”¨äºç”Ÿæˆä¸€äº› halper å‡½æ•°, åŒ…å« babel æ‰€æœ‰çš„ hepler å‡½æ•° (å¦‚: toArray å‡½æ•°, jsx è½¬åŒ–å‡½æ•°). è¿™äº›å‡½æ•°å®åœ¨ babel transform çš„æ—¶å€™ç”¨, éƒ½æ”¾åœ¨ `babel-helpers` è¿™ä¸ªåŒ…ä¸­, å½“è¿™äº› helpers è¢«ç”¨åˆ°å°±ä¼šè¢«æ”¾ç½®åœ¨ç”Ÿæˆä»£ç çš„é¡¶éƒ¨. ä½†æ˜¯å½“å¤šä¸ªæ–‡ä»¶éƒ½ç”¨åˆ°äº† helpers å‡½æ•°å°±ä¼šäº§ç”Ÿå†—ä½™ä»£ç , æ‰€ä»¥ babel æä¾›è¿™ä¸ªå‘½ä»¤ç”Ÿæˆä¸€ä¸ªåŒ…å«æ‰€æœ‰ helpers çš„ js æ–‡ä»¶ç”¨äºç›´æ¥å¼•ç”¨.(ç„¶åå¯ä»¥é€šè¿‡ plugin å»æ£€æŸ¥å…¨å±€æ—¶å€™å­˜åœ¨è¿™ä¸ªæ¨¡å—, å­˜åœ¨å°±ä¸å®šä¹‰)\n- babel-node: ä¸»è¦æ˜¯å®ç°åœ¨ node ä¸­å†™ä»£ç å’Œæ‰§è¡Œè„šæœ¬çš„èƒ½åŠ›, å¯ä»¥ç›´æ¥è¿è¡Œ ES6ä»£ç . æ¯”å¦‚ç›´æ¥åœ¨ node ä¸­å†™ jsx, é€šè¿‡è¿™ä¸ªå°±å¯ä»¥æ‰§è¡Œ. ä½†æ˜¯è¦æŠŠå®ƒç¼–è¯‘æˆå¯æ‰§è¡Œçš„è„šæœ¬è¿˜éœ€è¦ `babel-register`\n\nå®‰è£…\n`npm install --global babel-cli`\n\nç”¨æ³•\n```shell\nbabel example.js\n\n# è½¬ç ç»“æœå†™å…¥æ–‡ä»¶\nbabel example.js -o result.js\n\n# æ•´ä¸ªç›®å½•è½¬ç \nbabel src -d lib\n\n# ç”Ÿæˆ source map æ–‡ä»¶\nbabel src -d lib -s\n```\n\nå…¨å±€ç¯å¢ƒä¸‹ babel æ— æ³•æ”¯æŒä¸åŒç‰ˆæœ¬çš„ babel, æ‰€ä»¥å®‰å…¨çš„åšæ³•è¿˜æ˜¯æŠŠ babel è£…åœ¨é¡¹ç›®ä¸­\n```shell\nnpm install --save-dev babel-cli\n```\n\npackage.json æ”¹æˆ:\n```json\n{\n  \"script\": \"babel src -d lib\"\n}\n```\n\n**babel-register**\nå®ƒçš„ç‰¹ç‚¹å°±æ˜¯å®æ—¶ç¼–è¯‘, ä¸ä¼šè¾“å‡ºæ–‡ä»¶, ç”¨æ¥æ”¹å†™ `require` å‘½ä»¤ä¸ºå®ƒåŠ ä¸Šé’©å­. `require` è¿›æ¥çš„æ–‡ä»¶å°±ä¼šè¢«è½¬ç , ä½†æ˜¯å®ƒä¸ä¼šè½¬ç å½“å‰æ–‡ä»¶ä¸­çš„ä»£ç .\n\nå®‰è£…\n```js\nnpm install --save-dev babel-register\n```\n\nä½¿ç”¨\n```js\n// å¿…é¡»å…ˆåŠ è½½ register\nrequire('babel-register')\n// ç„¶å register å°±ä¼šå¯¹ test.js æ–‡ä»¶è½¬ç \nrequire('test.js')\n```\n\n> ç”±äº `babel-register` æ˜¯å³æ—¶è½¬ç , æ‰€ä»¥åªé€‚ç”¨äºå¼€å‘ç¯å¢ƒä½¿ç”¨.\n\n### babel-core\n`babel-core` å¯ä»¥è¯´æ˜¯ babel æœ€ä¸ºæ ¸å¿ƒçš„ä¸€ä¸ªåŒ…, å¯ä»¥æŠŠå®ƒçœ‹æˆä¸€ä¸ªç¼–è¯‘å™¨, babel æ ¸å¿ƒçš„ API éƒ½åœ¨é‡Œé¢. æ¯”å¦‚: transform å¤„ç†è½¬ç , å› ä¸º ES6 çš„è¯­æ³•è·Ÿè€è¯­æ³•ä¸åŒ, æ‰€ä»¥å…ˆå°†æˆ‘ä»¬çš„ä»£ç è½¬æ¢ä¸º AST(æŠ½è±¡è¯­æ³•æ ‘), ç„¶ååˆ†åˆ«åšå¤„ç†è½¬åŒ–ä¸º ES5. webpack çš„ babel-loader å°±æ˜¯è°ƒç”¨è¿™äº› API å®Œæˆè½¬è¯‘çš„. [è¿™é‡Œæ˜¯è¯¦ç»†çš„ API](https://babeljs.cn/docs/usage/api/)\n\n> è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯: `babel-core` ä»…å…³æ³¨ code transform, ä¹Ÿå°±æ˜¯è¯´å®ƒåªåšè¯­æ³•ä¸Šçš„è½¬æ¢, æ¯”å¦‚ç®­å¤´å‡½æ•°. æ‰€ä»¥å¹¶ä¸æ˜¯ä»€ä¹ˆéƒ½èƒ½ç”¨ babel æ¥è½¬æ¢çš„, å¦‚æœæ¶‰åŠåˆ°æ–°çš„ API å°±éœ€è¦ä½ ç”¨ polyfill æ¥è½¬è¯‘, æ¯”å¦‚ `Promise`.\n\n```js\n// æ•´å—å¼•å…¥\nvar babel = require('babel-core')\n// ä¹Ÿå¯ä»¥é€‰æ‹©æŸä¸ª API å•ç‹¬ä½¿ç”¨\nimport { transform } from 'babel-core'\n```\n\nä¸»è¦çš„ API:\n\n**babel.transform(code: string, options?: Object)**\nå°†ä¼ å…¥çš„ code åšè½¬æ¢, è¿”å›å€¼ä¸ºä¸€ä¸ªå¯¹è±¡, å‚æ•°ä¸º: ç”Ÿæˆçš„å¯¹è±¡, source map å’Œ AST\n\n```js\nvar result = babel.transform(\"code();\", options);\nresult.code\nresult.map\nresult.ast\n```\n\n**babel.transformFile(filename: string, options?: Object, callback: Function)**\nå¼‚æ­¥è½¬è¯‘æ–‡ä»¶ä¸­çš„æ‰€æœ‰å†…å®¹\n\n```js\nbabel.transformFile('filename.js', options, function (err, result) {\n  result // { code, map, ast }\n})\n```\n\n**babel.transformFileSync(filename: string, options?: Object)**\n`babel.transformFile` çš„åŒæ­¥ç‰ˆæœ¬, è¿”å›å€¼ä¸º `filename` æ–‡ä»¶ä¸­è½¬è¯‘åçš„ä»£ç \n\n```js\nbabel.transformFileSync(filename, options) // { code, map, ast }\n```\n\n**babel.transformFromAst(ast: Object, code?: string, options?: Object)**\nåè½¬è¯‘, ç»™ä¸€ä¸ª AST è½¬ä¸º code\n\n```js\nconst code = 'if (true) return'\nconst ast = babylon.parse(code, { allowReturnOutsideFunction: true })\nconst { code, map, ast } = babel.transformFormAst(ast, code, options)\n```\n\n### babel-runtime\n[`babel-runtime`](https://babeljs.cn/docs/plugins/transform-runtime/) è¿™ä¸ªåŒ…å…¶å®å°±æ˜¯æŠŠ core-js å’Œ regenerator ç»„åˆèµ·æ¥ä¾›ä½¿ç”¨, å®ƒå’Œ `babel-polyfill` çš„éƒ½æ˜¯ä¸ºäº†æ¨¡æ‹Ÿ ES6 ç¯å¢ƒ. ä¹‹å‰æåˆ°çš„ `babel-core` åªå¯¹è¯­æ³•è¿›è¡Œè½¬æ¢, ä½†ä¸æ”¯æŒ Promise, Set, Map, array.reduce, Array.form, genertor, async è¿™äº›æ–° API çš„ç¼–è¯‘, æ‰€ä»¥æ‰ä¼šç”¨åˆ°è¿™ä¸¤ä¸ªä¸œè¥¿.\n\n**core-js**: ä¸»è¦å®ç°äº† Promise, Symbols, ES7ææ¡ˆç­‰ç­‰çš„ polyfill, åŒ…å«äº†å¤§éƒ¨åˆ†çš„ JavaScript æœ€æ–°æ ‡å‡†çš„å«ç‰‡.\n```js\n// éœ€è¦å•ä¸ªå¼•ç”¨åå†ä½¿ç”¨\nrequire('core-js/array/reduce')\n```\n\n**regenerator**: ä¸»è¦å®ç° generator/yeild, async/await (ä¸çŸ¥é“ä¸ºå•¥ core-js ä¸æŠŠè¿™ä¸¤ä¸ªä¸€èµ·å®ç°äº†...)\n\n**helpers**: `babel-runtime` é‡Œä¹Ÿæœ‰ helpers, å®ƒé‡Œé¢çš„ helpers ç›¸å½“äºä¹‹å‰æåˆ°çš„ `babel-external-helpers` ç”Ÿæˆçš„ helpers.js, åªä¸è¿‡æŠŠæ¯ä¸ª helpers å‡½æ•°éƒ½å•ç‹¬æ”¾åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹é‡Œè€Œå·². è¿™æ ·é…åˆ transform çš„æ—¶å€™, éœ€è¦ç”¨åˆ° helpers å‡½æ•°å°±å¯ä»¥ç›´æ¥ä» `babel-runtime` ä¸­å¼•ç”¨äº†.\n```js\nconst _asyncToGenerator2 = require('babel-runtime/helpers/asyncToGenerator')\n```\n\nåŒºåˆ«: \n\n- [babel-polyfill](https://babeljs.cn/docs/usage/polyfill): æ˜¯é€šè¿‡å…¨å±€å¯¹è±¡å’Œå†…ç½®å¯¹è±¡çš„ prototype ä¸Šæ·»åŠ æ–¹æ³•æ¥è¾¾åˆ°ç›®çš„, æ‰€ä»¥ä¸€æ—¦å¼•å…¥ `babel-polyfill` å°±ä¼šæ±¡æŸ“å…¨å±€ç¯å¢ƒ.\n- babel-runtime: `babel-runtime` æ˜¯ä¸€ä¸ªæ¨¡å—, æ‰€ä»¥å®ƒä¸ä¼šæ±¡æŸ“å…¨å±€ç¯å¢ƒå’Œå†…ç½®å¯¹è±¡çš„åŸå‹. å®ƒçš„åšæ³•å¼•å…¥éœ€è¦çš„ helper å‡½æ•°(ç±»ä¼¼: `const Promise = require('babel-runtime/core-js/promise')` æ¥å¼•å…¥ Promise).\n\nä¼˜ç¼ºç‚¹:\n\n- babel-poly-fill: å¼•å…¥ä¸€åŠ³æ°¸é€¸, ä½†æ˜¯æ±¡æŸ“ç¯å¢ƒ.\n- babel-runtime: \n    1. æ‰‹åŠ¨å¼•å…¥ä¸æ–¹ä¾¿\n    2. ç›´æ¥åœ¨ä»£ç ä¸­å¼•å…¥ helper å‡½æ•°æ„å‘³ç€ä¸èƒ½å…±äº«, æœ€ç»ˆæ‰“åŒ…å‡ºæ¥ä¼šæœ‰å¾ˆå¤šå†—ä½™ä»£ç (å¼•å…¥çš„éƒ½æ˜¯å…¨é‡çš„ polyfill). \n    \næ‰€ä»¥è¦é…åˆ `babel-plugin-transform-runtime` (å¾ˆå¤šåœ°æ–¹éƒ½æ˜¯æŠŠ `babel-runtime` å’Œ `babel-plugin-transform-runtime` ç»Ÿç§°ä¸º transform-runtime, å› ä¸ºå®ƒä¿©å¾—åˆåœ¨ä¸€èµ·æ‰å¥½ç”¨) æ¥è¾¾åˆ°æŒ‰éœ€å¼•å…¥ helper é¿å…é‡å¤æ‰“åŒ…å’Œæ‰‹åŠ¨å¼•å…¥çš„ç—›è‹¦, å®ƒä¸»è¦æ˜¯åšä¸€å±‚æ˜ å°„: å°† `babel-runtime` å†…å¼•ç”¨åˆ°çš„ core-js æˆ– regenerator.js æ˜ å°„åˆ°å…·ä½“å¯¹åº”çš„ helper. \n\n> æ³¨æ„: `babel-runtime` æ— æ³•è½¬ç å®ä¾‹æ–¹æ³•, å³å†…ç½®å¯¹è±¡åŸå‹ä¸Šçš„æ–¹æ³•, åªèƒ½é€šè¿‡ `babel-polyfill` æ¥è½¬ç . æ¯”å¦‚:\n```js\nArray.prototype.find()\n'hello'.includes('h')\n```\n\nå¦å¤–, å…³äºä¸ºä»€ä¹ˆ `babel-runtime` æ˜¯ dependencies ä¾èµ–, å› ä¸ºä»–åªæ˜¯é›†åˆäº† polyfill çš„ä¸€ä¸ª library, å¯¹åº”éœ€è¦çš„ polyfill éƒ½æ˜¯è¦å¼•å…¥é¡¹ç›®ä¸­, å¹¶è·Ÿé¡¹ç›®ä»£ç ä¸€èµ·æ‰“åŒ…çš„.\n\n### babel-preset-env\nå®ƒèƒ½æ ¹æ®å½“å‰çš„è¿è¡Œç¯å¢ƒ, è‡ªåŠ¨ç¡®å®šä½ éœ€è¦çš„ plugins å’Œ polyfills, babel çš„é…ç½®å®˜æ–¹æ¨èæ˜¯å†™åˆ° `.babelrc` æ–‡ä»¶ä¸­, ä»¥ `Vue-cli` çš„ babel é…ç½®ä¸ºä¾‹.[è¯¦ç»†å‚æ•°è®¾ç½®åŠè¯´æ˜](https://babeljs.cn/docs/plugins/preset-env/)\n\n```json\n{\n  \"presets\": [\n    [\"env\", \n      { \n        \"modules\": false // è®¾ç½® ES6 æ¨¡å—è½¬è¯‘çš„æ¨¡å¼, é»˜è®¤æ˜¯ commonjs\n      }\n    ],\n    // éœ€è¦æ”¯æŒåˆ°å“ªä¸ªé˜¶æ®µçš„ JavaScript ç‰ˆæœ¬\n    \"stage-2\"\n  ],\n  // éœ€è¦çš„æ’ä»¶\n  \"plugins\": [\n    \"transform-runtime\", // è™½ç„¶è¿™é‡Œæ²¡æœ‰å†™ babel-runtime, ä½†æ˜¯ transform-runtime ä¾èµ–äºå®ƒ, æ‰€ä»¥è¿˜æ˜¯è¦å®‰è£…\n    \"transform-vue-jsx\"\n  ],\n  // ç¼–è¯‘è¿‡ç¨‹æ˜¯å¦ä¿ç•™æ³¨é‡Š\n  \"comments\": false,\n  \"env\": {\n    \"test\": {\n      \"presets\": [\"env\", \"stage-2\"],\n      \"plugins\": [ \"istanbul\"]\n    }\n  }\n}\n```\n\næœ¬æ¥ `babel-preset-env` ä¸­æœ‰ä¸€ä¸ª useBuiltIns é€‰é¡¹(é»˜è®¤å€¼æ˜¯ false), å°±æ˜¯å®ƒå®ç°çš„æ ¹æ®è¿è¡Œç¯å¢ƒå¹¶åˆ¤æ–­éœ€è¦ä»€ä¹ˆ polyfill, è¾¾åˆ°æŒ‰éœ€å¼•å…¥è€Œä¸æ˜¯æ•´ä¸ªå¼•å…¥, å¯¹äº `import 'babel-polyfill'` å°±å¾ˆæ£’äº†. ä½†æ˜¯å¯ä»¥çœ‹åˆ° vue-template å¹¶æ²¡æœ‰ä½¿ç”¨è¿™ä¸ªé€‰é¡¹, è¿™æ˜¯å› ä¸º   <a href='javascript:' title='æˆ‘æ¶ˆä¸æ‰è¿™ä¸ªè¶…é“¾æ¥ğŸ˜‘'>babel-preset-env@1.x</a> çš„ç‰ˆæœ¬æ²¡æœ‰åŠæ³•å¾ˆå¥½æ¶ˆé™¤æœªä½¿ç”¨çš„ polyfill, åœ¨2.x ç‰ˆæœ¬ä¸‹å¯ä»¥ç”¨ `usebuiltIns: 'usage'`è¾¾åˆ°ç›®çš„.\n\n### å…¶ä»–\nbabel è¿˜æœ‰å¾ˆå¤šç›¸å…³çš„ä¸œè¥¿æ²¡è¯´åˆ°, åªæŒ‘äº†å‡ ä¸ªæœ€é‡è¦çš„æ¥è¯´, å…·ä½“çš„ helpers/ plugins éƒ½å¯ä»¥åˆ°[å®˜æ–¹ä»“åº“](https://github.com/babel/babel/tree/master/packages)æŸ¥çœ‹\n\n- [badylon](https://github.com/babel/babel/tree/master/packages/babylon): è¯æ³•è§£æå™¨\n- [babel-traverse](https://github.com/babel/babel/tree/master/packages/babel-traverse): ç”¨äºéå†, ç»´æŠ¤æ•´ä¸ª AST çš„çŠ¶æ€\n- [babel-generator](https://github.com/babel/babel/tree/master/packages/babel-generator): æ ¹æ® AST ç”Ÿæˆä»£ç \n\n#### babel çš„å·¥ä½œæµç¨‹\n\nè¾“å…¥éœ€è¦è½¬ç çš„ä»£ç  -> badylon è§£æ -> å¾—åˆ° AST -> \nbabel-traverse éå†è½¬è¯‘ -> å¾—åˆ°æ–°çš„ AST -> \næœ€å babel-generator æ ¹æ®æ–°çš„ AST ç”Ÿæˆä»£ç \n\n### æ€»ç»“\næ•´ä¸ªæ¥è¯´æˆ‘è§‰å¾—è¿˜æ˜¯ `babel-runtime` å’Œ `babel-polyfill` æ¯”è¾ƒéš¾åŒºåˆ†, å…¶å®ä¸¤è€…çš„æ ¸å¿ƒéƒ½åœ¨äº [core-js](https://github.com/zloirock/core-js#basic) åªæ˜¯å„æœ‰ä¼˜ç¼ºç‚¹è€Œå·², ä¸‹é¢ä¼šå†ç®€è¦æ€»ç»“ä¸€ä¸‹åŒºåˆ«. å…¶ä»–çš„è¯åªéœ€è¦çŸ¥é“æ¯ä¸ªä¸œè¥¿æ˜¯å¹²å•¥çš„å°±è¡Œäº†.\n\n- babel-polyfill: æ±¡æŸ“ç¯å¢ƒ, æ”¯æŒå®ä¾‹æ–¹æ³•(å¦‚æœåªæƒ³å¼•å…¥ä¸€äº›ç‰¹å®šçš„polyfill, é‚£å°±å» [core-js](https://github.com/zloirock/core-js#basic) ä¸­æ‰¾ç›¸åº”çš„æ–¹æ³•è‡ªå·±æ‰‹åŠ¨ require è¿›æ¥); \n- runtime: æŒ‰éœ€å¼•ç”¨,ä¸æ”¯æŒå®ä¾‹æ–¹æ³•.\n\nCreated on 2018-4-11 by Cara","slug":"Babel","published":1,"updated":"2018-05-05T09:23:03.650Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjgurols20002klu0u8rvtunj","content":"<p>å¯¹äº babel çš„ä½¿ç”¨, ä¸€ç›´åœç•™åœ¨ä¸ webpack ç»“åˆä½¿ç”¨, ä»¥åŠåœ¨ Vue å¼€å‘ç¯å¢ƒä¸‹è„šæ‰‹æ¶åˆæ˜¯å¼€ç®±å³ç”¨. å¯¼è‡´å¾ˆå¤š babel çš„åŒ…, æˆ‘éƒ½ä¸æ¸…æ¥šä»–ä»¬æ˜¯å¹²ä»€ä¹ˆçš„. æ¯”å¦‚ babel-register/ babel-runtime/ helpers/ å„ç§ presets ä»¥åŠ transform-runtime å’Œ babel-polyfill çš„åŒºåˆ«, æ‰€ä»¥æ€»ç»“ä¸€ä¸‹.</p>\n<h3 id=\"babel-cli\"><a href=\"#babel-cli\" class=\"headerlink\" title=\"babel-cli\"></a>babel-cli</h3><p>æˆ‘ç†è§£ä¸º babel çš„ command å…¨å®¶æ¡¶, ç”¨äºåœ¨å‘½ä»¤è¡Œæ“ä½œçš„. é‡Œé¢åŒ…å«äº† <code>babel</code>/ <code>babel-external-helpers</code>/ <code>babel-node</code> 3ä¸ªå‘½ä»¤</p>\n<ul>\n<li>babel: ç”¨äºç¼–è¯‘ä»£ç </li>\n<li>babel-external-helpers: ç”¨äºç”Ÿæˆä¸€äº› halper å‡½æ•°, åŒ…å« babel æ‰€æœ‰çš„ hepler å‡½æ•° (å¦‚: toArray å‡½æ•°, jsx è½¬åŒ–å‡½æ•°). è¿™äº›å‡½æ•°å®åœ¨ babel transform çš„æ—¶å€™ç”¨, éƒ½æ”¾åœ¨ <code>babel-helpers</code> è¿™ä¸ªåŒ…ä¸­, å½“è¿™äº› helpers è¢«ç”¨åˆ°å°±ä¼šè¢«æ”¾ç½®åœ¨ç”Ÿæˆä»£ç çš„é¡¶éƒ¨. ä½†æ˜¯å½“å¤šä¸ªæ–‡ä»¶éƒ½ç”¨åˆ°äº† helpers å‡½æ•°å°±ä¼šäº§ç”Ÿå†—ä½™ä»£ç , æ‰€ä»¥ babel æä¾›è¿™ä¸ªå‘½ä»¤ç”Ÿæˆä¸€ä¸ªåŒ…å«æ‰€æœ‰ helpers çš„ js æ–‡ä»¶ç”¨äºç›´æ¥å¼•ç”¨.(ç„¶åå¯ä»¥é€šè¿‡ plugin å»æ£€æŸ¥å…¨å±€æ—¶å€™å­˜åœ¨è¿™ä¸ªæ¨¡å—, å­˜åœ¨å°±ä¸å®šä¹‰)</li>\n<li>babel-node: ä¸»è¦æ˜¯å®ç°åœ¨ node ä¸­å†™ä»£ç å’Œæ‰§è¡Œè„šæœ¬çš„èƒ½åŠ›, å¯ä»¥ç›´æ¥è¿è¡Œ ES6ä»£ç . æ¯”å¦‚ç›´æ¥åœ¨ node ä¸­å†™ jsx, é€šè¿‡è¿™ä¸ªå°±å¯ä»¥æ‰§è¡Œ. ä½†æ˜¯è¦æŠŠå®ƒç¼–è¯‘æˆå¯æ‰§è¡Œçš„è„šæœ¬è¿˜éœ€è¦ <code>babel-register</code></li>\n</ul>\n<p>å®‰è£…<br><code>npm install --global babel-cli</code></p>\n<p>ç”¨æ³•<br><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">babel example.js</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span> è½¬ç ç»“æœå†™å…¥æ–‡ä»¶</span><br><span class=\"line\">babel example.js -o result.js</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span> æ•´ä¸ªç›®å½•è½¬ç </span><br><span class=\"line\">babel src -d lib</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span> ç”Ÿæˆ source map æ–‡ä»¶</span><br><span class=\"line\">babel src -d lib -s</span><br></pre></td></tr></table></figure></p>\n<p>å…¨å±€ç¯å¢ƒä¸‹ babel æ— æ³•æ”¯æŒä¸åŒç‰ˆæœ¬çš„ babel, æ‰€ä»¥å®‰å…¨çš„åšæ³•è¿˜æ˜¯æŠŠ babel è£…åœ¨é¡¹ç›®ä¸­<br><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install --save-dev babel-cli</span><br></pre></td></tr></table></figure></p>\n<p>package.json æ”¹æˆ:<br><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"script\"</span>: <span class=\"string\">\"babel src -d lib\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><strong>babel-register</strong><br>å®ƒçš„ç‰¹ç‚¹å°±æ˜¯å®æ—¶ç¼–è¯‘, ä¸ä¼šè¾“å‡ºæ–‡ä»¶, ç”¨æ¥æ”¹å†™ <code>require</code> å‘½ä»¤ä¸ºå®ƒåŠ ä¸Šé’©å­. <code>require</code> è¿›æ¥çš„æ–‡ä»¶å°±ä¼šè¢«è½¬ç , ä½†æ˜¯å®ƒä¸ä¼šè½¬ç å½“å‰æ–‡ä»¶ä¸­çš„ä»£ç .</p>\n<p>å®‰è£…<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install --save-dev babel-register</span><br></pre></td></tr></table></figure></p>\n<p>ä½¿ç”¨<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// å¿…é¡»å…ˆåŠ è½½ register</span></span><br><span class=\"line\"><span class=\"built_in\">require</span>(<span class=\"string\">'babel-register'</span>)</span><br><span class=\"line\"><span class=\"comment\">// ç„¶å register å°±ä¼šå¯¹ test.js æ–‡ä»¶è½¬ç </span></span><br><span class=\"line\"><span class=\"built_in\">require</span>(<span class=\"string\">'test.js'</span>)</span><br></pre></td></tr></table></figure></p>\n<blockquote>\n<p>ç”±äº <code>babel-register</code> æ˜¯å³æ—¶è½¬ç , æ‰€ä»¥åªé€‚ç”¨äºå¼€å‘ç¯å¢ƒä½¿ç”¨.</p>\n</blockquote>\n<h3 id=\"babel-core\"><a href=\"#babel-core\" class=\"headerlink\" title=\"babel-core\"></a>babel-core</h3><p><code>babel-core</code> å¯ä»¥è¯´æ˜¯ babel æœ€ä¸ºæ ¸å¿ƒçš„ä¸€ä¸ªåŒ…, å¯ä»¥æŠŠå®ƒçœ‹æˆä¸€ä¸ªç¼–è¯‘å™¨, babel æ ¸å¿ƒçš„ API éƒ½åœ¨é‡Œé¢. æ¯”å¦‚: transform å¤„ç†è½¬ç , å› ä¸º ES6 çš„è¯­æ³•è·Ÿè€è¯­æ³•ä¸åŒ, æ‰€ä»¥å…ˆå°†æˆ‘ä»¬çš„ä»£ç è½¬æ¢ä¸º AST(æŠ½è±¡è¯­æ³•æ ‘), ç„¶ååˆ†åˆ«åšå¤„ç†è½¬åŒ–ä¸º ES5. webpack çš„ babel-loader å°±æ˜¯è°ƒç”¨è¿™äº› API å®Œæˆè½¬è¯‘çš„. <a href=\"https://babeljs.cn/docs/usage/api/\" target=\"_blank\" rel=\"noopener\">è¿™é‡Œæ˜¯è¯¦ç»†çš„ API</a></p>\n<blockquote>\n<p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯: <code>babel-core</code> ä»…å…³æ³¨ code transform, ä¹Ÿå°±æ˜¯è¯´å®ƒåªåšè¯­æ³•ä¸Šçš„è½¬æ¢, æ¯”å¦‚ç®­å¤´å‡½æ•°. æ‰€ä»¥å¹¶ä¸æ˜¯ä»€ä¹ˆéƒ½èƒ½ç”¨ babel æ¥è½¬æ¢çš„, å¦‚æœæ¶‰åŠåˆ°æ–°çš„ API å°±éœ€è¦ä½ ç”¨ polyfill æ¥è½¬è¯‘, æ¯”å¦‚ <code>Promise</code>.</p>\n</blockquote>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// æ•´å—å¼•å…¥</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> babel = <span class=\"built_in\">require</span>(<span class=\"string\">'babel-core'</span>)</span><br><span class=\"line\"><span class=\"comment\">// ä¹Ÿå¯ä»¥é€‰æ‹©æŸä¸ª API å•ç‹¬ä½¿ç”¨</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; transform &#125; <span class=\"keyword\">from</span> <span class=\"string\">'babel-core'</span></span><br></pre></td></tr></table></figure>\n<p>ä¸»è¦çš„ API:</p>\n<p><strong>babel.transform(code: string, options?: Object)</strong><br>å°†ä¼ å…¥çš„ code åšè½¬æ¢, è¿”å›å€¼ä¸ºä¸€ä¸ªå¯¹è±¡, å‚æ•°ä¸º: ç”Ÿæˆçš„å¯¹è±¡, source map å’Œ AST</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> result = babel.transform(<span class=\"string\">\"code();\"</span>, options);</span><br><span class=\"line\">result.code</span><br><span class=\"line\">result.map</span><br><span class=\"line\">result.ast</span><br></pre></td></tr></table></figure>\n<p><strong>babel.transformFile(filename: string, options?: Object, callback: Function)</strong><br>å¼‚æ­¥è½¬è¯‘æ–‡ä»¶ä¸­çš„æ‰€æœ‰å†…å®¹</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">babel.transformFile(<span class=\"string\">'filename.js'</span>, options, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">err, result</span>) </span>&#123;</span><br><span class=\"line\">  result <span class=\"comment\">// &#123; code, map, ast &#125;</span></span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p><strong>babel.transformFileSync(filename: string, options?: Object)</strong><br><code>babel.transformFile</code> çš„åŒæ­¥ç‰ˆæœ¬, è¿”å›å€¼ä¸º <code>filename</code> æ–‡ä»¶ä¸­è½¬è¯‘åçš„ä»£ç </p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">babel.transformFileSync(filename, options) <span class=\"comment\">// &#123; code, map, ast &#125;</span></span><br></pre></td></tr></table></figure>\n<p><strong>babel.transformFromAst(ast: Object, code?: string, options?: Object)</strong><br>åè½¬è¯‘, ç»™ä¸€ä¸ª AST è½¬ä¸º code</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> code = <span class=\"string\">'if (true) return'</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> ast = babylon.parse(code, &#123; <span class=\"attr\">allowReturnOutsideFunction</span>: <span class=\"literal\">true</span> &#125;)</span><br><span class=\"line\"><span class=\"keyword\">const</span> &#123; code, map, ast &#125; = babel.transformFormAst(ast, code, options)</span><br></pre></td></tr></table></figure>\n<h3 id=\"babel-runtime\"><a href=\"#babel-runtime\" class=\"headerlink\" title=\"babel-runtime\"></a>babel-runtime</h3><p><a href=\"https://babeljs.cn/docs/plugins/transform-runtime/\" target=\"_blank\" rel=\"noopener\"><code>babel-runtime</code></a> è¿™ä¸ªåŒ…å…¶å®å°±æ˜¯æŠŠ core-js å’Œ regenerator ç»„åˆèµ·æ¥ä¾›ä½¿ç”¨, å®ƒå’Œ <code>babel-polyfill</code> çš„éƒ½æ˜¯ä¸ºäº†æ¨¡æ‹Ÿ ES6 ç¯å¢ƒ. ä¹‹å‰æåˆ°çš„ <code>babel-core</code> åªå¯¹è¯­æ³•è¿›è¡Œè½¬æ¢, ä½†ä¸æ”¯æŒ Promise, Set, Map, array.reduce, Array.form, genertor, async è¿™äº›æ–° API çš„ç¼–è¯‘, æ‰€ä»¥æ‰ä¼šç”¨åˆ°è¿™ä¸¤ä¸ªä¸œè¥¿.</p>\n<p><strong>core-js</strong>: ä¸»è¦å®ç°äº† Promise, Symbols, ES7ææ¡ˆç­‰ç­‰çš„ polyfill, åŒ…å«äº†å¤§éƒ¨åˆ†çš„ JavaScript æœ€æ–°æ ‡å‡†çš„å«ç‰‡.<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// éœ€è¦å•ä¸ªå¼•ç”¨åå†ä½¿ç”¨</span></span><br><span class=\"line\"><span class=\"built_in\">require</span>(<span class=\"string\">'core-js/array/reduce'</span>)</span><br></pre></td></tr></table></figure></p>\n<p><strong>regenerator</strong>: ä¸»è¦å®ç° generator/yeild, async/await (ä¸çŸ¥é“ä¸ºå•¥ core-js ä¸æŠŠè¿™ä¸¤ä¸ªä¸€èµ·å®ç°äº†â€¦)</p>\n<p><strong>helpers</strong>: <code>babel-runtime</code> é‡Œä¹Ÿæœ‰ helpers, å®ƒé‡Œé¢çš„ helpers ç›¸å½“äºä¹‹å‰æåˆ°çš„ <code>babel-external-helpers</code> ç”Ÿæˆçš„ helpers.js, åªä¸è¿‡æŠŠæ¯ä¸ª helpers å‡½æ•°éƒ½å•ç‹¬æ”¾åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹é‡Œè€Œå·². è¿™æ ·é…åˆ transform çš„æ—¶å€™, éœ€è¦ç”¨åˆ° helpers å‡½æ•°å°±å¯ä»¥ç›´æ¥ä» <code>babel-runtime</code> ä¸­å¼•ç”¨äº†.<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> _asyncToGenerator2 = <span class=\"built_in\">require</span>(<span class=\"string\">'babel-runtime/helpers/asyncToGenerator'</span>)</span><br></pre></td></tr></table></figure></p>\n<p>åŒºåˆ«: </p>\n<ul>\n<li><a href=\"https://babeljs.cn/docs/usage/polyfill\" target=\"_blank\" rel=\"noopener\">babel-polyfill</a>: æ˜¯é€šè¿‡å…¨å±€å¯¹è±¡å’Œå†…ç½®å¯¹è±¡çš„ prototype ä¸Šæ·»åŠ æ–¹æ³•æ¥è¾¾åˆ°ç›®çš„, æ‰€ä»¥ä¸€æ—¦å¼•å…¥ <code>babel-polyfill</code> å°±ä¼šæ±¡æŸ“å…¨å±€ç¯å¢ƒ.</li>\n<li>babel-runtime: <code>babel-runtime</code> æ˜¯ä¸€ä¸ªæ¨¡å—, æ‰€ä»¥å®ƒä¸ä¼šæ±¡æŸ“å…¨å±€ç¯å¢ƒå’Œå†…ç½®å¯¹è±¡çš„åŸå‹. å®ƒçš„åšæ³•å¼•å…¥éœ€è¦çš„ helper å‡½æ•°(ç±»ä¼¼: <code>const Promise = require(&#39;babel-runtime/core-js/promise&#39;)</code> æ¥å¼•å…¥ Promise).</li>\n</ul>\n<p>ä¼˜ç¼ºç‚¹:</p>\n<ul>\n<li>babel-poly-fill: å¼•å…¥ä¸€åŠ³æ°¸é€¸, ä½†æ˜¯æ±¡æŸ“ç¯å¢ƒ.</li>\n<li>babel-runtime: <ol>\n<li>æ‰‹åŠ¨å¼•å…¥ä¸æ–¹ä¾¿</li>\n<li>ç›´æ¥åœ¨ä»£ç ä¸­å¼•å…¥ helper å‡½æ•°æ„å‘³ç€ä¸èƒ½å…±äº«, æœ€ç»ˆæ‰“åŒ…å‡ºæ¥ä¼šæœ‰å¾ˆå¤šå†—ä½™ä»£ç (å¼•å…¥çš„éƒ½æ˜¯å…¨é‡çš„ polyfill). </li>\n</ol>\n</li>\n</ul>\n<p>æ‰€ä»¥è¦é…åˆ <code>babel-plugin-transform-runtime</code> (å¾ˆå¤šåœ°æ–¹éƒ½æ˜¯æŠŠ <code>babel-runtime</code> å’Œ <code>babel-plugin-transform-runtime</code> ç»Ÿç§°ä¸º transform-runtime, å› ä¸ºå®ƒä¿©å¾—åˆåœ¨ä¸€èµ·æ‰å¥½ç”¨) æ¥è¾¾åˆ°æŒ‰éœ€å¼•å…¥ helper é¿å…é‡å¤æ‰“åŒ…å’Œæ‰‹åŠ¨å¼•å…¥çš„ç—›è‹¦, å®ƒä¸»è¦æ˜¯åšä¸€å±‚æ˜ å°„: å°† <code>babel-runtime</code> å†…å¼•ç”¨åˆ°çš„ core-js æˆ– regenerator.js æ˜ å°„åˆ°å…·ä½“å¯¹åº”çš„ helper. </p>\n<blockquote>\n<p>æ³¨æ„: <code>babel-runtime</code> æ— æ³•è½¬ç å®ä¾‹æ–¹æ³•, å³å†…ç½®å¯¹è±¡åŸå‹ä¸Šçš„æ–¹æ³•, åªèƒ½é€šè¿‡ <code>babel-polyfill</code> æ¥è½¬ç . æ¯”å¦‚:<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">Array</span>.prototype.find()</span><br><span class=\"line\"><span class=\"string\">'hello'</span>.includes(<span class=\"string\">'h'</span>)</span><br></pre></td></tr></table></figure></p>\n</blockquote>\n<p>å¦å¤–, å…³äºä¸ºä»€ä¹ˆ <code>babel-runtime</code> æ˜¯ dependencies ä¾èµ–, å› ä¸ºä»–åªæ˜¯é›†åˆäº† polyfill çš„ä¸€ä¸ª library, å¯¹åº”éœ€è¦çš„ polyfill éƒ½æ˜¯è¦å¼•å…¥é¡¹ç›®ä¸­, å¹¶è·Ÿé¡¹ç›®ä»£ç ä¸€èµ·æ‰“åŒ…çš„.</p>\n<h3 id=\"babel-preset-env\"><a href=\"#babel-preset-env\" class=\"headerlink\" title=\"babel-preset-env\"></a>babel-preset-env</h3><p>å®ƒèƒ½æ ¹æ®å½“å‰çš„è¿è¡Œç¯å¢ƒ, è‡ªåŠ¨ç¡®å®šä½ éœ€è¦çš„ plugins å’Œ polyfills, babel çš„é…ç½®å®˜æ–¹æ¨èæ˜¯å†™åˆ° <code>.babelrc</code> æ–‡ä»¶ä¸­, ä»¥ <code>Vue-cli</code> çš„ babel é…ç½®ä¸ºä¾‹.<a href=\"https://babeljs.cn/docs/plugins/preset-env/\" target=\"_blank\" rel=\"noopener\">è¯¦ç»†å‚æ•°è®¾ç½®åŠè¯´æ˜</a></p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"presets\"</span>: [</span><br><span class=\"line\">    [<span class=\"string\">\"env\"</span>, </span><br><span class=\"line\">      &#123; </span><br><span class=\"line\">        \"modules\": false // è®¾ç½® ES6 æ¨¡å—è½¬è¯‘çš„æ¨¡å¼, é»˜è®¤æ˜¯ commonjs</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    ],</span><br><span class=\"line\">    // éœ€è¦æ”¯æŒåˆ°å“ªä¸ªé˜¶æ®µçš„ JavaScript ç‰ˆæœ¬</span><br><span class=\"line\">    <span class=\"string\">\"stage-2\"</span></span><br><span class=\"line\">  ],</span><br><span class=\"line\">  // éœ€è¦çš„æ’ä»¶</span><br><span class=\"line\">  \"plugins\": [</span><br><span class=\"line\">    \"transform-runtime\", // è™½ç„¶è¿™é‡Œæ²¡æœ‰å†™ babel-runtime, ä½†æ˜¯ transform-runtime ä¾èµ–äºå®ƒ, æ‰€ä»¥è¿˜æ˜¯è¦å®‰è£…</span><br><span class=\"line\">    <span class=\"string\">\"transform-vue-jsx\"</span></span><br><span class=\"line\">  ],</span><br><span class=\"line\">  // ç¼–è¯‘è¿‡ç¨‹æ˜¯å¦ä¿ç•™æ³¨é‡Š</span><br><span class=\"line\">  \"comments\": false,</span><br><span class=\"line\">  \"env\": &#123;</span><br><span class=\"line\">    \"test\": &#123;</span><br><span class=\"line\">      \"presets\": [\"env\", \"stage-2\"],</span><br><span class=\"line\">      \"plugins\": [ \"istanbul\"]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>æœ¬æ¥ <code>babel-preset-env</code> ä¸­æœ‰ä¸€ä¸ª useBuiltIns é€‰é¡¹(é»˜è®¤å€¼æ˜¯ false), å°±æ˜¯å®ƒå®ç°çš„æ ¹æ®è¿è¡Œç¯å¢ƒå¹¶åˆ¤æ–­éœ€è¦ä»€ä¹ˆ polyfill, è¾¾åˆ°æŒ‰éœ€å¼•å…¥è€Œä¸æ˜¯æ•´ä¸ªå¼•å…¥, å¯¹äº <code>import &#39;babel-polyfill&#39;</code> å°±å¾ˆæ£’äº†. ä½†æ˜¯å¯ä»¥çœ‹åˆ° vue-template å¹¶æ²¡æœ‰ä½¿ç”¨è¿™ä¸ªé€‰é¡¹, è¿™æ˜¯å› ä¸º   <a href=\"javascript:\" title=\"æˆ‘æ¶ˆä¸æ‰è¿™ä¸ªè¶…é“¾æ¥ğŸ˜‘\" target=\"_blank\" rel=\"noopener\">babel-preset-env@1.x</a> çš„ç‰ˆæœ¬æ²¡æœ‰åŠæ³•å¾ˆå¥½æ¶ˆé™¤æœªä½¿ç”¨çš„ polyfill, åœ¨2.x ç‰ˆæœ¬ä¸‹å¯ä»¥ç”¨ <code>usebuiltIns: &#39;usage&#39;</code>è¾¾åˆ°ç›®çš„.</p>\n<h3 id=\"å…¶ä»–\"><a href=\"#å…¶ä»–\" class=\"headerlink\" title=\"å…¶ä»–\"></a>å…¶ä»–</h3><p>babel è¿˜æœ‰å¾ˆå¤šç›¸å…³çš„ä¸œè¥¿æ²¡è¯´åˆ°, åªæŒ‘äº†å‡ ä¸ªæœ€é‡è¦çš„æ¥è¯´, å…·ä½“çš„ helpers/ plugins éƒ½å¯ä»¥åˆ°<a href=\"https://github.com/babel/babel/tree/master/packages\" target=\"_blank\" rel=\"noopener\">å®˜æ–¹ä»“åº“</a>æŸ¥çœ‹</p>\n<ul>\n<li><a href=\"https://github.com/babel/babel/tree/master/packages/babylon\" target=\"_blank\" rel=\"noopener\">badylon</a>: è¯æ³•è§£æå™¨</li>\n<li><a href=\"https://github.com/babel/babel/tree/master/packages/babel-traverse\" target=\"_blank\" rel=\"noopener\">babel-traverse</a>: ç”¨äºéå†, ç»´æŠ¤æ•´ä¸ª AST çš„çŠ¶æ€</li>\n<li><a href=\"https://github.com/babel/babel/tree/master/packages/babel-generator\" target=\"_blank\" rel=\"noopener\">babel-generator</a>: æ ¹æ® AST ç”Ÿæˆä»£ç </li>\n</ul>\n<h4 id=\"babel-çš„å·¥ä½œæµç¨‹\"><a href=\"#babel-çš„å·¥ä½œæµç¨‹\" class=\"headerlink\" title=\"babel çš„å·¥ä½œæµç¨‹\"></a>babel çš„å·¥ä½œæµç¨‹</h4><p>è¾“å…¥éœ€è¦è½¬ç çš„ä»£ç  -&gt; badylon è§£æ -&gt; å¾—åˆ° AST -&gt;<br>babel-traverse éå†è½¬è¯‘ -&gt; å¾—åˆ°æ–°çš„ AST -&gt;<br>æœ€å babel-generator æ ¹æ®æ–°çš„ AST ç”Ÿæˆä»£ç </p>\n<h3 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h3><p>æ•´ä¸ªæ¥è¯´æˆ‘è§‰å¾—è¿˜æ˜¯ <code>babel-runtime</code> å’Œ <code>babel-polyfill</code> æ¯”è¾ƒéš¾åŒºåˆ†, å…¶å®ä¸¤è€…çš„æ ¸å¿ƒéƒ½åœ¨äº <a href=\"https://github.com/zloirock/core-js#basic\" target=\"_blank\" rel=\"noopener\">core-js</a> åªæ˜¯å„æœ‰ä¼˜ç¼ºç‚¹è€Œå·², ä¸‹é¢ä¼šå†ç®€è¦æ€»ç»“ä¸€ä¸‹åŒºåˆ«. å…¶ä»–çš„è¯åªéœ€è¦çŸ¥é“æ¯ä¸ªä¸œè¥¿æ˜¯å¹²å•¥çš„å°±è¡Œäº†.</p>\n<ul>\n<li>babel-polyfill: æ±¡æŸ“ç¯å¢ƒ, æ”¯æŒå®ä¾‹æ–¹æ³•(å¦‚æœåªæƒ³å¼•å…¥ä¸€äº›ç‰¹å®šçš„polyfill, é‚£å°±å» <a href=\"https://github.com/zloirock/core-js#basic\" target=\"_blank\" rel=\"noopener\">core-js</a> ä¸­æ‰¾ç›¸åº”çš„æ–¹æ³•è‡ªå·±æ‰‹åŠ¨ require è¿›æ¥); </li>\n<li>runtime: æŒ‰éœ€å¼•ç”¨,ä¸æ”¯æŒå®ä¾‹æ–¹æ³•.</li>\n</ul>\n<p>Created on 2018-4-11 by Cara</p>\n","site":{"data":{}},"excerpt":"","more":"<p>å¯¹äº babel çš„ä½¿ç”¨, ä¸€ç›´åœç•™åœ¨ä¸ webpack ç»“åˆä½¿ç”¨, ä»¥åŠåœ¨ Vue å¼€å‘ç¯å¢ƒä¸‹è„šæ‰‹æ¶åˆæ˜¯å¼€ç®±å³ç”¨. å¯¼è‡´å¾ˆå¤š babel çš„åŒ…, æˆ‘éƒ½ä¸æ¸…æ¥šä»–ä»¬æ˜¯å¹²ä»€ä¹ˆçš„. æ¯”å¦‚ babel-register/ babel-runtime/ helpers/ å„ç§ presets ä»¥åŠ transform-runtime å’Œ babel-polyfill çš„åŒºåˆ«, æ‰€ä»¥æ€»ç»“ä¸€ä¸‹.</p>\n<h3 id=\"babel-cli\"><a href=\"#babel-cli\" class=\"headerlink\" title=\"babel-cli\"></a>babel-cli</h3><p>æˆ‘ç†è§£ä¸º babel çš„ command å…¨å®¶æ¡¶, ç”¨äºåœ¨å‘½ä»¤è¡Œæ“ä½œçš„. é‡Œé¢åŒ…å«äº† <code>babel</code>/ <code>babel-external-helpers</code>/ <code>babel-node</code> 3ä¸ªå‘½ä»¤</p>\n<ul>\n<li>babel: ç”¨äºç¼–è¯‘ä»£ç </li>\n<li>babel-external-helpers: ç”¨äºç”Ÿæˆä¸€äº› halper å‡½æ•°, åŒ…å« babel æ‰€æœ‰çš„ hepler å‡½æ•° (å¦‚: toArray å‡½æ•°, jsx è½¬åŒ–å‡½æ•°). è¿™äº›å‡½æ•°å®åœ¨ babel transform çš„æ—¶å€™ç”¨, éƒ½æ”¾åœ¨ <code>babel-helpers</code> è¿™ä¸ªåŒ…ä¸­, å½“è¿™äº› helpers è¢«ç”¨åˆ°å°±ä¼šè¢«æ”¾ç½®åœ¨ç”Ÿæˆä»£ç çš„é¡¶éƒ¨. ä½†æ˜¯å½“å¤šä¸ªæ–‡ä»¶éƒ½ç”¨åˆ°äº† helpers å‡½æ•°å°±ä¼šäº§ç”Ÿå†—ä½™ä»£ç , æ‰€ä»¥ babel æä¾›è¿™ä¸ªå‘½ä»¤ç”Ÿæˆä¸€ä¸ªåŒ…å«æ‰€æœ‰ helpers çš„ js æ–‡ä»¶ç”¨äºç›´æ¥å¼•ç”¨.(ç„¶åå¯ä»¥é€šè¿‡ plugin å»æ£€æŸ¥å…¨å±€æ—¶å€™å­˜åœ¨è¿™ä¸ªæ¨¡å—, å­˜åœ¨å°±ä¸å®šä¹‰)</li>\n<li>babel-node: ä¸»è¦æ˜¯å®ç°åœ¨ node ä¸­å†™ä»£ç å’Œæ‰§è¡Œè„šæœ¬çš„èƒ½åŠ›, å¯ä»¥ç›´æ¥è¿è¡Œ ES6ä»£ç . æ¯”å¦‚ç›´æ¥åœ¨ node ä¸­å†™ jsx, é€šè¿‡è¿™ä¸ªå°±å¯ä»¥æ‰§è¡Œ. ä½†æ˜¯è¦æŠŠå®ƒç¼–è¯‘æˆå¯æ‰§è¡Œçš„è„šæœ¬è¿˜éœ€è¦ <code>babel-register</code></li>\n</ul>\n<p>å®‰è£…<br><code>npm install --global babel-cli</code></p>\n<p>ç”¨æ³•<br><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">babel example.js</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span> è½¬ç ç»“æœå†™å…¥æ–‡ä»¶</span><br><span class=\"line\">babel example.js -o result.js</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span> æ•´ä¸ªç›®å½•è½¬ç </span><br><span class=\"line\">babel src -d lib</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span> ç”Ÿæˆ source map æ–‡ä»¶</span><br><span class=\"line\">babel src -d lib -s</span><br></pre></td></tr></table></figure></p>\n<p>å…¨å±€ç¯å¢ƒä¸‹ babel æ— æ³•æ”¯æŒä¸åŒç‰ˆæœ¬çš„ babel, æ‰€ä»¥å®‰å…¨çš„åšæ³•è¿˜æ˜¯æŠŠ babel è£…åœ¨é¡¹ç›®ä¸­<br><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install --save-dev babel-cli</span><br></pre></td></tr></table></figure></p>\n<p>package.json æ”¹æˆ:<br><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"script\"</span>: <span class=\"string\">\"babel src -d lib\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><strong>babel-register</strong><br>å®ƒçš„ç‰¹ç‚¹å°±æ˜¯å®æ—¶ç¼–è¯‘, ä¸ä¼šè¾“å‡ºæ–‡ä»¶, ç”¨æ¥æ”¹å†™ <code>require</code> å‘½ä»¤ä¸ºå®ƒåŠ ä¸Šé’©å­. <code>require</code> è¿›æ¥çš„æ–‡ä»¶å°±ä¼šè¢«è½¬ç , ä½†æ˜¯å®ƒä¸ä¼šè½¬ç å½“å‰æ–‡ä»¶ä¸­çš„ä»£ç .</p>\n<p>å®‰è£…<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install --save-dev babel-register</span><br></pre></td></tr></table></figure></p>\n<p>ä½¿ç”¨<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// å¿…é¡»å…ˆåŠ è½½ register</span></span><br><span class=\"line\"><span class=\"built_in\">require</span>(<span class=\"string\">'babel-register'</span>)</span><br><span class=\"line\"><span class=\"comment\">// ç„¶å register å°±ä¼šå¯¹ test.js æ–‡ä»¶è½¬ç </span></span><br><span class=\"line\"><span class=\"built_in\">require</span>(<span class=\"string\">'test.js'</span>)</span><br></pre></td></tr></table></figure></p>\n<blockquote>\n<p>ç”±äº <code>babel-register</code> æ˜¯å³æ—¶è½¬ç , æ‰€ä»¥åªé€‚ç”¨äºå¼€å‘ç¯å¢ƒä½¿ç”¨.</p>\n</blockquote>\n<h3 id=\"babel-core\"><a href=\"#babel-core\" class=\"headerlink\" title=\"babel-core\"></a>babel-core</h3><p><code>babel-core</code> å¯ä»¥è¯´æ˜¯ babel æœ€ä¸ºæ ¸å¿ƒçš„ä¸€ä¸ªåŒ…, å¯ä»¥æŠŠå®ƒçœ‹æˆä¸€ä¸ªç¼–è¯‘å™¨, babel æ ¸å¿ƒçš„ API éƒ½åœ¨é‡Œé¢. æ¯”å¦‚: transform å¤„ç†è½¬ç , å› ä¸º ES6 çš„è¯­æ³•è·Ÿè€è¯­æ³•ä¸åŒ, æ‰€ä»¥å…ˆå°†æˆ‘ä»¬çš„ä»£ç è½¬æ¢ä¸º AST(æŠ½è±¡è¯­æ³•æ ‘), ç„¶ååˆ†åˆ«åšå¤„ç†è½¬åŒ–ä¸º ES5. webpack çš„ babel-loader å°±æ˜¯è°ƒç”¨è¿™äº› API å®Œæˆè½¬è¯‘çš„. <a href=\"https://babeljs.cn/docs/usage/api/\" target=\"_blank\" rel=\"noopener\">è¿™é‡Œæ˜¯è¯¦ç»†çš„ API</a></p>\n<blockquote>\n<p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯: <code>babel-core</code> ä»…å…³æ³¨ code transform, ä¹Ÿå°±æ˜¯è¯´å®ƒåªåšè¯­æ³•ä¸Šçš„è½¬æ¢, æ¯”å¦‚ç®­å¤´å‡½æ•°. æ‰€ä»¥å¹¶ä¸æ˜¯ä»€ä¹ˆéƒ½èƒ½ç”¨ babel æ¥è½¬æ¢çš„, å¦‚æœæ¶‰åŠåˆ°æ–°çš„ API å°±éœ€è¦ä½ ç”¨ polyfill æ¥è½¬è¯‘, æ¯”å¦‚ <code>Promise</code>.</p>\n</blockquote>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// æ•´å—å¼•å…¥</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> babel = <span class=\"built_in\">require</span>(<span class=\"string\">'babel-core'</span>)</span><br><span class=\"line\"><span class=\"comment\">// ä¹Ÿå¯ä»¥é€‰æ‹©æŸä¸ª API å•ç‹¬ä½¿ç”¨</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; transform &#125; <span class=\"keyword\">from</span> <span class=\"string\">'babel-core'</span></span><br></pre></td></tr></table></figure>\n<p>ä¸»è¦çš„ API:</p>\n<p><strong>babel.transform(code: string, options?: Object)</strong><br>å°†ä¼ å…¥çš„ code åšè½¬æ¢, è¿”å›å€¼ä¸ºä¸€ä¸ªå¯¹è±¡, å‚æ•°ä¸º: ç”Ÿæˆçš„å¯¹è±¡, source map å’Œ AST</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> result = babel.transform(<span class=\"string\">\"code();\"</span>, options);</span><br><span class=\"line\">result.code</span><br><span class=\"line\">result.map</span><br><span class=\"line\">result.ast</span><br></pre></td></tr></table></figure>\n<p><strong>babel.transformFile(filename: string, options?: Object, callback: Function)</strong><br>å¼‚æ­¥è½¬è¯‘æ–‡ä»¶ä¸­çš„æ‰€æœ‰å†…å®¹</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">babel.transformFile(<span class=\"string\">'filename.js'</span>, options, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">err, result</span>) </span>&#123;</span><br><span class=\"line\">  result <span class=\"comment\">// &#123; code, map, ast &#125;</span></span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p><strong>babel.transformFileSync(filename: string, options?: Object)</strong><br><code>babel.transformFile</code> çš„åŒæ­¥ç‰ˆæœ¬, è¿”å›å€¼ä¸º <code>filename</code> æ–‡ä»¶ä¸­è½¬è¯‘åçš„ä»£ç </p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">babel.transformFileSync(filename, options) <span class=\"comment\">// &#123; code, map, ast &#125;</span></span><br></pre></td></tr></table></figure>\n<p><strong>babel.transformFromAst(ast: Object, code?: string, options?: Object)</strong><br>åè½¬è¯‘, ç»™ä¸€ä¸ª AST è½¬ä¸º code</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> code = <span class=\"string\">'if (true) return'</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> ast = babylon.parse(code, &#123; <span class=\"attr\">allowReturnOutsideFunction</span>: <span class=\"literal\">true</span> &#125;)</span><br><span class=\"line\"><span class=\"keyword\">const</span> &#123; code, map, ast &#125; = babel.transformFormAst(ast, code, options)</span><br></pre></td></tr></table></figure>\n<h3 id=\"babel-runtime\"><a href=\"#babel-runtime\" class=\"headerlink\" title=\"babel-runtime\"></a>babel-runtime</h3><p><a href=\"https://babeljs.cn/docs/plugins/transform-runtime/\" target=\"_blank\" rel=\"noopener\"><code>babel-runtime</code></a> è¿™ä¸ªåŒ…å…¶å®å°±æ˜¯æŠŠ core-js å’Œ regenerator ç»„åˆèµ·æ¥ä¾›ä½¿ç”¨, å®ƒå’Œ <code>babel-polyfill</code> çš„éƒ½æ˜¯ä¸ºäº†æ¨¡æ‹Ÿ ES6 ç¯å¢ƒ. ä¹‹å‰æåˆ°çš„ <code>babel-core</code> åªå¯¹è¯­æ³•è¿›è¡Œè½¬æ¢, ä½†ä¸æ”¯æŒ Promise, Set, Map, array.reduce, Array.form, genertor, async è¿™äº›æ–° API çš„ç¼–è¯‘, æ‰€ä»¥æ‰ä¼šç”¨åˆ°è¿™ä¸¤ä¸ªä¸œè¥¿.</p>\n<p><strong>core-js</strong>: ä¸»è¦å®ç°äº† Promise, Symbols, ES7ææ¡ˆç­‰ç­‰çš„ polyfill, åŒ…å«äº†å¤§éƒ¨åˆ†çš„ JavaScript æœ€æ–°æ ‡å‡†çš„å«ç‰‡.<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// éœ€è¦å•ä¸ªå¼•ç”¨åå†ä½¿ç”¨</span></span><br><span class=\"line\"><span class=\"built_in\">require</span>(<span class=\"string\">'core-js/array/reduce'</span>)</span><br></pre></td></tr></table></figure></p>\n<p><strong>regenerator</strong>: ä¸»è¦å®ç° generator/yeild, async/await (ä¸çŸ¥é“ä¸ºå•¥ core-js ä¸æŠŠè¿™ä¸¤ä¸ªä¸€èµ·å®ç°äº†â€¦)</p>\n<p><strong>helpers</strong>: <code>babel-runtime</code> é‡Œä¹Ÿæœ‰ helpers, å®ƒé‡Œé¢çš„ helpers ç›¸å½“äºä¹‹å‰æåˆ°çš„ <code>babel-external-helpers</code> ç”Ÿæˆçš„ helpers.js, åªä¸è¿‡æŠŠæ¯ä¸ª helpers å‡½æ•°éƒ½å•ç‹¬æ”¾åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹é‡Œè€Œå·². è¿™æ ·é…åˆ transform çš„æ—¶å€™, éœ€è¦ç”¨åˆ° helpers å‡½æ•°å°±å¯ä»¥ç›´æ¥ä» <code>babel-runtime</code> ä¸­å¼•ç”¨äº†.<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> _asyncToGenerator2 = <span class=\"built_in\">require</span>(<span class=\"string\">'babel-runtime/helpers/asyncToGenerator'</span>)</span><br></pre></td></tr></table></figure></p>\n<p>åŒºåˆ«: </p>\n<ul>\n<li><a href=\"https://babeljs.cn/docs/usage/polyfill\" target=\"_blank\" rel=\"noopener\">babel-polyfill</a>: æ˜¯é€šè¿‡å…¨å±€å¯¹è±¡å’Œå†…ç½®å¯¹è±¡çš„ prototype ä¸Šæ·»åŠ æ–¹æ³•æ¥è¾¾åˆ°ç›®çš„, æ‰€ä»¥ä¸€æ—¦å¼•å…¥ <code>babel-polyfill</code> å°±ä¼šæ±¡æŸ“å…¨å±€ç¯å¢ƒ.</li>\n<li>babel-runtime: <code>babel-runtime</code> æ˜¯ä¸€ä¸ªæ¨¡å—, æ‰€ä»¥å®ƒä¸ä¼šæ±¡æŸ“å…¨å±€ç¯å¢ƒå’Œå†…ç½®å¯¹è±¡çš„åŸå‹. å®ƒçš„åšæ³•å¼•å…¥éœ€è¦çš„ helper å‡½æ•°(ç±»ä¼¼: <code>const Promise = require(&#39;babel-runtime/core-js/promise&#39;)</code> æ¥å¼•å…¥ Promise).</li>\n</ul>\n<p>ä¼˜ç¼ºç‚¹:</p>\n<ul>\n<li>babel-poly-fill: å¼•å…¥ä¸€åŠ³æ°¸é€¸, ä½†æ˜¯æ±¡æŸ“ç¯å¢ƒ.</li>\n<li>babel-runtime: <ol>\n<li>æ‰‹åŠ¨å¼•å…¥ä¸æ–¹ä¾¿</li>\n<li>ç›´æ¥åœ¨ä»£ç ä¸­å¼•å…¥ helper å‡½æ•°æ„å‘³ç€ä¸èƒ½å…±äº«, æœ€ç»ˆæ‰“åŒ…å‡ºæ¥ä¼šæœ‰å¾ˆå¤šå†—ä½™ä»£ç (å¼•å…¥çš„éƒ½æ˜¯å…¨é‡çš„ polyfill). </li>\n</ol>\n</li>\n</ul>\n<p>æ‰€ä»¥è¦é…åˆ <code>babel-plugin-transform-runtime</code> (å¾ˆå¤šåœ°æ–¹éƒ½æ˜¯æŠŠ <code>babel-runtime</code> å’Œ <code>babel-plugin-transform-runtime</code> ç»Ÿç§°ä¸º transform-runtime, å› ä¸ºå®ƒä¿©å¾—åˆåœ¨ä¸€èµ·æ‰å¥½ç”¨) æ¥è¾¾åˆ°æŒ‰éœ€å¼•å…¥ helper é¿å…é‡å¤æ‰“åŒ…å’Œæ‰‹åŠ¨å¼•å…¥çš„ç—›è‹¦, å®ƒä¸»è¦æ˜¯åšä¸€å±‚æ˜ å°„: å°† <code>babel-runtime</code> å†…å¼•ç”¨åˆ°çš„ core-js æˆ– regenerator.js æ˜ å°„åˆ°å…·ä½“å¯¹åº”çš„ helper. </p>\n<blockquote>\n<p>æ³¨æ„: <code>babel-runtime</code> æ— æ³•è½¬ç å®ä¾‹æ–¹æ³•, å³å†…ç½®å¯¹è±¡åŸå‹ä¸Šçš„æ–¹æ³•, åªèƒ½é€šè¿‡ <code>babel-polyfill</code> æ¥è½¬ç . æ¯”å¦‚:<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">Array</span>.prototype.find()</span><br><span class=\"line\"><span class=\"string\">'hello'</span>.includes(<span class=\"string\">'h'</span>)</span><br></pre></td></tr></table></figure></p>\n</blockquote>\n<p>å¦å¤–, å…³äºä¸ºä»€ä¹ˆ <code>babel-runtime</code> æ˜¯ dependencies ä¾èµ–, å› ä¸ºä»–åªæ˜¯é›†åˆäº† polyfill çš„ä¸€ä¸ª library, å¯¹åº”éœ€è¦çš„ polyfill éƒ½æ˜¯è¦å¼•å…¥é¡¹ç›®ä¸­, å¹¶è·Ÿé¡¹ç›®ä»£ç ä¸€èµ·æ‰“åŒ…çš„.</p>\n<h3 id=\"babel-preset-env\"><a href=\"#babel-preset-env\" class=\"headerlink\" title=\"babel-preset-env\"></a>babel-preset-env</h3><p>å®ƒèƒ½æ ¹æ®å½“å‰çš„è¿è¡Œç¯å¢ƒ, è‡ªåŠ¨ç¡®å®šä½ éœ€è¦çš„ plugins å’Œ polyfills, babel çš„é…ç½®å®˜æ–¹æ¨èæ˜¯å†™åˆ° <code>.babelrc</code> æ–‡ä»¶ä¸­, ä»¥ <code>Vue-cli</code> çš„ babel é…ç½®ä¸ºä¾‹.<a href=\"https://babeljs.cn/docs/plugins/preset-env/\" target=\"_blank\" rel=\"noopener\">è¯¦ç»†å‚æ•°è®¾ç½®åŠè¯´æ˜</a></p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"presets\"</span>: [</span><br><span class=\"line\">    [<span class=\"string\">\"env\"</span>, </span><br><span class=\"line\">      &#123; </span><br><span class=\"line\">        \"modules\": false // è®¾ç½® ES6 æ¨¡å—è½¬è¯‘çš„æ¨¡å¼, é»˜è®¤æ˜¯ commonjs</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    ],</span><br><span class=\"line\">    // éœ€è¦æ”¯æŒåˆ°å“ªä¸ªé˜¶æ®µçš„ JavaScript ç‰ˆæœ¬</span><br><span class=\"line\">    <span class=\"string\">\"stage-2\"</span></span><br><span class=\"line\">  ],</span><br><span class=\"line\">  // éœ€è¦çš„æ’ä»¶</span><br><span class=\"line\">  \"plugins\": [</span><br><span class=\"line\">    \"transform-runtime\", // è™½ç„¶è¿™é‡Œæ²¡æœ‰å†™ babel-runtime, ä½†æ˜¯ transform-runtime ä¾èµ–äºå®ƒ, æ‰€ä»¥è¿˜æ˜¯è¦å®‰è£…</span><br><span class=\"line\">    <span class=\"string\">\"transform-vue-jsx\"</span></span><br><span class=\"line\">  ],</span><br><span class=\"line\">  // ç¼–è¯‘è¿‡ç¨‹æ˜¯å¦ä¿ç•™æ³¨é‡Š</span><br><span class=\"line\">  \"comments\": false,</span><br><span class=\"line\">  \"env\": &#123;</span><br><span class=\"line\">    \"test\": &#123;</span><br><span class=\"line\">      \"presets\": [\"env\", \"stage-2\"],</span><br><span class=\"line\">      \"plugins\": [ \"istanbul\"]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>æœ¬æ¥ <code>babel-preset-env</code> ä¸­æœ‰ä¸€ä¸ª useBuiltIns é€‰é¡¹(é»˜è®¤å€¼æ˜¯ false), å°±æ˜¯å®ƒå®ç°çš„æ ¹æ®è¿è¡Œç¯å¢ƒå¹¶åˆ¤æ–­éœ€è¦ä»€ä¹ˆ polyfill, è¾¾åˆ°æŒ‰éœ€å¼•å…¥è€Œä¸æ˜¯æ•´ä¸ªå¼•å…¥, å¯¹äº <code>import &#39;babel-polyfill&#39;</code> å°±å¾ˆæ£’äº†. ä½†æ˜¯å¯ä»¥çœ‹åˆ° vue-template å¹¶æ²¡æœ‰ä½¿ç”¨è¿™ä¸ªé€‰é¡¹, è¿™æ˜¯å› ä¸º   <a href=\"javascript:\" title=\"æˆ‘æ¶ˆä¸æ‰è¿™ä¸ªè¶…é“¾æ¥ğŸ˜‘\" target=\"_blank\" rel=\"noopener\">babel-preset-env@1.x</a> çš„ç‰ˆæœ¬æ²¡æœ‰åŠæ³•å¾ˆå¥½æ¶ˆé™¤æœªä½¿ç”¨çš„ polyfill, åœ¨2.x ç‰ˆæœ¬ä¸‹å¯ä»¥ç”¨ <code>usebuiltIns: &#39;usage&#39;</code>è¾¾åˆ°ç›®çš„.</p>\n<h3 id=\"å…¶ä»–\"><a href=\"#å…¶ä»–\" class=\"headerlink\" title=\"å…¶ä»–\"></a>å…¶ä»–</h3><p>babel è¿˜æœ‰å¾ˆå¤šç›¸å…³çš„ä¸œè¥¿æ²¡è¯´åˆ°, åªæŒ‘äº†å‡ ä¸ªæœ€é‡è¦çš„æ¥è¯´, å…·ä½“çš„ helpers/ plugins éƒ½å¯ä»¥åˆ°<a href=\"https://github.com/babel/babel/tree/master/packages\" target=\"_blank\" rel=\"noopener\">å®˜æ–¹ä»“åº“</a>æŸ¥çœ‹</p>\n<ul>\n<li><a href=\"https://github.com/babel/babel/tree/master/packages/babylon\" target=\"_blank\" rel=\"noopener\">badylon</a>: è¯æ³•è§£æå™¨</li>\n<li><a href=\"https://github.com/babel/babel/tree/master/packages/babel-traverse\" target=\"_blank\" rel=\"noopener\">babel-traverse</a>: ç”¨äºéå†, ç»´æŠ¤æ•´ä¸ª AST çš„çŠ¶æ€</li>\n<li><a href=\"https://github.com/babel/babel/tree/master/packages/babel-generator\" target=\"_blank\" rel=\"noopener\">babel-generator</a>: æ ¹æ® AST ç”Ÿæˆä»£ç </li>\n</ul>\n<h4 id=\"babel-çš„å·¥ä½œæµç¨‹\"><a href=\"#babel-çš„å·¥ä½œæµç¨‹\" class=\"headerlink\" title=\"babel çš„å·¥ä½œæµç¨‹\"></a>babel çš„å·¥ä½œæµç¨‹</h4><p>è¾“å…¥éœ€è¦è½¬ç çš„ä»£ç  -&gt; badylon è§£æ -&gt; å¾—åˆ° AST -&gt;<br>babel-traverse éå†è½¬è¯‘ -&gt; å¾—åˆ°æ–°çš„ AST -&gt;<br>æœ€å babel-generator æ ¹æ®æ–°çš„ AST ç”Ÿæˆä»£ç </p>\n<h3 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h3><p>æ•´ä¸ªæ¥è¯´æˆ‘è§‰å¾—è¿˜æ˜¯ <code>babel-runtime</code> å’Œ <code>babel-polyfill</code> æ¯”è¾ƒéš¾åŒºåˆ†, å…¶å®ä¸¤è€…çš„æ ¸å¿ƒéƒ½åœ¨äº <a href=\"https://github.com/zloirock/core-js#basic\" target=\"_blank\" rel=\"noopener\">core-js</a> åªæ˜¯å„æœ‰ä¼˜ç¼ºç‚¹è€Œå·², ä¸‹é¢ä¼šå†ç®€è¦æ€»ç»“ä¸€ä¸‹åŒºåˆ«. å…¶ä»–çš„è¯åªéœ€è¦çŸ¥é“æ¯ä¸ªä¸œè¥¿æ˜¯å¹²å•¥çš„å°±è¡Œäº†.</p>\n<ul>\n<li>babel-polyfill: æ±¡æŸ“ç¯å¢ƒ, æ”¯æŒå®ä¾‹æ–¹æ³•(å¦‚æœåªæƒ³å¼•å…¥ä¸€äº›ç‰¹å®šçš„polyfill, é‚£å°±å» <a href=\"https://github.com/zloirock/core-js#basic\" target=\"_blank\" rel=\"noopener\">core-js</a> ä¸­æ‰¾ç›¸åº”çš„æ–¹æ³•è‡ªå·±æ‰‹åŠ¨ require è¿›æ¥); </li>\n<li>runtime: æŒ‰éœ€å¼•ç”¨,ä¸æ”¯æŒå®ä¾‹æ–¹æ³•.</li>\n</ul>\n<p>Created on 2018-4-11 by Cara</p>\n"},{"title":"CSS  å‚ç›´æ°´å¹³å±…ä¸­å¤§æ•´åˆ","date":"2017-10-14T12:31:30.000Z","_content":"\nåœ¨å¹³æ—¶çš„å¸ƒå±€ä¸­å¸¸å¸¸ä¼šç”¨åˆ°çš„å‚ç›´æ°´å¹³å±…ä¸­. ä¸‹é¢å°±æ¥æ€»ç»“å‡ ç§å‚ç›´\næ°´å¹³å±…ä¸­çš„æ–¹æ³•.\n\n> ### 1. ç»å¯¹å®šä½æ°´å¹³å‚ç›´å±…ä¸­\n> ç»™å…ƒç´ è®¾ç½®ç»å¯¹å®šä½, å…¶çˆ¶çº§å…ƒç´ ä¸º`body`æˆ–è€…æŒ‡å®šçš„ç›¸å¯¹å®šä½å…ƒç´ . \n> å®ƒçš„ç¼ºç‚¹æ˜¯å¿…é¡»è®¾ç½®å®½åº¦å€¼æˆ–è€…é«˜åº¦å€¼; ä¼˜ç‚¹æ˜¯å…¼å®¹æ€§æŒºå¥½, ä»£ç ä¹Ÿä¸\n> å¤š, ä¸è¿‡å¬è¯´åœ¨ windows phone ä¸Šä¸èµ·ä½œç”¨.\n\n```html\n<div class='wrapper'>\n\t<div class='absolute-center'>æˆ‘æ˜¯ç»å¯¹å®šä½<div>\n</div>\n```\n\n```css\n.wrapper{\n\twidth: 100%;\n\theight: 200px;\n\tposition: relative;\n\tborder: thin solid black;\n}\n.absolute-center{\n\tposition: absolute;\n\ttop: 0;\n\tright: 0;\n\tbottom: 0;\n\tleft: 0;\n\tmargin: auto;\n\tbackground: deepskyblue;\n\theight: 100px;\n\tline-height: 100px;\n\ttext-align: center;\n\tcolor: #fff;\n}\n```\n\n> ä¹‹å‰ä¸€ç›´ä¸æ‡‚ç»å¯¹å®šä½çš„å·¥ä½œæœºåˆ¶åˆ°åº•æ˜¯æ€æ ·, ä¸‹é¢æ˜¯æŸ¥èµ„æ–™çœ‹åˆ°çš„:\n\n1. åœ¨æ™®é€šæ–‡æ¡£æµä¸­`margin: auto`ç›¸å½“äº`margin-top: 0; margin-bottom: 0;`;\n2. `position: absolute`ä¼šè„±ç¦»æ–‡æ¡£æµ, è„±ç¦»çš„éƒ¨åˆ†å°†ä¸ä¼šå½±å“æ–‡æ¡£æµä¸­çš„å†…å®¹.\n3. ç»™å—åŒºåŸŸå†…è®¾ç½®`top: 0; right: 0;bottom: 0;left: 0`, æµè§ˆå™¨å°†é‡æ–°åˆ†é…ä¸€ä¸ªè¾¹ç•Œæ¡†,  è¿™ä¸ªæ—¶å€™çš„å—åŒºåŸŸä¼šå æ»¡çˆ¶çº§æ‰€æœ‰å¯ç”¨ç©ºé—´.\n4. ä¸ºè¿™ä¸ªå—åŒºåŸŸè®¾ç½®å®½åº¦æˆ–é«˜åº¦å°±å¯ä»¥é˜²æ­¢è¯¥å…ƒç´ å æ»¡æ•´ä¸ªçˆ¶çº§å…ƒç´ , ä¿ƒä½¿æµè§ˆå™¨æ ¹æ®æ–°çš„è¾¹ç•Œå€¼é‡æ–°è®¡ç®—`margin: auto`.\n5. ç”±äºå†…å®¹å—è¢«ç»å¯¹å®šä½, è„±ç¦»äº†æ­£å¸¸çš„å†…å®¹æµ, æµè§ˆå™¨ä¼šç»™`margin-top,margin-bottom`ç›¸åŒçš„å€¼, ä½¿å…ƒç´ å—åœ¨å…ˆå‰å®šä¹‰çš„è¾¹ç•Œå†…å±…ä¸­.\n\n> ### 2.  å¯è§†åŒºåŸŸå†…æ°´å¹³å‚ç›´å±…ä¸­\n> æŠŠä¸Šé¢ä¾‹å­æ”¹ä¸º`position: fixed; z-index: 999`, è®¾ç½®ä¸€ä¸ªè¾ƒå¤§å€¼çš„`z-index`; å¦‚æœä¸ç»™è¿™ä¸ªå—çº§å…ƒç´ è®¾ç½®å®½é«˜åˆ™ä¼šå æ»¡æ•´ä¸ªå±å¹•.\n\n```html\n<div class=\"fixed-center\">å›ºå®šå®šä½æ°´å¹³å‚ç›´å±…ä¸­</div>\n```\n\n```css\n.fixed-center{\n\twidth: 200px;\n\theight: 200px;\n\tposition: fixed;;\n\tz-index: 999;\n\tbackground: rgba(0, 0, 0, .3);\n\ttop: 0; \n\tleft: 0;\n\tbottom: 0; \n\tright: 0; \n\tmargin: auto;\n\tline-height: 200px;\n\tcolor: #fff;\n\ttext-align: center;\n}\n```\n\n> ### 3. è¾¹æ å‚ç›´å±…ä¸­\n> æœ‰æ—¶éœ€è¦å°†ä¸€ä¸ªå†…å®¹å—å›ºå®šåœ¨å±å¹•çš„å·¦ä¾§æˆ–è€…å³ä¾§, å¯ä»¥å‘å†…å®¹å¿«åŠ å…¥åƒè¿™æ ·çš„ CSS ä»£ç `top: 20px; bottom: auto;`; ç”±äºå·²ç»å£°æ˜äº†`margin: auto`, å†…å®¹å—å°†ä¼šå‚ç›´å±…ä¸­åœ¨ä½ å®šä¹‰çš„`top`/ `right`/ `bottom`/ `left`è¾¹ç•Œå€¼å†…. å¯ä»¥ç”¨`left: 0; right: auto`å°†å†…å®¹å¿«å›ºå®šåœ¨å·¦ä¾§; `right: 0; left: auto;`å°†å†…å®¹å›ºå®šåœ¨å³ä¾§.\n\n```html\n<div class=\"absolute-left\">\n\tç»å¯¹å®šä½åœ¨å·¦ä¾§\n</div>\n<div class=\"absolute-right\">\n\tç»å¯¹å®šä½åœ¨å³ä¾§\n</div>\n```\n\n```css\n.absolute-left {\n\tposition: absolute;\n\tleft: 20px;\n\tright: auto;\n\tmargin: auto;\n\twidth: 150px;\n\theight: 80px;\n\tbackground: red;\n\tcolor: #fff;\n\ttext-align: center;\n\tline-height: 80px;\n}\n.absolute-right {\n\tposition: absolute;\n\tleft: auto;\n\tright: 20px;\n\tmargin: auto;\n\twidth: 150px;\n\theight: 80px;\n\tbackground: green;\n\tcolor: #fff;\n\ttext-align: center;\n\tline-height: 80px;\n}\n```\n\n> ### 4. è‡ªé€‚åº”ç»å¯¹å®šä½å±…ä¸­\n> è‡ªé€‚åº”ç»å¯¹å±…ä¸­çš„ä¼˜åŠ¿å°±æ˜¯å¯¹ç™¾åˆ†æ¯”çš„å®½é«˜å®Œç¾æ”¯æŒ, ç”šè‡³æ˜¯`max-width/ min-width`æˆ–è€…æ˜¯`max-height/ max-width`, å³ä½¿åŠ ä¸Š`padding`ä¹Ÿä¸ä¼šå½±å“ç»å¯¹å±…ä¸­çš„å®ç°.\n\n```html\n<div class=\"wrapper-responsive\">\n\t<div class=\"absolute-responsive\">\n\t\tè‡ªé€‚åº”ç»å¯¹å®šä½å±…ä¸­\n\t</div>\n</div>\n```\n\n```css\n.wrapper-responsive{\n\tposition: relative;\n\ttop: 300px;\n\twidth: 200px;\n\theight: 200px;\n\tborder: thin solid black;\n}\n.absolute-responsive{\n\tposition: absolute;\n\ttop: 0;\n\tright: 0;\n\tbottom: 0;\n\tleft: 0;\n\tmargin: auto;\n\twidth: 60%;\n\theight: 60%;\n\tmin-width: 50px;\n\tmax-width: 150px;\n\tpadding: 10px;\n\ttext-align: center;\n\tcolor: #fff;\n\tbackground: skyblue;\n}\n```\n\n> ### 5. å†…å®¹æº¢å‡º\n> æœ‰æ—¶å†…å®¹å—çš„å†…å®¹è¿‡å¤šå¯¼è‡´é«˜åº¦å¤§äºçˆ¶çº§å…ƒç´ , å†…å®¹å°±ä¼šæ˜¾ç¤ºåˆ°å—å’Œå®¹å™¨çš„å¤–é¢, è¿™ç§æ—¶å€™åŠ ä¸ªç»™å†…å®¹å—`overflow: auto`å³å¯, å¦‚æœå†…å®¹å—æ²¡æœ‰`padding`çš„è¯åŠ ä¸ª`max-height: 100%`ä¹Ÿè¡Œ.\n\n> ### 6. å¯å˜é«˜åº¦\n> è®¾ç½®`display: table`, å†…å®¹å—ä¼šå‚ç›´å±…ä¸Šä¸è¿‡æ°´å¹³è¿˜æ˜¯å±…ä¸­. ä½†æ˜¯è¿™ä¸ªåœ¨ä¸€äº›æµè§ˆå™¨ä¸Šæœ‰é—®é¢˜( å¦‚: IE/ FF); `display: table-cell`é…åˆ`vertical-align: middle;`ä¹Ÿå¯å®ç°å‚ç›´æ°´å¹³å±…ä¸­.\n\n```html\n<div class=\"wrapper-table\">\n\t<div class=\"table-center\">\n\t\ttable æ°´å¹³å±…ä¸­\n\t\tå†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…\n\t</div>\n</div>\n\t\n<div class=\"wrapper-table-cell\">\n\t<div class=\"table-center-cell\">\n\t\ttable-cell å±…ä¸­\n\t\tå†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…\n\t</div>\n</div>\n```\n\n```css\n/* tabel å±…ä¸­ */\n.wrapper-table{\n\tmargin-top: 600px;\n\tdisplay: table;\n\theight: auto;\n\twidth: 200px;\n\theight: 200px;\n\tborder: thin solid black;\n}\n.table-center{\n\twidth: 80px;\n\tbackground: orange;\n\tcolor: #fff;\n}\n\n/* tabel-cell å±…ä¸­ */\n.wrapper-table-cell{\n\tmargin-top: 600px;\n\tdisplay: table-cell;\n\theight: auto;\n\twidth: 200px;\n\theight: 200px;\n\tborder: thin solid black;\n\tvertical-align: middle;\n}\n.table-center-cell{\n\twidth: 100px;\n\tbackground: #FFD34E;\n\tcolor: #fff;\n}\n```\n\n> ### 6. è´Ÿå¤–è¾¹è·\n> è¿™ä¸ªæ–¹æ³•åº”è¯¥æ˜¯å¾ˆå¸¸ç”¨çš„æ–¹æ³•äº†, å·²çŸ¥å…ƒç´ çš„å®½é«˜: å¤–è¾¹è·`margin`çš„å€¼å–è´Ÿæ•°(æ²¡æœ‰`box-sizing: border-box`çš„æƒ…å†µä¸‹, åŒ…æ‹¬`padding`), å¤§å°ä¸º `width/ height`çš„ä¸€åŠ, å†åŠ ä¸Š`top: 50%; left: 50%`, è¿™ä¸ªä¸èƒ½è‡ªé€‚åº”å“¦.\n```html\n<div class=\"wrapper-margin\">\n\t<div class=\"margin-center\">\n\t\tmargin å±…ä¸­\n\t</div>\n</div>\n```\n\n```css\n.wrapper-margin{\n  position: relative;\n\ttop: 100px;\n\tborder: thin solid black;\n\twidth: 200px;\n\theight: 200px;\n}\n.margin-center{\n\twidth: 100px;\n\theight: 100px;\n\tbackground: #105B63;\n\tposition: absolute;\n\ttop: 50%;\n\tleft: 50%;\n\tmargin: -50px auto auto -50px;\n\tcolor: #fff;\n\ttext-align: center;\n\tline-height: 100px;\n}\n```\n\n> ### 7. å˜å½¢\n> è¿™å¯ä»¥è¯´æ˜¯æœ€ç®€å•çš„æ–¹æ³•äº†, ä¸ä»…å¯ä»¥å®ç°ç»å¯¹å±…ä¸­çš„æƒ³è¿‡è¿˜å¯ä»¥å®ç°å¯å˜å®½é«˜åº¦. å†…å®¹å—å®šä¹‰`transform: translate(-50%, -50%)`å¸¦ä¸Šæµè§ˆå™¨å‰ç¼€, å†åŠ ä¸Š`top: 50%; left: 50%`å³å¯.\n\n```html\n<div class=\"wrapper-transform\">\n\t<div class=\"transform-center\">\n\t\ttransform å±…ä¸­\n\t</div>\n</div>\n```\n\n```css\n.wrapper-transform{\n\tposition: relative;\n\ttop: 200px;\n\tborder: thin solid black;\n\twidth: 200px;\n\theight: 200px;\n}\n.transform-center{\n\twidth: 100px;\n\theight: 100px;\n\tbackground: #BD4932;\n\tposition: absolute;\n\ttop: 50%;\n\tleft: 50%;\n\t-webkit-transform: translate(-50%, -50%);\n\t-ms-transform: translate(-50%, -50%);\n\t-o-transform: translate(-50%, -50%);\n\ttransform: translate(-50%, -50%);\n\tcolor: #fff;\n\ttext-align: center;\n}\n```\n\n> ### 8. Flexbox\n> CSS3çš„æ–°å±æ€§ä¹Ÿå«å¼¹æ€§ç›’å­, å®ƒä¸ä»…å¯ä»¥è§£å†³å±…ä¸­çš„é—®é¢˜è¿˜å¯ä»¥åˆ†æ æˆ–è€…å…¶ä»–çš„ä¸€äº›å¸ƒå±€é—®é¢˜. è¿™é‡Œä¸å¤šè§£é‡Š, ä¸‹æ¬¡åšä¸€ä¸ªè¯¦ç»†çš„è¯´æ˜.\n```html\n<div class=\"wrapper-flex\">\n\t<div class=\"flex-center\">\n\t\tå¼¹æ€§ç›’å­å±…ä¸­\n\t</div>\n</div>\n```\n\n```css\n.wrapper-flex{\n\tmargin-top: 500px;\n\twidth: 200px;\n\theight: 200px;\n\tborder: thin solid black;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n}\n.flex-center{\n\tbackground: grey;\n\tcolor: #fff;\n\ttext-align: center;\n}\n```\n\n[é¢„è§ˆåœ°å€](https://caraws.github.io/Review-JavaScript/CSS/vertical-horizontal-center)\n\nCreated on 2017-10-11 by Cara\n","source":"_posts/CSS-å‚ç›´æ°´å¹³å±…ä¸­å¤§æ•´åˆ.md","raw":"---\ntitle: CSS  å‚ç›´æ°´å¹³å±…ä¸­å¤§æ•´åˆ\ndate: 2017-10-14 20:31:30\ntags: CSS\ncategories:\n- å¤ä¹ \n---\n\nåœ¨å¹³æ—¶çš„å¸ƒå±€ä¸­å¸¸å¸¸ä¼šç”¨åˆ°çš„å‚ç›´æ°´å¹³å±…ä¸­. ä¸‹é¢å°±æ¥æ€»ç»“å‡ ç§å‚ç›´\næ°´å¹³å±…ä¸­çš„æ–¹æ³•.\n\n> ### 1. ç»å¯¹å®šä½æ°´å¹³å‚ç›´å±…ä¸­\n> ç»™å…ƒç´ è®¾ç½®ç»å¯¹å®šä½, å…¶çˆ¶çº§å…ƒç´ ä¸º`body`æˆ–è€…æŒ‡å®šçš„ç›¸å¯¹å®šä½å…ƒç´ . \n> å®ƒçš„ç¼ºç‚¹æ˜¯å¿…é¡»è®¾ç½®å®½åº¦å€¼æˆ–è€…é«˜åº¦å€¼; ä¼˜ç‚¹æ˜¯å…¼å®¹æ€§æŒºå¥½, ä»£ç ä¹Ÿä¸\n> å¤š, ä¸è¿‡å¬è¯´åœ¨ windows phone ä¸Šä¸èµ·ä½œç”¨.\n\n```html\n<div class='wrapper'>\n\t<div class='absolute-center'>æˆ‘æ˜¯ç»å¯¹å®šä½<div>\n</div>\n```\n\n```css\n.wrapper{\n\twidth: 100%;\n\theight: 200px;\n\tposition: relative;\n\tborder: thin solid black;\n}\n.absolute-center{\n\tposition: absolute;\n\ttop: 0;\n\tright: 0;\n\tbottom: 0;\n\tleft: 0;\n\tmargin: auto;\n\tbackground: deepskyblue;\n\theight: 100px;\n\tline-height: 100px;\n\ttext-align: center;\n\tcolor: #fff;\n}\n```\n\n> ä¹‹å‰ä¸€ç›´ä¸æ‡‚ç»å¯¹å®šä½çš„å·¥ä½œæœºåˆ¶åˆ°åº•æ˜¯æ€æ ·, ä¸‹é¢æ˜¯æŸ¥èµ„æ–™çœ‹åˆ°çš„:\n\n1. åœ¨æ™®é€šæ–‡æ¡£æµä¸­`margin: auto`ç›¸å½“äº`margin-top: 0; margin-bottom: 0;`;\n2. `position: absolute`ä¼šè„±ç¦»æ–‡æ¡£æµ, è„±ç¦»çš„éƒ¨åˆ†å°†ä¸ä¼šå½±å“æ–‡æ¡£æµä¸­çš„å†…å®¹.\n3. ç»™å—åŒºåŸŸå†…è®¾ç½®`top: 0; right: 0;bottom: 0;left: 0`, æµè§ˆå™¨å°†é‡æ–°åˆ†é…ä¸€ä¸ªè¾¹ç•Œæ¡†,  è¿™ä¸ªæ—¶å€™çš„å—åŒºåŸŸä¼šå æ»¡çˆ¶çº§æ‰€æœ‰å¯ç”¨ç©ºé—´.\n4. ä¸ºè¿™ä¸ªå—åŒºåŸŸè®¾ç½®å®½åº¦æˆ–é«˜åº¦å°±å¯ä»¥é˜²æ­¢è¯¥å…ƒç´ å æ»¡æ•´ä¸ªçˆ¶çº§å…ƒç´ , ä¿ƒä½¿æµè§ˆå™¨æ ¹æ®æ–°çš„è¾¹ç•Œå€¼é‡æ–°è®¡ç®—`margin: auto`.\n5. ç”±äºå†…å®¹å—è¢«ç»å¯¹å®šä½, è„±ç¦»äº†æ­£å¸¸çš„å†…å®¹æµ, æµè§ˆå™¨ä¼šç»™`margin-top,margin-bottom`ç›¸åŒçš„å€¼, ä½¿å…ƒç´ å—åœ¨å…ˆå‰å®šä¹‰çš„è¾¹ç•Œå†…å±…ä¸­.\n\n> ### 2.  å¯è§†åŒºåŸŸå†…æ°´å¹³å‚ç›´å±…ä¸­\n> æŠŠä¸Šé¢ä¾‹å­æ”¹ä¸º`position: fixed; z-index: 999`, è®¾ç½®ä¸€ä¸ªè¾ƒå¤§å€¼çš„`z-index`; å¦‚æœä¸ç»™è¿™ä¸ªå—çº§å…ƒç´ è®¾ç½®å®½é«˜åˆ™ä¼šå æ»¡æ•´ä¸ªå±å¹•.\n\n```html\n<div class=\"fixed-center\">å›ºå®šå®šä½æ°´å¹³å‚ç›´å±…ä¸­</div>\n```\n\n```css\n.fixed-center{\n\twidth: 200px;\n\theight: 200px;\n\tposition: fixed;;\n\tz-index: 999;\n\tbackground: rgba(0, 0, 0, .3);\n\ttop: 0; \n\tleft: 0;\n\tbottom: 0; \n\tright: 0; \n\tmargin: auto;\n\tline-height: 200px;\n\tcolor: #fff;\n\ttext-align: center;\n}\n```\n\n> ### 3. è¾¹æ å‚ç›´å±…ä¸­\n> æœ‰æ—¶éœ€è¦å°†ä¸€ä¸ªå†…å®¹å—å›ºå®šåœ¨å±å¹•çš„å·¦ä¾§æˆ–è€…å³ä¾§, å¯ä»¥å‘å†…å®¹å¿«åŠ å…¥åƒè¿™æ ·çš„ CSS ä»£ç `top: 20px; bottom: auto;`; ç”±äºå·²ç»å£°æ˜äº†`margin: auto`, å†…å®¹å—å°†ä¼šå‚ç›´å±…ä¸­åœ¨ä½ å®šä¹‰çš„`top`/ `right`/ `bottom`/ `left`è¾¹ç•Œå€¼å†…. å¯ä»¥ç”¨`left: 0; right: auto`å°†å†…å®¹å¿«å›ºå®šåœ¨å·¦ä¾§; `right: 0; left: auto;`å°†å†…å®¹å›ºå®šåœ¨å³ä¾§.\n\n```html\n<div class=\"absolute-left\">\n\tç»å¯¹å®šä½åœ¨å·¦ä¾§\n</div>\n<div class=\"absolute-right\">\n\tç»å¯¹å®šä½åœ¨å³ä¾§\n</div>\n```\n\n```css\n.absolute-left {\n\tposition: absolute;\n\tleft: 20px;\n\tright: auto;\n\tmargin: auto;\n\twidth: 150px;\n\theight: 80px;\n\tbackground: red;\n\tcolor: #fff;\n\ttext-align: center;\n\tline-height: 80px;\n}\n.absolute-right {\n\tposition: absolute;\n\tleft: auto;\n\tright: 20px;\n\tmargin: auto;\n\twidth: 150px;\n\theight: 80px;\n\tbackground: green;\n\tcolor: #fff;\n\ttext-align: center;\n\tline-height: 80px;\n}\n```\n\n> ### 4. è‡ªé€‚åº”ç»å¯¹å®šä½å±…ä¸­\n> è‡ªé€‚åº”ç»å¯¹å±…ä¸­çš„ä¼˜åŠ¿å°±æ˜¯å¯¹ç™¾åˆ†æ¯”çš„å®½é«˜å®Œç¾æ”¯æŒ, ç”šè‡³æ˜¯`max-width/ min-width`æˆ–è€…æ˜¯`max-height/ max-width`, å³ä½¿åŠ ä¸Š`padding`ä¹Ÿä¸ä¼šå½±å“ç»å¯¹å±…ä¸­çš„å®ç°.\n\n```html\n<div class=\"wrapper-responsive\">\n\t<div class=\"absolute-responsive\">\n\t\tè‡ªé€‚åº”ç»å¯¹å®šä½å±…ä¸­\n\t</div>\n</div>\n```\n\n```css\n.wrapper-responsive{\n\tposition: relative;\n\ttop: 300px;\n\twidth: 200px;\n\theight: 200px;\n\tborder: thin solid black;\n}\n.absolute-responsive{\n\tposition: absolute;\n\ttop: 0;\n\tright: 0;\n\tbottom: 0;\n\tleft: 0;\n\tmargin: auto;\n\twidth: 60%;\n\theight: 60%;\n\tmin-width: 50px;\n\tmax-width: 150px;\n\tpadding: 10px;\n\ttext-align: center;\n\tcolor: #fff;\n\tbackground: skyblue;\n}\n```\n\n> ### 5. å†…å®¹æº¢å‡º\n> æœ‰æ—¶å†…å®¹å—çš„å†…å®¹è¿‡å¤šå¯¼è‡´é«˜åº¦å¤§äºçˆ¶çº§å…ƒç´ , å†…å®¹å°±ä¼šæ˜¾ç¤ºåˆ°å—å’Œå®¹å™¨çš„å¤–é¢, è¿™ç§æ—¶å€™åŠ ä¸ªç»™å†…å®¹å—`overflow: auto`å³å¯, å¦‚æœå†…å®¹å—æ²¡æœ‰`padding`çš„è¯åŠ ä¸ª`max-height: 100%`ä¹Ÿè¡Œ.\n\n> ### 6. å¯å˜é«˜åº¦\n> è®¾ç½®`display: table`, å†…å®¹å—ä¼šå‚ç›´å±…ä¸Šä¸è¿‡æ°´å¹³è¿˜æ˜¯å±…ä¸­. ä½†æ˜¯è¿™ä¸ªåœ¨ä¸€äº›æµè§ˆå™¨ä¸Šæœ‰é—®é¢˜( å¦‚: IE/ FF); `display: table-cell`é…åˆ`vertical-align: middle;`ä¹Ÿå¯å®ç°å‚ç›´æ°´å¹³å±…ä¸­.\n\n```html\n<div class=\"wrapper-table\">\n\t<div class=\"table-center\">\n\t\ttable æ°´å¹³å±…ä¸­\n\t\tå†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…\n\t</div>\n</div>\n\t\n<div class=\"wrapper-table-cell\">\n\t<div class=\"table-center-cell\">\n\t\ttable-cell å±…ä¸­\n\t\tå†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…\n\t</div>\n</div>\n```\n\n```css\n/* tabel å±…ä¸­ */\n.wrapper-table{\n\tmargin-top: 600px;\n\tdisplay: table;\n\theight: auto;\n\twidth: 200px;\n\theight: 200px;\n\tborder: thin solid black;\n}\n.table-center{\n\twidth: 80px;\n\tbackground: orange;\n\tcolor: #fff;\n}\n\n/* tabel-cell å±…ä¸­ */\n.wrapper-table-cell{\n\tmargin-top: 600px;\n\tdisplay: table-cell;\n\theight: auto;\n\twidth: 200px;\n\theight: 200px;\n\tborder: thin solid black;\n\tvertical-align: middle;\n}\n.table-center-cell{\n\twidth: 100px;\n\tbackground: #FFD34E;\n\tcolor: #fff;\n}\n```\n\n> ### 6. è´Ÿå¤–è¾¹è·\n> è¿™ä¸ªæ–¹æ³•åº”è¯¥æ˜¯å¾ˆå¸¸ç”¨çš„æ–¹æ³•äº†, å·²çŸ¥å…ƒç´ çš„å®½é«˜: å¤–è¾¹è·`margin`çš„å€¼å–è´Ÿæ•°(æ²¡æœ‰`box-sizing: border-box`çš„æƒ…å†µä¸‹, åŒ…æ‹¬`padding`), å¤§å°ä¸º `width/ height`çš„ä¸€åŠ, å†åŠ ä¸Š`top: 50%; left: 50%`, è¿™ä¸ªä¸èƒ½è‡ªé€‚åº”å“¦.\n```html\n<div class=\"wrapper-margin\">\n\t<div class=\"margin-center\">\n\t\tmargin å±…ä¸­\n\t</div>\n</div>\n```\n\n```css\n.wrapper-margin{\n  position: relative;\n\ttop: 100px;\n\tborder: thin solid black;\n\twidth: 200px;\n\theight: 200px;\n}\n.margin-center{\n\twidth: 100px;\n\theight: 100px;\n\tbackground: #105B63;\n\tposition: absolute;\n\ttop: 50%;\n\tleft: 50%;\n\tmargin: -50px auto auto -50px;\n\tcolor: #fff;\n\ttext-align: center;\n\tline-height: 100px;\n}\n```\n\n> ### 7. å˜å½¢\n> è¿™å¯ä»¥è¯´æ˜¯æœ€ç®€å•çš„æ–¹æ³•äº†, ä¸ä»…å¯ä»¥å®ç°ç»å¯¹å±…ä¸­çš„æƒ³è¿‡è¿˜å¯ä»¥å®ç°å¯å˜å®½é«˜åº¦. å†…å®¹å—å®šä¹‰`transform: translate(-50%, -50%)`å¸¦ä¸Šæµè§ˆå™¨å‰ç¼€, å†åŠ ä¸Š`top: 50%; left: 50%`å³å¯.\n\n```html\n<div class=\"wrapper-transform\">\n\t<div class=\"transform-center\">\n\t\ttransform å±…ä¸­\n\t</div>\n</div>\n```\n\n```css\n.wrapper-transform{\n\tposition: relative;\n\ttop: 200px;\n\tborder: thin solid black;\n\twidth: 200px;\n\theight: 200px;\n}\n.transform-center{\n\twidth: 100px;\n\theight: 100px;\n\tbackground: #BD4932;\n\tposition: absolute;\n\ttop: 50%;\n\tleft: 50%;\n\t-webkit-transform: translate(-50%, -50%);\n\t-ms-transform: translate(-50%, -50%);\n\t-o-transform: translate(-50%, -50%);\n\ttransform: translate(-50%, -50%);\n\tcolor: #fff;\n\ttext-align: center;\n}\n```\n\n> ### 8. Flexbox\n> CSS3çš„æ–°å±æ€§ä¹Ÿå«å¼¹æ€§ç›’å­, å®ƒä¸ä»…å¯ä»¥è§£å†³å±…ä¸­çš„é—®é¢˜è¿˜å¯ä»¥åˆ†æ æˆ–è€…å…¶ä»–çš„ä¸€äº›å¸ƒå±€é—®é¢˜. è¿™é‡Œä¸å¤šè§£é‡Š, ä¸‹æ¬¡åšä¸€ä¸ªè¯¦ç»†çš„è¯´æ˜.\n```html\n<div class=\"wrapper-flex\">\n\t<div class=\"flex-center\">\n\t\tå¼¹æ€§ç›’å­å±…ä¸­\n\t</div>\n</div>\n```\n\n```css\n.wrapper-flex{\n\tmargin-top: 500px;\n\twidth: 200px;\n\theight: 200px;\n\tborder: thin solid black;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n}\n.flex-center{\n\tbackground: grey;\n\tcolor: #fff;\n\ttext-align: center;\n}\n```\n\n[é¢„è§ˆåœ°å€](https://caraws.github.io/Review-JavaScript/CSS/vertical-horizontal-center)\n\nCreated on 2017-10-11 by Cara\n","slug":"CSS-å‚ç›´æ°´å¹³å±…ä¸­å¤§æ•´åˆ","published":1,"updated":"2018-05-05T09:23:03.653Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjgurols60005klu0q22caaj0","content":"<p>åœ¨å¹³æ—¶çš„å¸ƒå±€ä¸­å¸¸å¸¸ä¼šç”¨åˆ°çš„å‚ç›´æ°´å¹³å±…ä¸­. ä¸‹é¢å°±æ¥æ€»ç»“å‡ ç§å‚ç›´<br>æ°´å¹³å±…ä¸­çš„æ–¹æ³•.</p>\n<blockquote>\n<h3 id=\"1-ç»å¯¹å®šä½æ°´å¹³å‚ç›´å±…ä¸­\"><a href=\"#1-ç»å¯¹å®šä½æ°´å¹³å‚ç›´å±…ä¸­\" class=\"headerlink\" title=\"1. ç»å¯¹å®šä½æ°´å¹³å‚ç›´å±…ä¸­\"></a>1. ç»å¯¹å®šä½æ°´å¹³å‚ç›´å±…ä¸­</h3><p>ç»™å…ƒç´ è®¾ç½®ç»å¯¹å®šä½, å…¶çˆ¶çº§å…ƒç´ ä¸º<code>body</code>æˆ–è€…æŒ‡å®šçš„ç›¸å¯¹å®šä½å…ƒç´ .<br>å®ƒçš„ç¼ºç‚¹æ˜¯å¿…é¡»è®¾ç½®å®½åº¦å€¼æˆ–è€…é«˜åº¦å€¼; ä¼˜ç‚¹æ˜¯å…¼å®¹æ€§æŒºå¥½, ä»£ç ä¹Ÿä¸<br>å¤š, ä¸è¿‡å¬è¯´åœ¨ windows phone ä¸Šä¸èµ·ä½œç”¨.</p>\n</blockquote>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">'wrapper'</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">'absolute-center'</span>&gt;</span>æˆ‘æ˜¯ç»å¯¹å®šä½<span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.wrapper</span>&#123;</span><br><span class=\"line\">\t<span class=\"attribute\">width</span>: <span class=\"number\">100%</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">height</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">position</span>: relative;</span><br><span class=\"line\">\t<span class=\"attribute\">border</span>: thin solid black;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.absolute-center</span>&#123;</span><br><span class=\"line\">\t<span class=\"attribute\">position</span>: absolute;</span><br><span class=\"line\">\t<span class=\"attribute\">top</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">right</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">bottom</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">left</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">margin</span>: auto;</span><br><span class=\"line\">\t<span class=\"attribute\">background</span>: deepskyblue;</span><br><span class=\"line\">\t<span class=\"attribute\">height</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">line-height</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">text-align</span>: center;</span><br><span class=\"line\">\t<span class=\"attribute\">color</span>: <span class=\"number\">#fff</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>ä¹‹å‰ä¸€ç›´ä¸æ‡‚ç»å¯¹å®šä½çš„å·¥ä½œæœºåˆ¶åˆ°åº•æ˜¯æ€æ ·, ä¸‹é¢æ˜¯æŸ¥èµ„æ–™çœ‹åˆ°çš„:</p>\n</blockquote>\n<ol>\n<li>åœ¨æ™®é€šæ–‡æ¡£æµä¸­<code>margin: auto</code>ç›¸å½“äº<code>margin-top: 0; margin-bottom: 0;</code>;</li>\n<li><code>position: absolute</code>ä¼šè„±ç¦»æ–‡æ¡£æµ, è„±ç¦»çš„éƒ¨åˆ†å°†ä¸ä¼šå½±å“æ–‡æ¡£æµä¸­çš„å†…å®¹.</li>\n<li>ç»™å—åŒºåŸŸå†…è®¾ç½®<code>top: 0; right: 0;bottom: 0;left: 0</code>, æµè§ˆå™¨å°†é‡æ–°åˆ†é…ä¸€ä¸ªè¾¹ç•Œæ¡†,  è¿™ä¸ªæ—¶å€™çš„å—åŒºåŸŸä¼šå æ»¡çˆ¶çº§æ‰€æœ‰å¯ç”¨ç©ºé—´.</li>\n<li>ä¸ºè¿™ä¸ªå—åŒºåŸŸè®¾ç½®å®½åº¦æˆ–é«˜åº¦å°±å¯ä»¥é˜²æ­¢è¯¥å…ƒç´ å æ»¡æ•´ä¸ªçˆ¶çº§å…ƒç´ , ä¿ƒä½¿æµè§ˆå™¨æ ¹æ®æ–°çš„è¾¹ç•Œå€¼é‡æ–°è®¡ç®—<code>margin: auto</code>.</li>\n<li>ç”±äºå†…å®¹å—è¢«ç»å¯¹å®šä½, è„±ç¦»äº†æ­£å¸¸çš„å†…å®¹æµ, æµè§ˆå™¨ä¼šç»™<code>margin-top,margin-bottom</code>ç›¸åŒçš„å€¼, ä½¿å…ƒç´ å—åœ¨å…ˆå‰å®šä¹‰çš„è¾¹ç•Œå†…å±…ä¸­.</li>\n</ol>\n<blockquote>\n<h3 id=\"2-å¯è§†åŒºåŸŸå†…æ°´å¹³å‚ç›´å±…ä¸­\"><a href=\"#2-å¯è§†åŒºåŸŸå†…æ°´å¹³å‚ç›´å±…ä¸­\" class=\"headerlink\" title=\"2.  å¯è§†åŒºåŸŸå†…æ°´å¹³å‚ç›´å±…ä¸­\"></a>2.  å¯è§†åŒºåŸŸå†…æ°´å¹³å‚ç›´å±…ä¸­</h3><p>æŠŠä¸Šé¢ä¾‹å­æ”¹ä¸º<code>position: fixed; z-index: 999</code>, è®¾ç½®ä¸€ä¸ªè¾ƒå¤§å€¼çš„<code>z-index</code>; å¦‚æœä¸ç»™è¿™ä¸ªå—çº§å…ƒç´ è®¾ç½®å®½é«˜åˆ™ä¼šå æ»¡æ•´ä¸ªå±å¹•.</p>\n</blockquote>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"fixed-center\"</span>&gt;</span>å›ºå®šå®šä½æ°´å¹³å‚ç›´å±…ä¸­<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.fixed-center</span>&#123;</span><br><span class=\"line\">\t<span class=\"attribute\">width</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">height</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">\tposition: fixed;;</span><br><span class=\"line\">\t<span class=\"selector-tag\">z-index</span>: 999;</span><br><span class=\"line\">\t<span class=\"selector-tag\">background</span>: <span class=\"selector-tag\">rgba</span>(0, 0, 0, <span class=\"selector-class\">.3</span>);</span><br><span class=\"line\">\t<span class=\"selector-tag\">top</span>: 0; </span><br><span class=\"line\">\t<span class=\"selector-tag\">left</span>: 0;</span><br><span class=\"line\">\t<span class=\"selector-tag\">bottom</span>: 0; </span><br><span class=\"line\">\t<span class=\"selector-tag\">right</span>: 0; </span><br><span class=\"line\">\t<span class=\"selector-tag\">margin</span>: <span class=\"selector-tag\">auto</span>;</span><br><span class=\"line\">\t<span class=\"selector-tag\">line-height</span>: 200<span class=\"selector-tag\">px</span>;</span><br><span class=\"line\">\t<span class=\"selector-tag\">color</span>: <span class=\"selector-id\">#fff</span>;</span><br><span class=\"line\">\t<span class=\"selector-tag\">text-align</span>: <span class=\"selector-tag\">center</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<h3 id=\"3-è¾¹æ å‚ç›´å±…ä¸­\"><a href=\"#3-è¾¹æ å‚ç›´å±…ä¸­\" class=\"headerlink\" title=\"3. è¾¹æ å‚ç›´å±…ä¸­\"></a>3. è¾¹æ å‚ç›´å±…ä¸­</h3><p>æœ‰æ—¶éœ€è¦å°†ä¸€ä¸ªå†…å®¹å—å›ºå®šåœ¨å±å¹•çš„å·¦ä¾§æˆ–è€…å³ä¾§, å¯ä»¥å‘å†…å®¹å¿«åŠ å…¥åƒè¿™æ ·çš„ CSS ä»£ç <code>top: 20px; bottom: auto;</code>; ç”±äºå·²ç»å£°æ˜äº†<code>margin: auto</code>, å†…å®¹å—å°†ä¼šå‚ç›´å±…ä¸­åœ¨ä½ å®šä¹‰çš„<code>top</code>/ <code>right</code>/ <code>bottom</code>/ <code>left</code>è¾¹ç•Œå€¼å†…. å¯ä»¥ç”¨<code>left: 0; right: auto</code>å°†å†…å®¹å¿«å›ºå®šåœ¨å·¦ä¾§; <code>right: 0; left: auto;</code>å°†å†…å®¹å›ºå®šåœ¨å³ä¾§.</p>\n</blockquote>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"absolute-left\"</span>&gt;</span></span><br><span class=\"line\">\tç»å¯¹å®šä½åœ¨å·¦ä¾§</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"absolute-right\"</span>&gt;</span></span><br><span class=\"line\">\tç»å¯¹å®šä½åœ¨å³ä¾§</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.absolute-left</span> &#123;</span><br><span class=\"line\">\t<span class=\"attribute\">position</span>: absolute;</span><br><span class=\"line\">\t<span class=\"attribute\">left</span>: <span class=\"number\">20px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">right</span>: auto;</span><br><span class=\"line\">\t<span class=\"attribute\">margin</span>: auto;</span><br><span class=\"line\">\t<span class=\"attribute\">width</span>: <span class=\"number\">150px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">height</span>: <span class=\"number\">80px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">background</span>: red;</span><br><span class=\"line\">\t<span class=\"attribute\">color</span>: <span class=\"number\">#fff</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">text-align</span>: center;</span><br><span class=\"line\">\t<span class=\"attribute\">line-height</span>: <span class=\"number\">80px</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.absolute-right</span> &#123;</span><br><span class=\"line\">\t<span class=\"attribute\">position</span>: absolute;</span><br><span class=\"line\">\t<span class=\"attribute\">left</span>: auto;</span><br><span class=\"line\">\t<span class=\"attribute\">right</span>: <span class=\"number\">20px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">margin</span>: auto;</span><br><span class=\"line\">\t<span class=\"attribute\">width</span>: <span class=\"number\">150px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">height</span>: <span class=\"number\">80px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">background</span>: green;</span><br><span class=\"line\">\t<span class=\"attribute\">color</span>: <span class=\"number\">#fff</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">text-align</span>: center;</span><br><span class=\"line\">\t<span class=\"attribute\">line-height</span>: <span class=\"number\">80px</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<h3 id=\"4-è‡ªé€‚åº”ç»å¯¹å®šä½å±…ä¸­\"><a href=\"#4-è‡ªé€‚åº”ç»å¯¹å®šä½å±…ä¸­\" class=\"headerlink\" title=\"4. è‡ªé€‚åº”ç»å¯¹å®šä½å±…ä¸­\"></a>4. è‡ªé€‚åº”ç»å¯¹å®šä½å±…ä¸­</h3><p>è‡ªé€‚åº”ç»å¯¹å±…ä¸­çš„ä¼˜åŠ¿å°±æ˜¯å¯¹ç™¾åˆ†æ¯”çš„å®½é«˜å®Œç¾æ”¯æŒ, ç”šè‡³æ˜¯<code>max-width/ min-width</code>æˆ–è€…æ˜¯<code>max-height/ max-width</code>, å³ä½¿åŠ ä¸Š<code>padding</code>ä¹Ÿä¸ä¼šå½±å“ç»å¯¹å±…ä¸­çš„å®ç°.</p>\n</blockquote>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"wrapper-responsive\"</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"absolute-responsive\"</span>&gt;</span></span><br><span class=\"line\">\t\tè‡ªé€‚åº”ç»å¯¹å®šä½å±…ä¸­</span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.wrapper-responsive</span>&#123;</span><br><span class=\"line\">\t<span class=\"attribute\">position</span>: relative;</span><br><span class=\"line\">\t<span class=\"attribute\">top</span>: <span class=\"number\">300px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">width</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">height</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">border</span>: thin solid black;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.absolute-responsive</span>&#123;</span><br><span class=\"line\">\t<span class=\"attribute\">position</span>: absolute;</span><br><span class=\"line\">\t<span class=\"attribute\">top</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">right</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">bottom</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">left</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">margin</span>: auto;</span><br><span class=\"line\">\t<span class=\"attribute\">width</span>: <span class=\"number\">60%</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">height</span>: <span class=\"number\">60%</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">min-width</span>: <span class=\"number\">50px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">max-width</span>: <span class=\"number\">150px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">padding</span>: <span class=\"number\">10px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">text-align</span>: center;</span><br><span class=\"line\">\t<span class=\"attribute\">color</span>: <span class=\"number\">#fff</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">background</span>: skyblue;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<h3 id=\"5-å†…å®¹æº¢å‡º\"><a href=\"#5-å†…å®¹æº¢å‡º\" class=\"headerlink\" title=\"5. å†…å®¹æº¢å‡º\"></a>5. å†…å®¹æº¢å‡º</h3><p>æœ‰æ—¶å†…å®¹å—çš„å†…å®¹è¿‡å¤šå¯¼è‡´é«˜åº¦å¤§äºçˆ¶çº§å…ƒç´ , å†…å®¹å°±ä¼šæ˜¾ç¤ºåˆ°å—å’Œå®¹å™¨çš„å¤–é¢, è¿™ç§æ—¶å€™åŠ ä¸ªç»™å†…å®¹å—<code>overflow: auto</code>å³å¯, å¦‚æœå†…å®¹å—æ²¡æœ‰<code>padding</code>çš„è¯åŠ ä¸ª<code>max-height: 100%</code>ä¹Ÿè¡Œ.</p>\n</blockquote>\n<blockquote>\n<h3 id=\"6-å¯å˜é«˜åº¦\"><a href=\"#6-å¯å˜é«˜åº¦\" class=\"headerlink\" title=\"6. å¯å˜é«˜åº¦\"></a>6. å¯å˜é«˜åº¦</h3><p>è®¾ç½®<code>display: table</code>, å†…å®¹å—ä¼šå‚ç›´å±…ä¸Šä¸è¿‡æ°´å¹³è¿˜æ˜¯å±…ä¸­. ä½†æ˜¯è¿™ä¸ªåœ¨ä¸€äº›æµè§ˆå™¨ä¸Šæœ‰é—®é¢˜( å¦‚: IE/ FF); <code>display: table-cell</code>é…åˆ<code>vertical-align: middle;</code>ä¹Ÿå¯å®ç°å‚ç›´æ°´å¹³å±…ä¸­.</p>\n</blockquote>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"wrapper-table\"</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"table-center\"</span>&gt;</span></span><br><span class=\"line\">\t\ttable æ°´å¹³å±…ä¸­</span><br><span class=\"line\">\t\tå†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…</span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">\t</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"wrapper-table-cell\"</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"table-center-cell\"</span>&gt;</span></span><br><span class=\"line\">\t\ttable-cell å±…ä¸­</span><br><span class=\"line\">\t\tå†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…</span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/* tabel å±…ä¸­ */</span></span><br><span class=\"line\"><span class=\"selector-class\">.wrapper-table</span>&#123;</span><br><span class=\"line\">\t<span class=\"attribute\">margin-top</span>: <span class=\"number\">600px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">display</span>: table;</span><br><span class=\"line\">\t<span class=\"attribute\">height</span>: auto;</span><br><span class=\"line\">\t<span class=\"attribute\">width</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">height</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">border</span>: thin solid black;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.table-center</span>&#123;</span><br><span class=\"line\">\t<span class=\"attribute\">width</span>: <span class=\"number\">80px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">background</span>: orange;</span><br><span class=\"line\">\t<span class=\"attribute\">color</span>: <span class=\"number\">#fff</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* tabel-cell å±…ä¸­ */</span></span><br><span class=\"line\"><span class=\"selector-class\">.wrapper-table-cell</span>&#123;</span><br><span class=\"line\">\t<span class=\"attribute\">margin-top</span>: <span class=\"number\">600px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">display</span>: table-cell;</span><br><span class=\"line\">\t<span class=\"attribute\">height</span>: auto;</span><br><span class=\"line\">\t<span class=\"attribute\">width</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">height</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">border</span>: thin solid black;</span><br><span class=\"line\">\t<span class=\"attribute\">vertical-align</span>: middle;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.table-center-cell</span>&#123;</span><br><span class=\"line\">\t<span class=\"attribute\">width</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">background</span>: <span class=\"number\">#FFD34E</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">color</span>: <span class=\"number\">#fff</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<h3 id=\"6-è´Ÿå¤–è¾¹è·\"><a href=\"#6-è´Ÿå¤–è¾¹è·\" class=\"headerlink\" title=\"6. è´Ÿå¤–è¾¹è·\"></a>6. è´Ÿå¤–è¾¹è·</h3><p>è¿™ä¸ªæ–¹æ³•åº”è¯¥æ˜¯å¾ˆå¸¸ç”¨çš„æ–¹æ³•äº†, å·²çŸ¥å…ƒç´ çš„å®½é«˜: å¤–è¾¹è·<code>margin</code>çš„å€¼å–è´Ÿæ•°(æ²¡æœ‰<code>box-sizing: border-box</code>çš„æƒ…å†µä¸‹, åŒ…æ‹¬<code>padding</code>), å¤§å°ä¸º <code>width/ height</code>çš„ä¸€åŠ, å†åŠ ä¸Š<code>top: 50%; left: 50%</code>, è¿™ä¸ªä¸èƒ½è‡ªé€‚åº”å“¦.<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"wrapper-margin\"</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"margin-center\"</span>&gt;</span></span><br><span class=\"line\">\t\tmargin å±…ä¸­</span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p>\n</blockquote>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.wrapper-margin</span>&#123;</span><br><span class=\"line\">  <span class=\"attribute\">position</span>: relative;</span><br><span class=\"line\">\t<span class=\"attribute\">top</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">border</span>: thin solid black;</span><br><span class=\"line\">\t<span class=\"attribute\">width</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">height</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.margin-center</span>&#123;</span><br><span class=\"line\">\t<span class=\"attribute\">width</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">height</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">background</span>: <span class=\"number\">#105B63</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">position</span>: absolute;</span><br><span class=\"line\">\t<span class=\"attribute\">top</span>: <span class=\"number\">50%</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">left</span>: <span class=\"number\">50%</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">margin</span>: -<span class=\"number\">50px</span> auto auto -<span class=\"number\">50px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">color</span>: <span class=\"number\">#fff</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">text-align</span>: center;</span><br><span class=\"line\">\t<span class=\"attribute\">line-height</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<h3 id=\"7-å˜å½¢\"><a href=\"#7-å˜å½¢\" class=\"headerlink\" title=\"7. å˜å½¢\"></a>7. å˜å½¢</h3><p>è¿™å¯ä»¥è¯´æ˜¯æœ€ç®€å•çš„æ–¹æ³•äº†, ä¸ä»…å¯ä»¥å®ç°ç»å¯¹å±…ä¸­çš„æƒ³è¿‡è¿˜å¯ä»¥å®ç°å¯å˜å®½é«˜åº¦. å†…å®¹å—å®šä¹‰<code>transform: translate(-50%, -50%)</code>å¸¦ä¸Šæµè§ˆå™¨å‰ç¼€, å†åŠ ä¸Š<code>top: 50%; left: 50%</code>å³å¯.</p>\n</blockquote>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"wrapper-transform\"</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"transform-center\"</span>&gt;</span></span><br><span class=\"line\">\t\ttransform å±…ä¸­</span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.wrapper-transform</span>&#123;</span><br><span class=\"line\">\t<span class=\"attribute\">position</span>: relative;</span><br><span class=\"line\">\t<span class=\"attribute\">top</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">border</span>: thin solid black;</span><br><span class=\"line\">\t<span class=\"attribute\">width</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">height</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.transform-center</span>&#123;</span><br><span class=\"line\">\t<span class=\"attribute\">width</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">height</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">background</span>: <span class=\"number\">#BD4932</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">position</span>: absolute;</span><br><span class=\"line\">\t<span class=\"attribute\">top</span>: <span class=\"number\">50%</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">left</span>: <span class=\"number\">50%</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">-webkit-transform</span>: <span class=\"built_in\">translate</span>(-50%, -50%);</span><br><span class=\"line\">\t<span class=\"attribute\">-ms-transform</span>: <span class=\"built_in\">translate</span>(-50%, -50%);</span><br><span class=\"line\">\t<span class=\"attribute\">-o-transform</span>: <span class=\"built_in\">translate</span>(-50%, -50%);</span><br><span class=\"line\">\t<span class=\"attribute\">transform</span>: <span class=\"built_in\">translate</span>(-50%, -50%);</span><br><span class=\"line\">\t<span class=\"attribute\">color</span>: <span class=\"number\">#fff</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">text-align</span>: center;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<h3 id=\"8-Flexbox\"><a href=\"#8-Flexbox\" class=\"headerlink\" title=\"8. Flexbox\"></a>8. Flexbox</h3><p>CSS3çš„æ–°å±æ€§ä¹Ÿå«å¼¹æ€§ç›’å­, å®ƒä¸ä»…å¯ä»¥è§£å†³å±…ä¸­çš„é—®é¢˜è¿˜å¯ä»¥åˆ†æ æˆ–è€…å…¶ä»–çš„ä¸€äº›å¸ƒå±€é—®é¢˜. è¿™é‡Œä¸å¤šè§£é‡Š, ä¸‹æ¬¡åšä¸€ä¸ªè¯¦ç»†çš„è¯´æ˜.<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"wrapper-flex\"</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"flex-center\"</span>&gt;</span></span><br><span class=\"line\">\t\tå¼¹æ€§ç›’å­å±…ä¸­</span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p>\n</blockquote>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.wrapper-flex</span>&#123;</span><br><span class=\"line\">\t<span class=\"attribute\">margin-top</span>: <span class=\"number\">500px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">width</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">height</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">border</span>: thin solid black;</span><br><span class=\"line\">\t<span class=\"attribute\">display</span>: flex;</span><br><span class=\"line\">\t<span class=\"attribute\">justify-content</span>: center;</span><br><span class=\"line\">\t<span class=\"attribute\">align-items</span>: center;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.flex-center</span>&#123;</span><br><span class=\"line\">\t<span class=\"attribute\">background</span>: grey;</span><br><span class=\"line\">\t<span class=\"attribute\">color</span>: <span class=\"number\">#fff</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">text-align</span>: center;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><a href=\"https://caraws.github.io/Review-JavaScript/CSS/vertical-horizontal-center\" target=\"_blank\" rel=\"noopener\">é¢„è§ˆåœ°å€</a></p>\n<p>Created on 2017-10-11 by Cara</p>\n","site":{"data":{}},"excerpt":"","more":"<p>åœ¨å¹³æ—¶çš„å¸ƒå±€ä¸­å¸¸å¸¸ä¼šç”¨åˆ°çš„å‚ç›´æ°´å¹³å±…ä¸­. ä¸‹é¢å°±æ¥æ€»ç»“å‡ ç§å‚ç›´<br>æ°´å¹³å±…ä¸­çš„æ–¹æ³•.</p>\n<blockquote>\n<h3 id=\"1-ç»å¯¹å®šä½æ°´å¹³å‚ç›´å±…ä¸­\"><a href=\"#1-ç»å¯¹å®šä½æ°´å¹³å‚ç›´å±…ä¸­\" class=\"headerlink\" title=\"1. ç»å¯¹å®šä½æ°´å¹³å‚ç›´å±…ä¸­\"></a>1. ç»å¯¹å®šä½æ°´å¹³å‚ç›´å±…ä¸­</h3><p>ç»™å…ƒç´ è®¾ç½®ç»å¯¹å®šä½, å…¶çˆ¶çº§å…ƒç´ ä¸º<code>body</code>æˆ–è€…æŒ‡å®šçš„ç›¸å¯¹å®šä½å…ƒç´ .<br>å®ƒçš„ç¼ºç‚¹æ˜¯å¿…é¡»è®¾ç½®å®½åº¦å€¼æˆ–è€…é«˜åº¦å€¼; ä¼˜ç‚¹æ˜¯å…¼å®¹æ€§æŒºå¥½, ä»£ç ä¹Ÿä¸<br>å¤š, ä¸è¿‡å¬è¯´åœ¨ windows phone ä¸Šä¸èµ·ä½œç”¨.</p>\n</blockquote>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">'wrapper'</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">'absolute-center'</span>&gt;</span>æˆ‘æ˜¯ç»å¯¹å®šä½<span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.wrapper</span>&#123;</span><br><span class=\"line\">\t<span class=\"attribute\">width</span>: <span class=\"number\">100%</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">height</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">position</span>: relative;</span><br><span class=\"line\">\t<span class=\"attribute\">border</span>: thin solid black;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.absolute-center</span>&#123;</span><br><span class=\"line\">\t<span class=\"attribute\">position</span>: absolute;</span><br><span class=\"line\">\t<span class=\"attribute\">top</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">right</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">bottom</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">left</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">margin</span>: auto;</span><br><span class=\"line\">\t<span class=\"attribute\">background</span>: deepskyblue;</span><br><span class=\"line\">\t<span class=\"attribute\">height</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">line-height</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">text-align</span>: center;</span><br><span class=\"line\">\t<span class=\"attribute\">color</span>: <span class=\"number\">#fff</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>ä¹‹å‰ä¸€ç›´ä¸æ‡‚ç»å¯¹å®šä½çš„å·¥ä½œæœºåˆ¶åˆ°åº•æ˜¯æ€æ ·, ä¸‹é¢æ˜¯æŸ¥èµ„æ–™çœ‹åˆ°çš„:</p>\n</blockquote>\n<ol>\n<li>åœ¨æ™®é€šæ–‡æ¡£æµä¸­<code>margin: auto</code>ç›¸å½“äº<code>margin-top: 0; margin-bottom: 0;</code>;</li>\n<li><code>position: absolute</code>ä¼šè„±ç¦»æ–‡æ¡£æµ, è„±ç¦»çš„éƒ¨åˆ†å°†ä¸ä¼šå½±å“æ–‡æ¡£æµä¸­çš„å†…å®¹.</li>\n<li>ç»™å—åŒºåŸŸå†…è®¾ç½®<code>top: 0; right: 0;bottom: 0;left: 0</code>, æµè§ˆå™¨å°†é‡æ–°åˆ†é…ä¸€ä¸ªè¾¹ç•Œæ¡†,  è¿™ä¸ªæ—¶å€™çš„å—åŒºåŸŸä¼šå æ»¡çˆ¶çº§æ‰€æœ‰å¯ç”¨ç©ºé—´.</li>\n<li>ä¸ºè¿™ä¸ªå—åŒºåŸŸè®¾ç½®å®½åº¦æˆ–é«˜åº¦å°±å¯ä»¥é˜²æ­¢è¯¥å…ƒç´ å æ»¡æ•´ä¸ªçˆ¶çº§å…ƒç´ , ä¿ƒä½¿æµè§ˆå™¨æ ¹æ®æ–°çš„è¾¹ç•Œå€¼é‡æ–°è®¡ç®—<code>margin: auto</code>.</li>\n<li>ç”±äºå†…å®¹å—è¢«ç»å¯¹å®šä½, è„±ç¦»äº†æ­£å¸¸çš„å†…å®¹æµ, æµè§ˆå™¨ä¼šç»™<code>margin-top,margin-bottom</code>ç›¸åŒçš„å€¼, ä½¿å…ƒç´ å—åœ¨å…ˆå‰å®šä¹‰çš„è¾¹ç•Œå†…å±…ä¸­.</li>\n</ol>\n<blockquote>\n<h3 id=\"2-å¯è§†åŒºåŸŸå†…æ°´å¹³å‚ç›´å±…ä¸­\"><a href=\"#2-å¯è§†åŒºåŸŸå†…æ°´å¹³å‚ç›´å±…ä¸­\" class=\"headerlink\" title=\"2.  å¯è§†åŒºåŸŸå†…æ°´å¹³å‚ç›´å±…ä¸­\"></a>2.  å¯è§†åŒºåŸŸå†…æ°´å¹³å‚ç›´å±…ä¸­</h3><p>æŠŠä¸Šé¢ä¾‹å­æ”¹ä¸º<code>position: fixed; z-index: 999</code>, è®¾ç½®ä¸€ä¸ªè¾ƒå¤§å€¼çš„<code>z-index</code>; å¦‚æœä¸ç»™è¿™ä¸ªå—çº§å…ƒç´ è®¾ç½®å®½é«˜åˆ™ä¼šå æ»¡æ•´ä¸ªå±å¹•.</p>\n</blockquote>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"fixed-center\"</span>&gt;</span>å›ºå®šå®šä½æ°´å¹³å‚ç›´å±…ä¸­<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.fixed-center</span>&#123;</span><br><span class=\"line\">\t<span class=\"attribute\">width</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">height</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">\tposition: fixed;;</span><br><span class=\"line\">\t<span class=\"selector-tag\">z-index</span>: 999;</span><br><span class=\"line\">\t<span class=\"selector-tag\">background</span>: <span class=\"selector-tag\">rgba</span>(0, 0, 0, <span class=\"selector-class\">.3</span>);</span><br><span class=\"line\">\t<span class=\"selector-tag\">top</span>: 0; </span><br><span class=\"line\">\t<span class=\"selector-tag\">left</span>: 0;</span><br><span class=\"line\">\t<span class=\"selector-tag\">bottom</span>: 0; </span><br><span class=\"line\">\t<span class=\"selector-tag\">right</span>: 0; </span><br><span class=\"line\">\t<span class=\"selector-tag\">margin</span>: <span class=\"selector-tag\">auto</span>;</span><br><span class=\"line\">\t<span class=\"selector-tag\">line-height</span>: 200<span class=\"selector-tag\">px</span>;</span><br><span class=\"line\">\t<span class=\"selector-tag\">color</span>: <span class=\"selector-id\">#fff</span>;</span><br><span class=\"line\">\t<span class=\"selector-tag\">text-align</span>: <span class=\"selector-tag\">center</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<h3 id=\"3-è¾¹æ å‚ç›´å±…ä¸­\"><a href=\"#3-è¾¹æ å‚ç›´å±…ä¸­\" class=\"headerlink\" title=\"3. è¾¹æ å‚ç›´å±…ä¸­\"></a>3. è¾¹æ å‚ç›´å±…ä¸­</h3><p>æœ‰æ—¶éœ€è¦å°†ä¸€ä¸ªå†…å®¹å—å›ºå®šåœ¨å±å¹•çš„å·¦ä¾§æˆ–è€…å³ä¾§, å¯ä»¥å‘å†…å®¹å¿«åŠ å…¥åƒè¿™æ ·çš„ CSS ä»£ç <code>top: 20px; bottom: auto;</code>; ç”±äºå·²ç»å£°æ˜äº†<code>margin: auto</code>, å†…å®¹å—å°†ä¼šå‚ç›´å±…ä¸­åœ¨ä½ å®šä¹‰çš„<code>top</code>/ <code>right</code>/ <code>bottom</code>/ <code>left</code>è¾¹ç•Œå€¼å†…. å¯ä»¥ç”¨<code>left: 0; right: auto</code>å°†å†…å®¹å¿«å›ºå®šåœ¨å·¦ä¾§; <code>right: 0; left: auto;</code>å°†å†…å®¹å›ºå®šåœ¨å³ä¾§.</p>\n</blockquote>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"absolute-left\"</span>&gt;</span></span><br><span class=\"line\">\tç»å¯¹å®šä½åœ¨å·¦ä¾§</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"absolute-right\"</span>&gt;</span></span><br><span class=\"line\">\tç»å¯¹å®šä½åœ¨å³ä¾§</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.absolute-left</span> &#123;</span><br><span class=\"line\">\t<span class=\"attribute\">position</span>: absolute;</span><br><span class=\"line\">\t<span class=\"attribute\">left</span>: <span class=\"number\">20px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">right</span>: auto;</span><br><span class=\"line\">\t<span class=\"attribute\">margin</span>: auto;</span><br><span class=\"line\">\t<span class=\"attribute\">width</span>: <span class=\"number\">150px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">height</span>: <span class=\"number\">80px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">background</span>: red;</span><br><span class=\"line\">\t<span class=\"attribute\">color</span>: <span class=\"number\">#fff</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">text-align</span>: center;</span><br><span class=\"line\">\t<span class=\"attribute\">line-height</span>: <span class=\"number\">80px</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.absolute-right</span> &#123;</span><br><span class=\"line\">\t<span class=\"attribute\">position</span>: absolute;</span><br><span class=\"line\">\t<span class=\"attribute\">left</span>: auto;</span><br><span class=\"line\">\t<span class=\"attribute\">right</span>: <span class=\"number\">20px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">margin</span>: auto;</span><br><span class=\"line\">\t<span class=\"attribute\">width</span>: <span class=\"number\">150px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">height</span>: <span class=\"number\">80px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">background</span>: green;</span><br><span class=\"line\">\t<span class=\"attribute\">color</span>: <span class=\"number\">#fff</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">text-align</span>: center;</span><br><span class=\"line\">\t<span class=\"attribute\">line-height</span>: <span class=\"number\">80px</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<h3 id=\"4-è‡ªé€‚åº”ç»å¯¹å®šä½å±…ä¸­\"><a href=\"#4-è‡ªé€‚åº”ç»å¯¹å®šä½å±…ä¸­\" class=\"headerlink\" title=\"4. è‡ªé€‚åº”ç»å¯¹å®šä½å±…ä¸­\"></a>4. è‡ªé€‚åº”ç»å¯¹å®šä½å±…ä¸­</h3><p>è‡ªé€‚åº”ç»å¯¹å±…ä¸­çš„ä¼˜åŠ¿å°±æ˜¯å¯¹ç™¾åˆ†æ¯”çš„å®½é«˜å®Œç¾æ”¯æŒ, ç”šè‡³æ˜¯<code>max-width/ min-width</code>æˆ–è€…æ˜¯<code>max-height/ max-width</code>, å³ä½¿åŠ ä¸Š<code>padding</code>ä¹Ÿä¸ä¼šå½±å“ç»å¯¹å±…ä¸­çš„å®ç°.</p>\n</blockquote>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"wrapper-responsive\"</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"absolute-responsive\"</span>&gt;</span></span><br><span class=\"line\">\t\tè‡ªé€‚åº”ç»å¯¹å®šä½å±…ä¸­</span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.wrapper-responsive</span>&#123;</span><br><span class=\"line\">\t<span class=\"attribute\">position</span>: relative;</span><br><span class=\"line\">\t<span class=\"attribute\">top</span>: <span class=\"number\">300px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">width</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">height</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">border</span>: thin solid black;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.absolute-responsive</span>&#123;</span><br><span class=\"line\">\t<span class=\"attribute\">position</span>: absolute;</span><br><span class=\"line\">\t<span class=\"attribute\">top</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">right</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">bottom</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">left</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">margin</span>: auto;</span><br><span class=\"line\">\t<span class=\"attribute\">width</span>: <span class=\"number\">60%</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">height</span>: <span class=\"number\">60%</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">min-width</span>: <span class=\"number\">50px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">max-width</span>: <span class=\"number\">150px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">padding</span>: <span class=\"number\">10px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">text-align</span>: center;</span><br><span class=\"line\">\t<span class=\"attribute\">color</span>: <span class=\"number\">#fff</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">background</span>: skyblue;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<h3 id=\"5-å†…å®¹æº¢å‡º\"><a href=\"#5-å†…å®¹æº¢å‡º\" class=\"headerlink\" title=\"5. å†…å®¹æº¢å‡º\"></a>5. å†…å®¹æº¢å‡º</h3><p>æœ‰æ—¶å†…å®¹å—çš„å†…å®¹è¿‡å¤šå¯¼è‡´é«˜åº¦å¤§äºçˆ¶çº§å…ƒç´ , å†…å®¹å°±ä¼šæ˜¾ç¤ºåˆ°å—å’Œå®¹å™¨çš„å¤–é¢, è¿™ç§æ—¶å€™åŠ ä¸ªç»™å†…å®¹å—<code>overflow: auto</code>å³å¯, å¦‚æœå†…å®¹å—æ²¡æœ‰<code>padding</code>çš„è¯åŠ ä¸ª<code>max-height: 100%</code>ä¹Ÿè¡Œ.</p>\n</blockquote>\n<blockquote>\n<h3 id=\"6-å¯å˜é«˜åº¦\"><a href=\"#6-å¯å˜é«˜åº¦\" class=\"headerlink\" title=\"6. å¯å˜é«˜åº¦\"></a>6. å¯å˜é«˜åº¦</h3><p>è®¾ç½®<code>display: table</code>, å†…å®¹å—ä¼šå‚ç›´å±…ä¸Šä¸è¿‡æ°´å¹³è¿˜æ˜¯å±…ä¸­. ä½†æ˜¯è¿™ä¸ªåœ¨ä¸€äº›æµè§ˆå™¨ä¸Šæœ‰é—®é¢˜( å¦‚: IE/ FF); <code>display: table-cell</code>é…åˆ<code>vertical-align: middle;</code>ä¹Ÿå¯å®ç°å‚ç›´æ°´å¹³å±…ä¸­.</p>\n</blockquote>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"wrapper-table\"</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"table-center\"</span>&gt;</span></span><br><span class=\"line\">\t\ttable æ°´å¹³å±…ä¸­</span><br><span class=\"line\">\t\tå†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…</span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">\t</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"wrapper-table-cell\"</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"table-center-cell\"</span>&gt;</span></span><br><span class=\"line\">\t\ttable-cell å±…ä¸­</span><br><span class=\"line\">\t\tå†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…å®¹å†…</span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/* tabel å±…ä¸­ */</span></span><br><span class=\"line\"><span class=\"selector-class\">.wrapper-table</span>&#123;</span><br><span class=\"line\">\t<span class=\"attribute\">margin-top</span>: <span class=\"number\">600px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">display</span>: table;</span><br><span class=\"line\">\t<span class=\"attribute\">height</span>: auto;</span><br><span class=\"line\">\t<span class=\"attribute\">width</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">height</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">border</span>: thin solid black;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.table-center</span>&#123;</span><br><span class=\"line\">\t<span class=\"attribute\">width</span>: <span class=\"number\">80px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">background</span>: orange;</span><br><span class=\"line\">\t<span class=\"attribute\">color</span>: <span class=\"number\">#fff</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* tabel-cell å±…ä¸­ */</span></span><br><span class=\"line\"><span class=\"selector-class\">.wrapper-table-cell</span>&#123;</span><br><span class=\"line\">\t<span class=\"attribute\">margin-top</span>: <span class=\"number\">600px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">display</span>: table-cell;</span><br><span class=\"line\">\t<span class=\"attribute\">height</span>: auto;</span><br><span class=\"line\">\t<span class=\"attribute\">width</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">height</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">border</span>: thin solid black;</span><br><span class=\"line\">\t<span class=\"attribute\">vertical-align</span>: middle;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.table-center-cell</span>&#123;</span><br><span class=\"line\">\t<span class=\"attribute\">width</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">background</span>: <span class=\"number\">#FFD34E</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">color</span>: <span class=\"number\">#fff</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<h3 id=\"6-è´Ÿå¤–è¾¹è·\"><a href=\"#6-è´Ÿå¤–è¾¹è·\" class=\"headerlink\" title=\"6. è´Ÿå¤–è¾¹è·\"></a>6. è´Ÿå¤–è¾¹è·</h3><p>è¿™ä¸ªæ–¹æ³•åº”è¯¥æ˜¯å¾ˆå¸¸ç”¨çš„æ–¹æ³•äº†, å·²çŸ¥å…ƒç´ çš„å®½é«˜: å¤–è¾¹è·<code>margin</code>çš„å€¼å–è´Ÿæ•°(æ²¡æœ‰<code>box-sizing: border-box</code>çš„æƒ…å†µä¸‹, åŒ…æ‹¬<code>padding</code>), å¤§å°ä¸º <code>width/ height</code>çš„ä¸€åŠ, å†åŠ ä¸Š<code>top: 50%; left: 50%</code>, è¿™ä¸ªä¸èƒ½è‡ªé€‚åº”å“¦.<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"wrapper-margin\"</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"margin-center\"</span>&gt;</span></span><br><span class=\"line\">\t\tmargin å±…ä¸­</span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p>\n</blockquote>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.wrapper-margin</span>&#123;</span><br><span class=\"line\">  <span class=\"attribute\">position</span>: relative;</span><br><span class=\"line\">\t<span class=\"attribute\">top</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">border</span>: thin solid black;</span><br><span class=\"line\">\t<span class=\"attribute\">width</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">height</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.margin-center</span>&#123;</span><br><span class=\"line\">\t<span class=\"attribute\">width</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">height</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">background</span>: <span class=\"number\">#105B63</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">position</span>: absolute;</span><br><span class=\"line\">\t<span class=\"attribute\">top</span>: <span class=\"number\">50%</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">left</span>: <span class=\"number\">50%</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">margin</span>: -<span class=\"number\">50px</span> auto auto -<span class=\"number\">50px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">color</span>: <span class=\"number\">#fff</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">text-align</span>: center;</span><br><span class=\"line\">\t<span class=\"attribute\">line-height</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<h3 id=\"7-å˜å½¢\"><a href=\"#7-å˜å½¢\" class=\"headerlink\" title=\"7. å˜å½¢\"></a>7. å˜å½¢</h3><p>è¿™å¯ä»¥è¯´æ˜¯æœ€ç®€å•çš„æ–¹æ³•äº†, ä¸ä»…å¯ä»¥å®ç°ç»å¯¹å±…ä¸­çš„æƒ³è¿‡è¿˜å¯ä»¥å®ç°å¯å˜å®½é«˜åº¦. å†…å®¹å—å®šä¹‰<code>transform: translate(-50%, -50%)</code>å¸¦ä¸Šæµè§ˆå™¨å‰ç¼€, å†åŠ ä¸Š<code>top: 50%; left: 50%</code>å³å¯.</p>\n</blockquote>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"wrapper-transform\"</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"transform-center\"</span>&gt;</span></span><br><span class=\"line\">\t\ttransform å±…ä¸­</span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.wrapper-transform</span>&#123;</span><br><span class=\"line\">\t<span class=\"attribute\">position</span>: relative;</span><br><span class=\"line\">\t<span class=\"attribute\">top</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">border</span>: thin solid black;</span><br><span class=\"line\">\t<span class=\"attribute\">width</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">height</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.transform-center</span>&#123;</span><br><span class=\"line\">\t<span class=\"attribute\">width</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">height</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">background</span>: <span class=\"number\">#BD4932</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">position</span>: absolute;</span><br><span class=\"line\">\t<span class=\"attribute\">top</span>: <span class=\"number\">50%</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">left</span>: <span class=\"number\">50%</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">-webkit-transform</span>: <span class=\"built_in\">translate</span>(-50%, -50%);</span><br><span class=\"line\">\t<span class=\"attribute\">-ms-transform</span>: <span class=\"built_in\">translate</span>(-50%, -50%);</span><br><span class=\"line\">\t<span class=\"attribute\">-o-transform</span>: <span class=\"built_in\">translate</span>(-50%, -50%);</span><br><span class=\"line\">\t<span class=\"attribute\">transform</span>: <span class=\"built_in\">translate</span>(-50%, -50%);</span><br><span class=\"line\">\t<span class=\"attribute\">color</span>: <span class=\"number\">#fff</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">text-align</span>: center;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<h3 id=\"8-Flexbox\"><a href=\"#8-Flexbox\" class=\"headerlink\" title=\"8. Flexbox\"></a>8. Flexbox</h3><p>CSS3çš„æ–°å±æ€§ä¹Ÿå«å¼¹æ€§ç›’å­, å®ƒä¸ä»…å¯ä»¥è§£å†³å±…ä¸­çš„é—®é¢˜è¿˜å¯ä»¥åˆ†æ æˆ–è€…å…¶ä»–çš„ä¸€äº›å¸ƒå±€é—®é¢˜. è¿™é‡Œä¸å¤šè§£é‡Š, ä¸‹æ¬¡åšä¸€ä¸ªè¯¦ç»†çš„è¯´æ˜.<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"wrapper-flex\"</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"flex-center\"</span>&gt;</span></span><br><span class=\"line\">\t\tå¼¹æ€§ç›’å­å±…ä¸­</span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p>\n</blockquote>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.wrapper-flex</span>&#123;</span><br><span class=\"line\">\t<span class=\"attribute\">margin-top</span>: <span class=\"number\">500px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">width</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">height</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">border</span>: thin solid black;</span><br><span class=\"line\">\t<span class=\"attribute\">display</span>: flex;</span><br><span class=\"line\">\t<span class=\"attribute\">justify-content</span>: center;</span><br><span class=\"line\">\t<span class=\"attribute\">align-items</span>: center;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.flex-center</span>&#123;</span><br><span class=\"line\">\t<span class=\"attribute\">background</span>: grey;</span><br><span class=\"line\">\t<span class=\"attribute\">color</span>: <span class=\"number\">#fff</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">text-align</span>: center;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><a href=\"https://caraws.github.io/Review-JavaScript/CSS/vertical-horizontal-center\" target=\"_blank\" rel=\"noopener\">é¢„è§ˆåœ°å€</a></p>\n<p>Created on 2017-10-11 by Cara</p>\n"},{"title":"Flex å¼¹æ€§ç›’å­","date":"2017-11-23T11:15:28.000Z","_content":"Flex æ˜¯ Flexible box çš„ç¼©å†™(å¼¹æ€§å¸ƒå±€), ç”¨æ¥ä¸ºç›’æ¨¡å‹æä¾›æœ€å¤§çµæ´»æ€§çš„å¸ƒå±€, æ›´ä¸ºæ–¹ä¾¿çš„å®ç°å“åº”å¼å¸ƒå±€.\n\n> å¦‚ä½•ä½¿ç”¨ Flex  \nä»»ä½•ä¸€ä¸ªå®¹å™¨éƒ½å¯ä»¥æŒ‡å®šä¸ºä¸€ä¸ª Flex å¸ƒå±€.  \n\n```css\n.box {\n\tdisplay: flex;\n}\n/* è¡Œå†…å…ƒç´  */\n.box{\n\tdisplay: inline-flex;\n}\n/* å†…æ ¸ä¸º webkit çš„æµè§ˆå™¨ */\n.box{\n\t/* Safari */\n\tdisplay: -webkit-flex;\n\tdisplay: flex;\n}\n```\n\nè®¾å®š Flexå¸ƒå±€ä¹‹åçš„å­å…ƒç´ `float`/ `clear`/ `vertical-align`éƒ½å°†å¤±æ•ˆ.\n\n#### åŸºæœ¬æ¦‚å¿µ\næ‰€æœ‰é‡‡ç”¨ Flex å¸ƒå±€çš„çš„å…ƒç´ éƒ½ç§°ä¸º Flex å®¹å™¨, å®ƒçš„æ‰€æœ‰èµ„æºéƒ½ä¸º Flex å®¹å™¨çš„å®¹å™¨æˆå‘˜, æˆä¸º Flex é¡¹ç›®.\nFlex å®¹å™¨éƒ½å­˜åœ¨ä¸¤æ ¹è½´: æ°´å¹³çš„ä¸»è½´(main axis)å’Œå‚ç›´çš„äº¤å‰è½´(cross axis), é¡¹ç›®é»˜è®¤æ²¿ä¸»è½´æ’åˆ—. æ¯ä¸ªé¡¹ç›®å ä¸»è½´çš„ç©ºé—´ç§°ä¸º`main size`, å äº¤å‰è½´çš„ç©ºé—´ç§°ä¸º`cross size`.\n\n#### Flex å®¹å™¨çš„å±æ€§\n\n- flex-direction\né¡¹ç›®æ’åˆ—åœ¨ä¸»è½´çš„æ–¹å‘ \n\n    ```css\n    .box {\n    \tflex-direction: row | row-reverse | column | column-reverse;\n    }\n    ```\n\t- row: é»˜è®¤å€¼, ä¸»è½´ä¸ºæ°´å¹³æ–¹å‘, èµ·ç‚¹ä¸ºå·¦è¾¹\n\t- row-reverse: ä¸»è½´ä¸ºæ°´å¹³æ–¹å‘, èµ·ç‚¹ä¸ºå³è¾¹\n\t- column: ä¸»è½´ä¸ºäº¤å‰è½´æ–¹å‘, èµ·ç‚¹åœ¨é¡¶éƒ¨\n\t- column-reverse: ä¸»è½´ä¸ºäº¤å‰è½´æ–¹å‘, èµ·ç‚¹åœ¨åº•éƒ¨\n\t\n- flex-wrap\né¡¹ç›®åœ¨ä¸»è½´ä¸Šçš„æ¢è¡Œæ–¹å¼\n\n    ```css\n    .box {\n    \tflex-wrap: nowrap | wrap | wrap-reverse;\n    }\n    ```\n\n\t- nowrap: é»˜è®¤å€¼, ä¸æ¢è¡Œ\n\t- wrap: æ¢è¡Œ, ç¬¬ä¸€è¡Œåœ¨ä¸Šé¢\n\t- wrap-reverse: æ¢è¡Œ, ç¬¬ä¸€è¡Œåœ¨ä¸‹é¢\n\t\n- flex-flow\nè¯¥å±æ€§ä¸º`flex-direction`å’Œ`flex-wrap`çš„ç¼©å†™, é»˜è®¤å€¼ä¸º`row nowrap`\n\n```css\n.box {\n\tflex-flow: flex-direction || flex-wrap;\n}\n```\n\n- justify-content\né¡¹ç›®åœ¨ä¸»è½´ä¸Šçš„å¯¹é½æ–¹å¼, æ‰€ä»¥å®ƒçš„å¯¹é½æ–¹å¼è·Ÿè½´çš„æ–¹å‘æœ‰å…³\n\n    ```css\n    .box {\n    \tjustify-content: flex-start | center | space-around | space-between | flex-end;\n    }\n    ```\n\n\t- flex-start: é»˜è®¤å€¼, å·¦å¯¹é½\n\t- center: å±…ä¸­\n\t- space-around: å·¦å³å±…ä¸­å¯¹é½, é¡¹ç›®ä¹‹é—´é—´éš”ä¸ºé¡¹ç›®ä¸è¾¹æ¡†çš„é—´éš”å¤§ä¸€å€\n\t- space-between: ä¸¤ç«¯å¯¹é½\n\t- flex-end: å³å¯¹é½ \n\n- align-items\né¡¹ç›®åœ¨äº¤å‰è½´åœ¨çš„å¯¹é½æ–¹å¼, ä¸äº¤å‰è½´æ–¹å‘æœ‰å…³\n\n    ```css\n    .box {\n    \talign-items: flex-start | center | baseline | stretch | flex-end;\n    }\n    ```\n\n\t- flex-start: äº¤å‰è½´èµ·ç‚¹å¯¹é½\n\t- center: å±…ä¸­\n\t- baseline: é¡¹ç›®ç¬¬ä¸€è¡Œæ–‡å­—åŸºçº¿å¯¹é½, ç±»ä¼¼åœ¨æ–‡å­—çš„ä¸‹åˆ’çº¿ä½ç½®\n\t- stretch: é»˜è®¤å€¼, é¡¹ç›®æ²¡æœ‰é«˜åº¦æˆ–ä¸º`auto`æ—¶, å æ»¡æ•´ä¸ªå®¹å™¨\n\t- flex-end: ç»ˆç‚¹å¯¹é½\n    \n- align-content\nå¤šæ ¹è½´çº¿å¯¹é½æ–¹å¼. å¦‚æœé¡¹ç›®åªæœ‰ä¸€æ ¹è½´çº¿, è¯¥å±æ€§åˆ™ä¸èµ·ä½œç”¨. è·Ÿ`align-items`å®¹æ˜“æ··æ·†, åŒºåˆ«åœ¨äº `align-content`é¡¹ç›®æœ‰å¤šè¡Œæ—¶èµ·ä½œç”¨, è€Œ`align-items`é¡¹ç›®å•è¡Œå°±å¯èµ·ä½œç”¨.\n\n    ```css\n    .box {\n    \talign-content: flex-start | center | space-around | space-between | stretch | flex-end;\n    }\n    ```\n\n\t- flex-start: äº¤å‰è½´å¯¹é½æ–¹å¼\n\t- center: å±…ä¸­\n\t- space-around: å·¦å³å±…ä¸­å¯¹é½\n\t- space-between: ä¸¤ç«¯å¯¹é½\n\t- stretch: é»˜è®¤å€¼, é¡¹ç›®è½´çº¿å æ»¡æ•´ä¸ªäº¤å‰è½´\n\n#### Flex é¡¹ç›®å±æ€§\n\n- order\nå®šä¹‰é¡¹ç›®çš„æ’åˆ—é¡ºåº, æ•°å€¼è¶Šå°è¶Šé å‰, é»˜è®¤ä¸º0\n\n    ```css\n    .item {\n    \torder: <number>;\n    }\n    ```\n\n- flex-grow\nå®šä¹‰é¡¹ç›®çš„æ”¾å¤§æ¯”ä¾‹, é»˜è®¤ä¸º0(æœ‰å‰©ä½™ç©ºé—´ä¹Ÿä¸æ”¾å¤§). å¦‚æœæ‰€æœ‰é¡¹ç›®éƒ½ä¸º1, å®ƒä»¬å°†ç­‰åˆ†å‰©ä½™ç©ºé—´; å¦‚æœå…¶ä¸­ä¸€ä¸ªé¡¹ç›®ä¸º2, å…¶å®ƒé¡¹ç›®ä¸º1, é‚£ä¹ˆå±æ€§ä¸º2çš„é¡¹ç›®å æ®çš„å‰©ä½™ç©ºé—´å°†æ¯”å±æ€§ä¸º1çš„é¡¹ç›®å¤§ä¸€å€\n\n    ```css\n    .item {\n    \tflex-grow: <number>;\n    }\n    ```\n\n- flex-shrink\nå®šä¹‰é¡¹ç›®çš„ç¼©å°æ¯”ä¾‹, é»˜è®¤ä¸º1(å¦‚æœç©ºé—´ä¸è¶³, å°†ç¼©å°). å¦‚æœæ‰€æœ‰é¡¹ç›®éƒ½ä¸º1, å½“ç©ºé—´ä¸è¶³æ—¶, æ‰€æœ‰é¡¹ç›®éƒ½å°†ç­‰æ¯”ä¾‹ç¼©å°; å¦‚æœå…¶ä¸­ä¸€ä¸ªé¡¹ç›®ä¸º0, å…¶å®ƒé¡¹ç›®ä¸º1, é‚£ä¹ˆå½“ç©ºé—´ä¸è¶³æ—¶, å‰è€…å°†ä¸ç¼©å°\n\n    ```css\n    .item {\n    \tflex-shrink: <number>;\n    }\n    ```\n\n- flex-basis\nå®šä¹‰å±æ€§åœ¨åˆ†é…å¤šä½™ç©ºé—´ä¹‹å‰é¡¹ç›®å æ®çš„ä¸»è½´ç©ºé—´(main size). æµè§ˆå™¨ä¼šæ ¹æ®è¿™ä¸ªå±æ€§è®¡ç®—æ˜¯å¦æœ‰å¤šäºç©ºé—´. é»˜è®¤å€¼ä¸º auto(é¡¹ç›®æœ¬èº«çš„å¤§å°). å¦‚æœä¸ä½¿ç”¨`box-sizing`æ¥æ”¹å˜ç›’æ¨¡å‹çš„è¯, è¯¥å±æ€§å°†å†³å®šé¡¹ç›®çš„å†…å®¹ç›’(content-box)çš„å®½æˆ–è€…é«˜(å®½æˆ–é«˜å–å†³äºä¸»è½´çš„æ–¹å‘).\n\n    ```css\n    .item {\n    \t/* size çš„å•ä½å¯ä»¥ä¸º px/ em/rem ç™¾åˆ†æ¯”éƒ½è¡Œ(è´Ÿå€¼æ— æ•ˆ) */\n    \tflex-basis: <size> | <content>;\n    }\n    ```\n\n\t- size: è·Ÿå®½é«˜è®¾ç½®ä¸€æ ·, ä¸å¤šè¯´.\n\t- content: css3 çš„å‡ ä¸ª width æ–°å±æ€§. fill-available/ max-content/ min-content/ fit-content, å…¼å®¹æ€§ IE ä¸æ”¯æŒ.\n- flex\nè¯¥å±æ€§ä¸º`flex-grow`/`flex-shrink`å’Œ`flex-basis`çš„ç¼©å†™, é»˜è®¤å€¼ä¸º `0 1 auto`, åä¸¤ä¸ªå±æ€§å¯é€‰\n\n    ```css\n    .item {\n    \tflex: none | flex-grow flex-shrink flex-basis\n    }\n    ```\n- align-self\nå…è®¸å•ä¸ªé¡¹ç›®ä¸å…¶ä»–é¡¹ç›®æœ‰ä¸åŒçš„å¯¹é½æ–¹å¼, å¯è¦†ç›–`align-items`å±æ€§, é»˜è®¤å€¼ä¸º auto, ç»§æ‰¿çˆ¶çº§å…ƒç´ çš„`align-items`å±æ€§, æ²¡æœ‰çš„è¯ç­‰åŒäº`stretch`\n\n    ```\n    .item {\n    \talign-self: auto | flex-start | center | stretch | baseline | flex-end;\n    }\n    ```\né™¤äº† `auto`ä»¥å¤–å…¶ä»–å±æ€§å€¼è·Ÿ`align-items`ä¸€æ ·å°±ä¸å†é‡å¤äº†.\n\n> è¯´ä¸€ä¸‹ CSS3 width çš„å‡ ä¸ªæ–°å±æ€§  \n> éœ€è¦å¸¦æœ‰ç§æœ‰å‰ç¼€  \n\n- fill-available\nè®©å…ƒç´ è‡ªåŠ¨100%å¾—å¡«å……çˆ¶çº§å®½åº¦, è®©å…ƒç´ è¡¨ç°å¾—åƒå—çº§å…ƒç´ ä¸€æ ·, `inline-block`çš„å…ƒç´ ä¹Ÿå¯ä»¥è‡ªåŠ¨å¡«å……, é¡ºä¾¿å†çˆ¶çº§åŠ ä¸€ä¸ª`line-height`è®©å…ƒç´ å‚ç›´å±…ä¸­.\n- max-content\nå®ƒçš„è¡¨ç°å°±åƒè®¾ç½®äº†`white-space:nowrap`ä¸€æ ·, å…ƒç´ çš„å®½åº¦å–å­å…ƒç´ ä¸­è¾ƒå¤§å®½åº¦çš„å®½åº¦\n- min-content\nå®ƒè¡¨ç¤ºçš„ä¸æ˜¯å­å…ƒç´ ä¸­å®½åº¦å°çš„é‚£ä¸ªå®½åº¦, è€Œæ˜¯å†…éƒ¨å…ƒç´ æœ€å°å®½åº¦å€¼æœ€å¤§çš„é‚£ä¸ªå…ƒç´ ä½œä¸ºæœ€ç»ˆå®½åº¦. æ¯”å¦‚: ä¸€ä¸ª`div`ä¸­, æœ‰ä¸€å¼ `img`çš„å®½åº¦ä¸º200px, æœ‰ä¸€ä¸ª`p`é‡Œé¢çš„æ–‡å­—å¯å¤šå¯å°‘é‡Œé¢æœ‰è‹±æ–‡(å¦‚æœæ–‡æœ¬å…¨æ˜¯ä¸­æ–‡, æœ€å°å®½åº¦å€¼å°±æ˜¯ä¸€ä¸ªä¸­æ–‡çš„å®½åº¦, å¦‚æœå¤¹æ‚è‹±æ–‡, ç”±äºè‹±æ–‡é»˜è®¤ä¸æ¢è¡Œ, æ‰€ä»¥æœ€å°å®½åº¦å€¼æ˜¯æœ€é•¿å•è¯çš„å®½åº¦), æ‰€ä»¥å‡è®¾è¿™é‡Œè‹±æ–‡çš„æœ€é•¿å•è¯ä¸è¶³200px, é‚£ä¹ˆæœ€ç»ˆçš„å…ƒç´ å®½åº¦å°±ä¸º200px\n- fit-content\nè®¾ç½®è¯¥å±æ€§å, ä¸éœ€è¦å›ºå®šå®½åº¦, åœ¨çˆ¶çº§å…ƒç´ `margin: 0 auto`å°±å¯ä»¥å®ç°æ°´å¹³å±…ä¸­äº†\n\nCreated on 2017-11-23 By Cara","source":"_posts/Flex-å¼¹æ€§ç›’å­.md","raw":"---\ntitle: Flex å¼¹æ€§ç›’å­\ndate: 2017-11-23 19:15:28\ntags: \n- CSS\ncategories: \n- å¤ä¹ \n---\nFlex æ˜¯ Flexible box çš„ç¼©å†™(å¼¹æ€§å¸ƒå±€), ç”¨æ¥ä¸ºç›’æ¨¡å‹æä¾›æœ€å¤§çµæ´»æ€§çš„å¸ƒå±€, æ›´ä¸ºæ–¹ä¾¿çš„å®ç°å“åº”å¼å¸ƒå±€.\n\n> å¦‚ä½•ä½¿ç”¨ Flex  \nä»»ä½•ä¸€ä¸ªå®¹å™¨éƒ½å¯ä»¥æŒ‡å®šä¸ºä¸€ä¸ª Flex å¸ƒå±€.  \n\n```css\n.box {\n\tdisplay: flex;\n}\n/* è¡Œå†…å…ƒç´  */\n.box{\n\tdisplay: inline-flex;\n}\n/* å†…æ ¸ä¸º webkit çš„æµè§ˆå™¨ */\n.box{\n\t/* Safari */\n\tdisplay: -webkit-flex;\n\tdisplay: flex;\n}\n```\n\nè®¾å®š Flexå¸ƒå±€ä¹‹åçš„å­å…ƒç´ `float`/ `clear`/ `vertical-align`éƒ½å°†å¤±æ•ˆ.\n\n#### åŸºæœ¬æ¦‚å¿µ\næ‰€æœ‰é‡‡ç”¨ Flex å¸ƒå±€çš„çš„å…ƒç´ éƒ½ç§°ä¸º Flex å®¹å™¨, å®ƒçš„æ‰€æœ‰èµ„æºéƒ½ä¸º Flex å®¹å™¨çš„å®¹å™¨æˆå‘˜, æˆä¸º Flex é¡¹ç›®.\nFlex å®¹å™¨éƒ½å­˜åœ¨ä¸¤æ ¹è½´: æ°´å¹³çš„ä¸»è½´(main axis)å’Œå‚ç›´çš„äº¤å‰è½´(cross axis), é¡¹ç›®é»˜è®¤æ²¿ä¸»è½´æ’åˆ—. æ¯ä¸ªé¡¹ç›®å ä¸»è½´çš„ç©ºé—´ç§°ä¸º`main size`, å äº¤å‰è½´çš„ç©ºé—´ç§°ä¸º`cross size`.\n\n#### Flex å®¹å™¨çš„å±æ€§\n\n- flex-direction\né¡¹ç›®æ’åˆ—åœ¨ä¸»è½´çš„æ–¹å‘ \n\n    ```css\n    .box {\n    \tflex-direction: row | row-reverse | column | column-reverse;\n    }\n    ```\n\t- row: é»˜è®¤å€¼, ä¸»è½´ä¸ºæ°´å¹³æ–¹å‘, èµ·ç‚¹ä¸ºå·¦è¾¹\n\t- row-reverse: ä¸»è½´ä¸ºæ°´å¹³æ–¹å‘, èµ·ç‚¹ä¸ºå³è¾¹\n\t- column: ä¸»è½´ä¸ºäº¤å‰è½´æ–¹å‘, èµ·ç‚¹åœ¨é¡¶éƒ¨\n\t- column-reverse: ä¸»è½´ä¸ºäº¤å‰è½´æ–¹å‘, èµ·ç‚¹åœ¨åº•éƒ¨\n\t\n- flex-wrap\né¡¹ç›®åœ¨ä¸»è½´ä¸Šçš„æ¢è¡Œæ–¹å¼\n\n    ```css\n    .box {\n    \tflex-wrap: nowrap | wrap | wrap-reverse;\n    }\n    ```\n\n\t- nowrap: é»˜è®¤å€¼, ä¸æ¢è¡Œ\n\t- wrap: æ¢è¡Œ, ç¬¬ä¸€è¡Œåœ¨ä¸Šé¢\n\t- wrap-reverse: æ¢è¡Œ, ç¬¬ä¸€è¡Œåœ¨ä¸‹é¢\n\t\n- flex-flow\nè¯¥å±æ€§ä¸º`flex-direction`å’Œ`flex-wrap`çš„ç¼©å†™, é»˜è®¤å€¼ä¸º`row nowrap`\n\n```css\n.box {\n\tflex-flow: flex-direction || flex-wrap;\n}\n```\n\n- justify-content\né¡¹ç›®åœ¨ä¸»è½´ä¸Šçš„å¯¹é½æ–¹å¼, æ‰€ä»¥å®ƒçš„å¯¹é½æ–¹å¼è·Ÿè½´çš„æ–¹å‘æœ‰å…³\n\n    ```css\n    .box {\n    \tjustify-content: flex-start | center | space-around | space-between | flex-end;\n    }\n    ```\n\n\t- flex-start: é»˜è®¤å€¼, å·¦å¯¹é½\n\t- center: å±…ä¸­\n\t- space-around: å·¦å³å±…ä¸­å¯¹é½, é¡¹ç›®ä¹‹é—´é—´éš”ä¸ºé¡¹ç›®ä¸è¾¹æ¡†çš„é—´éš”å¤§ä¸€å€\n\t- space-between: ä¸¤ç«¯å¯¹é½\n\t- flex-end: å³å¯¹é½ \n\n- align-items\né¡¹ç›®åœ¨äº¤å‰è½´åœ¨çš„å¯¹é½æ–¹å¼, ä¸äº¤å‰è½´æ–¹å‘æœ‰å…³\n\n    ```css\n    .box {\n    \talign-items: flex-start | center | baseline | stretch | flex-end;\n    }\n    ```\n\n\t- flex-start: äº¤å‰è½´èµ·ç‚¹å¯¹é½\n\t- center: å±…ä¸­\n\t- baseline: é¡¹ç›®ç¬¬ä¸€è¡Œæ–‡å­—åŸºçº¿å¯¹é½, ç±»ä¼¼åœ¨æ–‡å­—çš„ä¸‹åˆ’çº¿ä½ç½®\n\t- stretch: é»˜è®¤å€¼, é¡¹ç›®æ²¡æœ‰é«˜åº¦æˆ–ä¸º`auto`æ—¶, å æ»¡æ•´ä¸ªå®¹å™¨\n\t- flex-end: ç»ˆç‚¹å¯¹é½\n    \n- align-content\nå¤šæ ¹è½´çº¿å¯¹é½æ–¹å¼. å¦‚æœé¡¹ç›®åªæœ‰ä¸€æ ¹è½´çº¿, è¯¥å±æ€§åˆ™ä¸èµ·ä½œç”¨. è·Ÿ`align-items`å®¹æ˜“æ··æ·†, åŒºåˆ«åœ¨äº `align-content`é¡¹ç›®æœ‰å¤šè¡Œæ—¶èµ·ä½œç”¨, è€Œ`align-items`é¡¹ç›®å•è¡Œå°±å¯èµ·ä½œç”¨.\n\n    ```css\n    .box {\n    \talign-content: flex-start | center | space-around | space-between | stretch | flex-end;\n    }\n    ```\n\n\t- flex-start: äº¤å‰è½´å¯¹é½æ–¹å¼\n\t- center: å±…ä¸­\n\t- space-around: å·¦å³å±…ä¸­å¯¹é½\n\t- space-between: ä¸¤ç«¯å¯¹é½\n\t- stretch: é»˜è®¤å€¼, é¡¹ç›®è½´çº¿å æ»¡æ•´ä¸ªäº¤å‰è½´\n\n#### Flex é¡¹ç›®å±æ€§\n\n- order\nå®šä¹‰é¡¹ç›®çš„æ’åˆ—é¡ºåº, æ•°å€¼è¶Šå°è¶Šé å‰, é»˜è®¤ä¸º0\n\n    ```css\n    .item {\n    \torder: <number>;\n    }\n    ```\n\n- flex-grow\nå®šä¹‰é¡¹ç›®çš„æ”¾å¤§æ¯”ä¾‹, é»˜è®¤ä¸º0(æœ‰å‰©ä½™ç©ºé—´ä¹Ÿä¸æ”¾å¤§). å¦‚æœæ‰€æœ‰é¡¹ç›®éƒ½ä¸º1, å®ƒä»¬å°†ç­‰åˆ†å‰©ä½™ç©ºé—´; å¦‚æœå…¶ä¸­ä¸€ä¸ªé¡¹ç›®ä¸º2, å…¶å®ƒé¡¹ç›®ä¸º1, é‚£ä¹ˆå±æ€§ä¸º2çš„é¡¹ç›®å æ®çš„å‰©ä½™ç©ºé—´å°†æ¯”å±æ€§ä¸º1çš„é¡¹ç›®å¤§ä¸€å€\n\n    ```css\n    .item {\n    \tflex-grow: <number>;\n    }\n    ```\n\n- flex-shrink\nå®šä¹‰é¡¹ç›®çš„ç¼©å°æ¯”ä¾‹, é»˜è®¤ä¸º1(å¦‚æœç©ºé—´ä¸è¶³, å°†ç¼©å°). å¦‚æœæ‰€æœ‰é¡¹ç›®éƒ½ä¸º1, å½“ç©ºé—´ä¸è¶³æ—¶, æ‰€æœ‰é¡¹ç›®éƒ½å°†ç­‰æ¯”ä¾‹ç¼©å°; å¦‚æœå…¶ä¸­ä¸€ä¸ªé¡¹ç›®ä¸º0, å…¶å®ƒé¡¹ç›®ä¸º1, é‚£ä¹ˆå½“ç©ºé—´ä¸è¶³æ—¶, å‰è€…å°†ä¸ç¼©å°\n\n    ```css\n    .item {\n    \tflex-shrink: <number>;\n    }\n    ```\n\n- flex-basis\nå®šä¹‰å±æ€§åœ¨åˆ†é…å¤šä½™ç©ºé—´ä¹‹å‰é¡¹ç›®å æ®çš„ä¸»è½´ç©ºé—´(main size). æµè§ˆå™¨ä¼šæ ¹æ®è¿™ä¸ªå±æ€§è®¡ç®—æ˜¯å¦æœ‰å¤šäºç©ºé—´. é»˜è®¤å€¼ä¸º auto(é¡¹ç›®æœ¬èº«çš„å¤§å°). å¦‚æœä¸ä½¿ç”¨`box-sizing`æ¥æ”¹å˜ç›’æ¨¡å‹çš„è¯, è¯¥å±æ€§å°†å†³å®šé¡¹ç›®çš„å†…å®¹ç›’(content-box)çš„å®½æˆ–è€…é«˜(å®½æˆ–é«˜å–å†³äºä¸»è½´çš„æ–¹å‘).\n\n    ```css\n    .item {\n    \t/* size çš„å•ä½å¯ä»¥ä¸º px/ em/rem ç™¾åˆ†æ¯”éƒ½è¡Œ(è´Ÿå€¼æ— æ•ˆ) */\n    \tflex-basis: <size> | <content>;\n    }\n    ```\n\n\t- size: è·Ÿå®½é«˜è®¾ç½®ä¸€æ ·, ä¸å¤šè¯´.\n\t- content: css3 çš„å‡ ä¸ª width æ–°å±æ€§. fill-available/ max-content/ min-content/ fit-content, å…¼å®¹æ€§ IE ä¸æ”¯æŒ.\n- flex\nè¯¥å±æ€§ä¸º`flex-grow`/`flex-shrink`å’Œ`flex-basis`çš„ç¼©å†™, é»˜è®¤å€¼ä¸º `0 1 auto`, åä¸¤ä¸ªå±æ€§å¯é€‰\n\n    ```css\n    .item {\n    \tflex: none | flex-grow flex-shrink flex-basis\n    }\n    ```\n- align-self\nå…è®¸å•ä¸ªé¡¹ç›®ä¸å…¶ä»–é¡¹ç›®æœ‰ä¸åŒçš„å¯¹é½æ–¹å¼, å¯è¦†ç›–`align-items`å±æ€§, é»˜è®¤å€¼ä¸º auto, ç»§æ‰¿çˆ¶çº§å…ƒç´ çš„`align-items`å±æ€§, æ²¡æœ‰çš„è¯ç­‰åŒäº`stretch`\n\n    ```\n    .item {\n    \talign-self: auto | flex-start | center | stretch | baseline | flex-end;\n    }\n    ```\né™¤äº† `auto`ä»¥å¤–å…¶ä»–å±æ€§å€¼è·Ÿ`align-items`ä¸€æ ·å°±ä¸å†é‡å¤äº†.\n\n> è¯´ä¸€ä¸‹ CSS3 width çš„å‡ ä¸ªæ–°å±æ€§  \n> éœ€è¦å¸¦æœ‰ç§æœ‰å‰ç¼€  \n\n- fill-available\nè®©å…ƒç´ è‡ªåŠ¨100%å¾—å¡«å……çˆ¶çº§å®½åº¦, è®©å…ƒç´ è¡¨ç°å¾—åƒå—çº§å…ƒç´ ä¸€æ ·, `inline-block`çš„å…ƒç´ ä¹Ÿå¯ä»¥è‡ªåŠ¨å¡«å……, é¡ºä¾¿å†çˆ¶çº§åŠ ä¸€ä¸ª`line-height`è®©å…ƒç´ å‚ç›´å±…ä¸­.\n- max-content\nå®ƒçš„è¡¨ç°å°±åƒè®¾ç½®äº†`white-space:nowrap`ä¸€æ ·, å…ƒç´ çš„å®½åº¦å–å­å…ƒç´ ä¸­è¾ƒå¤§å®½åº¦çš„å®½åº¦\n- min-content\nå®ƒè¡¨ç¤ºçš„ä¸æ˜¯å­å…ƒç´ ä¸­å®½åº¦å°çš„é‚£ä¸ªå®½åº¦, è€Œæ˜¯å†…éƒ¨å…ƒç´ æœ€å°å®½åº¦å€¼æœ€å¤§çš„é‚£ä¸ªå…ƒç´ ä½œä¸ºæœ€ç»ˆå®½åº¦. æ¯”å¦‚: ä¸€ä¸ª`div`ä¸­, æœ‰ä¸€å¼ `img`çš„å®½åº¦ä¸º200px, æœ‰ä¸€ä¸ª`p`é‡Œé¢çš„æ–‡å­—å¯å¤šå¯å°‘é‡Œé¢æœ‰è‹±æ–‡(å¦‚æœæ–‡æœ¬å…¨æ˜¯ä¸­æ–‡, æœ€å°å®½åº¦å€¼å°±æ˜¯ä¸€ä¸ªä¸­æ–‡çš„å®½åº¦, å¦‚æœå¤¹æ‚è‹±æ–‡, ç”±äºè‹±æ–‡é»˜è®¤ä¸æ¢è¡Œ, æ‰€ä»¥æœ€å°å®½åº¦å€¼æ˜¯æœ€é•¿å•è¯çš„å®½åº¦), æ‰€ä»¥å‡è®¾è¿™é‡Œè‹±æ–‡çš„æœ€é•¿å•è¯ä¸è¶³200px, é‚£ä¹ˆæœ€ç»ˆçš„å…ƒç´ å®½åº¦å°±ä¸º200px\n- fit-content\nè®¾ç½®è¯¥å±æ€§å, ä¸éœ€è¦å›ºå®šå®½åº¦, åœ¨çˆ¶çº§å…ƒç´ `margin: 0 auto`å°±å¯ä»¥å®ç°æ°´å¹³å±…ä¸­äº†\n\nCreated on 2017-11-23 By Cara","slug":"Flex-å¼¹æ€§ç›’å­","published":1,"updated":"2018-05-05T09:23:03.654Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjgurols70006klu026z6lakf","content":"<p>Flex æ˜¯ Flexible box çš„ç¼©å†™(å¼¹æ€§å¸ƒå±€), ç”¨æ¥ä¸ºç›’æ¨¡å‹æä¾›æœ€å¤§çµæ´»æ€§çš„å¸ƒå±€, æ›´ä¸ºæ–¹ä¾¿çš„å®ç°å“åº”å¼å¸ƒå±€.</p>\n<blockquote>\n<p>å¦‚ä½•ä½¿ç”¨ Flex<br>ä»»ä½•ä¸€ä¸ªå®¹å™¨éƒ½å¯ä»¥æŒ‡å®šä¸ºä¸€ä¸ª Flex å¸ƒå±€.  </p>\n</blockquote>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.box</span> &#123;</span><br><span class=\"line\">\t<span class=\"attribute\">display</span>: flex;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">/* è¡Œå†…å…ƒç´  */</span></span><br><span class=\"line\"><span class=\"selector-class\">.box</span>&#123;</span><br><span class=\"line\">\t<span class=\"attribute\">display</span>: inline-flex;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">/* å†…æ ¸ä¸º webkit çš„æµè§ˆå™¨ */</span></span><br><span class=\"line\"><span class=\"selector-class\">.box</span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">/* Safari */</span></span><br><span class=\"line\">\t<span class=\"attribute\">display</span>: -webkit-flex;</span><br><span class=\"line\">\t<span class=\"attribute\">display</span>: flex;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>è®¾å®š Flexå¸ƒå±€ä¹‹åçš„å­å…ƒç´ <code>float</code>/ <code>clear</code>/ <code>vertical-align</code>éƒ½å°†å¤±æ•ˆ.</p>\n<h4 id=\"åŸºæœ¬æ¦‚å¿µ\"><a href=\"#åŸºæœ¬æ¦‚å¿µ\" class=\"headerlink\" title=\"åŸºæœ¬æ¦‚å¿µ\"></a>åŸºæœ¬æ¦‚å¿µ</h4><p>æ‰€æœ‰é‡‡ç”¨ Flex å¸ƒå±€çš„çš„å…ƒç´ éƒ½ç§°ä¸º Flex å®¹å™¨, å®ƒçš„æ‰€æœ‰èµ„æºéƒ½ä¸º Flex å®¹å™¨çš„å®¹å™¨æˆå‘˜, æˆä¸º Flex é¡¹ç›®.<br>Flex å®¹å™¨éƒ½å­˜åœ¨ä¸¤æ ¹è½´: æ°´å¹³çš„ä¸»è½´(main axis)å’Œå‚ç›´çš„äº¤å‰è½´(cross axis), é¡¹ç›®é»˜è®¤æ²¿ä¸»è½´æ’åˆ—. æ¯ä¸ªé¡¹ç›®å ä¸»è½´çš„ç©ºé—´ç§°ä¸º<code>main size</code>, å äº¤å‰è½´çš„ç©ºé—´ç§°ä¸º<code>cross size</code>.</p>\n<h4 id=\"Flex-å®¹å™¨çš„å±æ€§\"><a href=\"#Flex-å®¹å™¨çš„å±æ€§\" class=\"headerlink\" title=\"Flex å®¹å™¨çš„å±æ€§\"></a>Flex å®¹å™¨çš„å±æ€§</h4><ul>\n<li><p>flex-direction<br>é¡¹ç›®æ’åˆ—åœ¨ä¸»è½´çš„æ–¹å‘ </p>\n  <figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.box</span> &#123;</span><br><span class=\"line\">\t<span class=\"attribute\">flex-direction</span>: row | row-reverse | column | column-reverse;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>row: é»˜è®¤å€¼, ä¸»è½´ä¸ºæ°´å¹³æ–¹å‘, èµ·ç‚¹ä¸ºå·¦è¾¹</li>\n<li>row-reverse: ä¸»è½´ä¸ºæ°´å¹³æ–¹å‘, èµ·ç‚¹ä¸ºå³è¾¹</li>\n<li>column: ä¸»è½´ä¸ºäº¤å‰è½´æ–¹å‘, èµ·ç‚¹åœ¨é¡¶éƒ¨</li>\n<li>column-reverse: ä¸»è½´ä¸ºäº¤å‰è½´æ–¹å‘, èµ·ç‚¹åœ¨åº•éƒ¨</li>\n</ul>\n</li>\n<li><p>flex-wrap<br>é¡¹ç›®åœ¨ä¸»è½´ä¸Šçš„æ¢è¡Œæ–¹å¼</p>\n  <figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.box</span> &#123;</span><br><span class=\"line\">\t<span class=\"attribute\">flex-wrap</span>: nowrap | wrap | wrap-reverse;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>nowrap: é»˜è®¤å€¼, ä¸æ¢è¡Œ</li>\n<li>wrap: æ¢è¡Œ, ç¬¬ä¸€è¡Œåœ¨ä¸Šé¢</li>\n<li>wrap-reverse: æ¢è¡Œ, ç¬¬ä¸€è¡Œåœ¨ä¸‹é¢</li>\n</ul>\n</li>\n<li><p>flex-flow<br>è¯¥å±æ€§ä¸º<code>flex-direction</code>å’Œ<code>flex-wrap</code>çš„ç¼©å†™, é»˜è®¤å€¼ä¸º<code>row nowrap</code></p>\n</li>\n</ul>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.box</span> &#123;</span><br><span class=\"line\">\t<span class=\"attribute\">flex-flow</span>: flex-direction || flex-wrap;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li><p>justify-content<br>é¡¹ç›®åœ¨ä¸»è½´ä¸Šçš„å¯¹é½æ–¹å¼, æ‰€ä»¥å®ƒçš„å¯¹é½æ–¹å¼è·Ÿè½´çš„æ–¹å‘æœ‰å…³</p>\n  <figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.box</span> &#123;</span><br><span class=\"line\">\t<span class=\"attribute\">justify-content</span>: flex-start | center | space-around | space-between | flex-end;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>flex-start: é»˜è®¤å€¼, å·¦å¯¹é½</li>\n<li>center: å±…ä¸­</li>\n<li>space-around: å·¦å³å±…ä¸­å¯¹é½, é¡¹ç›®ä¹‹é—´é—´éš”ä¸ºé¡¹ç›®ä¸è¾¹æ¡†çš„é—´éš”å¤§ä¸€å€</li>\n<li>space-between: ä¸¤ç«¯å¯¹é½</li>\n<li>flex-end: å³å¯¹é½ </li>\n</ul>\n</li>\n<li><p>align-items<br>é¡¹ç›®åœ¨äº¤å‰è½´åœ¨çš„å¯¹é½æ–¹å¼, ä¸äº¤å‰è½´æ–¹å‘æœ‰å…³</p>\n  <figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.box</span> &#123;</span><br><span class=\"line\">\t<span class=\"attribute\">align-items</span>: flex-start | center | baseline | stretch | flex-end;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>flex-start: äº¤å‰è½´èµ·ç‚¹å¯¹é½</li>\n<li>center: å±…ä¸­</li>\n<li>baseline: é¡¹ç›®ç¬¬ä¸€è¡Œæ–‡å­—åŸºçº¿å¯¹é½, ç±»ä¼¼åœ¨æ–‡å­—çš„ä¸‹åˆ’çº¿ä½ç½®</li>\n<li>stretch: é»˜è®¤å€¼, é¡¹ç›®æ²¡æœ‰é«˜åº¦æˆ–ä¸º<code>auto</code>æ—¶, å æ»¡æ•´ä¸ªå®¹å™¨</li>\n<li>flex-end: ç»ˆç‚¹å¯¹é½</li>\n</ul>\n</li>\n<li><p>align-content<br>å¤šæ ¹è½´çº¿å¯¹é½æ–¹å¼. å¦‚æœé¡¹ç›®åªæœ‰ä¸€æ ¹è½´çº¿, è¯¥å±æ€§åˆ™ä¸èµ·ä½œç”¨. è·Ÿ<code>align-items</code>å®¹æ˜“æ··æ·†, åŒºåˆ«åœ¨äº <code>align-content</code>é¡¹ç›®æœ‰å¤šè¡Œæ—¶èµ·ä½œç”¨, è€Œ<code>align-items</code>é¡¹ç›®å•è¡Œå°±å¯èµ·ä½œç”¨.</p>\n  <figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.box</span> &#123;</span><br><span class=\"line\">\t<span class=\"attribute\">align-content</span>: flex-start | center | space-around | space-between | stretch | flex-end;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>flex-start: äº¤å‰è½´å¯¹é½æ–¹å¼</li>\n<li>center: å±…ä¸­</li>\n<li>space-around: å·¦å³å±…ä¸­å¯¹é½</li>\n<li>space-between: ä¸¤ç«¯å¯¹é½</li>\n<li>stretch: é»˜è®¤å€¼, é¡¹ç›®è½´çº¿å æ»¡æ•´ä¸ªäº¤å‰è½´</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"Flex-é¡¹ç›®å±æ€§\"><a href=\"#Flex-é¡¹ç›®å±æ€§\" class=\"headerlink\" title=\"Flex é¡¹ç›®å±æ€§\"></a>Flex é¡¹ç›®å±æ€§</h4><ul>\n<li><p>order<br>å®šä¹‰é¡¹ç›®çš„æ’åˆ—é¡ºåº, æ•°å€¼è¶Šå°è¶Šé å‰, é»˜è®¤ä¸º0</p>\n  <figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.item</span> &#123;</span><br><span class=\"line\">\t<span class=\"attribute\">order</span>: &lt;number&gt;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>flex-grow<br>å®šä¹‰é¡¹ç›®çš„æ”¾å¤§æ¯”ä¾‹, é»˜è®¤ä¸º0(æœ‰å‰©ä½™ç©ºé—´ä¹Ÿä¸æ”¾å¤§). å¦‚æœæ‰€æœ‰é¡¹ç›®éƒ½ä¸º1, å®ƒä»¬å°†ç­‰åˆ†å‰©ä½™ç©ºé—´; å¦‚æœå…¶ä¸­ä¸€ä¸ªé¡¹ç›®ä¸º2, å…¶å®ƒé¡¹ç›®ä¸º1, é‚£ä¹ˆå±æ€§ä¸º2çš„é¡¹ç›®å æ®çš„å‰©ä½™ç©ºé—´å°†æ¯”å±æ€§ä¸º1çš„é¡¹ç›®å¤§ä¸€å€</p>\n  <figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.item</span> &#123;</span><br><span class=\"line\">\t<span class=\"attribute\">flex-grow</span>: &lt;number&gt;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>flex-shrink<br>å®šä¹‰é¡¹ç›®çš„ç¼©å°æ¯”ä¾‹, é»˜è®¤ä¸º1(å¦‚æœç©ºé—´ä¸è¶³, å°†ç¼©å°). å¦‚æœæ‰€æœ‰é¡¹ç›®éƒ½ä¸º1, å½“ç©ºé—´ä¸è¶³æ—¶, æ‰€æœ‰é¡¹ç›®éƒ½å°†ç­‰æ¯”ä¾‹ç¼©å°; å¦‚æœå…¶ä¸­ä¸€ä¸ªé¡¹ç›®ä¸º0, å…¶å®ƒé¡¹ç›®ä¸º1, é‚£ä¹ˆå½“ç©ºé—´ä¸è¶³æ—¶, å‰è€…å°†ä¸ç¼©å°</p>\n  <figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.item</span> &#123;</span><br><span class=\"line\">\t<span class=\"attribute\">flex-shrink</span>: &lt;number&gt;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>flex-basis<br>å®šä¹‰å±æ€§åœ¨åˆ†é…å¤šä½™ç©ºé—´ä¹‹å‰é¡¹ç›®å æ®çš„ä¸»è½´ç©ºé—´(main size). æµè§ˆå™¨ä¼šæ ¹æ®è¿™ä¸ªå±æ€§è®¡ç®—æ˜¯å¦æœ‰å¤šäºç©ºé—´. é»˜è®¤å€¼ä¸º auto(é¡¹ç›®æœ¬èº«çš„å¤§å°). å¦‚æœä¸ä½¿ç”¨<code>box-sizing</code>æ¥æ”¹å˜ç›’æ¨¡å‹çš„è¯, è¯¥å±æ€§å°†å†³å®šé¡¹ç›®çš„å†…å®¹ç›’(content-box)çš„å®½æˆ–è€…é«˜(å®½æˆ–é«˜å–å†³äºä¸»è½´çš„æ–¹å‘).</p>\n  <figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.item</span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">/* size çš„å•ä½å¯ä»¥ä¸º px/ em/rem ç™¾åˆ†æ¯”éƒ½è¡Œ(è´Ÿå€¼æ— æ•ˆ) */</span></span><br><span class=\"line\">\t<span class=\"attribute\">flex-basis</span>: &lt;size&gt; | &lt;content&gt;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>size: è·Ÿå®½é«˜è®¾ç½®ä¸€æ ·, ä¸å¤šè¯´.</li>\n<li>content: css3 çš„å‡ ä¸ª width æ–°å±æ€§. fill-available/ max-content/ min-content/ fit-content, å…¼å®¹æ€§ IE ä¸æ”¯æŒ.</li>\n</ul>\n</li>\n<li><p>flex<br>è¯¥å±æ€§ä¸º<code>flex-grow</code>/<code>flex-shrink</code>å’Œ<code>flex-basis</code>çš„ç¼©å†™, é»˜è®¤å€¼ä¸º <code>0 1 auto</code>, åä¸¤ä¸ªå±æ€§å¯é€‰</p>\n  <figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.item</span> &#123;</span><br><span class=\"line\">\t<span class=\"attribute\">flex</span>: none | flex-grow flex-shrink flex-basis</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>align-self<br>å…è®¸å•ä¸ªé¡¹ç›®ä¸å…¶ä»–é¡¹ç›®æœ‰ä¸åŒçš„å¯¹é½æ–¹å¼, å¯è¦†ç›–<code>align-items</code>å±æ€§, é»˜è®¤å€¼ä¸º auto, ç»§æ‰¿çˆ¶çº§å…ƒç´ çš„<code>align-items</code>å±æ€§, æ²¡æœ‰çš„è¯ç­‰åŒäº<code>stretch</code></p>\n  <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.item &#123;</span><br><span class=\"line\">\talign-self: auto | flex-start | center | stretch | baseline | flex-end;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>é™¤äº† <code>auto</code>ä»¥å¤–å…¶ä»–å±æ€§å€¼è·Ÿ<code>align-items</code>ä¸€æ ·å°±ä¸å†é‡å¤äº†.</p>\n<blockquote>\n<p>è¯´ä¸€ä¸‹ CSS3 width çš„å‡ ä¸ªæ–°å±æ€§<br>éœ€è¦å¸¦æœ‰ç§æœ‰å‰ç¼€  </p>\n</blockquote>\n<ul>\n<li>fill-available<br>è®©å…ƒç´ è‡ªåŠ¨100%å¾—å¡«å……çˆ¶çº§å®½åº¦, è®©å…ƒç´ è¡¨ç°å¾—åƒå—çº§å…ƒç´ ä¸€æ ·, <code>inline-block</code>çš„å…ƒç´ ä¹Ÿå¯ä»¥è‡ªåŠ¨å¡«å……, é¡ºä¾¿å†çˆ¶çº§åŠ ä¸€ä¸ª<code>line-height</code>è®©å…ƒç´ å‚ç›´å±…ä¸­.</li>\n<li>max-content<br>å®ƒçš„è¡¨ç°å°±åƒè®¾ç½®äº†<code>white-space:nowrap</code>ä¸€æ ·, å…ƒç´ çš„å®½åº¦å–å­å…ƒç´ ä¸­è¾ƒå¤§å®½åº¦çš„å®½åº¦</li>\n<li>min-content<br>å®ƒè¡¨ç¤ºçš„ä¸æ˜¯å­å…ƒç´ ä¸­å®½åº¦å°çš„é‚£ä¸ªå®½åº¦, è€Œæ˜¯å†…éƒ¨å…ƒç´ æœ€å°å®½åº¦å€¼æœ€å¤§çš„é‚£ä¸ªå…ƒç´ ä½œä¸ºæœ€ç»ˆå®½åº¦. æ¯”å¦‚: ä¸€ä¸ª<code>div</code>ä¸­, æœ‰ä¸€å¼ <code>img</code>çš„å®½åº¦ä¸º200px, æœ‰ä¸€ä¸ª<code>p</code>é‡Œé¢çš„æ–‡å­—å¯å¤šå¯å°‘é‡Œé¢æœ‰è‹±æ–‡(å¦‚æœæ–‡æœ¬å…¨æ˜¯ä¸­æ–‡, æœ€å°å®½åº¦å€¼å°±æ˜¯ä¸€ä¸ªä¸­æ–‡çš„å®½åº¦, å¦‚æœå¤¹æ‚è‹±æ–‡, ç”±äºè‹±æ–‡é»˜è®¤ä¸æ¢è¡Œ, æ‰€ä»¥æœ€å°å®½åº¦å€¼æ˜¯æœ€é•¿å•è¯çš„å®½åº¦), æ‰€ä»¥å‡è®¾è¿™é‡Œè‹±æ–‡çš„æœ€é•¿å•è¯ä¸è¶³200px, é‚£ä¹ˆæœ€ç»ˆçš„å…ƒç´ å®½åº¦å°±ä¸º200px</li>\n<li>fit-content<br>è®¾ç½®è¯¥å±æ€§å, ä¸éœ€è¦å›ºå®šå®½åº¦, åœ¨çˆ¶çº§å…ƒç´ <code>margin: 0 auto</code>å°±å¯ä»¥å®ç°æ°´å¹³å±…ä¸­äº†</li>\n</ul>\n<p>Created on 2017-11-23 By Cara</p>\n","site":{"data":{}},"excerpt":"","more":"<p>Flex æ˜¯ Flexible box çš„ç¼©å†™(å¼¹æ€§å¸ƒå±€), ç”¨æ¥ä¸ºç›’æ¨¡å‹æä¾›æœ€å¤§çµæ´»æ€§çš„å¸ƒå±€, æ›´ä¸ºæ–¹ä¾¿çš„å®ç°å“åº”å¼å¸ƒå±€.</p>\n<blockquote>\n<p>å¦‚ä½•ä½¿ç”¨ Flex<br>ä»»ä½•ä¸€ä¸ªå®¹å™¨éƒ½å¯ä»¥æŒ‡å®šä¸ºä¸€ä¸ª Flex å¸ƒå±€.  </p>\n</blockquote>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.box</span> &#123;</span><br><span class=\"line\">\t<span class=\"attribute\">display</span>: flex;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">/* è¡Œå†…å…ƒç´  */</span></span><br><span class=\"line\"><span class=\"selector-class\">.box</span>&#123;</span><br><span class=\"line\">\t<span class=\"attribute\">display</span>: inline-flex;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">/* å†…æ ¸ä¸º webkit çš„æµè§ˆå™¨ */</span></span><br><span class=\"line\"><span class=\"selector-class\">.box</span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">/* Safari */</span></span><br><span class=\"line\">\t<span class=\"attribute\">display</span>: -webkit-flex;</span><br><span class=\"line\">\t<span class=\"attribute\">display</span>: flex;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>è®¾å®š Flexå¸ƒå±€ä¹‹åçš„å­å…ƒç´ <code>float</code>/ <code>clear</code>/ <code>vertical-align</code>éƒ½å°†å¤±æ•ˆ.</p>\n<h4 id=\"åŸºæœ¬æ¦‚å¿µ\"><a href=\"#åŸºæœ¬æ¦‚å¿µ\" class=\"headerlink\" title=\"åŸºæœ¬æ¦‚å¿µ\"></a>åŸºæœ¬æ¦‚å¿µ</h4><p>æ‰€æœ‰é‡‡ç”¨ Flex å¸ƒå±€çš„çš„å…ƒç´ éƒ½ç§°ä¸º Flex å®¹å™¨, å®ƒçš„æ‰€æœ‰èµ„æºéƒ½ä¸º Flex å®¹å™¨çš„å®¹å™¨æˆå‘˜, æˆä¸º Flex é¡¹ç›®.<br>Flex å®¹å™¨éƒ½å­˜åœ¨ä¸¤æ ¹è½´: æ°´å¹³çš„ä¸»è½´(main axis)å’Œå‚ç›´çš„äº¤å‰è½´(cross axis), é¡¹ç›®é»˜è®¤æ²¿ä¸»è½´æ’åˆ—. æ¯ä¸ªé¡¹ç›®å ä¸»è½´çš„ç©ºé—´ç§°ä¸º<code>main size</code>, å äº¤å‰è½´çš„ç©ºé—´ç§°ä¸º<code>cross size</code>.</p>\n<h4 id=\"Flex-å®¹å™¨çš„å±æ€§\"><a href=\"#Flex-å®¹å™¨çš„å±æ€§\" class=\"headerlink\" title=\"Flex å®¹å™¨çš„å±æ€§\"></a>Flex å®¹å™¨çš„å±æ€§</h4><ul>\n<li><p>flex-direction<br>é¡¹ç›®æ’åˆ—åœ¨ä¸»è½´çš„æ–¹å‘ </p>\n  <figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.box</span> &#123;</span><br><span class=\"line\">\t<span class=\"attribute\">flex-direction</span>: row | row-reverse | column | column-reverse;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>row: é»˜è®¤å€¼, ä¸»è½´ä¸ºæ°´å¹³æ–¹å‘, èµ·ç‚¹ä¸ºå·¦è¾¹</li>\n<li>row-reverse: ä¸»è½´ä¸ºæ°´å¹³æ–¹å‘, èµ·ç‚¹ä¸ºå³è¾¹</li>\n<li>column: ä¸»è½´ä¸ºäº¤å‰è½´æ–¹å‘, èµ·ç‚¹åœ¨é¡¶éƒ¨</li>\n<li>column-reverse: ä¸»è½´ä¸ºäº¤å‰è½´æ–¹å‘, èµ·ç‚¹åœ¨åº•éƒ¨</li>\n</ul>\n</li>\n<li><p>flex-wrap<br>é¡¹ç›®åœ¨ä¸»è½´ä¸Šçš„æ¢è¡Œæ–¹å¼</p>\n  <figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.box</span> &#123;</span><br><span class=\"line\">\t<span class=\"attribute\">flex-wrap</span>: nowrap | wrap | wrap-reverse;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>nowrap: é»˜è®¤å€¼, ä¸æ¢è¡Œ</li>\n<li>wrap: æ¢è¡Œ, ç¬¬ä¸€è¡Œåœ¨ä¸Šé¢</li>\n<li>wrap-reverse: æ¢è¡Œ, ç¬¬ä¸€è¡Œåœ¨ä¸‹é¢</li>\n</ul>\n</li>\n<li><p>flex-flow<br>è¯¥å±æ€§ä¸º<code>flex-direction</code>å’Œ<code>flex-wrap</code>çš„ç¼©å†™, é»˜è®¤å€¼ä¸º<code>row nowrap</code></p>\n</li>\n</ul>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.box</span> &#123;</span><br><span class=\"line\">\t<span class=\"attribute\">flex-flow</span>: flex-direction || flex-wrap;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li><p>justify-content<br>é¡¹ç›®åœ¨ä¸»è½´ä¸Šçš„å¯¹é½æ–¹å¼, æ‰€ä»¥å®ƒçš„å¯¹é½æ–¹å¼è·Ÿè½´çš„æ–¹å‘æœ‰å…³</p>\n  <figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.box</span> &#123;</span><br><span class=\"line\">\t<span class=\"attribute\">justify-content</span>: flex-start | center | space-around | space-between | flex-end;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>flex-start: é»˜è®¤å€¼, å·¦å¯¹é½</li>\n<li>center: å±…ä¸­</li>\n<li>space-around: å·¦å³å±…ä¸­å¯¹é½, é¡¹ç›®ä¹‹é—´é—´éš”ä¸ºé¡¹ç›®ä¸è¾¹æ¡†çš„é—´éš”å¤§ä¸€å€</li>\n<li>space-between: ä¸¤ç«¯å¯¹é½</li>\n<li>flex-end: å³å¯¹é½ </li>\n</ul>\n</li>\n<li><p>align-items<br>é¡¹ç›®åœ¨äº¤å‰è½´åœ¨çš„å¯¹é½æ–¹å¼, ä¸äº¤å‰è½´æ–¹å‘æœ‰å…³</p>\n  <figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.box</span> &#123;</span><br><span class=\"line\">\t<span class=\"attribute\">align-items</span>: flex-start | center | baseline | stretch | flex-end;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>flex-start: äº¤å‰è½´èµ·ç‚¹å¯¹é½</li>\n<li>center: å±…ä¸­</li>\n<li>baseline: é¡¹ç›®ç¬¬ä¸€è¡Œæ–‡å­—åŸºçº¿å¯¹é½, ç±»ä¼¼åœ¨æ–‡å­—çš„ä¸‹åˆ’çº¿ä½ç½®</li>\n<li>stretch: é»˜è®¤å€¼, é¡¹ç›®æ²¡æœ‰é«˜åº¦æˆ–ä¸º<code>auto</code>æ—¶, å æ»¡æ•´ä¸ªå®¹å™¨</li>\n<li>flex-end: ç»ˆç‚¹å¯¹é½</li>\n</ul>\n</li>\n<li><p>align-content<br>å¤šæ ¹è½´çº¿å¯¹é½æ–¹å¼. å¦‚æœé¡¹ç›®åªæœ‰ä¸€æ ¹è½´çº¿, è¯¥å±æ€§åˆ™ä¸èµ·ä½œç”¨. è·Ÿ<code>align-items</code>å®¹æ˜“æ··æ·†, åŒºåˆ«åœ¨äº <code>align-content</code>é¡¹ç›®æœ‰å¤šè¡Œæ—¶èµ·ä½œç”¨, è€Œ<code>align-items</code>é¡¹ç›®å•è¡Œå°±å¯èµ·ä½œç”¨.</p>\n  <figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.box</span> &#123;</span><br><span class=\"line\">\t<span class=\"attribute\">align-content</span>: flex-start | center | space-around | space-between | stretch | flex-end;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>flex-start: äº¤å‰è½´å¯¹é½æ–¹å¼</li>\n<li>center: å±…ä¸­</li>\n<li>space-around: å·¦å³å±…ä¸­å¯¹é½</li>\n<li>space-between: ä¸¤ç«¯å¯¹é½</li>\n<li>stretch: é»˜è®¤å€¼, é¡¹ç›®è½´çº¿å æ»¡æ•´ä¸ªäº¤å‰è½´</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"Flex-é¡¹ç›®å±æ€§\"><a href=\"#Flex-é¡¹ç›®å±æ€§\" class=\"headerlink\" title=\"Flex é¡¹ç›®å±æ€§\"></a>Flex é¡¹ç›®å±æ€§</h4><ul>\n<li><p>order<br>å®šä¹‰é¡¹ç›®çš„æ’åˆ—é¡ºåº, æ•°å€¼è¶Šå°è¶Šé å‰, é»˜è®¤ä¸º0</p>\n  <figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.item</span> &#123;</span><br><span class=\"line\">\t<span class=\"attribute\">order</span>: &lt;number&gt;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>flex-grow<br>å®šä¹‰é¡¹ç›®çš„æ”¾å¤§æ¯”ä¾‹, é»˜è®¤ä¸º0(æœ‰å‰©ä½™ç©ºé—´ä¹Ÿä¸æ”¾å¤§). å¦‚æœæ‰€æœ‰é¡¹ç›®éƒ½ä¸º1, å®ƒä»¬å°†ç­‰åˆ†å‰©ä½™ç©ºé—´; å¦‚æœå…¶ä¸­ä¸€ä¸ªé¡¹ç›®ä¸º2, å…¶å®ƒé¡¹ç›®ä¸º1, é‚£ä¹ˆå±æ€§ä¸º2çš„é¡¹ç›®å æ®çš„å‰©ä½™ç©ºé—´å°†æ¯”å±æ€§ä¸º1çš„é¡¹ç›®å¤§ä¸€å€</p>\n  <figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.item</span> &#123;</span><br><span class=\"line\">\t<span class=\"attribute\">flex-grow</span>: &lt;number&gt;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>flex-shrink<br>å®šä¹‰é¡¹ç›®çš„ç¼©å°æ¯”ä¾‹, é»˜è®¤ä¸º1(å¦‚æœç©ºé—´ä¸è¶³, å°†ç¼©å°). å¦‚æœæ‰€æœ‰é¡¹ç›®éƒ½ä¸º1, å½“ç©ºé—´ä¸è¶³æ—¶, æ‰€æœ‰é¡¹ç›®éƒ½å°†ç­‰æ¯”ä¾‹ç¼©å°; å¦‚æœå…¶ä¸­ä¸€ä¸ªé¡¹ç›®ä¸º0, å…¶å®ƒé¡¹ç›®ä¸º1, é‚£ä¹ˆå½“ç©ºé—´ä¸è¶³æ—¶, å‰è€…å°†ä¸ç¼©å°</p>\n  <figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.item</span> &#123;</span><br><span class=\"line\">\t<span class=\"attribute\">flex-shrink</span>: &lt;number&gt;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>flex-basis<br>å®šä¹‰å±æ€§åœ¨åˆ†é…å¤šä½™ç©ºé—´ä¹‹å‰é¡¹ç›®å æ®çš„ä¸»è½´ç©ºé—´(main size). æµè§ˆå™¨ä¼šæ ¹æ®è¿™ä¸ªå±æ€§è®¡ç®—æ˜¯å¦æœ‰å¤šäºç©ºé—´. é»˜è®¤å€¼ä¸º auto(é¡¹ç›®æœ¬èº«çš„å¤§å°). å¦‚æœä¸ä½¿ç”¨<code>box-sizing</code>æ¥æ”¹å˜ç›’æ¨¡å‹çš„è¯, è¯¥å±æ€§å°†å†³å®šé¡¹ç›®çš„å†…å®¹ç›’(content-box)çš„å®½æˆ–è€…é«˜(å®½æˆ–é«˜å–å†³äºä¸»è½´çš„æ–¹å‘).</p>\n  <figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.item</span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">/* size çš„å•ä½å¯ä»¥ä¸º px/ em/rem ç™¾åˆ†æ¯”éƒ½è¡Œ(è´Ÿå€¼æ— æ•ˆ) */</span></span><br><span class=\"line\">\t<span class=\"attribute\">flex-basis</span>: &lt;size&gt; | &lt;content&gt;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>size: è·Ÿå®½é«˜è®¾ç½®ä¸€æ ·, ä¸å¤šè¯´.</li>\n<li>content: css3 çš„å‡ ä¸ª width æ–°å±æ€§. fill-available/ max-content/ min-content/ fit-content, å…¼å®¹æ€§ IE ä¸æ”¯æŒ.</li>\n</ul>\n</li>\n<li><p>flex<br>è¯¥å±æ€§ä¸º<code>flex-grow</code>/<code>flex-shrink</code>å’Œ<code>flex-basis</code>çš„ç¼©å†™, é»˜è®¤å€¼ä¸º <code>0 1 auto</code>, åä¸¤ä¸ªå±æ€§å¯é€‰</p>\n  <figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.item</span> &#123;</span><br><span class=\"line\">\t<span class=\"attribute\">flex</span>: none | flex-grow flex-shrink flex-basis</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>align-self<br>å…è®¸å•ä¸ªé¡¹ç›®ä¸å…¶ä»–é¡¹ç›®æœ‰ä¸åŒçš„å¯¹é½æ–¹å¼, å¯è¦†ç›–<code>align-items</code>å±æ€§, é»˜è®¤å€¼ä¸º auto, ç»§æ‰¿çˆ¶çº§å…ƒç´ çš„<code>align-items</code>å±æ€§, æ²¡æœ‰çš„è¯ç­‰åŒäº<code>stretch</code></p>\n  <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.item &#123;</span><br><span class=\"line\">\talign-self: auto | flex-start | center | stretch | baseline | flex-end;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>é™¤äº† <code>auto</code>ä»¥å¤–å…¶ä»–å±æ€§å€¼è·Ÿ<code>align-items</code>ä¸€æ ·å°±ä¸å†é‡å¤äº†.</p>\n<blockquote>\n<p>è¯´ä¸€ä¸‹ CSS3 width çš„å‡ ä¸ªæ–°å±æ€§<br>éœ€è¦å¸¦æœ‰ç§æœ‰å‰ç¼€  </p>\n</blockquote>\n<ul>\n<li>fill-available<br>è®©å…ƒç´ è‡ªåŠ¨100%å¾—å¡«å……çˆ¶çº§å®½åº¦, è®©å…ƒç´ è¡¨ç°å¾—åƒå—çº§å…ƒç´ ä¸€æ ·, <code>inline-block</code>çš„å…ƒç´ ä¹Ÿå¯ä»¥è‡ªåŠ¨å¡«å……, é¡ºä¾¿å†çˆ¶çº§åŠ ä¸€ä¸ª<code>line-height</code>è®©å…ƒç´ å‚ç›´å±…ä¸­.</li>\n<li>max-content<br>å®ƒçš„è¡¨ç°å°±åƒè®¾ç½®äº†<code>white-space:nowrap</code>ä¸€æ ·, å…ƒç´ çš„å®½åº¦å–å­å…ƒç´ ä¸­è¾ƒå¤§å®½åº¦çš„å®½åº¦</li>\n<li>min-content<br>å®ƒè¡¨ç¤ºçš„ä¸æ˜¯å­å…ƒç´ ä¸­å®½åº¦å°çš„é‚£ä¸ªå®½åº¦, è€Œæ˜¯å†…éƒ¨å…ƒç´ æœ€å°å®½åº¦å€¼æœ€å¤§çš„é‚£ä¸ªå…ƒç´ ä½œä¸ºæœ€ç»ˆå®½åº¦. æ¯”å¦‚: ä¸€ä¸ª<code>div</code>ä¸­, æœ‰ä¸€å¼ <code>img</code>çš„å®½åº¦ä¸º200px, æœ‰ä¸€ä¸ª<code>p</code>é‡Œé¢çš„æ–‡å­—å¯å¤šå¯å°‘é‡Œé¢æœ‰è‹±æ–‡(å¦‚æœæ–‡æœ¬å…¨æ˜¯ä¸­æ–‡, æœ€å°å®½åº¦å€¼å°±æ˜¯ä¸€ä¸ªä¸­æ–‡çš„å®½åº¦, å¦‚æœå¤¹æ‚è‹±æ–‡, ç”±äºè‹±æ–‡é»˜è®¤ä¸æ¢è¡Œ, æ‰€ä»¥æœ€å°å®½åº¦å€¼æ˜¯æœ€é•¿å•è¯çš„å®½åº¦), æ‰€ä»¥å‡è®¾è¿™é‡Œè‹±æ–‡çš„æœ€é•¿å•è¯ä¸è¶³200px, é‚£ä¹ˆæœ€ç»ˆçš„å…ƒç´ å®½åº¦å°±ä¸º200px</li>\n<li>fit-content<br>è®¾ç½®è¯¥å±æ€§å, ä¸éœ€è¦å›ºå®šå®½åº¦, åœ¨çˆ¶çº§å…ƒç´ <code>margin: 0 auto</code>å°±å¯ä»¥å®ç°æ°´å¹³å±…ä¸­äº†</li>\n</ul>\n<p>Created on 2017-11-23 By Cara</p>\n"},{"title":"ã€Šå›¾è§£ HTTPã€‹(ä¸Š)","date":"2018-01-03T14:03:05.000Z","_content":"Webä½¿ç”¨HTTP(HyperText Transfer Protocal) è¶…æ–‡æœ¬ä¼ è¾“åè®®ä½œä¸ºè§„èŒƒ, å®Œæˆä»å®¢æˆ·ç«¯åˆ°æœåŠ¡ç«¯çš„ä¸€ç³»åˆ—æµç¨‹. å¯ä»¥è¯´ Web æ˜¯åœ¨ HTTP åè®®ä¸Šé€šä¿¡çš„.\n\n### 1.0 ç½‘ç»œåŸºç¡€TCP/IP\né€šå¸¸æˆ‘ä»¬ä½¿ç”¨çš„ç½‘ç»œæ˜¯åœ¨ TCP/IP åè®®æ—çš„åŸºç¡€ä¸Šè¿è¡Œçš„, è€Œ HTTP æ˜¯å±äº TCP/IP æ—ç¾¤ä¸­çš„ä¸€ç§åè®®. åœ¨è®¡ç®—æœºå’Œç½‘ç»œç›¸äº’é€šä¿¡çš„æ—¶å€™, ä¸¤è€…éƒ½å¿…é¡»è¦éµå®ˆåŒä¸€ç§åè®®.\n\n#### 1.1 TCP/ IPåˆ†å±‚ç®¡ç†\nTCP/IPåè®®æ—é‡Œæœ€é‡è¦çš„ä¸€ç‚¹å°±æ˜¯åˆ†å±‚, æ¯ä¸€å±‚å°±åªéœ€è¦ä¸“æ³¨äºè‡ªå·±ä»»åŠ¡å°±è¡Œäº†, æŒ‰å±‚æ¬¡åˆ†åˆ«ä¸ºä»¥ä¸‹å››å±‚:\n\n1. åº”ç”¨å±‚\nå†³å®šå‘ç”¨æˆ·æä¾›åº”ç”¨æœåŠ¡æ—¶çš„é€šä¿¡æ´»åŠ¨, åœ¨ TCP/IP ä¸­é¢„å­˜äº†å„ç±»é€šç”¨çš„åº”ç”¨æœåŠ¡. æ¯”å¦‚: FTP(File Transfer Protocol, æ–‡ä»¶ä¼ è¾“åè®®)å’Œ DNS(Domain Name System, åŸŸåç³»ç»Ÿ), HTTP åè®®ä¹Ÿå±äºè¿™å±‚.\n\n2. ä¼ è¾“å±‚\nç»™ä¸¤ä¸ªè®¡ç®—æœºåœ¨ç½‘ç»œä¸­æä¾›æ•°æ®ä¼ è¾“. TCP(ä¼ è¾“æ§åˆ¶åè®®)å’Œ UDP(ç”¨æˆ·æ•°æ®æŠ¥åè®®)\n\n3. ç½‘ç»œå±‚\nå¤„ç†ç½‘ä¸ŠæµåŠ¨çš„æ•°æ®åŒ…, å†³å®šæ•°æ®é€šè¿‡å“ªæ¡ä¼ è¾“è·¯çº¿åˆ°å¯¹æ–¹è®¡ç®—æœºå¹¶æŠŠæ•°æ®ä¼ è¾“ç»™å¯¹æ–¹.\n\n4. é“¾è·¯å±‚\nå¤„ç†è¿æ¥ç½‘ç»œçš„ç¡¬ä»¶éƒ¨åˆ†. ç½‘å¡/ é©±åŠ¨/ å…‰çº¤ä»€ä¹ˆçš„\n\n#### 1.2 TCP/IP ä¼ è¾“æµç¨‹\nTCP/IP åœ¨ç½‘ç»œé€šä¿¡æ—¶, ä¼šæŒ‰ç…§åˆ†å±‚é¡ºåºä¸å¯¹æ–¹é€šä¿¡. å‘é€ç«¯ä»åº”ç”¨å±‚å¾€ä¸‹, æ¥æ”¶ç«¯ä»åº”ç”¨ç«¯ç½‘ä¸Š.\n\n![TCP/IPä¼ è¾“æµç¨‹](/img/http.jpg)\n\n### 2.0 ä¸ HTTP å…³ç³»å¯†åˆ‡çš„åè®®: IP/TCP å’Œ DNS\n\n- è´Ÿè´£ä¼ è¾“çš„ IP åè®®\nå°†æ•°æ®åŒ…ä¼ é€’ç»™å¯¹æ–¹å¹¶ç¡®è®¤åˆ°è¾¾, ç¡®è®¤åˆ°è¾¾çš„é‡è¦æ¡ä»¶åŒ…æ‹¬: IP åœ°å€å’Œ MAC åœ°å€.\n![IP](/img/ip.jpg)\n- ç¡®ä¿å¯é æ€§çš„ TCP åè®®\nä¸ºäº†æ–¹ä¾¿ä¼ è¾“å°†å¤§æ•°æ®åŒ…åˆ†å‰²æˆä»¥æŠ¥æ–‡æ®µä¸ºå•ä½çš„æ•°æ®åŒ…è¿›è¡Œç®¡ç†, å†å°†æ•°æ®å‡†ç¡®å¯é çš„ä¼ é€’ç»™å¯¹æ–¹. é‚£ä¹ˆå¦‚ä½•å‡†ç¡®å¯é çš„ä¼ é€’ç»™å¯¹æ–¹å‘¢, æ‰€ä»¥å°±æœ‰äº†TCP çš„ä¸‰æ¬¡æ¡æ‰‹ç­–ç•¥: å‘é€ç«¯å…ˆå‘é€ä¸€ä¸ªå¸¦æœ‰ `SYN`æ ‡å¿—çš„æ•°æ®åŒ…ç»™å¯¹æ–¹, æ¥æ”¶ç«¯å›ä¼ ä¸€ä¸ªå¸¦æœ‰`SYN/ACK`æ ‡å¿—çš„æ•°æ®åŒ…ä¼ è¾¾ç¡®è®¤ä¿¡æ¯, æœ€åå‘é€ç«¯å†å›ä¼ ä¸€ä¸ªå¸¦æœ‰`ACK`æ ‡å¿—çš„æ•°æ®åŒ…, ä»£è¡¨æ¡æ‰‹ç»“æŸ.\n![TCP](/img/tcp.jpg)\n- è´Ÿè´£åŸŸååè®®çš„ DNS æœåŠ¡\næä¾›åŸŸååˆ° IP åœ°å€ä¹‹é—´è§£ææœåŠ¡.\n![DNS](/img/dns.jpg)\n\n#### 2.1 HTTP åè®®çš„é€šä¿¡è¿‡ç¨‹\né€šè¿‡ä¸€æ•´å¥—æµç¨‹æ¥çœ‹ä¸€ä¸‹, IPåè®®/ TCPåè®® å’Œ DNSæœåŠ¡åœ¨ HTTPåè®®çš„é€šä¿¡è¿‡ç¨‹ä¸­å„è‡ªå‘æŒ¥äº†ä»€ä¹ˆä½œç”¨.\n![HTTPåè®®é€šä¿¡è¿‡ç¨‹](/img/HTTP_IP_TCP_DNS.jpg)\n\n**ä»ä¸Šå›¾æ¥çœ‹, ä»è¾“å…¥ä¸€ä¸ªç½‘å€åˆ°é¡µé¢çš„å±•ç¤ºè¿‡ç¨‹å¤§è‡´å¦‚ä¸‹:**\n1. åŸŸåè§£æ(DNS æœåŠ¡)\n2. å»ºç«‹TCP, å‘é€ HTTP è¯·æ±‚(ä¸‰æ¬¡æ¡æ‰‹)\n    1. å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€è¯·æ±‚(SYN)\n    2. æœåŠ¡å™¨åº”ç­”å¹¶è¦æ±‚ç¡®è®¤(SYN/ACK)\n    3. å®¢æˆ·ç«¯ç¡®è®¤(ACK)\n3. IP æœç´¢å¯¹æ–¹åœ°å€, ä¸€è¾¹ä¸­è½¬ä¸€è¾¹ä¼ è¾“æ•°æ®åŒ…\n4. æœåŠ¡å™¨å¤„ç†è¯·æ±‚è¿”å› HTTP å“åº”æŠ¥æ–‡\n5. è¿æ¥ç»“æŸ(å››æ¬¡æŒ¥æ‰‹)\n    1. å®¢æˆ·ç«¯å‘é€ä¸€ä¸ª FIN æ¥å‘Šè¯‰æœåŠ¡å™¨æ•°æ®å‘é€å®Œæ¯•\n    2. æœåŠ¡å™¨æ”¶åˆ°è¿™ä¸ª FIN ä¹‹åå›å‘ä¸€ä¸ª ACK(è¿™ä¸ªæ—¶å€™æœåŠ¡å™¨è¿˜å¯ä»¥å‘å®¢æˆ·ç«¯å‘é€æ•°æ®)\n    3. æœåŠ¡å™¨å‘é€ä¸€ä¸ª FIN å‘Šè¯‰å®¢æˆ·ç«¯æœåŠ¡å™¨çš„æ•°æ®å‘é€å®Œæ¯•, è¯·æ±‚å…³é—­è¿æ¥\n    4. å®¢æˆ·ç«¯å›å‘ ACK ç¡®è®¤, å…³é—­è¿æ¥\n6. æµè§ˆå™¨è§£ææ¸²æŸ“é¡µé¢\n\n#### 2.2 HTTP æ˜¯å¦ä¿å­˜çŠ¶æ€\nHTTP æ˜¯ä¸€ç§ä¸ä¿å­˜çŠ¶æ€(æ— çŠ¶æ€)åè®®, åè®®æœ¬èº«ä¸ä¼šä¿ç•™ä¹‹å‰çš„è¯·æ±‚æˆ–å“åº”æŠ¥æ–‡çš„ä¿¡æ¯. è¿™æ˜¯ä¸ºäº†æ›´å¿«çš„å¤„ç†å¤§é‡è¯·æ±‚, ä½†æ˜¯éšç€ Web å‘å±•\nå¾ˆå¤šä¸šåŠ¡éƒ½éœ€è¦ä¿å­˜ç”¨æˆ·çš„çŠ¶æ€, å› æ­¤å¼•å…¥ Cookie æ¥ç®¡ç†çŠ¶æ€.\n\n### 3.0 HTTP è¿”å›çŠ¶æ€ç \nçŠ¶æ€ç æ˜¯ç”¨æ¥å‘Šè¯‰å®¢æˆ·ç«¯ä»æœåŠ¡å™¨å“åº”çš„è¯·æ±‚ç»“æœ, å¯ä»¥é€šè¿‡çŠ¶æ€ç çŸ¥é“è¯¥æ¬¡è¯·æ±‚æ˜¯æ­£å¸¸å¤„ç†äº†è¿˜æ˜¯å‘ç”Ÿäº†é”™è¯¯.\n\n#### 3.1 çŠ¶æ€ç çš„ç±»åˆ«\n\n| | ç±»åˆ« | åŸå› çŸ­å¥ |\n| -- |:----- |:-----|\n| 1XX | ä¿¡æ¯ç±» | æ¥æ”¶çš„è¯·æ±‚æ­£åœ¨å¤„ç† |\n| 2XX | æˆåŠŸç±» | è¯·æ±‚æ­£å¸¸å¤„ç†å®Œæ¯• |\n| 3XX | é‡å®šå‘ç±» | éœ€è¦é™„åŠ æ“ä½œå®Œæˆè¯·æ±‚ |\n| 4XX | å®¢æˆ·ç«¯é”™è¯¯ç±» | æœåŠ¡å™¨æ— æ³•å¤„ç†è¯·æ±‚ |\n| 5XX | æœåŠ¡å™¨é”™è¯¯ç±» | æœåŠ¡å™¨å‘ç”Ÿé”™è¯¯ |\n\n#### 3.2 å…·æœ‰ä»£è¡¨æ€§çš„14ç§çŠ¶æ€ç \n\n- 2XX æˆåŠŸç±»\n\t1.  200 OK\n\tè¡¨ç¤ºè¯·æ±‚åœ¨æœåŠ¡ç«¯è¢«æ­£å¸¸å¤„ç†äº†\n\t2. 204  No Content\n\tè¡¨ç¤ºè¯·æ±‚å¤„ç†æˆåŠŸä½†æ˜¯å“åº”æŠ¥æ–‡ä¸åŒ…å«å®ä½“çš„ä¸»ä½“(æœ¬èº«ä¹Ÿä¸å…è®¸è¿”å›å®ä½“çš„ä¸»ä½“)\n\t3. 206  Partial Content\n\tæœåŠ¡ç«¯æˆåŠŸå¤„ç†äº†å®¢æˆ·ç«¯å‘å‡ºçš„èŒƒå›´è¯·æ±‚\n- 3XX é‡å®šå‘\n\t1. 301 Moved Permanently\n\tæ°¸ä¹…æ€§é‡å®šå‘. è¯·æ±‚çš„èµ„æºå·²ç»è¢«åˆ†é…äº†æ–°çš„ URI åº”è¯¥ä½¿ç”¨æ–°çš„ URI\n\t2. 302 Found\n\tä¸´æ—¶æ€§é‡å®šå‘. è¯·æ±‚çš„èµ„æºè¢«åˆ†é…äº†æ–°çš„ URI, å¸Œæœ›æœ¬æ¬¡è¯·æ±‚ç”¨æ–°çš„ URI\n\t3. 303 See Other\n\tè¯·æ±‚çš„èµ„æºå­˜åœ¨å¦ä¸€ä¸ª URI, åº”ä½¿ç”¨ GET æ–¹æ³•å®šå‘è·å–è¯·æ±‚çš„èµ„æº(è·Ÿ302çš„åŠŸèƒ½ç›¸åŒ)\n\t4. 304 Not Modified\n\tè¡¨ç¤ºè¯·æ±‚æ—¶é™„å¸¦äº†æ¡ä»¶, æœåŠ¡ç«¯å…è®¸è¯·æ±‚èµ„æºä½†ä¸ºæ»¡è¶³æ¡ä»¶. æ‰€ä»¥è¿”å›æ—¶, ä¸åŒ…å«ä»»ä½•å“åº”çš„ä¸»ä½“éƒ¨åˆ†(è·Ÿé‡å®šå‘å¹¶æ²¡æœ‰åŠæ¯›é’±å…³ç³»).\n\t5. 307 Temporary Redirect\n\tä¸´æ—¶é‡å®šå‘, è·Ÿ302æœ‰ç€åŒæ ·çš„ä¸€æ ·. å°½ç®¡302æ ‡å‡†ä¸å…è®¸ POST å˜ä¸º GET, ä½†æ˜¯å¹¶æ²¡æœ‰äººéµå®ˆ; 307ä¼šéµå®ˆæ ‡å‡†ä½†æ˜¯å¤„ç†å“åº”æ—¶, æ¯ä¸ªæµè§ˆå™¨æœ‰å¯èƒ½å‡ºç°ä¸åŒçš„æƒ…å†µ\n- 4XX å®¢æˆ·ç«¯é”™è¯¯\n\t1. 400 Bad Request\n\tè¯·æ±‚æŠ¥æ–‡ä¸­æœ‰è¯­æ³•é”™è¯¯\n\t2. 401 Unauthorized\n\tè¯·æ±‚éœ€è¦é€šè¿‡ HTTP è®¤è¯\n\t3. 403 Forbidden\n\tè¯·æ±‚èµ„æºè®¿é—®è¢«æœåŠ¡ç«¯æ‹’ç»(ä¸€èˆ¬éƒ½æ˜¯æƒé™é—®é¢˜)\n\t4. 404 Not Found\n\tæœåŠ¡ç«¯ä¸Šæ— æ³•æ‰¾åˆ°è¯·æ±‚çš„èµ„æº\n\t5. 405 Not Allow\n\tå¯¹äºè¯·æ±‚çš„èµ„æº, æœåŠ¡ç«¯ä¸å…è®¸ä½¿ç”¨è¯·æ±‚ä¸­ä½¿ç”¨çš„æ–¹æ³•\n- 5XX æœåŠ¡å™¨é”™è¯¯\n\t1. 500 Internal Server Error\n\tæœåŠ¡ç«¯åœ¨æ‰§è¡Œè¯·æ±‚ä»»åŠ¡æ—¶å‘ç”Ÿé”™è¯¯\n\t2. 503 Service Unavailable\n\tæœåŠ¡ç«¯æš‚æ—¶å¤„äºè¶…è´Ÿè½½æˆ–è€…åœæœºç»´æŠ¤, æ— æ³•å¤„ç†è¯·æ±‚(ä¸€èˆ¬å°±æ˜¯æœåŠ¡å™¨æŒ‚äº†)\n\n#### æ€»ç»“\nä¸»è¦ä¸ºäº†å¤§è‡´äº†è§£ä¸€ä¸‹ HTTP çš„åŸºç¡€/å¤§æ¦‚çš„æ‰§è¡Œæµç¨‹å’Œå¸¸è§çš„HTTP çŠ¶æ€ç . å¯¹äºçŠ¶æ€ç ä¹‹å‰ä¸€ç›´åˆ†ä¸å¤ªæ¸…301å’Œ302çš„åŒºåˆ«, ç®€å•çš„æ¥è¯´: 301 æ”¹å˜èµ„æºçš„URI å, å¦‚æœè¿™ä¸ªèµ„æºæ˜¯è¢«ä¿å­˜åœ¨ä¹¦ç­¾ä¸­çš„, é‚£ä¹ˆè¿™æ—¶è¦æ ¹æ®æ–°çš„ URI ä¿å­˜; 302 è¡¨ç¤ºè¿™ä¸ªèµ„æºåªæ˜¯ä¸´æ—¶æ€§çš„ç§»åŠ¨, ä¹‹åè¿™ä¸ª URI å¯èƒ½è¿˜ä¼šå˜åŒ–. é‚£ä¹ˆå¦‚æœä¹Ÿè¢«ä¿å­˜åœ¨äº†ä¹¦ç­¾ä¸­, ä»ç„¶ä¼šä¿ç•™åŸæ¥çš„ URI. çŠ¶æ€ç ä¸­çš„ 304 æ”¾åœ¨ä¸‹æ¬¡æ”¾åœ¨ç¼“å­˜ç­–ç•¥ä¸­å†æ‹ä¸€æ‹å§.\n\nCreate on 2018-1-3 By Cara","source":"_posts/HTTP-ä¸Š.md","raw":"---\ntitle: ã€Šå›¾è§£ HTTPã€‹(ä¸Š)\ndate: 2018-01-03 22:03:05\ntags:\n- HTTP\ncategories:\n- ç¬”è®°ğŸ“’\n---\nWebä½¿ç”¨HTTP(HyperText Transfer Protocal) è¶…æ–‡æœ¬ä¼ è¾“åè®®ä½œä¸ºè§„èŒƒ, å®Œæˆä»å®¢æˆ·ç«¯åˆ°æœåŠ¡ç«¯çš„ä¸€ç³»åˆ—æµç¨‹. å¯ä»¥è¯´ Web æ˜¯åœ¨ HTTP åè®®ä¸Šé€šä¿¡çš„.\n\n### 1.0 ç½‘ç»œåŸºç¡€TCP/IP\né€šå¸¸æˆ‘ä»¬ä½¿ç”¨çš„ç½‘ç»œæ˜¯åœ¨ TCP/IP åè®®æ—çš„åŸºç¡€ä¸Šè¿è¡Œçš„, è€Œ HTTP æ˜¯å±äº TCP/IP æ—ç¾¤ä¸­çš„ä¸€ç§åè®®. åœ¨è®¡ç®—æœºå’Œç½‘ç»œç›¸äº’é€šä¿¡çš„æ—¶å€™, ä¸¤è€…éƒ½å¿…é¡»è¦éµå®ˆåŒä¸€ç§åè®®.\n\n#### 1.1 TCP/ IPåˆ†å±‚ç®¡ç†\nTCP/IPåè®®æ—é‡Œæœ€é‡è¦çš„ä¸€ç‚¹å°±æ˜¯åˆ†å±‚, æ¯ä¸€å±‚å°±åªéœ€è¦ä¸“æ³¨äºè‡ªå·±ä»»åŠ¡å°±è¡Œäº†, æŒ‰å±‚æ¬¡åˆ†åˆ«ä¸ºä»¥ä¸‹å››å±‚:\n\n1. åº”ç”¨å±‚\nå†³å®šå‘ç”¨æˆ·æä¾›åº”ç”¨æœåŠ¡æ—¶çš„é€šä¿¡æ´»åŠ¨, åœ¨ TCP/IP ä¸­é¢„å­˜äº†å„ç±»é€šç”¨çš„åº”ç”¨æœåŠ¡. æ¯”å¦‚: FTP(File Transfer Protocol, æ–‡ä»¶ä¼ è¾“åè®®)å’Œ DNS(Domain Name System, åŸŸåç³»ç»Ÿ), HTTP åè®®ä¹Ÿå±äºè¿™å±‚.\n\n2. ä¼ è¾“å±‚\nç»™ä¸¤ä¸ªè®¡ç®—æœºåœ¨ç½‘ç»œä¸­æä¾›æ•°æ®ä¼ è¾“. TCP(ä¼ è¾“æ§åˆ¶åè®®)å’Œ UDP(ç”¨æˆ·æ•°æ®æŠ¥åè®®)\n\n3. ç½‘ç»œå±‚\nå¤„ç†ç½‘ä¸ŠæµåŠ¨çš„æ•°æ®åŒ…, å†³å®šæ•°æ®é€šè¿‡å“ªæ¡ä¼ è¾“è·¯çº¿åˆ°å¯¹æ–¹è®¡ç®—æœºå¹¶æŠŠæ•°æ®ä¼ è¾“ç»™å¯¹æ–¹.\n\n4. é“¾è·¯å±‚\nå¤„ç†è¿æ¥ç½‘ç»œçš„ç¡¬ä»¶éƒ¨åˆ†. ç½‘å¡/ é©±åŠ¨/ å…‰çº¤ä»€ä¹ˆçš„\n\n#### 1.2 TCP/IP ä¼ è¾“æµç¨‹\nTCP/IP åœ¨ç½‘ç»œé€šä¿¡æ—¶, ä¼šæŒ‰ç…§åˆ†å±‚é¡ºåºä¸å¯¹æ–¹é€šä¿¡. å‘é€ç«¯ä»åº”ç”¨å±‚å¾€ä¸‹, æ¥æ”¶ç«¯ä»åº”ç”¨ç«¯ç½‘ä¸Š.\n\n![TCP/IPä¼ è¾“æµç¨‹](/img/http.jpg)\n\n### 2.0 ä¸ HTTP å…³ç³»å¯†åˆ‡çš„åè®®: IP/TCP å’Œ DNS\n\n- è´Ÿè´£ä¼ è¾“çš„ IP åè®®\nå°†æ•°æ®åŒ…ä¼ é€’ç»™å¯¹æ–¹å¹¶ç¡®è®¤åˆ°è¾¾, ç¡®è®¤åˆ°è¾¾çš„é‡è¦æ¡ä»¶åŒ…æ‹¬: IP åœ°å€å’Œ MAC åœ°å€.\n![IP](/img/ip.jpg)\n- ç¡®ä¿å¯é æ€§çš„ TCP åè®®\nä¸ºäº†æ–¹ä¾¿ä¼ è¾“å°†å¤§æ•°æ®åŒ…åˆ†å‰²æˆä»¥æŠ¥æ–‡æ®µä¸ºå•ä½çš„æ•°æ®åŒ…è¿›è¡Œç®¡ç†, å†å°†æ•°æ®å‡†ç¡®å¯é çš„ä¼ é€’ç»™å¯¹æ–¹. é‚£ä¹ˆå¦‚ä½•å‡†ç¡®å¯é çš„ä¼ é€’ç»™å¯¹æ–¹å‘¢, æ‰€ä»¥å°±æœ‰äº†TCP çš„ä¸‰æ¬¡æ¡æ‰‹ç­–ç•¥: å‘é€ç«¯å…ˆå‘é€ä¸€ä¸ªå¸¦æœ‰ `SYN`æ ‡å¿—çš„æ•°æ®åŒ…ç»™å¯¹æ–¹, æ¥æ”¶ç«¯å›ä¼ ä¸€ä¸ªå¸¦æœ‰`SYN/ACK`æ ‡å¿—çš„æ•°æ®åŒ…ä¼ è¾¾ç¡®è®¤ä¿¡æ¯, æœ€åå‘é€ç«¯å†å›ä¼ ä¸€ä¸ªå¸¦æœ‰`ACK`æ ‡å¿—çš„æ•°æ®åŒ…, ä»£è¡¨æ¡æ‰‹ç»“æŸ.\n![TCP](/img/tcp.jpg)\n- è´Ÿè´£åŸŸååè®®çš„ DNS æœåŠ¡\næä¾›åŸŸååˆ° IP åœ°å€ä¹‹é—´è§£ææœåŠ¡.\n![DNS](/img/dns.jpg)\n\n#### 2.1 HTTP åè®®çš„é€šä¿¡è¿‡ç¨‹\né€šè¿‡ä¸€æ•´å¥—æµç¨‹æ¥çœ‹ä¸€ä¸‹, IPåè®®/ TCPåè®® å’Œ DNSæœåŠ¡åœ¨ HTTPåè®®çš„é€šä¿¡è¿‡ç¨‹ä¸­å„è‡ªå‘æŒ¥äº†ä»€ä¹ˆä½œç”¨.\n![HTTPåè®®é€šä¿¡è¿‡ç¨‹](/img/HTTP_IP_TCP_DNS.jpg)\n\n**ä»ä¸Šå›¾æ¥çœ‹, ä»è¾“å…¥ä¸€ä¸ªç½‘å€åˆ°é¡µé¢çš„å±•ç¤ºè¿‡ç¨‹å¤§è‡´å¦‚ä¸‹:**\n1. åŸŸåè§£æ(DNS æœåŠ¡)\n2. å»ºç«‹TCP, å‘é€ HTTP è¯·æ±‚(ä¸‰æ¬¡æ¡æ‰‹)\n    1. å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€è¯·æ±‚(SYN)\n    2. æœåŠ¡å™¨åº”ç­”å¹¶è¦æ±‚ç¡®è®¤(SYN/ACK)\n    3. å®¢æˆ·ç«¯ç¡®è®¤(ACK)\n3. IP æœç´¢å¯¹æ–¹åœ°å€, ä¸€è¾¹ä¸­è½¬ä¸€è¾¹ä¼ è¾“æ•°æ®åŒ…\n4. æœåŠ¡å™¨å¤„ç†è¯·æ±‚è¿”å› HTTP å“åº”æŠ¥æ–‡\n5. è¿æ¥ç»“æŸ(å››æ¬¡æŒ¥æ‰‹)\n    1. å®¢æˆ·ç«¯å‘é€ä¸€ä¸ª FIN æ¥å‘Šè¯‰æœåŠ¡å™¨æ•°æ®å‘é€å®Œæ¯•\n    2. æœåŠ¡å™¨æ”¶åˆ°è¿™ä¸ª FIN ä¹‹åå›å‘ä¸€ä¸ª ACK(è¿™ä¸ªæ—¶å€™æœåŠ¡å™¨è¿˜å¯ä»¥å‘å®¢æˆ·ç«¯å‘é€æ•°æ®)\n    3. æœåŠ¡å™¨å‘é€ä¸€ä¸ª FIN å‘Šè¯‰å®¢æˆ·ç«¯æœåŠ¡å™¨çš„æ•°æ®å‘é€å®Œæ¯•, è¯·æ±‚å…³é—­è¿æ¥\n    4. å®¢æˆ·ç«¯å›å‘ ACK ç¡®è®¤, å…³é—­è¿æ¥\n6. æµè§ˆå™¨è§£ææ¸²æŸ“é¡µé¢\n\n#### 2.2 HTTP æ˜¯å¦ä¿å­˜çŠ¶æ€\nHTTP æ˜¯ä¸€ç§ä¸ä¿å­˜çŠ¶æ€(æ— çŠ¶æ€)åè®®, åè®®æœ¬èº«ä¸ä¼šä¿ç•™ä¹‹å‰çš„è¯·æ±‚æˆ–å“åº”æŠ¥æ–‡çš„ä¿¡æ¯. è¿™æ˜¯ä¸ºäº†æ›´å¿«çš„å¤„ç†å¤§é‡è¯·æ±‚, ä½†æ˜¯éšç€ Web å‘å±•\nå¾ˆå¤šä¸šåŠ¡éƒ½éœ€è¦ä¿å­˜ç”¨æˆ·çš„çŠ¶æ€, å› æ­¤å¼•å…¥ Cookie æ¥ç®¡ç†çŠ¶æ€.\n\n### 3.0 HTTP è¿”å›çŠ¶æ€ç \nçŠ¶æ€ç æ˜¯ç”¨æ¥å‘Šè¯‰å®¢æˆ·ç«¯ä»æœåŠ¡å™¨å“åº”çš„è¯·æ±‚ç»“æœ, å¯ä»¥é€šè¿‡çŠ¶æ€ç çŸ¥é“è¯¥æ¬¡è¯·æ±‚æ˜¯æ­£å¸¸å¤„ç†äº†è¿˜æ˜¯å‘ç”Ÿäº†é”™è¯¯.\n\n#### 3.1 çŠ¶æ€ç çš„ç±»åˆ«\n\n| | ç±»åˆ« | åŸå› çŸ­å¥ |\n| -- |:----- |:-----|\n| 1XX | ä¿¡æ¯ç±» | æ¥æ”¶çš„è¯·æ±‚æ­£åœ¨å¤„ç† |\n| 2XX | æˆåŠŸç±» | è¯·æ±‚æ­£å¸¸å¤„ç†å®Œæ¯• |\n| 3XX | é‡å®šå‘ç±» | éœ€è¦é™„åŠ æ“ä½œå®Œæˆè¯·æ±‚ |\n| 4XX | å®¢æˆ·ç«¯é”™è¯¯ç±» | æœåŠ¡å™¨æ— æ³•å¤„ç†è¯·æ±‚ |\n| 5XX | æœåŠ¡å™¨é”™è¯¯ç±» | æœåŠ¡å™¨å‘ç”Ÿé”™è¯¯ |\n\n#### 3.2 å…·æœ‰ä»£è¡¨æ€§çš„14ç§çŠ¶æ€ç \n\n- 2XX æˆåŠŸç±»\n\t1.  200 OK\n\tè¡¨ç¤ºè¯·æ±‚åœ¨æœåŠ¡ç«¯è¢«æ­£å¸¸å¤„ç†äº†\n\t2. 204  No Content\n\tè¡¨ç¤ºè¯·æ±‚å¤„ç†æˆåŠŸä½†æ˜¯å“åº”æŠ¥æ–‡ä¸åŒ…å«å®ä½“çš„ä¸»ä½“(æœ¬èº«ä¹Ÿä¸å…è®¸è¿”å›å®ä½“çš„ä¸»ä½“)\n\t3. 206  Partial Content\n\tæœåŠ¡ç«¯æˆåŠŸå¤„ç†äº†å®¢æˆ·ç«¯å‘å‡ºçš„èŒƒå›´è¯·æ±‚\n- 3XX é‡å®šå‘\n\t1. 301 Moved Permanently\n\tæ°¸ä¹…æ€§é‡å®šå‘. è¯·æ±‚çš„èµ„æºå·²ç»è¢«åˆ†é…äº†æ–°çš„ URI åº”è¯¥ä½¿ç”¨æ–°çš„ URI\n\t2. 302 Found\n\tä¸´æ—¶æ€§é‡å®šå‘. è¯·æ±‚çš„èµ„æºè¢«åˆ†é…äº†æ–°çš„ URI, å¸Œæœ›æœ¬æ¬¡è¯·æ±‚ç”¨æ–°çš„ URI\n\t3. 303 See Other\n\tè¯·æ±‚çš„èµ„æºå­˜åœ¨å¦ä¸€ä¸ª URI, åº”ä½¿ç”¨ GET æ–¹æ³•å®šå‘è·å–è¯·æ±‚çš„èµ„æº(è·Ÿ302çš„åŠŸèƒ½ç›¸åŒ)\n\t4. 304 Not Modified\n\tè¡¨ç¤ºè¯·æ±‚æ—¶é™„å¸¦äº†æ¡ä»¶, æœåŠ¡ç«¯å…è®¸è¯·æ±‚èµ„æºä½†ä¸ºæ»¡è¶³æ¡ä»¶. æ‰€ä»¥è¿”å›æ—¶, ä¸åŒ…å«ä»»ä½•å“åº”çš„ä¸»ä½“éƒ¨åˆ†(è·Ÿé‡å®šå‘å¹¶æ²¡æœ‰åŠæ¯›é’±å…³ç³»).\n\t5. 307 Temporary Redirect\n\tä¸´æ—¶é‡å®šå‘, è·Ÿ302æœ‰ç€åŒæ ·çš„ä¸€æ ·. å°½ç®¡302æ ‡å‡†ä¸å…è®¸ POST å˜ä¸º GET, ä½†æ˜¯å¹¶æ²¡æœ‰äººéµå®ˆ; 307ä¼šéµå®ˆæ ‡å‡†ä½†æ˜¯å¤„ç†å“åº”æ—¶, æ¯ä¸ªæµè§ˆå™¨æœ‰å¯èƒ½å‡ºç°ä¸åŒçš„æƒ…å†µ\n- 4XX å®¢æˆ·ç«¯é”™è¯¯\n\t1. 400 Bad Request\n\tè¯·æ±‚æŠ¥æ–‡ä¸­æœ‰è¯­æ³•é”™è¯¯\n\t2. 401 Unauthorized\n\tè¯·æ±‚éœ€è¦é€šè¿‡ HTTP è®¤è¯\n\t3. 403 Forbidden\n\tè¯·æ±‚èµ„æºè®¿é—®è¢«æœåŠ¡ç«¯æ‹’ç»(ä¸€èˆ¬éƒ½æ˜¯æƒé™é—®é¢˜)\n\t4. 404 Not Found\n\tæœåŠ¡ç«¯ä¸Šæ— æ³•æ‰¾åˆ°è¯·æ±‚çš„èµ„æº\n\t5. 405 Not Allow\n\tå¯¹äºè¯·æ±‚çš„èµ„æº, æœåŠ¡ç«¯ä¸å…è®¸ä½¿ç”¨è¯·æ±‚ä¸­ä½¿ç”¨çš„æ–¹æ³•\n- 5XX æœåŠ¡å™¨é”™è¯¯\n\t1. 500 Internal Server Error\n\tæœåŠ¡ç«¯åœ¨æ‰§è¡Œè¯·æ±‚ä»»åŠ¡æ—¶å‘ç”Ÿé”™è¯¯\n\t2. 503 Service Unavailable\n\tæœåŠ¡ç«¯æš‚æ—¶å¤„äºè¶…è´Ÿè½½æˆ–è€…åœæœºç»´æŠ¤, æ— æ³•å¤„ç†è¯·æ±‚(ä¸€èˆ¬å°±æ˜¯æœåŠ¡å™¨æŒ‚äº†)\n\n#### æ€»ç»“\nä¸»è¦ä¸ºäº†å¤§è‡´äº†è§£ä¸€ä¸‹ HTTP çš„åŸºç¡€/å¤§æ¦‚çš„æ‰§è¡Œæµç¨‹å’Œå¸¸è§çš„HTTP çŠ¶æ€ç . å¯¹äºçŠ¶æ€ç ä¹‹å‰ä¸€ç›´åˆ†ä¸å¤ªæ¸…301å’Œ302çš„åŒºåˆ«, ç®€å•çš„æ¥è¯´: 301 æ”¹å˜èµ„æºçš„URI å, å¦‚æœè¿™ä¸ªèµ„æºæ˜¯è¢«ä¿å­˜åœ¨ä¹¦ç­¾ä¸­çš„, é‚£ä¹ˆè¿™æ—¶è¦æ ¹æ®æ–°çš„ URI ä¿å­˜; 302 è¡¨ç¤ºè¿™ä¸ªèµ„æºåªæ˜¯ä¸´æ—¶æ€§çš„ç§»åŠ¨, ä¹‹åè¿™ä¸ª URI å¯èƒ½è¿˜ä¼šå˜åŒ–. é‚£ä¹ˆå¦‚æœä¹Ÿè¢«ä¿å­˜åœ¨äº†ä¹¦ç­¾ä¸­, ä»ç„¶ä¼šä¿ç•™åŸæ¥çš„ URI. çŠ¶æ€ç ä¸­çš„ 304 æ”¾åœ¨ä¸‹æ¬¡æ”¾åœ¨ç¼“å­˜ç­–ç•¥ä¸­å†æ‹ä¸€æ‹å§.\n\nCreate on 2018-1-3 By Cara","slug":"HTTP-ä¸Š","published":1,"updated":"2018-05-05T09:23:03.655Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjgurols80007klu051p1vj2i","content":"<p>Webä½¿ç”¨HTTP(HyperText Transfer Protocal) è¶…æ–‡æœ¬ä¼ è¾“åè®®ä½œä¸ºè§„èŒƒ, å®Œæˆä»å®¢æˆ·ç«¯åˆ°æœåŠ¡ç«¯çš„ä¸€ç³»åˆ—æµç¨‹. å¯ä»¥è¯´ Web æ˜¯åœ¨ HTTP åè®®ä¸Šé€šä¿¡çš„.</p>\n<h3 id=\"1-0-ç½‘ç»œåŸºç¡€TCP-IP\"><a href=\"#1-0-ç½‘ç»œåŸºç¡€TCP-IP\" class=\"headerlink\" title=\"1.0 ç½‘ç»œåŸºç¡€TCP/IP\"></a>1.0 ç½‘ç»œåŸºç¡€TCP/IP</h3><p>é€šå¸¸æˆ‘ä»¬ä½¿ç”¨çš„ç½‘ç»œæ˜¯åœ¨ TCP/IP åè®®æ—çš„åŸºç¡€ä¸Šè¿è¡Œçš„, è€Œ HTTP æ˜¯å±äº TCP/IP æ—ç¾¤ä¸­çš„ä¸€ç§åè®®. åœ¨è®¡ç®—æœºå’Œç½‘ç»œç›¸äº’é€šä¿¡çš„æ—¶å€™, ä¸¤è€…éƒ½å¿…é¡»è¦éµå®ˆåŒä¸€ç§åè®®.</p>\n<h4 id=\"1-1-TCP-IPåˆ†å±‚ç®¡ç†\"><a href=\"#1-1-TCP-IPåˆ†å±‚ç®¡ç†\" class=\"headerlink\" title=\"1.1 TCP/ IPåˆ†å±‚ç®¡ç†\"></a>1.1 TCP/ IPåˆ†å±‚ç®¡ç†</h4><p>TCP/IPåè®®æ—é‡Œæœ€é‡è¦çš„ä¸€ç‚¹å°±æ˜¯åˆ†å±‚, æ¯ä¸€å±‚å°±åªéœ€è¦ä¸“æ³¨äºè‡ªå·±ä»»åŠ¡å°±è¡Œäº†, æŒ‰å±‚æ¬¡åˆ†åˆ«ä¸ºä»¥ä¸‹å››å±‚:</p>\n<ol>\n<li><p>åº”ç”¨å±‚<br>å†³å®šå‘ç”¨æˆ·æä¾›åº”ç”¨æœåŠ¡æ—¶çš„é€šä¿¡æ´»åŠ¨, åœ¨ TCP/IP ä¸­é¢„å­˜äº†å„ç±»é€šç”¨çš„åº”ç”¨æœåŠ¡. æ¯”å¦‚: FTP(File Transfer Protocol, æ–‡ä»¶ä¼ è¾“åè®®)å’Œ DNS(Domain Name System, åŸŸåç³»ç»Ÿ), HTTP åè®®ä¹Ÿå±äºè¿™å±‚.</p>\n</li>\n<li><p>ä¼ è¾“å±‚<br>ç»™ä¸¤ä¸ªè®¡ç®—æœºåœ¨ç½‘ç»œä¸­æä¾›æ•°æ®ä¼ è¾“. TCP(ä¼ è¾“æ§åˆ¶åè®®)å’Œ UDP(ç”¨æˆ·æ•°æ®æŠ¥åè®®)</p>\n</li>\n<li><p>ç½‘ç»œå±‚<br>å¤„ç†ç½‘ä¸ŠæµåŠ¨çš„æ•°æ®åŒ…, å†³å®šæ•°æ®é€šè¿‡å“ªæ¡ä¼ è¾“è·¯çº¿åˆ°å¯¹æ–¹è®¡ç®—æœºå¹¶æŠŠæ•°æ®ä¼ è¾“ç»™å¯¹æ–¹.</p>\n</li>\n<li><p>é“¾è·¯å±‚<br>å¤„ç†è¿æ¥ç½‘ç»œçš„ç¡¬ä»¶éƒ¨åˆ†. ç½‘å¡/ é©±åŠ¨/ å…‰çº¤ä»€ä¹ˆçš„</p>\n</li>\n</ol>\n<h4 id=\"1-2-TCP-IP-ä¼ è¾“æµç¨‹\"><a href=\"#1-2-TCP-IP-ä¼ è¾“æµç¨‹\" class=\"headerlink\" title=\"1.2 TCP/IP ä¼ è¾“æµç¨‹\"></a>1.2 TCP/IP ä¼ è¾“æµç¨‹</h4><p>TCP/IP åœ¨ç½‘ç»œé€šä¿¡æ—¶, ä¼šæŒ‰ç…§åˆ†å±‚é¡ºåºä¸å¯¹æ–¹é€šä¿¡. å‘é€ç«¯ä»åº”ç”¨å±‚å¾€ä¸‹, æ¥æ”¶ç«¯ä»åº”ç”¨ç«¯ç½‘ä¸Š.</p>\n<p><img src=\"/img/http.jpg\" alt=\"TCP/IPä¼ è¾“æµç¨‹\"></p>\n<h3 id=\"2-0-ä¸-HTTP-å…³ç³»å¯†åˆ‡çš„åè®®-IP-TCP-å’Œ-DNS\"><a href=\"#2-0-ä¸-HTTP-å…³ç³»å¯†åˆ‡çš„åè®®-IP-TCP-å’Œ-DNS\" class=\"headerlink\" title=\"2.0 ä¸ HTTP å…³ç³»å¯†åˆ‡çš„åè®®: IP/TCP å’Œ DNS\"></a>2.0 ä¸ HTTP å…³ç³»å¯†åˆ‡çš„åè®®: IP/TCP å’Œ DNS</h3><ul>\n<li>è´Ÿè´£ä¼ è¾“çš„ IP åè®®<br>å°†æ•°æ®åŒ…ä¼ é€’ç»™å¯¹æ–¹å¹¶ç¡®è®¤åˆ°è¾¾, ç¡®è®¤åˆ°è¾¾çš„é‡è¦æ¡ä»¶åŒ…æ‹¬: IP åœ°å€å’Œ MAC åœ°å€.<br><img src=\"/img/ip.jpg\" alt=\"IP\"></li>\n<li>ç¡®ä¿å¯é æ€§çš„ TCP åè®®<br>ä¸ºäº†æ–¹ä¾¿ä¼ è¾“å°†å¤§æ•°æ®åŒ…åˆ†å‰²æˆä»¥æŠ¥æ–‡æ®µä¸ºå•ä½çš„æ•°æ®åŒ…è¿›è¡Œç®¡ç†, å†å°†æ•°æ®å‡†ç¡®å¯é çš„ä¼ é€’ç»™å¯¹æ–¹. é‚£ä¹ˆå¦‚ä½•å‡†ç¡®å¯é çš„ä¼ é€’ç»™å¯¹æ–¹å‘¢, æ‰€ä»¥å°±æœ‰äº†TCP çš„ä¸‰æ¬¡æ¡æ‰‹ç­–ç•¥: å‘é€ç«¯å…ˆå‘é€ä¸€ä¸ªå¸¦æœ‰ <code>SYN</code>æ ‡å¿—çš„æ•°æ®åŒ…ç»™å¯¹æ–¹, æ¥æ”¶ç«¯å›ä¼ ä¸€ä¸ªå¸¦æœ‰<code>SYN/ACK</code>æ ‡å¿—çš„æ•°æ®åŒ…ä¼ è¾¾ç¡®è®¤ä¿¡æ¯, æœ€åå‘é€ç«¯å†å›ä¼ ä¸€ä¸ªå¸¦æœ‰<code>ACK</code>æ ‡å¿—çš„æ•°æ®åŒ…, ä»£è¡¨æ¡æ‰‹ç»“æŸ.<br><img src=\"/img/tcp.jpg\" alt=\"TCP\"></li>\n<li>è´Ÿè´£åŸŸååè®®çš„ DNS æœåŠ¡<br>æä¾›åŸŸååˆ° IP åœ°å€ä¹‹é—´è§£ææœåŠ¡.<br><img src=\"/img/dns.jpg\" alt=\"DNS\"></li>\n</ul>\n<h4 id=\"2-1-HTTP-åè®®çš„é€šä¿¡è¿‡ç¨‹\"><a href=\"#2-1-HTTP-åè®®çš„é€šä¿¡è¿‡ç¨‹\" class=\"headerlink\" title=\"2.1 HTTP åè®®çš„é€šä¿¡è¿‡ç¨‹\"></a>2.1 HTTP åè®®çš„é€šä¿¡è¿‡ç¨‹</h4><p>é€šè¿‡ä¸€æ•´å¥—æµç¨‹æ¥çœ‹ä¸€ä¸‹, IPåè®®/ TCPåè®® å’Œ DNSæœåŠ¡åœ¨ HTTPåè®®çš„é€šä¿¡è¿‡ç¨‹ä¸­å„è‡ªå‘æŒ¥äº†ä»€ä¹ˆä½œç”¨.<br><img src=\"/img/HTTP_IP_TCP_DNS.jpg\" alt=\"HTTPåè®®é€šä¿¡è¿‡ç¨‹\"></p>\n<p><strong>ä»ä¸Šå›¾æ¥çœ‹, ä»è¾“å…¥ä¸€ä¸ªç½‘å€åˆ°é¡µé¢çš„å±•ç¤ºè¿‡ç¨‹å¤§è‡´å¦‚ä¸‹:</strong></p>\n<ol>\n<li>åŸŸåè§£æ(DNS æœåŠ¡)</li>\n<li>å»ºç«‹TCP, å‘é€ HTTP è¯·æ±‚(ä¸‰æ¬¡æ¡æ‰‹)<ol>\n<li>å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€è¯·æ±‚(SYN)</li>\n<li>æœåŠ¡å™¨åº”ç­”å¹¶è¦æ±‚ç¡®è®¤(SYN/ACK)</li>\n<li>å®¢æˆ·ç«¯ç¡®è®¤(ACK)</li>\n</ol>\n</li>\n<li>IP æœç´¢å¯¹æ–¹åœ°å€, ä¸€è¾¹ä¸­è½¬ä¸€è¾¹ä¼ è¾“æ•°æ®åŒ…</li>\n<li>æœåŠ¡å™¨å¤„ç†è¯·æ±‚è¿”å› HTTP å“åº”æŠ¥æ–‡</li>\n<li>è¿æ¥ç»“æŸ(å››æ¬¡æŒ¥æ‰‹)<ol>\n<li>å®¢æˆ·ç«¯å‘é€ä¸€ä¸ª FIN æ¥å‘Šè¯‰æœåŠ¡å™¨æ•°æ®å‘é€å®Œæ¯•</li>\n<li>æœåŠ¡å™¨æ”¶åˆ°è¿™ä¸ª FIN ä¹‹åå›å‘ä¸€ä¸ª ACK(è¿™ä¸ªæ—¶å€™æœåŠ¡å™¨è¿˜å¯ä»¥å‘å®¢æˆ·ç«¯å‘é€æ•°æ®)</li>\n<li>æœåŠ¡å™¨å‘é€ä¸€ä¸ª FIN å‘Šè¯‰å®¢æˆ·ç«¯æœåŠ¡å™¨çš„æ•°æ®å‘é€å®Œæ¯•, è¯·æ±‚å…³é—­è¿æ¥</li>\n<li>å®¢æˆ·ç«¯å›å‘ ACK ç¡®è®¤, å…³é—­è¿æ¥</li>\n</ol>\n</li>\n<li>æµè§ˆå™¨è§£ææ¸²æŸ“é¡µé¢</li>\n</ol>\n<h4 id=\"2-2-HTTP-æ˜¯å¦ä¿å­˜çŠ¶æ€\"><a href=\"#2-2-HTTP-æ˜¯å¦ä¿å­˜çŠ¶æ€\" class=\"headerlink\" title=\"2.2 HTTP æ˜¯å¦ä¿å­˜çŠ¶æ€\"></a>2.2 HTTP æ˜¯å¦ä¿å­˜çŠ¶æ€</h4><p>HTTP æ˜¯ä¸€ç§ä¸ä¿å­˜çŠ¶æ€(æ— çŠ¶æ€)åè®®, åè®®æœ¬èº«ä¸ä¼šä¿ç•™ä¹‹å‰çš„è¯·æ±‚æˆ–å“åº”æŠ¥æ–‡çš„ä¿¡æ¯. è¿™æ˜¯ä¸ºäº†æ›´å¿«çš„å¤„ç†å¤§é‡è¯·æ±‚, ä½†æ˜¯éšç€ Web å‘å±•<br>å¾ˆå¤šä¸šåŠ¡éƒ½éœ€è¦ä¿å­˜ç”¨æˆ·çš„çŠ¶æ€, å› æ­¤å¼•å…¥ Cookie æ¥ç®¡ç†çŠ¶æ€.</p>\n<h3 id=\"3-0-HTTP-è¿”å›çŠ¶æ€ç \"><a href=\"#3-0-HTTP-è¿”å›çŠ¶æ€ç \" class=\"headerlink\" title=\"3.0 HTTP è¿”å›çŠ¶æ€ç \"></a>3.0 HTTP è¿”å›çŠ¶æ€ç </h3><p>çŠ¶æ€ç æ˜¯ç”¨æ¥å‘Šè¯‰å®¢æˆ·ç«¯ä»æœåŠ¡å™¨å“åº”çš„è¯·æ±‚ç»“æœ, å¯ä»¥é€šè¿‡çŠ¶æ€ç çŸ¥é“è¯¥æ¬¡è¯·æ±‚æ˜¯æ­£å¸¸å¤„ç†äº†è¿˜æ˜¯å‘ç”Ÿäº†é”™è¯¯.</p>\n<h4 id=\"3-1-çŠ¶æ€ç çš„ç±»åˆ«\"><a href=\"#3-1-çŠ¶æ€ç çš„ç±»åˆ«\" class=\"headerlink\" title=\"3.1 çŠ¶æ€ç çš„ç±»åˆ«\"></a>3.1 çŠ¶æ€ç çš„ç±»åˆ«</h4><table>\n<thead>\n<tr>\n<th></th>\n<th style=\"text-align:left\">ç±»åˆ«</th>\n<th style=\"text-align:left\">åŸå› çŸ­å¥</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1XX</td>\n<td style=\"text-align:left\">ä¿¡æ¯ç±»</td>\n<td style=\"text-align:left\">æ¥æ”¶çš„è¯·æ±‚æ­£åœ¨å¤„ç†</td>\n</tr>\n<tr>\n<td>2XX</td>\n<td style=\"text-align:left\">æˆåŠŸç±»</td>\n<td style=\"text-align:left\">è¯·æ±‚æ­£å¸¸å¤„ç†å®Œæ¯•</td>\n</tr>\n<tr>\n<td>3XX</td>\n<td style=\"text-align:left\">é‡å®šå‘ç±»</td>\n<td style=\"text-align:left\">éœ€è¦é™„åŠ æ“ä½œå®Œæˆè¯·æ±‚</td>\n</tr>\n<tr>\n<td>4XX</td>\n<td style=\"text-align:left\">å®¢æˆ·ç«¯é”™è¯¯ç±»</td>\n<td style=\"text-align:left\">æœåŠ¡å™¨æ— æ³•å¤„ç†è¯·æ±‚</td>\n</tr>\n<tr>\n<td>5XX</td>\n<td style=\"text-align:left\">æœåŠ¡å™¨é”™è¯¯ç±»</td>\n<td style=\"text-align:left\">æœåŠ¡å™¨å‘ç”Ÿé”™è¯¯</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"3-2-å…·æœ‰ä»£è¡¨æ€§çš„14ç§çŠ¶æ€ç \"><a href=\"#3-2-å…·æœ‰ä»£è¡¨æ€§çš„14ç§çŠ¶æ€ç \" class=\"headerlink\" title=\"3.2 å…·æœ‰ä»£è¡¨æ€§çš„14ç§çŠ¶æ€ç \"></a>3.2 å…·æœ‰ä»£è¡¨æ€§çš„14ç§çŠ¶æ€ç </h4><ul>\n<li>2XX æˆåŠŸç±»<ol>\n<li>200 OK<br>è¡¨ç¤ºè¯·æ±‚åœ¨æœåŠ¡ç«¯è¢«æ­£å¸¸å¤„ç†äº†</li>\n<li>204  No Content<br>è¡¨ç¤ºè¯·æ±‚å¤„ç†æˆåŠŸä½†æ˜¯å“åº”æŠ¥æ–‡ä¸åŒ…å«å®ä½“çš„ä¸»ä½“(æœ¬èº«ä¹Ÿä¸å…è®¸è¿”å›å®ä½“çš„ä¸»ä½“)</li>\n<li>206  Partial Content<br>æœåŠ¡ç«¯æˆåŠŸå¤„ç†äº†å®¢æˆ·ç«¯å‘å‡ºçš„èŒƒå›´è¯·æ±‚</li>\n</ol>\n</li>\n<li>3XX é‡å®šå‘<ol>\n<li>301 Moved Permanently<br>æ°¸ä¹…æ€§é‡å®šå‘. è¯·æ±‚çš„èµ„æºå·²ç»è¢«åˆ†é…äº†æ–°çš„ URI åº”è¯¥ä½¿ç”¨æ–°çš„ URI</li>\n<li>302 Found<br>ä¸´æ—¶æ€§é‡å®šå‘. è¯·æ±‚çš„èµ„æºè¢«åˆ†é…äº†æ–°çš„ URI, å¸Œæœ›æœ¬æ¬¡è¯·æ±‚ç”¨æ–°çš„ URI</li>\n<li>303 See Other<br>è¯·æ±‚çš„èµ„æºå­˜åœ¨å¦ä¸€ä¸ª URI, åº”ä½¿ç”¨ GET æ–¹æ³•å®šå‘è·å–è¯·æ±‚çš„èµ„æº(è·Ÿ302çš„åŠŸèƒ½ç›¸åŒ)</li>\n<li>304 Not Modified<br>è¡¨ç¤ºè¯·æ±‚æ—¶é™„å¸¦äº†æ¡ä»¶, æœåŠ¡ç«¯å…è®¸è¯·æ±‚èµ„æºä½†ä¸ºæ»¡è¶³æ¡ä»¶. æ‰€ä»¥è¿”å›æ—¶, ä¸åŒ…å«ä»»ä½•å“åº”çš„ä¸»ä½“éƒ¨åˆ†(è·Ÿé‡å®šå‘å¹¶æ²¡æœ‰åŠæ¯›é’±å…³ç³»).</li>\n<li>307 Temporary Redirect<br>ä¸´æ—¶é‡å®šå‘, è·Ÿ302æœ‰ç€åŒæ ·çš„ä¸€æ ·. å°½ç®¡302æ ‡å‡†ä¸å…è®¸ POST å˜ä¸º GET, ä½†æ˜¯å¹¶æ²¡æœ‰äººéµå®ˆ; 307ä¼šéµå®ˆæ ‡å‡†ä½†æ˜¯å¤„ç†å“åº”æ—¶, æ¯ä¸ªæµè§ˆå™¨æœ‰å¯èƒ½å‡ºç°ä¸åŒçš„æƒ…å†µ</li>\n</ol>\n</li>\n<li>4XX å®¢æˆ·ç«¯é”™è¯¯<ol>\n<li>400 Bad Request<br>è¯·æ±‚æŠ¥æ–‡ä¸­æœ‰è¯­æ³•é”™è¯¯</li>\n<li>401 Unauthorized<br>è¯·æ±‚éœ€è¦é€šè¿‡ HTTP è®¤è¯</li>\n<li>403 Forbidden<br>è¯·æ±‚èµ„æºè®¿é—®è¢«æœåŠ¡ç«¯æ‹’ç»(ä¸€èˆ¬éƒ½æ˜¯æƒé™é—®é¢˜)</li>\n<li>404 Not Found<br>æœåŠ¡ç«¯ä¸Šæ— æ³•æ‰¾åˆ°è¯·æ±‚çš„èµ„æº</li>\n<li>405 Not Allow<br>å¯¹äºè¯·æ±‚çš„èµ„æº, æœåŠ¡ç«¯ä¸å…è®¸ä½¿ç”¨è¯·æ±‚ä¸­ä½¿ç”¨çš„æ–¹æ³•</li>\n</ol>\n</li>\n<li>5XX æœåŠ¡å™¨é”™è¯¯<ol>\n<li>500 Internal Server Error<br>æœåŠ¡ç«¯åœ¨æ‰§è¡Œè¯·æ±‚ä»»åŠ¡æ—¶å‘ç”Ÿé”™è¯¯</li>\n<li>503 Service Unavailable<br>æœåŠ¡ç«¯æš‚æ—¶å¤„äºè¶…è´Ÿè½½æˆ–è€…åœæœºç»´æŠ¤, æ— æ³•å¤„ç†è¯·æ±‚(ä¸€èˆ¬å°±æ˜¯æœåŠ¡å™¨æŒ‚äº†)</li>\n</ol>\n</li>\n</ul>\n<h4 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h4><p>ä¸»è¦ä¸ºäº†å¤§è‡´äº†è§£ä¸€ä¸‹ HTTP çš„åŸºç¡€/å¤§æ¦‚çš„æ‰§è¡Œæµç¨‹å’Œå¸¸è§çš„HTTP çŠ¶æ€ç . å¯¹äºçŠ¶æ€ç ä¹‹å‰ä¸€ç›´åˆ†ä¸å¤ªæ¸…301å’Œ302çš„åŒºåˆ«, ç®€å•çš„æ¥è¯´: 301 æ”¹å˜èµ„æºçš„URI å, å¦‚æœè¿™ä¸ªèµ„æºæ˜¯è¢«ä¿å­˜åœ¨ä¹¦ç­¾ä¸­çš„, é‚£ä¹ˆè¿™æ—¶è¦æ ¹æ®æ–°çš„ URI ä¿å­˜; 302 è¡¨ç¤ºè¿™ä¸ªèµ„æºåªæ˜¯ä¸´æ—¶æ€§çš„ç§»åŠ¨, ä¹‹åè¿™ä¸ª URI å¯èƒ½è¿˜ä¼šå˜åŒ–. é‚£ä¹ˆå¦‚æœä¹Ÿè¢«ä¿å­˜åœ¨äº†ä¹¦ç­¾ä¸­, ä»ç„¶ä¼šä¿ç•™åŸæ¥çš„ URI. çŠ¶æ€ç ä¸­çš„ 304 æ”¾åœ¨ä¸‹æ¬¡æ”¾åœ¨ç¼“å­˜ç­–ç•¥ä¸­å†æ‹ä¸€æ‹å§.</p>\n<p>Create on 2018-1-3 By Cara</p>\n","site":{"data":{}},"excerpt":"","more":"<p>Webä½¿ç”¨HTTP(HyperText Transfer Protocal) è¶…æ–‡æœ¬ä¼ è¾“åè®®ä½œä¸ºè§„èŒƒ, å®Œæˆä»å®¢æˆ·ç«¯åˆ°æœåŠ¡ç«¯çš„ä¸€ç³»åˆ—æµç¨‹. å¯ä»¥è¯´ Web æ˜¯åœ¨ HTTP åè®®ä¸Šé€šä¿¡çš„.</p>\n<h3 id=\"1-0-ç½‘ç»œåŸºç¡€TCP-IP\"><a href=\"#1-0-ç½‘ç»œåŸºç¡€TCP-IP\" class=\"headerlink\" title=\"1.0 ç½‘ç»œåŸºç¡€TCP/IP\"></a>1.0 ç½‘ç»œåŸºç¡€TCP/IP</h3><p>é€šå¸¸æˆ‘ä»¬ä½¿ç”¨çš„ç½‘ç»œæ˜¯åœ¨ TCP/IP åè®®æ—çš„åŸºç¡€ä¸Šè¿è¡Œçš„, è€Œ HTTP æ˜¯å±äº TCP/IP æ—ç¾¤ä¸­çš„ä¸€ç§åè®®. åœ¨è®¡ç®—æœºå’Œç½‘ç»œç›¸äº’é€šä¿¡çš„æ—¶å€™, ä¸¤è€…éƒ½å¿…é¡»è¦éµå®ˆåŒä¸€ç§åè®®.</p>\n<h4 id=\"1-1-TCP-IPåˆ†å±‚ç®¡ç†\"><a href=\"#1-1-TCP-IPåˆ†å±‚ç®¡ç†\" class=\"headerlink\" title=\"1.1 TCP/ IPåˆ†å±‚ç®¡ç†\"></a>1.1 TCP/ IPåˆ†å±‚ç®¡ç†</h4><p>TCP/IPåè®®æ—é‡Œæœ€é‡è¦çš„ä¸€ç‚¹å°±æ˜¯åˆ†å±‚, æ¯ä¸€å±‚å°±åªéœ€è¦ä¸“æ³¨äºè‡ªå·±ä»»åŠ¡å°±è¡Œäº†, æŒ‰å±‚æ¬¡åˆ†åˆ«ä¸ºä»¥ä¸‹å››å±‚:</p>\n<ol>\n<li><p>åº”ç”¨å±‚<br>å†³å®šå‘ç”¨æˆ·æä¾›åº”ç”¨æœåŠ¡æ—¶çš„é€šä¿¡æ´»åŠ¨, åœ¨ TCP/IP ä¸­é¢„å­˜äº†å„ç±»é€šç”¨çš„åº”ç”¨æœåŠ¡. æ¯”å¦‚: FTP(File Transfer Protocol, æ–‡ä»¶ä¼ è¾“åè®®)å’Œ DNS(Domain Name System, åŸŸåç³»ç»Ÿ), HTTP åè®®ä¹Ÿå±äºè¿™å±‚.</p>\n</li>\n<li><p>ä¼ è¾“å±‚<br>ç»™ä¸¤ä¸ªè®¡ç®—æœºåœ¨ç½‘ç»œä¸­æä¾›æ•°æ®ä¼ è¾“. TCP(ä¼ è¾“æ§åˆ¶åè®®)å’Œ UDP(ç”¨æˆ·æ•°æ®æŠ¥åè®®)</p>\n</li>\n<li><p>ç½‘ç»œå±‚<br>å¤„ç†ç½‘ä¸ŠæµåŠ¨çš„æ•°æ®åŒ…, å†³å®šæ•°æ®é€šè¿‡å“ªæ¡ä¼ è¾“è·¯çº¿åˆ°å¯¹æ–¹è®¡ç®—æœºå¹¶æŠŠæ•°æ®ä¼ è¾“ç»™å¯¹æ–¹.</p>\n</li>\n<li><p>é“¾è·¯å±‚<br>å¤„ç†è¿æ¥ç½‘ç»œçš„ç¡¬ä»¶éƒ¨åˆ†. ç½‘å¡/ é©±åŠ¨/ å…‰çº¤ä»€ä¹ˆçš„</p>\n</li>\n</ol>\n<h4 id=\"1-2-TCP-IP-ä¼ è¾“æµç¨‹\"><a href=\"#1-2-TCP-IP-ä¼ è¾“æµç¨‹\" class=\"headerlink\" title=\"1.2 TCP/IP ä¼ è¾“æµç¨‹\"></a>1.2 TCP/IP ä¼ è¾“æµç¨‹</h4><p>TCP/IP åœ¨ç½‘ç»œé€šä¿¡æ—¶, ä¼šæŒ‰ç…§åˆ†å±‚é¡ºåºä¸å¯¹æ–¹é€šä¿¡. å‘é€ç«¯ä»åº”ç”¨å±‚å¾€ä¸‹, æ¥æ”¶ç«¯ä»åº”ç”¨ç«¯ç½‘ä¸Š.</p>\n<p><img src=\"/img/http.jpg\" alt=\"TCP/IPä¼ è¾“æµç¨‹\"></p>\n<h3 id=\"2-0-ä¸-HTTP-å…³ç³»å¯†åˆ‡çš„åè®®-IP-TCP-å’Œ-DNS\"><a href=\"#2-0-ä¸-HTTP-å…³ç³»å¯†åˆ‡çš„åè®®-IP-TCP-å’Œ-DNS\" class=\"headerlink\" title=\"2.0 ä¸ HTTP å…³ç³»å¯†åˆ‡çš„åè®®: IP/TCP å’Œ DNS\"></a>2.0 ä¸ HTTP å…³ç³»å¯†åˆ‡çš„åè®®: IP/TCP å’Œ DNS</h3><ul>\n<li>è´Ÿè´£ä¼ è¾“çš„ IP åè®®<br>å°†æ•°æ®åŒ…ä¼ é€’ç»™å¯¹æ–¹å¹¶ç¡®è®¤åˆ°è¾¾, ç¡®è®¤åˆ°è¾¾çš„é‡è¦æ¡ä»¶åŒ…æ‹¬: IP åœ°å€å’Œ MAC åœ°å€.<br><img src=\"/img/ip.jpg\" alt=\"IP\"></li>\n<li>ç¡®ä¿å¯é æ€§çš„ TCP åè®®<br>ä¸ºäº†æ–¹ä¾¿ä¼ è¾“å°†å¤§æ•°æ®åŒ…åˆ†å‰²æˆä»¥æŠ¥æ–‡æ®µä¸ºå•ä½çš„æ•°æ®åŒ…è¿›è¡Œç®¡ç†, å†å°†æ•°æ®å‡†ç¡®å¯é çš„ä¼ é€’ç»™å¯¹æ–¹. é‚£ä¹ˆå¦‚ä½•å‡†ç¡®å¯é çš„ä¼ é€’ç»™å¯¹æ–¹å‘¢, æ‰€ä»¥å°±æœ‰äº†TCP çš„ä¸‰æ¬¡æ¡æ‰‹ç­–ç•¥: å‘é€ç«¯å…ˆå‘é€ä¸€ä¸ªå¸¦æœ‰ <code>SYN</code>æ ‡å¿—çš„æ•°æ®åŒ…ç»™å¯¹æ–¹, æ¥æ”¶ç«¯å›ä¼ ä¸€ä¸ªå¸¦æœ‰<code>SYN/ACK</code>æ ‡å¿—çš„æ•°æ®åŒ…ä¼ è¾¾ç¡®è®¤ä¿¡æ¯, æœ€åå‘é€ç«¯å†å›ä¼ ä¸€ä¸ªå¸¦æœ‰<code>ACK</code>æ ‡å¿—çš„æ•°æ®åŒ…, ä»£è¡¨æ¡æ‰‹ç»“æŸ.<br><img src=\"/img/tcp.jpg\" alt=\"TCP\"></li>\n<li>è´Ÿè´£åŸŸååè®®çš„ DNS æœåŠ¡<br>æä¾›åŸŸååˆ° IP åœ°å€ä¹‹é—´è§£ææœåŠ¡.<br><img src=\"/img/dns.jpg\" alt=\"DNS\"></li>\n</ul>\n<h4 id=\"2-1-HTTP-åè®®çš„é€šä¿¡è¿‡ç¨‹\"><a href=\"#2-1-HTTP-åè®®çš„é€šä¿¡è¿‡ç¨‹\" class=\"headerlink\" title=\"2.1 HTTP åè®®çš„é€šä¿¡è¿‡ç¨‹\"></a>2.1 HTTP åè®®çš„é€šä¿¡è¿‡ç¨‹</h4><p>é€šè¿‡ä¸€æ•´å¥—æµç¨‹æ¥çœ‹ä¸€ä¸‹, IPåè®®/ TCPåè®® å’Œ DNSæœåŠ¡åœ¨ HTTPåè®®çš„é€šä¿¡è¿‡ç¨‹ä¸­å„è‡ªå‘æŒ¥äº†ä»€ä¹ˆä½œç”¨.<br><img src=\"/img/HTTP_IP_TCP_DNS.jpg\" alt=\"HTTPåè®®é€šä¿¡è¿‡ç¨‹\"></p>\n<p><strong>ä»ä¸Šå›¾æ¥çœ‹, ä»è¾“å…¥ä¸€ä¸ªç½‘å€åˆ°é¡µé¢çš„å±•ç¤ºè¿‡ç¨‹å¤§è‡´å¦‚ä¸‹:</strong></p>\n<ol>\n<li>åŸŸåè§£æ(DNS æœåŠ¡)</li>\n<li>å»ºç«‹TCP, å‘é€ HTTP è¯·æ±‚(ä¸‰æ¬¡æ¡æ‰‹)<ol>\n<li>å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€è¯·æ±‚(SYN)</li>\n<li>æœåŠ¡å™¨åº”ç­”å¹¶è¦æ±‚ç¡®è®¤(SYN/ACK)</li>\n<li>å®¢æˆ·ç«¯ç¡®è®¤(ACK)</li>\n</ol>\n</li>\n<li>IP æœç´¢å¯¹æ–¹åœ°å€, ä¸€è¾¹ä¸­è½¬ä¸€è¾¹ä¼ è¾“æ•°æ®åŒ…</li>\n<li>æœåŠ¡å™¨å¤„ç†è¯·æ±‚è¿”å› HTTP å“åº”æŠ¥æ–‡</li>\n<li>è¿æ¥ç»“æŸ(å››æ¬¡æŒ¥æ‰‹)<ol>\n<li>å®¢æˆ·ç«¯å‘é€ä¸€ä¸ª FIN æ¥å‘Šè¯‰æœåŠ¡å™¨æ•°æ®å‘é€å®Œæ¯•</li>\n<li>æœåŠ¡å™¨æ”¶åˆ°è¿™ä¸ª FIN ä¹‹åå›å‘ä¸€ä¸ª ACK(è¿™ä¸ªæ—¶å€™æœåŠ¡å™¨è¿˜å¯ä»¥å‘å®¢æˆ·ç«¯å‘é€æ•°æ®)</li>\n<li>æœåŠ¡å™¨å‘é€ä¸€ä¸ª FIN å‘Šè¯‰å®¢æˆ·ç«¯æœåŠ¡å™¨çš„æ•°æ®å‘é€å®Œæ¯•, è¯·æ±‚å…³é—­è¿æ¥</li>\n<li>å®¢æˆ·ç«¯å›å‘ ACK ç¡®è®¤, å…³é—­è¿æ¥</li>\n</ol>\n</li>\n<li>æµè§ˆå™¨è§£ææ¸²æŸ“é¡µé¢</li>\n</ol>\n<h4 id=\"2-2-HTTP-æ˜¯å¦ä¿å­˜çŠ¶æ€\"><a href=\"#2-2-HTTP-æ˜¯å¦ä¿å­˜çŠ¶æ€\" class=\"headerlink\" title=\"2.2 HTTP æ˜¯å¦ä¿å­˜çŠ¶æ€\"></a>2.2 HTTP æ˜¯å¦ä¿å­˜çŠ¶æ€</h4><p>HTTP æ˜¯ä¸€ç§ä¸ä¿å­˜çŠ¶æ€(æ— çŠ¶æ€)åè®®, åè®®æœ¬èº«ä¸ä¼šä¿ç•™ä¹‹å‰çš„è¯·æ±‚æˆ–å“åº”æŠ¥æ–‡çš„ä¿¡æ¯. è¿™æ˜¯ä¸ºäº†æ›´å¿«çš„å¤„ç†å¤§é‡è¯·æ±‚, ä½†æ˜¯éšç€ Web å‘å±•<br>å¾ˆå¤šä¸šåŠ¡éƒ½éœ€è¦ä¿å­˜ç”¨æˆ·çš„çŠ¶æ€, å› æ­¤å¼•å…¥ Cookie æ¥ç®¡ç†çŠ¶æ€.</p>\n<h3 id=\"3-0-HTTP-è¿”å›çŠ¶æ€ç \"><a href=\"#3-0-HTTP-è¿”å›çŠ¶æ€ç \" class=\"headerlink\" title=\"3.0 HTTP è¿”å›çŠ¶æ€ç \"></a>3.0 HTTP è¿”å›çŠ¶æ€ç </h3><p>çŠ¶æ€ç æ˜¯ç”¨æ¥å‘Šè¯‰å®¢æˆ·ç«¯ä»æœåŠ¡å™¨å“åº”çš„è¯·æ±‚ç»“æœ, å¯ä»¥é€šè¿‡çŠ¶æ€ç çŸ¥é“è¯¥æ¬¡è¯·æ±‚æ˜¯æ­£å¸¸å¤„ç†äº†è¿˜æ˜¯å‘ç”Ÿäº†é”™è¯¯.</p>\n<h4 id=\"3-1-çŠ¶æ€ç çš„ç±»åˆ«\"><a href=\"#3-1-çŠ¶æ€ç çš„ç±»åˆ«\" class=\"headerlink\" title=\"3.1 çŠ¶æ€ç çš„ç±»åˆ«\"></a>3.1 çŠ¶æ€ç çš„ç±»åˆ«</h4><table>\n<thead>\n<tr>\n<th></th>\n<th style=\"text-align:left\">ç±»åˆ«</th>\n<th style=\"text-align:left\">åŸå› çŸ­å¥</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1XX</td>\n<td style=\"text-align:left\">ä¿¡æ¯ç±»</td>\n<td style=\"text-align:left\">æ¥æ”¶çš„è¯·æ±‚æ­£åœ¨å¤„ç†</td>\n</tr>\n<tr>\n<td>2XX</td>\n<td style=\"text-align:left\">æˆåŠŸç±»</td>\n<td style=\"text-align:left\">è¯·æ±‚æ­£å¸¸å¤„ç†å®Œæ¯•</td>\n</tr>\n<tr>\n<td>3XX</td>\n<td style=\"text-align:left\">é‡å®šå‘ç±»</td>\n<td style=\"text-align:left\">éœ€è¦é™„åŠ æ“ä½œå®Œæˆè¯·æ±‚</td>\n</tr>\n<tr>\n<td>4XX</td>\n<td style=\"text-align:left\">å®¢æˆ·ç«¯é”™è¯¯ç±»</td>\n<td style=\"text-align:left\">æœåŠ¡å™¨æ— æ³•å¤„ç†è¯·æ±‚</td>\n</tr>\n<tr>\n<td>5XX</td>\n<td style=\"text-align:left\">æœåŠ¡å™¨é”™è¯¯ç±»</td>\n<td style=\"text-align:left\">æœåŠ¡å™¨å‘ç”Ÿé”™è¯¯</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"3-2-å…·æœ‰ä»£è¡¨æ€§çš„14ç§çŠ¶æ€ç \"><a href=\"#3-2-å…·æœ‰ä»£è¡¨æ€§çš„14ç§çŠ¶æ€ç \" class=\"headerlink\" title=\"3.2 å…·æœ‰ä»£è¡¨æ€§çš„14ç§çŠ¶æ€ç \"></a>3.2 å…·æœ‰ä»£è¡¨æ€§çš„14ç§çŠ¶æ€ç </h4><ul>\n<li>2XX æˆåŠŸç±»<ol>\n<li>200 OK<br>è¡¨ç¤ºè¯·æ±‚åœ¨æœåŠ¡ç«¯è¢«æ­£å¸¸å¤„ç†äº†</li>\n<li>204  No Content<br>è¡¨ç¤ºè¯·æ±‚å¤„ç†æˆåŠŸä½†æ˜¯å“åº”æŠ¥æ–‡ä¸åŒ…å«å®ä½“çš„ä¸»ä½“(æœ¬èº«ä¹Ÿä¸å…è®¸è¿”å›å®ä½“çš„ä¸»ä½“)</li>\n<li>206  Partial Content<br>æœåŠ¡ç«¯æˆåŠŸå¤„ç†äº†å®¢æˆ·ç«¯å‘å‡ºçš„èŒƒå›´è¯·æ±‚</li>\n</ol>\n</li>\n<li>3XX é‡å®šå‘<ol>\n<li>301 Moved Permanently<br>æ°¸ä¹…æ€§é‡å®šå‘. è¯·æ±‚çš„èµ„æºå·²ç»è¢«åˆ†é…äº†æ–°çš„ URI åº”è¯¥ä½¿ç”¨æ–°çš„ URI</li>\n<li>302 Found<br>ä¸´æ—¶æ€§é‡å®šå‘. è¯·æ±‚çš„èµ„æºè¢«åˆ†é…äº†æ–°çš„ URI, å¸Œæœ›æœ¬æ¬¡è¯·æ±‚ç”¨æ–°çš„ URI</li>\n<li>303 See Other<br>è¯·æ±‚çš„èµ„æºå­˜åœ¨å¦ä¸€ä¸ª URI, åº”ä½¿ç”¨ GET æ–¹æ³•å®šå‘è·å–è¯·æ±‚çš„èµ„æº(è·Ÿ302çš„åŠŸèƒ½ç›¸åŒ)</li>\n<li>304 Not Modified<br>è¡¨ç¤ºè¯·æ±‚æ—¶é™„å¸¦äº†æ¡ä»¶, æœåŠ¡ç«¯å…è®¸è¯·æ±‚èµ„æºä½†ä¸ºæ»¡è¶³æ¡ä»¶. æ‰€ä»¥è¿”å›æ—¶, ä¸åŒ…å«ä»»ä½•å“åº”çš„ä¸»ä½“éƒ¨åˆ†(è·Ÿé‡å®šå‘å¹¶æ²¡æœ‰åŠæ¯›é’±å…³ç³»).</li>\n<li>307 Temporary Redirect<br>ä¸´æ—¶é‡å®šå‘, è·Ÿ302æœ‰ç€åŒæ ·çš„ä¸€æ ·. å°½ç®¡302æ ‡å‡†ä¸å…è®¸ POST å˜ä¸º GET, ä½†æ˜¯å¹¶æ²¡æœ‰äººéµå®ˆ; 307ä¼šéµå®ˆæ ‡å‡†ä½†æ˜¯å¤„ç†å“åº”æ—¶, æ¯ä¸ªæµè§ˆå™¨æœ‰å¯èƒ½å‡ºç°ä¸åŒçš„æƒ…å†µ</li>\n</ol>\n</li>\n<li>4XX å®¢æˆ·ç«¯é”™è¯¯<ol>\n<li>400 Bad Request<br>è¯·æ±‚æŠ¥æ–‡ä¸­æœ‰è¯­æ³•é”™è¯¯</li>\n<li>401 Unauthorized<br>è¯·æ±‚éœ€è¦é€šè¿‡ HTTP è®¤è¯</li>\n<li>403 Forbidden<br>è¯·æ±‚èµ„æºè®¿é—®è¢«æœåŠ¡ç«¯æ‹’ç»(ä¸€èˆ¬éƒ½æ˜¯æƒé™é—®é¢˜)</li>\n<li>404 Not Found<br>æœåŠ¡ç«¯ä¸Šæ— æ³•æ‰¾åˆ°è¯·æ±‚çš„èµ„æº</li>\n<li>405 Not Allow<br>å¯¹äºè¯·æ±‚çš„èµ„æº, æœåŠ¡ç«¯ä¸å…è®¸ä½¿ç”¨è¯·æ±‚ä¸­ä½¿ç”¨çš„æ–¹æ³•</li>\n</ol>\n</li>\n<li>5XX æœåŠ¡å™¨é”™è¯¯<ol>\n<li>500 Internal Server Error<br>æœåŠ¡ç«¯åœ¨æ‰§è¡Œè¯·æ±‚ä»»åŠ¡æ—¶å‘ç”Ÿé”™è¯¯</li>\n<li>503 Service Unavailable<br>æœåŠ¡ç«¯æš‚æ—¶å¤„äºè¶…è´Ÿè½½æˆ–è€…åœæœºç»´æŠ¤, æ— æ³•å¤„ç†è¯·æ±‚(ä¸€èˆ¬å°±æ˜¯æœåŠ¡å™¨æŒ‚äº†)</li>\n</ol>\n</li>\n</ul>\n<h4 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h4><p>ä¸»è¦ä¸ºäº†å¤§è‡´äº†è§£ä¸€ä¸‹ HTTP çš„åŸºç¡€/å¤§æ¦‚çš„æ‰§è¡Œæµç¨‹å’Œå¸¸è§çš„HTTP çŠ¶æ€ç . å¯¹äºçŠ¶æ€ç ä¹‹å‰ä¸€ç›´åˆ†ä¸å¤ªæ¸…301å’Œ302çš„åŒºåˆ«, ç®€å•çš„æ¥è¯´: 301 æ”¹å˜èµ„æºçš„URI å, å¦‚æœè¿™ä¸ªèµ„æºæ˜¯è¢«ä¿å­˜åœ¨ä¹¦ç­¾ä¸­çš„, é‚£ä¹ˆè¿™æ—¶è¦æ ¹æ®æ–°çš„ URI ä¿å­˜; 302 è¡¨ç¤ºè¿™ä¸ªèµ„æºåªæ˜¯ä¸´æ—¶æ€§çš„ç§»åŠ¨, ä¹‹åè¿™ä¸ª URI å¯èƒ½è¿˜ä¼šå˜åŒ–. é‚£ä¹ˆå¦‚æœä¹Ÿè¢«ä¿å­˜åœ¨äº†ä¹¦ç­¾ä¸­, ä»ç„¶ä¼šä¿ç•™åŸæ¥çš„ URI. çŠ¶æ€ç ä¸­çš„ 304 æ”¾åœ¨ä¸‹æ¬¡æ”¾åœ¨ç¼“å­˜ç­–ç•¥ä¸­å†æ‹ä¸€æ‹å§.</p>\n<p>Create on 2018-1-3 By Cara</p>\n"},{"title":"JavaScript æ–¹æ³•é›†","date":"2017-10-16T14:29:16.000Z","_content":"JavaScriptåŒ…å«äº†ä¸€å¥—å°å‹çš„å¯ç”¨åœ¨æ ‡å‡†ç±»å‹ä¸Šçš„æ ‡å‡†æ–¹æ³•é›†,\nä¸»è¦æ˜¯é’ˆå¯¹æ•°ç»„/æ­£åˆ™åŠå­—ç¬¦ä¸²çš„ä¸€äº›å¤„ç†.\n\n> ## Array\n\n### array.concat(item...)\nconcat æ–¹æ³•äº§ç”Ÿä¸€ä¸ªæ–°çš„æ•°ç»„, å®ƒåŒ…å«çš„æ˜¯ä¸€ä»½ array çš„æµ…å¤åˆ¶\nå¹¶æŠŠå‚æ•° item è¿½åŠ åœ¨å…¶å. å¦‚æœ item æ˜¯æ•°ç»„, é‚£ä¹ˆè¿™ä¸ªæ•°ç»„çš„\næ¯ä¸ªå…ƒç´ éƒ½ä¼šè¢«æ·»åŠ .\n\n```javascript\nlet arr = [1, 2, 3];\nlet arr2 = [4, 5, 6];\nlet result = arr.concat(arr2, 'wow');\n\nconsole.log(result); // [1, 2, 3, 4, 5, 6, 'wow'];\n```\n\n### array.join(separator)\njoin æ–¹æ³•æ˜¯æŠŠä¸€ä¸ª array ä»¥æŒ‡å®šçš„åˆ†éš”ç¬¦æ„é€ æˆä¸€ä¸ªå­—ç¬¦ä¸².\nå®ƒå…ˆæŠŠ array ä¸­çš„æ¯ä¸ªå…ƒç´ æ„é€ æˆä¸€ä¸ªå­—ç¬¦ä¸², ç„¶åä»¥æŒ‡å®šçš„\nåˆ†éš”ç¬¦æŠŠå®ƒä»¬éƒ½è¿æ¥èµ·æ¥. é»˜è®¤çš„ separate æ˜¯é€—å·, å¯ä»¥ç”¨\nç©ºå­—ç¬¦ä¸²ä½œä¸º separate.\n\n```javascript\nlet array = [\"a\", \"b\", \"c\"];\narray.push(\"d\");\n\nlet result = array(\"|\");\nconsole.log(result); // \"a|b|c|d\"\n```\n\n### array.pop()\npop å’Œ push æ–¹æ³•å¯ä»¥ä½¿ array åƒå †æ ˆä¸€æ ·å·¥ä½œ. pop æ–¹æ³•ç§»é™¤æ•°ç»„\nä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ å¹¶è¿”å›è¯¥å…ƒç´ , å¦‚æœæ˜¯ç©ºæ•°ç»„, å®ƒå°†è¿”å› undefined.\n\n```javascript\nlet arr = [1, 2, 3];\narr.pop()\n\nconsole.log(arr); // 3\n```\n\n### array.push(item...)\npush æ–¹æ³•å‘æ•°ç»„çš„æœ«å°¾æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ . å’Œ concat æ–¹æ³•ä¸åŒçš„æ˜¯, \nä»–ä¼šä¿®æ”¹ array, å¦‚æœ item æ˜¯ä¸€ä¸ªæ•°ç»„, ä¼šå°†æ•´ä¸ªå‚æ•°æ•°ç»„ä½œä¸ºä¸€ä¸ªå…ƒç´ \næ·»åŠ åˆ° array çš„æœ«å°¾, å¹¶è¿”å›è¿™ä¸ªæ–°æ•°ç»„çš„é•¿åº¦.\n\n```javascript\nlet array = [1, 2, 3];\nlet arr = [4, 5, 6];\n\nlet result = array.push(arr. 'Hi');\nconsole.log(result); \n// array: [1, 2, 3, [4, 5, 6], 'Hi']\n// result: 5\n```\n\n### array.reverse()\nreverse æ–¹æ³•åè½¬æ•°ç»„å…ƒç´ çš„é¡ºåº, å¹¶è¿”å›æ•°ç»„æœ¬èº«.\n\n```javascript\nlet array = [1, 2, 3];\n\nlet result = array.reverse();\nconsole.log(result); // [3, 2, 1]\n```\n\n### array.shift()\nshift æ–¹æ³•ç§»é™¤æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ å¹¶è¿”å›è¯¥å…ƒç´ . å¦‚æœæ˜¯ç©ºæ•°ç»„\nå°†ä¼šè¿”å› undefined. shift é€šå¸¸æ¯” pop æ…¢å¾—å¤š.\n\n```javascript\nlet array = [1, 2, 3];\nlet result = array.shift();\n\nconsole.log(result); // 1\n\n```\n\n### array.slice(start, end)\nslice æ–¹æ³•æ˜¯æˆªå– array ä¸­çš„ä¸€æ®µåšæµ…å¤åˆ¶. å¤åˆ¶ array[start] å¼€å§‹\nåˆ°å¤åˆ¶ array[end]ä¸ºæ­¢. end å‚æ•°æ˜¯å¯é€‰çš„, é»˜è®¤å€¼çš„é•¿åº¦æ˜¯ array.length.\nå¦‚æœ start çš„å€¼å¤§äºç­‰äº array.length, ä¼šå¾—åˆ°ä¸€ä¸ªæ–°çš„ç©ºæ•°ç»„.\n\n```javascript\nlet array = [1, 2, 3];\n\nlet a  = array.slice(0, 1); // [1]\nlet b = array.slice(1); // [2, 3]\nlet c = array.slice(-1); // [3]\n\n```\n\n### array.sort(comparefn)\nsort æ–¹æ³•æ˜¯å¯¹æ•°ç»„ä¸­çš„å…ƒç´ æ’åºï¼Œä½†ä»–çš„é»˜è®¤æ¯”è¾ƒå‡½æ•°æ˜¯æŠŠè¢«æ’åºçš„å…ƒç´ éƒ½è§†ä¸º\nå­—ç¬¦ä¸²ã€‚ æ‰€ä»¥é€šå¸¸éƒ½æ˜¯è‡ªå·±å®šä¹‰æ¯”è¾ƒå‡½æ•°.\n\n```javascript\n// å¯¹å­—ç¬¦ä¸²å’Œæ•°å­—æ’åº\nconst compare = (a, b) => {\n\tif (a === b) {\n\t\treturn 0\n\t}\n\tif (typeof a === typeof b) {\n\t\treturn  a < b ? -1 : 1\n\t}\n\treturn typeof a < typeof b ? -1 :1\n}\n\nlet array = ['bb', 'aa', 2, 'cc', 3, 1, 7];\n\nconsole.log(array.sort(compare())); // [ 1, 2, 3, 7, 'aa', 'bb', 'cc' ]\n```\n\n> ç¨³å®šæ€§ï¼šæ’åºå2ä¸ªç›¸ç­‰é”®å€¼çš„é¡ºåºå’Œæ’åºä¹‹å‰å®ƒä»¬çš„é¡ºåºç›¸åŒ.\n\n- ä¸ç¨³å®šæ’åº\n\n```javascript\nconst by = name => {\n\t// o/p æ¯ç»„ç›¸æ¯”è¾ƒçš„æ•°æ®\n\treturn (o, p) => {\n\t\tlet a, b;\n\n\t\tif(o && p && typeof o === 'object' && typeof p === 'object') {\n\t\t\ta = o[name];\n\t\t\tb = p[name];\n\t\t\t// å…¨ç­‰æ—¶\n\t\t\tif (a === b) {\n\t\t\t\treturn 0\n\t\t\t}\n\t\t\t// åŒç±»å‹\n\t\t\tif (typeof a === typeof b) {\n\t\t\t\treturn a < b ? -1 : 1 \n\t\t\t}\n\t\t\t// ä¸åŒç±»å‹\n\t\t\treturn typeof a < typeof b ? -1 : 1\n\t\t}else {\n\t\t\tconsole.log('æ’åºå¤±è´¥')\n\t\t}\n\t}\n}\n\nlet s = [\n\t{first: 'Joe', last: 'DeRita'},\n\t{first: 'Moe', last: 'Howard'},\n\t{first: 'Joe', last: 'Besser'},\n\t{first: 'Shemp', last: 'Howard'},\n\t{first: 'Larry', last: 'Fine'},\n\t{first: 'Curly', last: 'Howard'},\n]\n\nconsole.log(s.sort(by('first')).sort('last'));\n/*\n[ \n\t{ first: 'Curly', last: 'Howard' },\n\t{ first: 'Joe', last: 'DeRita' },\n\t{ first: 'Joe', last: 'Besser' },\n\t{ first: 'Larry', last: 'Fine' },\n\t{ first: 'Moe', last: 'Howard' },\n\t{ first: 'Shemp', last: 'Howard' }  \n]\n */\n```\n\n- ç¨³å®šæ’åº\n\n```javascript\n// è®©å‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°, å½“ç¬¬ä¸€ä¸ªå‡½æ•°ç›¸ç­‰æ—¶\n// ç”±ç¬¬äºŒä¸ªå‚æ•°å†æ¬¡æ¯”è¾ƒ, ç¬¬äºŒä¸ªæ¬¡è¦æ¯”è¾ƒå‡½æ•°å¯é€‰\nconst betterBy = (name, minor) => {\n\treturn (o, p) => {\n\t\tlet a, b;\n\t\tif (o && p && typeof o === 'object' && typeof 'object') {\n\t\t\ta = o[name];\n\t\t\tb = p[name];\n\t\t\tif (a === b) {\n\t\t\t\t// ç”¨æ¬¡è¦æ¯”è¾ƒå‡½æ•°å†æ¬¡å¯¹æ¯”\n\t\t\t\treturn typeof minor === 'function' ? minor(o, p) : 0\n\t\t\t}\n\t\t\tif (typeof a === typeof b) {\n\t\t\t\treturn a < b ? -1 : 1\n\t\t\t}\n\t\t\treturn typeof a < typeof b ? -1 : 1\n\t\t}else {\n\t\t\tconsole.log('æ’åºå¤±è´¥');\n\t\t}\n\t}\n}\n\nlet a = [\n\t{first: 'Joe', last: 'DeRita'},\n\t{first: 'Moe', last: 'Howard'},\n\t{first: 'Joe', last: 'Besser'},\n\t{first: 'Shemp', last: 'Howard'},\n\t{first: 'Larry', last: 'Fine'},\n\t{first: 'Curly', last: 'Howard'},\n];\n\nconsole.log(a.sort(by('last',by('first'))));\n/*[ \n\t{ first: 'Joe', last: 'Besser' },\n\t{ first: 'Joe', last: 'DeRita' },\n\t{ first: 'Larry', last: 'Fine' },\n\t{ first: 'Moe', last: 'Howard' },\n\t{ first: 'Shemp', last: 'Howard' },\n\t{ first: 'Curly', last: 'Howard' } \n]\n */\n```\n\n### array.splice(start, deleteCount, item...)\nsplice æ–¹æ³•ä» array ä¸­ç§»é™¤ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ , å¹¶ç”¨æ–°çš„ item æ›¿æ¢ä»–ä»¬.\nstart æ˜¯ä» array ä¸­ç§»é™¤å…ƒç´ çš„å¼€å§‹ä½ç½® ( ç´¢å¼• ) , deleteCount æ˜¯è¦\nåˆ é™¤å…ƒç´ çš„ä¸ªæ•°, item å‚æ•°å¦‚æœæœ‰ä¼šè¢«æ’å…¥åˆ°è¢«åˆ é™¤å…ƒç´ çš„ä½ç½®ä¸Š. è¿”å›\nè¢«åˆ é™¤çš„å…ƒç´ .\n\n```javascript\nlet arr = ['b', 'a', 'c', 'bug'];\nlet remove = arr.splice(1, 1, 'newItem', 'Hi');\n\nconsole.log(arr); // ['b', 'newItem', 'Hi','c', 'bug']\nconsole.log(remove); // ['a']\n```\n\n### array.unshift(item...)\nunshift æ–¹æ³•å‘æ•°ç»„çš„å¼€å¤´æ’å…¥ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ å¹¶è¿”å›æ•°ç»„æ–°çš„é•¿åº¦.\n\n```javascript\nlet arr = ['a', 'b', 'c'];\nlet insert = arr.unshift('Hi', 'd');\n\nconsole.log(arr); // ['Hi', 'd', 'a', 'b', 'c']\nconsole.log(insert); // 5\n```\n\n> ## RegExp\n\n### regexp.exec(string)\nexec æ–¹æ³•æ˜¯ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼çš„æœ€å¼ºå¤§(æœ€æ…¢)çš„æ–¹æ³•. å¦‚æœå®ƒæˆåŠŸåŒ¹é…\nregexp å’Œå­—ç¬¦ä¸² string, å°†è¿”å›ä¸€ä¸ªæ•°ç»„. æ•°ç»„ä¸­ä¸‹æ ‡ä¸º0çš„å…ƒç´ åŒ…å«\næ­£åˆ™è¡¨è¾¾å¼ regexp åŒ¹é…çš„å­å­—ç¬¦ä¸²; ä¸‹æ ‡ä¸º1çš„å…ƒç´ æ˜¯åˆ†ç»„1æ•è·çš„æ–‡æœ¬;\nä¸‹æ ‡ä¸º2çš„å…ƒç´ æ˜¯åˆ†ç»„2æ•è·çš„æ–‡æœ¬, ä»¥æ­¤ç±»æ¨. å¦‚æœåŒ¹é…å¤±è´¥åˆ™è¿”å›null.\n\n### regexp.test(string)\ntest æ–¹æ³•æ˜¯ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼çš„æœ€ç®€å•(æœ€å¿«)çš„æ–¹æ³•. å¦‚æœè¯¥regexp ä¸ string\nåŒ¹é…, å®ƒè¿”å› true, å¦åˆ™è¿”å› false. ä¸è¦å¯¹è¿™ä¸ªæ–¹æ³•ä½¿ç”¨ g æ ‡è¯†.\n\n```\nlet b = /&.+/.test('frank &amp; beans');\n\nconsole.log(b); // true\n```\n\n> ## String\n\n### string.charAt(pos)\ncharAt æ–¹æ³•è¿”å›åœ¨ string ä¸­ pos ä½ç½®å¤„çš„å­—ç¬¦ä¸². å¦‚æœ pos å°äº0æˆ–è€…\nå¤§äºç­‰äºå­—ç¬¦ä¸²çš„é•¿åº¦, å°†è¿”å›ç©ºå­—ç¬¦ä¸².\n\n```javascript\nlet name = 'Cara';\nlet initial = name.charAt(0);\n\nconsole.log(initial); // 'C'\n```\n\n### string.concat(string...)\nconcat æ–¹æ³•æŠŠå…¶ä»–å­—ç¬¦ä¸²è¿æ¥èµ·æ¥è¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸². é€šå¸¸ç”¨`+`\n\n### string.indexOf(searchString, position)\nindexOf æ–¹æ³•åœ¨ string å†…æŸ¥æ‰¾å¦ä¸€ä¸ªå­—ç¬¦ä¸² searchString. å¦‚æœè¢«\næ‰¾åˆ°è¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…å­—ç¬¦ä¸²çš„ä½ç½®, å¦åˆ™è¿”å›-1. å¯é€‰å‚æ•° position\nå¯è®¾ç½®ä» string çš„æŸä¸ªæŒ‡å®šä½ç½®å¼€å§‹æŸ¥æ‰¾.\n\n```javascript\nlet text = 'Mississippi';\nlet p = text.indexOf('ss'); // 2\np = text.indexOf('ss', 3); // 5\n```\n\n### string.lastIndexOf(searchString, position)\nlastIndexOf è·Ÿ indexOf æ–¹æ³•ç›¸å, æ˜¯ä»æ•°ç»„çš„æœ«å°¾å¼€å§‹æŸ¥æ‰¾.\nè¿”å›ä¸€ä¸ªæŒ‡å®šçš„å­—ç¬¦ä¸²å€¼æœ€åå‡ºç°çš„ä½ç½®, åœ¨ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­çš„æŒ‡å®šä½ç½®ä»åå‘å‰æœç´¢.\n\n```javascript\nlet text = 'Mississippi';\nlet p = text.lastIndexOf('ss'); // 5\np = text.lastIndexOf('ss', 3); // 2\np = text.lastIndexOf('ss', 6); // 5\n```\n\n### string.match(regexp)\nmatch æ–¹æ³•è®©å­—ç¬¦ä¸²å’Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼è¿›è¡ŒåŒ¹é…. å®ƒä¾æ®`g`æ ‡è¯†ç¬¦æ¥å†³å®šå¦‚ä½•\nè¿›è¡ŒåŒ¹é…. å¦‚æœæ²¡æœ‰`g`æ ‡è¯†ç¬¦, é‚£ä¹ˆè°ƒç”¨ `string.match(regexp)`çš„ç»“æœä¸\nè°ƒç”¨`regexp.exec(string)`çš„ç»“æœç›¸åŒ. å¦‚æœæœ‰`g`æ ‡è¯†ç¬¦, é‚£ä¹ˆå®ƒè¿”å›ä¸€ä¸ª\nåŒ…å«æ‰€æœ‰åŒ¹é…é¡¹(é™¤æ•è·åˆ†ç»„)çš„æ•°ç»„.\n\n### string.replace(searchValue, replaceValue)\nreplace æ–¹æ³•å¯¹ string è¿›è¡ŒæŸ¥æ‰¾å’Œæ›¿æ¢æ“ä½œ, å¹¶è¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸². å‚æ•°\nsearchValue å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡. å¦‚æœæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²,\né‚£ä¹ˆ searchValue åªä¼šæŠŠç¬¬ä¸€æ¬¡åŒ¹é…çš„å‡ºç°çš„åœ°æ–¹æ›¿æ¢æ‰; å¦‚æœæ˜¯æ­£åˆ™è¡¨è¾¾å¼\nå¸¦æœ‰`g`æ ‡è¯†ç¬¦, åˆ™ä¼šæ›¿æ¢ç‚¹æ‰€æœ‰åŒ¹é…é¡¹.\n\n```javascript\nlet str = '1-10-1001';\nlet reg = /-(\\d+)-/;\n\nstr.replace(reg, 'æ ‹$1å•å…ƒ');\nconsole.log(str); // 1æ ‹10å•å…ƒ1001\n\n```\n\n### string.search(regexp)\nsearch æ–¹æ³•å’Œ indexOf æ–¹æ³•ç±»ä¼¼, åªæ˜¯å®ƒåªæ¥å—ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡ä½œä¸ºå‚æ•°\nè€Œä¸æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸². å¦‚æœæ‰¾åˆ°åŒ¹é…, å®ƒè¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…çš„é¦–å­—ç¬¦ä½ç½®. å¦‚æœæ²¡æœ‰\nè¿”å›-1. æ­¤æ–¹æ³•ä¼šå¿½ç•¥`g`æ ‡è¯†ç¬¦.\n\n### string.slice(start, end)\nslice æ–¹æ³•å¤åˆ¶ string çš„ä¸€éƒ¨åˆ†æ„é€ æˆä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸². å¦‚æœ start å‚æ•°æ˜¯è´Ÿæ•°\n, ä»–å°†ä¸ string.length ç›¸åŠ . end å‚æ•°æ˜¯å¯é€‰çš„, é»˜è®¤æ˜¯ string.length. å¦‚æœ\nend å‚æ•°æ˜¯è´Ÿæ•°, ä¹Ÿä¼šä¸ string.length ç›¸åŠ . end å‚æ•°ç­‰äºä½ æƒ³å–çš„æœ€åä¸€ä¸ªå­—ç¬¦\nçš„ä½ç½®åŠ 1.\n\n```javascript\n// str.length == 39\nlet str = 'and in it he says \"Any damn fool could';\nlet a = str.slice(0, 3); // 'and'\nlet b = str.slice(-5); // 'could'\n```\n\n### string.split(separator, limit)\nsplit æ–¹æ³•æŠŠ string ä»¥æŒ‡å®šçš„åˆ†éš”ç¬¦æ„é€ æˆä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„. å¯é€‰å‚æ•°\nlimit å¯ä»¥é™åˆ¶è¢«åˆ†å‰²ç‰‡æ®µçš„æ•°é‡. separator å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…ä¸€ä¸ª\næ­£åˆ™è¡¨è¾¾å¼. æ­¤æ–¹æ³•ä¼šå¿½ç•¥`g`æ ‡è¯†ç¬¦.\n\n```javascript\nlet str = '0123456789';\nlet a = str.split('', 5);\n\nconsole.log(a); // ['0', '1', '2', '3', '4']\n```\n\n### string.substring(start, end)\nsubstring æ–¹æ³•å’Œ`slice` æ–¹æ³•ä¸€æ ·, åªæ˜¯ä¸èƒ½å¤„ç†è´Ÿæ•°. æ‰€ä»¥ç”¨`slice`ä»£æ›¿å®ƒ\n\n### string.toLocaleLowerCase()\ntoLocaleLowerCase æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸², å®ƒä½¿ç”¨æœ¬åœ°åŒ–çš„è§„åˆ™æŠŠè¿™ä¸ª string\nä¸­çš„æ‰€æœ‰å­—æ¯è½¬æ¢ä¸ºå°å†™æ ¼å¼.\n\n### string.toLocaleUpperCase()\ntoLocaleUpperCase æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸², å®ƒä½¿ç”¨æœ¬åœ°åŒ–çš„è§„åˆ™æŠŠè¿™ä¸ª string\nä¸­çš„æ‰€æœ‰å­—æ¯è½¬æ¢ä¸ºå¤§å†™æ ¼å¼.\n\nCreated on 17/9/21 by Cara\n","source":"_posts/JavaScript-æ–¹æ³•é›†.md","raw":"---\ntitle: JavaScript æ–¹æ³•é›†\ndate: 2017-10-16 22:29:16\ntags:\n- JavaScript\ncategories:\n- ç¬”è®°ğŸ“’\n- å¤ä¹ \n---\nJavaScriptåŒ…å«äº†ä¸€å¥—å°å‹çš„å¯ç”¨åœ¨æ ‡å‡†ç±»å‹ä¸Šçš„æ ‡å‡†æ–¹æ³•é›†,\nä¸»è¦æ˜¯é’ˆå¯¹æ•°ç»„/æ­£åˆ™åŠå­—ç¬¦ä¸²çš„ä¸€äº›å¤„ç†.\n\n> ## Array\n\n### array.concat(item...)\nconcat æ–¹æ³•äº§ç”Ÿä¸€ä¸ªæ–°çš„æ•°ç»„, å®ƒåŒ…å«çš„æ˜¯ä¸€ä»½ array çš„æµ…å¤åˆ¶\nå¹¶æŠŠå‚æ•° item è¿½åŠ åœ¨å…¶å. å¦‚æœ item æ˜¯æ•°ç»„, é‚£ä¹ˆè¿™ä¸ªæ•°ç»„çš„\næ¯ä¸ªå…ƒç´ éƒ½ä¼šè¢«æ·»åŠ .\n\n```javascript\nlet arr = [1, 2, 3];\nlet arr2 = [4, 5, 6];\nlet result = arr.concat(arr2, 'wow');\n\nconsole.log(result); // [1, 2, 3, 4, 5, 6, 'wow'];\n```\n\n### array.join(separator)\njoin æ–¹æ³•æ˜¯æŠŠä¸€ä¸ª array ä»¥æŒ‡å®šçš„åˆ†éš”ç¬¦æ„é€ æˆä¸€ä¸ªå­—ç¬¦ä¸².\nå®ƒå…ˆæŠŠ array ä¸­çš„æ¯ä¸ªå…ƒç´ æ„é€ æˆä¸€ä¸ªå­—ç¬¦ä¸², ç„¶åä»¥æŒ‡å®šçš„\nåˆ†éš”ç¬¦æŠŠå®ƒä»¬éƒ½è¿æ¥èµ·æ¥. é»˜è®¤çš„ separate æ˜¯é€—å·, å¯ä»¥ç”¨\nç©ºå­—ç¬¦ä¸²ä½œä¸º separate.\n\n```javascript\nlet array = [\"a\", \"b\", \"c\"];\narray.push(\"d\");\n\nlet result = array(\"|\");\nconsole.log(result); // \"a|b|c|d\"\n```\n\n### array.pop()\npop å’Œ push æ–¹æ³•å¯ä»¥ä½¿ array åƒå †æ ˆä¸€æ ·å·¥ä½œ. pop æ–¹æ³•ç§»é™¤æ•°ç»„\nä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ å¹¶è¿”å›è¯¥å…ƒç´ , å¦‚æœæ˜¯ç©ºæ•°ç»„, å®ƒå°†è¿”å› undefined.\n\n```javascript\nlet arr = [1, 2, 3];\narr.pop()\n\nconsole.log(arr); // 3\n```\n\n### array.push(item...)\npush æ–¹æ³•å‘æ•°ç»„çš„æœ«å°¾æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ . å’Œ concat æ–¹æ³•ä¸åŒçš„æ˜¯, \nä»–ä¼šä¿®æ”¹ array, å¦‚æœ item æ˜¯ä¸€ä¸ªæ•°ç»„, ä¼šå°†æ•´ä¸ªå‚æ•°æ•°ç»„ä½œä¸ºä¸€ä¸ªå…ƒç´ \næ·»åŠ åˆ° array çš„æœ«å°¾, å¹¶è¿”å›è¿™ä¸ªæ–°æ•°ç»„çš„é•¿åº¦.\n\n```javascript\nlet array = [1, 2, 3];\nlet arr = [4, 5, 6];\n\nlet result = array.push(arr. 'Hi');\nconsole.log(result); \n// array: [1, 2, 3, [4, 5, 6], 'Hi']\n// result: 5\n```\n\n### array.reverse()\nreverse æ–¹æ³•åè½¬æ•°ç»„å…ƒç´ çš„é¡ºåº, å¹¶è¿”å›æ•°ç»„æœ¬èº«.\n\n```javascript\nlet array = [1, 2, 3];\n\nlet result = array.reverse();\nconsole.log(result); // [3, 2, 1]\n```\n\n### array.shift()\nshift æ–¹æ³•ç§»é™¤æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ å¹¶è¿”å›è¯¥å…ƒç´ . å¦‚æœæ˜¯ç©ºæ•°ç»„\nå°†ä¼šè¿”å› undefined. shift é€šå¸¸æ¯” pop æ…¢å¾—å¤š.\n\n```javascript\nlet array = [1, 2, 3];\nlet result = array.shift();\n\nconsole.log(result); // 1\n\n```\n\n### array.slice(start, end)\nslice æ–¹æ³•æ˜¯æˆªå– array ä¸­çš„ä¸€æ®µåšæµ…å¤åˆ¶. å¤åˆ¶ array[start] å¼€å§‹\nåˆ°å¤åˆ¶ array[end]ä¸ºæ­¢. end å‚æ•°æ˜¯å¯é€‰çš„, é»˜è®¤å€¼çš„é•¿åº¦æ˜¯ array.length.\nå¦‚æœ start çš„å€¼å¤§äºç­‰äº array.length, ä¼šå¾—åˆ°ä¸€ä¸ªæ–°çš„ç©ºæ•°ç»„.\n\n```javascript\nlet array = [1, 2, 3];\n\nlet a  = array.slice(0, 1); // [1]\nlet b = array.slice(1); // [2, 3]\nlet c = array.slice(-1); // [3]\n\n```\n\n### array.sort(comparefn)\nsort æ–¹æ³•æ˜¯å¯¹æ•°ç»„ä¸­çš„å…ƒç´ æ’åºï¼Œä½†ä»–çš„é»˜è®¤æ¯”è¾ƒå‡½æ•°æ˜¯æŠŠè¢«æ’åºçš„å…ƒç´ éƒ½è§†ä¸º\nå­—ç¬¦ä¸²ã€‚ æ‰€ä»¥é€šå¸¸éƒ½æ˜¯è‡ªå·±å®šä¹‰æ¯”è¾ƒå‡½æ•°.\n\n```javascript\n// å¯¹å­—ç¬¦ä¸²å’Œæ•°å­—æ’åº\nconst compare = (a, b) => {\n\tif (a === b) {\n\t\treturn 0\n\t}\n\tif (typeof a === typeof b) {\n\t\treturn  a < b ? -1 : 1\n\t}\n\treturn typeof a < typeof b ? -1 :1\n}\n\nlet array = ['bb', 'aa', 2, 'cc', 3, 1, 7];\n\nconsole.log(array.sort(compare())); // [ 1, 2, 3, 7, 'aa', 'bb', 'cc' ]\n```\n\n> ç¨³å®šæ€§ï¼šæ’åºå2ä¸ªç›¸ç­‰é”®å€¼çš„é¡ºåºå’Œæ’åºä¹‹å‰å®ƒä»¬çš„é¡ºåºç›¸åŒ.\n\n- ä¸ç¨³å®šæ’åº\n\n```javascript\nconst by = name => {\n\t// o/p æ¯ç»„ç›¸æ¯”è¾ƒçš„æ•°æ®\n\treturn (o, p) => {\n\t\tlet a, b;\n\n\t\tif(o && p && typeof o === 'object' && typeof p === 'object') {\n\t\t\ta = o[name];\n\t\t\tb = p[name];\n\t\t\t// å…¨ç­‰æ—¶\n\t\t\tif (a === b) {\n\t\t\t\treturn 0\n\t\t\t}\n\t\t\t// åŒç±»å‹\n\t\t\tif (typeof a === typeof b) {\n\t\t\t\treturn a < b ? -1 : 1 \n\t\t\t}\n\t\t\t// ä¸åŒç±»å‹\n\t\t\treturn typeof a < typeof b ? -1 : 1\n\t\t}else {\n\t\t\tconsole.log('æ’åºå¤±è´¥')\n\t\t}\n\t}\n}\n\nlet s = [\n\t{first: 'Joe', last: 'DeRita'},\n\t{first: 'Moe', last: 'Howard'},\n\t{first: 'Joe', last: 'Besser'},\n\t{first: 'Shemp', last: 'Howard'},\n\t{first: 'Larry', last: 'Fine'},\n\t{first: 'Curly', last: 'Howard'},\n]\n\nconsole.log(s.sort(by('first')).sort('last'));\n/*\n[ \n\t{ first: 'Curly', last: 'Howard' },\n\t{ first: 'Joe', last: 'DeRita' },\n\t{ first: 'Joe', last: 'Besser' },\n\t{ first: 'Larry', last: 'Fine' },\n\t{ first: 'Moe', last: 'Howard' },\n\t{ first: 'Shemp', last: 'Howard' }  \n]\n */\n```\n\n- ç¨³å®šæ’åº\n\n```javascript\n// è®©å‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°, å½“ç¬¬ä¸€ä¸ªå‡½æ•°ç›¸ç­‰æ—¶\n// ç”±ç¬¬äºŒä¸ªå‚æ•°å†æ¬¡æ¯”è¾ƒ, ç¬¬äºŒä¸ªæ¬¡è¦æ¯”è¾ƒå‡½æ•°å¯é€‰\nconst betterBy = (name, minor) => {\n\treturn (o, p) => {\n\t\tlet a, b;\n\t\tif (o && p && typeof o === 'object' && typeof 'object') {\n\t\t\ta = o[name];\n\t\t\tb = p[name];\n\t\t\tif (a === b) {\n\t\t\t\t// ç”¨æ¬¡è¦æ¯”è¾ƒå‡½æ•°å†æ¬¡å¯¹æ¯”\n\t\t\t\treturn typeof minor === 'function' ? minor(o, p) : 0\n\t\t\t}\n\t\t\tif (typeof a === typeof b) {\n\t\t\t\treturn a < b ? -1 : 1\n\t\t\t}\n\t\t\treturn typeof a < typeof b ? -1 : 1\n\t\t}else {\n\t\t\tconsole.log('æ’åºå¤±è´¥');\n\t\t}\n\t}\n}\n\nlet a = [\n\t{first: 'Joe', last: 'DeRita'},\n\t{first: 'Moe', last: 'Howard'},\n\t{first: 'Joe', last: 'Besser'},\n\t{first: 'Shemp', last: 'Howard'},\n\t{first: 'Larry', last: 'Fine'},\n\t{first: 'Curly', last: 'Howard'},\n];\n\nconsole.log(a.sort(by('last',by('first'))));\n/*[ \n\t{ first: 'Joe', last: 'Besser' },\n\t{ first: 'Joe', last: 'DeRita' },\n\t{ first: 'Larry', last: 'Fine' },\n\t{ first: 'Moe', last: 'Howard' },\n\t{ first: 'Shemp', last: 'Howard' },\n\t{ first: 'Curly', last: 'Howard' } \n]\n */\n```\n\n### array.splice(start, deleteCount, item...)\nsplice æ–¹æ³•ä» array ä¸­ç§»é™¤ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ , å¹¶ç”¨æ–°çš„ item æ›¿æ¢ä»–ä»¬.\nstart æ˜¯ä» array ä¸­ç§»é™¤å…ƒç´ çš„å¼€å§‹ä½ç½® ( ç´¢å¼• ) , deleteCount æ˜¯è¦\nåˆ é™¤å…ƒç´ çš„ä¸ªæ•°, item å‚æ•°å¦‚æœæœ‰ä¼šè¢«æ’å…¥åˆ°è¢«åˆ é™¤å…ƒç´ çš„ä½ç½®ä¸Š. è¿”å›\nè¢«åˆ é™¤çš„å…ƒç´ .\n\n```javascript\nlet arr = ['b', 'a', 'c', 'bug'];\nlet remove = arr.splice(1, 1, 'newItem', 'Hi');\n\nconsole.log(arr); // ['b', 'newItem', 'Hi','c', 'bug']\nconsole.log(remove); // ['a']\n```\n\n### array.unshift(item...)\nunshift æ–¹æ³•å‘æ•°ç»„çš„å¼€å¤´æ’å…¥ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ å¹¶è¿”å›æ•°ç»„æ–°çš„é•¿åº¦.\n\n```javascript\nlet arr = ['a', 'b', 'c'];\nlet insert = arr.unshift('Hi', 'd');\n\nconsole.log(arr); // ['Hi', 'd', 'a', 'b', 'c']\nconsole.log(insert); // 5\n```\n\n> ## RegExp\n\n### regexp.exec(string)\nexec æ–¹æ³•æ˜¯ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼çš„æœ€å¼ºå¤§(æœ€æ…¢)çš„æ–¹æ³•. å¦‚æœå®ƒæˆåŠŸåŒ¹é…\nregexp å’Œå­—ç¬¦ä¸² string, å°†è¿”å›ä¸€ä¸ªæ•°ç»„. æ•°ç»„ä¸­ä¸‹æ ‡ä¸º0çš„å…ƒç´ åŒ…å«\næ­£åˆ™è¡¨è¾¾å¼ regexp åŒ¹é…çš„å­å­—ç¬¦ä¸²; ä¸‹æ ‡ä¸º1çš„å…ƒç´ æ˜¯åˆ†ç»„1æ•è·çš„æ–‡æœ¬;\nä¸‹æ ‡ä¸º2çš„å…ƒç´ æ˜¯åˆ†ç»„2æ•è·çš„æ–‡æœ¬, ä»¥æ­¤ç±»æ¨. å¦‚æœåŒ¹é…å¤±è´¥åˆ™è¿”å›null.\n\n### regexp.test(string)\ntest æ–¹æ³•æ˜¯ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼çš„æœ€ç®€å•(æœ€å¿«)çš„æ–¹æ³•. å¦‚æœè¯¥regexp ä¸ string\nåŒ¹é…, å®ƒè¿”å› true, å¦åˆ™è¿”å› false. ä¸è¦å¯¹è¿™ä¸ªæ–¹æ³•ä½¿ç”¨ g æ ‡è¯†.\n\n```\nlet b = /&.+/.test('frank &amp; beans');\n\nconsole.log(b); // true\n```\n\n> ## String\n\n### string.charAt(pos)\ncharAt æ–¹æ³•è¿”å›åœ¨ string ä¸­ pos ä½ç½®å¤„çš„å­—ç¬¦ä¸². å¦‚æœ pos å°äº0æˆ–è€…\nå¤§äºç­‰äºå­—ç¬¦ä¸²çš„é•¿åº¦, å°†è¿”å›ç©ºå­—ç¬¦ä¸².\n\n```javascript\nlet name = 'Cara';\nlet initial = name.charAt(0);\n\nconsole.log(initial); // 'C'\n```\n\n### string.concat(string...)\nconcat æ–¹æ³•æŠŠå…¶ä»–å­—ç¬¦ä¸²è¿æ¥èµ·æ¥è¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸². é€šå¸¸ç”¨`+`\n\n### string.indexOf(searchString, position)\nindexOf æ–¹æ³•åœ¨ string å†…æŸ¥æ‰¾å¦ä¸€ä¸ªå­—ç¬¦ä¸² searchString. å¦‚æœè¢«\næ‰¾åˆ°è¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…å­—ç¬¦ä¸²çš„ä½ç½®, å¦åˆ™è¿”å›-1. å¯é€‰å‚æ•° position\nå¯è®¾ç½®ä» string çš„æŸä¸ªæŒ‡å®šä½ç½®å¼€å§‹æŸ¥æ‰¾.\n\n```javascript\nlet text = 'Mississippi';\nlet p = text.indexOf('ss'); // 2\np = text.indexOf('ss', 3); // 5\n```\n\n### string.lastIndexOf(searchString, position)\nlastIndexOf è·Ÿ indexOf æ–¹æ³•ç›¸å, æ˜¯ä»æ•°ç»„çš„æœ«å°¾å¼€å§‹æŸ¥æ‰¾.\nè¿”å›ä¸€ä¸ªæŒ‡å®šçš„å­—ç¬¦ä¸²å€¼æœ€åå‡ºç°çš„ä½ç½®, åœ¨ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­çš„æŒ‡å®šä½ç½®ä»åå‘å‰æœç´¢.\n\n```javascript\nlet text = 'Mississippi';\nlet p = text.lastIndexOf('ss'); // 5\np = text.lastIndexOf('ss', 3); // 2\np = text.lastIndexOf('ss', 6); // 5\n```\n\n### string.match(regexp)\nmatch æ–¹æ³•è®©å­—ç¬¦ä¸²å’Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼è¿›è¡ŒåŒ¹é…. å®ƒä¾æ®`g`æ ‡è¯†ç¬¦æ¥å†³å®šå¦‚ä½•\nè¿›è¡ŒåŒ¹é…. å¦‚æœæ²¡æœ‰`g`æ ‡è¯†ç¬¦, é‚£ä¹ˆè°ƒç”¨ `string.match(regexp)`çš„ç»“æœä¸\nè°ƒç”¨`regexp.exec(string)`çš„ç»“æœç›¸åŒ. å¦‚æœæœ‰`g`æ ‡è¯†ç¬¦, é‚£ä¹ˆå®ƒè¿”å›ä¸€ä¸ª\nåŒ…å«æ‰€æœ‰åŒ¹é…é¡¹(é™¤æ•è·åˆ†ç»„)çš„æ•°ç»„.\n\n### string.replace(searchValue, replaceValue)\nreplace æ–¹æ³•å¯¹ string è¿›è¡ŒæŸ¥æ‰¾å’Œæ›¿æ¢æ“ä½œ, å¹¶è¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸². å‚æ•°\nsearchValue å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡. å¦‚æœæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²,\né‚£ä¹ˆ searchValue åªä¼šæŠŠç¬¬ä¸€æ¬¡åŒ¹é…çš„å‡ºç°çš„åœ°æ–¹æ›¿æ¢æ‰; å¦‚æœæ˜¯æ­£åˆ™è¡¨è¾¾å¼\nå¸¦æœ‰`g`æ ‡è¯†ç¬¦, åˆ™ä¼šæ›¿æ¢ç‚¹æ‰€æœ‰åŒ¹é…é¡¹.\n\n```javascript\nlet str = '1-10-1001';\nlet reg = /-(\\d+)-/;\n\nstr.replace(reg, 'æ ‹$1å•å…ƒ');\nconsole.log(str); // 1æ ‹10å•å…ƒ1001\n\n```\n\n### string.search(regexp)\nsearch æ–¹æ³•å’Œ indexOf æ–¹æ³•ç±»ä¼¼, åªæ˜¯å®ƒåªæ¥å—ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡ä½œä¸ºå‚æ•°\nè€Œä¸æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸². å¦‚æœæ‰¾åˆ°åŒ¹é…, å®ƒè¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…çš„é¦–å­—ç¬¦ä½ç½®. å¦‚æœæ²¡æœ‰\nè¿”å›-1. æ­¤æ–¹æ³•ä¼šå¿½ç•¥`g`æ ‡è¯†ç¬¦.\n\n### string.slice(start, end)\nslice æ–¹æ³•å¤åˆ¶ string çš„ä¸€éƒ¨åˆ†æ„é€ æˆä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸². å¦‚æœ start å‚æ•°æ˜¯è´Ÿæ•°\n, ä»–å°†ä¸ string.length ç›¸åŠ . end å‚æ•°æ˜¯å¯é€‰çš„, é»˜è®¤æ˜¯ string.length. å¦‚æœ\nend å‚æ•°æ˜¯è´Ÿæ•°, ä¹Ÿä¼šä¸ string.length ç›¸åŠ . end å‚æ•°ç­‰äºä½ æƒ³å–çš„æœ€åä¸€ä¸ªå­—ç¬¦\nçš„ä½ç½®åŠ 1.\n\n```javascript\n// str.length == 39\nlet str = 'and in it he says \"Any damn fool could';\nlet a = str.slice(0, 3); // 'and'\nlet b = str.slice(-5); // 'could'\n```\n\n### string.split(separator, limit)\nsplit æ–¹æ³•æŠŠ string ä»¥æŒ‡å®šçš„åˆ†éš”ç¬¦æ„é€ æˆä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„. å¯é€‰å‚æ•°\nlimit å¯ä»¥é™åˆ¶è¢«åˆ†å‰²ç‰‡æ®µçš„æ•°é‡. separator å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…ä¸€ä¸ª\næ­£åˆ™è¡¨è¾¾å¼. æ­¤æ–¹æ³•ä¼šå¿½ç•¥`g`æ ‡è¯†ç¬¦.\n\n```javascript\nlet str = '0123456789';\nlet a = str.split('', 5);\n\nconsole.log(a); // ['0', '1', '2', '3', '4']\n```\n\n### string.substring(start, end)\nsubstring æ–¹æ³•å’Œ`slice` æ–¹æ³•ä¸€æ ·, åªæ˜¯ä¸èƒ½å¤„ç†è´Ÿæ•°. æ‰€ä»¥ç”¨`slice`ä»£æ›¿å®ƒ\n\n### string.toLocaleLowerCase()\ntoLocaleLowerCase æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸², å®ƒä½¿ç”¨æœ¬åœ°åŒ–çš„è§„åˆ™æŠŠè¿™ä¸ª string\nä¸­çš„æ‰€æœ‰å­—æ¯è½¬æ¢ä¸ºå°å†™æ ¼å¼.\n\n### string.toLocaleUpperCase()\ntoLocaleUpperCase æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸², å®ƒä½¿ç”¨æœ¬åœ°åŒ–çš„è§„åˆ™æŠŠè¿™ä¸ª string\nä¸­çš„æ‰€æœ‰å­—æ¯è½¬æ¢ä¸ºå¤§å†™æ ¼å¼.\n\nCreated on 17/9/21 by Cara\n","slug":"JavaScript-æ–¹æ³•é›†","published":1,"updated":"2018-05-05T09:23:03.659Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjgurolsa000bklu0mpcieva2","content":"<p>JavaScriptåŒ…å«äº†ä¸€å¥—å°å‹çš„å¯ç”¨åœ¨æ ‡å‡†ç±»å‹ä¸Šçš„æ ‡å‡†æ–¹æ³•é›†,<br>ä¸»è¦æ˜¯é’ˆå¯¹æ•°ç»„/æ­£åˆ™åŠå­—ç¬¦ä¸²çš„ä¸€äº›å¤„ç†.</p>\n<blockquote>\n<h2 id=\"Array\"><a href=\"#Array\" class=\"headerlink\" title=\"Array\"></a>Array</h2></blockquote>\n<h3 id=\"array-concat-itemâ€¦\"><a href=\"#array-concat-itemâ€¦\" class=\"headerlink\" title=\"array.concat(itemâ€¦)\"></a>array.concat(itemâ€¦)</h3><p>concat æ–¹æ³•äº§ç”Ÿä¸€ä¸ªæ–°çš„æ•°ç»„, å®ƒåŒ…å«çš„æ˜¯ä¸€ä»½ array çš„æµ…å¤åˆ¶<br>å¹¶æŠŠå‚æ•° item è¿½åŠ åœ¨å…¶å. å¦‚æœ item æ˜¯æ•°ç»„, é‚£ä¹ˆè¿™ä¸ªæ•°ç»„çš„<br>æ¯ä¸ªå…ƒç´ éƒ½ä¼šè¢«æ·»åŠ .</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> arr = [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>];</span><br><span class=\"line\"><span class=\"keyword\">let</span> arr2 = [<span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>];</span><br><span class=\"line\"><span class=\"keyword\">let</span> result = arr.concat(arr2, <span class=\"string\">'wow'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(result); <span class=\"comment\">// [1, 2, 3, 4, 5, 6, 'wow'];</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"array-join-separator\"><a href=\"#array-join-separator\" class=\"headerlink\" title=\"array.join(separator)\"></a>array.join(separator)</h3><p>join æ–¹æ³•æ˜¯æŠŠä¸€ä¸ª array ä»¥æŒ‡å®šçš„åˆ†éš”ç¬¦æ„é€ æˆä¸€ä¸ªå­—ç¬¦ä¸².<br>å®ƒå…ˆæŠŠ array ä¸­çš„æ¯ä¸ªå…ƒç´ æ„é€ æˆä¸€ä¸ªå­—ç¬¦ä¸², ç„¶åä»¥æŒ‡å®šçš„<br>åˆ†éš”ç¬¦æŠŠå®ƒä»¬éƒ½è¿æ¥èµ·æ¥. é»˜è®¤çš„ separate æ˜¯é€—å·, å¯ä»¥ç”¨<br>ç©ºå­—ç¬¦ä¸²ä½œä¸º separate.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> array = [<span class=\"string\">\"a\"</span>, <span class=\"string\">\"b\"</span>, <span class=\"string\">\"c\"</span>];</span><br><span class=\"line\">array.push(<span class=\"string\">\"d\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> result = array(<span class=\"string\">\"|\"</span>);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(result); <span class=\"comment\">// \"a|b|c|d\"</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"array-pop\"><a href=\"#array-pop\" class=\"headerlink\" title=\"array.pop()\"></a>array.pop()</h3><p>pop å’Œ push æ–¹æ³•å¯ä»¥ä½¿ array åƒå †æ ˆä¸€æ ·å·¥ä½œ. pop æ–¹æ³•ç§»é™¤æ•°ç»„<br>ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ å¹¶è¿”å›è¯¥å…ƒç´ , å¦‚æœæ˜¯ç©ºæ•°ç»„, å®ƒå°†è¿”å› undefined.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> arr = [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>];</span><br><span class=\"line\">arr.pop()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(arr); <span class=\"comment\">// 3</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"array-push-itemâ€¦\"><a href=\"#array-push-itemâ€¦\" class=\"headerlink\" title=\"array.push(itemâ€¦)\"></a>array.push(itemâ€¦)</h3><p>push æ–¹æ³•å‘æ•°ç»„çš„æœ«å°¾æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ . å’Œ concat æ–¹æ³•ä¸åŒçš„æ˜¯,<br>ä»–ä¼šä¿®æ”¹ array, å¦‚æœ item æ˜¯ä¸€ä¸ªæ•°ç»„, ä¼šå°†æ•´ä¸ªå‚æ•°æ•°ç»„ä½œä¸ºä¸€ä¸ªå…ƒç´ <br>æ·»åŠ åˆ° array çš„æœ«å°¾, å¹¶è¿”å›è¿™ä¸ªæ–°æ•°ç»„çš„é•¿åº¦.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> array = [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>];</span><br><span class=\"line\"><span class=\"keyword\">let</span> arr = [<span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> result = array.push(arr. <span class=\"string\">'Hi'</span>);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(result); </span><br><span class=\"line\"><span class=\"comment\">// array: [1, 2, 3, [4, 5, 6], 'Hi']</span></span><br><span class=\"line\"><span class=\"comment\">// result: 5</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"array-reverse\"><a href=\"#array-reverse\" class=\"headerlink\" title=\"array.reverse()\"></a>array.reverse()</h3><p>reverse æ–¹æ³•åè½¬æ•°ç»„å…ƒç´ çš„é¡ºåº, å¹¶è¿”å›æ•°ç»„æœ¬èº«.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> array = [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> result = array.reverse();</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(result); <span class=\"comment\">// [3, 2, 1]</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"array-shift\"><a href=\"#array-shift\" class=\"headerlink\" title=\"array.shift()\"></a>array.shift()</h3><p>shift æ–¹æ³•ç§»é™¤æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ å¹¶è¿”å›è¯¥å…ƒç´ . å¦‚æœæ˜¯ç©ºæ•°ç»„<br>å°†ä¼šè¿”å› undefined. shift é€šå¸¸æ¯” pop æ…¢å¾—å¤š.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> array = [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>];</span><br><span class=\"line\"><span class=\"keyword\">let</span> result = array.shift();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(result); <span class=\"comment\">// 1</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"array-slice-start-end\"><a href=\"#array-slice-start-end\" class=\"headerlink\" title=\"array.slice(start, end)\"></a>array.slice(start, end)</h3><p>slice æ–¹æ³•æ˜¯æˆªå– array ä¸­çš„ä¸€æ®µåšæµ…å¤åˆ¶. å¤åˆ¶ array[start] å¼€å§‹<br>åˆ°å¤åˆ¶ array[end]ä¸ºæ­¢. end å‚æ•°æ˜¯å¯é€‰çš„, é»˜è®¤å€¼çš„é•¿åº¦æ˜¯ array.length.<br>å¦‚æœ start çš„å€¼å¤§äºç­‰äº array.length, ä¼šå¾—åˆ°ä¸€ä¸ªæ–°çš„ç©ºæ•°ç»„.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> array = [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> a  = array.slice(<span class=\"number\">0</span>, <span class=\"number\">1</span>); <span class=\"comment\">// [1]</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> b = array.slice(<span class=\"number\">1</span>); <span class=\"comment\">// [2, 3]</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> c = array.slice(<span class=\"number\">-1</span>); <span class=\"comment\">// [3]</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"array-sort-comparefn\"><a href=\"#array-sort-comparefn\" class=\"headerlink\" title=\"array.sort(comparefn)\"></a>array.sort(comparefn)</h3><p>sort æ–¹æ³•æ˜¯å¯¹æ•°ç»„ä¸­çš„å…ƒç´ æ’åºï¼Œä½†ä»–çš„é»˜è®¤æ¯”è¾ƒå‡½æ•°æ˜¯æŠŠè¢«æ’åºçš„å…ƒç´ éƒ½è§†ä¸º<br>å­—ç¬¦ä¸²ã€‚ æ‰€ä»¥é€šå¸¸éƒ½æ˜¯è‡ªå·±å®šä¹‰æ¯”è¾ƒå‡½æ•°.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// å¯¹å­—ç¬¦ä¸²å’Œæ•°å­—æ’åº</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> compare = <span class=\"function\">(<span class=\"params\">a, b</span>) =&gt;</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (a === b) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"number\">0</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> a === <span class=\"keyword\">typeof</span> b) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span>  a &lt; b ? <span class=\"number\">-1</span> : <span class=\"number\">1</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"keyword\">typeof</span> a &lt; <span class=\"keyword\">typeof</span> b ? <span class=\"number\">-1</span> :<span class=\"number\">1</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> array = [<span class=\"string\">'bb'</span>, <span class=\"string\">'aa'</span>, <span class=\"number\">2</span>, <span class=\"string\">'cc'</span>, <span class=\"number\">3</span>, <span class=\"number\">1</span>, <span class=\"number\">7</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(array.sort(compare())); <span class=\"comment\">// [ 1, 2, 3, 7, 'aa', 'bb', 'cc' ]</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>ç¨³å®šæ€§ï¼šæ’åºå2ä¸ªç›¸ç­‰é”®å€¼çš„é¡ºåºå’Œæ’åºä¹‹å‰å®ƒä»¬çš„é¡ºåºç›¸åŒ.</p>\n</blockquote>\n<ul>\n<li>ä¸ç¨³å®šæ’åº</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> by = <span class=\"function\"><span class=\"params\">name</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">// o/p æ¯ç»„ç›¸æ¯”è¾ƒçš„æ•°æ®</span></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"function\">(<span class=\"params\">o, p</span>) =&gt;</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> a, b;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(o &amp;&amp; p &amp;&amp; <span class=\"keyword\">typeof</span> o === <span class=\"string\">'object'</span> &amp;&amp; <span class=\"keyword\">typeof</span> p === <span class=\"string\">'object'</span>) &#123;</span><br><span class=\"line\">\t\t\ta = o[name];</span><br><span class=\"line\">\t\t\tb = p[name];</span><br><span class=\"line\">\t\t\t<span class=\"comment\">// å…¨ç­‰æ—¶</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (a === b) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> <span class=\"number\">0</span></span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">// åŒç±»å‹</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> a === <span class=\"keyword\">typeof</span> b) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> a &lt; b ? <span class=\"number\">-1</span> : <span class=\"number\">1</span> </span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">// ä¸åŒç±»å‹</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">typeof</span> a &lt; <span class=\"keyword\">typeof</span> b ? <span class=\"number\">-1</span> : <span class=\"number\">1</span></span><br><span class=\"line\">\t\t&#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">'æ’åºå¤±è´¥'</span>)</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> s = [</span><br><span class=\"line\">\t&#123;<span class=\"attr\">first</span>: <span class=\"string\">'Joe'</span>, <span class=\"attr\">last</span>: <span class=\"string\">'DeRita'</span>&#125;,</span><br><span class=\"line\">\t&#123;<span class=\"attr\">first</span>: <span class=\"string\">'Moe'</span>, <span class=\"attr\">last</span>: <span class=\"string\">'Howard'</span>&#125;,</span><br><span class=\"line\">\t&#123;<span class=\"attr\">first</span>: <span class=\"string\">'Joe'</span>, <span class=\"attr\">last</span>: <span class=\"string\">'Besser'</span>&#125;,</span><br><span class=\"line\">\t&#123;<span class=\"attr\">first</span>: <span class=\"string\">'Shemp'</span>, <span class=\"attr\">last</span>: <span class=\"string\">'Howard'</span>&#125;,</span><br><span class=\"line\">\t&#123;<span class=\"attr\">first</span>: <span class=\"string\">'Larry'</span>, <span class=\"attr\">last</span>: <span class=\"string\">'Fine'</span>&#125;,</span><br><span class=\"line\">\t&#123;<span class=\"attr\">first</span>: <span class=\"string\">'Curly'</span>, <span class=\"attr\">last</span>: <span class=\"string\">'Howard'</span>&#125;,</span><br><span class=\"line\">]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(s.sort(by(<span class=\"string\">'first'</span>)).sort(<span class=\"string\">'last'</span>));</span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">[ </span></span><br><span class=\"line\"><span class=\"comment\">\t&#123; first: 'Curly', last: 'Howard' &#125;,</span></span><br><span class=\"line\"><span class=\"comment\">\t&#123; first: 'Joe', last: 'DeRita' &#125;,</span></span><br><span class=\"line\"><span class=\"comment\">\t&#123; first: 'Joe', last: 'Besser' &#125;,</span></span><br><span class=\"line\"><span class=\"comment\">\t&#123; first: 'Larry', last: 'Fine' &#125;,</span></span><br><span class=\"line\"><span class=\"comment\">\t&#123; first: 'Moe', last: 'Howard' &#125;,</span></span><br><span class=\"line\"><span class=\"comment\">\t&#123; first: 'Shemp', last: 'Howard' &#125;  </span></span><br><span class=\"line\"><span class=\"comment\">]</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>ç¨³å®šæ’åº</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// è®©å‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°, å½“ç¬¬ä¸€ä¸ªå‡½æ•°ç›¸ç­‰æ—¶</span></span><br><span class=\"line\"><span class=\"comment\">// ç”±ç¬¬äºŒä¸ªå‚æ•°å†æ¬¡æ¯”è¾ƒ, ç¬¬äºŒä¸ªæ¬¡è¦æ¯”è¾ƒå‡½æ•°å¯é€‰</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> betterBy = <span class=\"function\">(<span class=\"params\">name, minor</span>) =&gt;</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"function\">(<span class=\"params\">o, p</span>) =&gt;</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> a, b;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (o &amp;&amp; p &amp;&amp; <span class=\"keyword\">typeof</span> o === <span class=\"string\">'object'</span> &amp;&amp; <span class=\"keyword\">typeof</span> <span class=\"string\">'object'</span>) &#123;</span><br><span class=\"line\">\t\t\ta = o[name];</span><br><span class=\"line\">\t\t\tb = p[name];</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (a === b) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"comment\">// ç”¨æ¬¡è¦æ¯”è¾ƒå‡½æ•°å†æ¬¡å¯¹æ¯”</span></span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">typeof</span> minor === <span class=\"string\">'function'</span> ? minor(o, p) : <span class=\"number\">0</span></span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> a === <span class=\"keyword\">typeof</span> b) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> a &lt; b ? <span class=\"number\">-1</span> : <span class=\"number\">1</span></span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">typeof</span> a &lt; <span class=\"keyword\">typeof</span> b ? <span class=\"number\">-1</span> : <span class=\"number\">1</span></span><br><span class=\"line\">\t\t&#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">'æ’åºå¤±è´¥'</span>);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> a = [</span><br><span class=\"line\">\t&#123;<span class=\"attr\">first</span>: <span class=\"string\">'Joe'</span>, <span class=\"attr\">last</span>: <span class=\"string\">'DeRita'</span>&#125;,</span><br><span class=\"line\">\t&#123;<span class=\"attr\">first</span>: <span class=\"string\">'Moe'</span>, <span class=\"attr\">last</span>: <span class=\"string\">'Howard'</span>&#125;,</span><br><span class=\"line\">\t&#123;<span class=\"attr\">first</span>: <span class=\"string\">'Joe'</span>, <span class=\"attr\">last</span>: <span class=\"string\">'Besser'</span>&#125;,</span><br><span class=\"line\">\t&#123;<span class=\"attr\">first</span>: <span class=\"string\">'Shemp'</span>, <span class=\"attr\">last</span>: <span class=\"string\">'Howard'</span>&#125;,</span><br><span class=\"line\">\t&#123;<span class=\"attr\">first</span>: <span class=\"string\">'Larry'</span>, <span class=\"attr\">last</span>: <span class=\"string\">'Fine'</span>&#125;,</span><br><span class=\"line\">\t&#123;<span class=\"attr\">first</span>: <span class=\"string\">'Curly'</span>, <span class=\"attr\">last</span>: <span class=\"string\">'Howard'</span>&#125;,</span><br><span class=\"line\">];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(a.sort(by(<span class=\"string\">'last'</span>,by(<span class=\"string\">'first'</span>))));</span><br><span class=\"line\"><span class=\"comment\">/*[ </span></span><br><span class=\"line\"><span class=\"comment\">\t&#123; first: 'Joe', last: 'Besser' &#125;,</span></span><br><span class=\"line\"><span class=\"comment\">\t&#123; first: 'Joe', last: 'DeRita' &#125;,</span></span><br><span class=\"line\"><span class=\"comment\">\t&#123; first: 'Larry', last: 'Fine' &#125;,</span></span><br><span class=\"line\"><span class=\"comment\">\t&#123; first: 'Moe', last: 'Howard' &#125;,</span></span><br><span class=\"line\"><span class=\"comment\">\t&#123; first: 'Shemp', last: 'Howard' &#125;,</span></span><br><span class=\"line\"><span class=\"comment\">\t&#123; first: 'Curly', last: 'Howard' &#125; </span></span><br><span class=\"line\"><span class=\"comment\">]</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"array-splice-start-deleteCount-itemâ€¦\"><a href=\"#array-splice-start-deleteCount-itemâ€¦\" class=\"headerlink\" title=\"array.splice(start, deleteCount, itemâ€¦)\"></a>array.splice(start, deleteCount, itemâ€¦)</h3><p>splice æ–¹æ³•ä» array ä¸­ç§»é™¤ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ , å¹¶ç”¨æ–°çš„ item æ›¿æ¢ä»–ä»¬.<br>start æ˜¯ä» array ä¸­ç§»é™¤å…ƒç´ çš„å¼€å§‹ä½ç½® ( ç´¢å¼• ) , deleteCount æ˜¯è¦<br>åˆ é™¤å…ƒç´ çš„ä¸ªæ•°, item å‚æ•°å¦‚æœæœ‰ä¼šè¢«æ’å…¥åˆ°è¢«åˆ é™¤å…ƒç´ çš„ä½ç½®ä¸Š. è¿”å›<br>è¢«åˆ é™¤çš„å…ƒç´ .</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> arr = [<span class=\"string\">'b'</span>, <span class=\"string\">'a'</span>, <span class=\"string\">'c'</span>, <span class=\"string\">'bug'</span>];</span><br><span class=\"line\"><span class=\"keyword\">let</span> remove = arr.splice(<span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"string\">'newItem'</span>, <span class=\"string\">'Hi'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(arr); <span class=\"comment\">// ['b', 'newItem', 'Hi','c', 'bug']</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(remove); <span class=\"comment\">// ['a']</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"array-unshift-itemâ€¦\"><a href=\"#array-unshift-itemâ€¦\" class=\"headerlink\" title=\"array.unshift(itemâ€¦)\"></a>array.unshift(itemâ€¦)</h3><p>unshift æ–¹æ³•å‘æ•°ç»„çš„å¼€å¤´æ’å…¥ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ å¹¶è¿”å›æ•°ç»„æ–°çš„é•¿åº¦.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> arr = [<span class=\"string\">'a'</span>, <span class=\"string\">'b'</span>, <span class=\"string\">'c'</span>];</span><br><span class=\"line\"><span class=\"keyword\">let</span> insert = arr.unshift(<span class=\"string\">'Hi'</span>, <span class=\"string\">'d'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(arr); <span class=\"comment\">// ['Hi', 'd', 'a', 'b', 'c']</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(insert); <span class=\"comment\">// 5</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<h2 id=\"RegExp\"><a href=\"#RegExp\" class=\"headerlink\" title=\"RegExp\"></a>RegExp</h2></blockquote>\n<h3 id=\"regexp-exec-string\"><a href=\"#regexp-exec-string\" class=\"headerlink\" title=\"regexp.exec(string)\"></a>regexp.exec(string)</h3><p>exec æ–¹æ³•æ˜¯ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼çš„æœ€å¼ºå¤§(æœ€æ…¢)çš„æ–¹æ³•. å¦‚æœå®ƒæˆåŠŸåŒ¹é…<br>regexp å’Œå­—ç¬¦ä¸² string, å°†è¿”å›ä¸€ä¸ªæ•°ç»„. æ•°ç»„ä¸­ä¸‹æ ‡ä¸º0çš„å…ƒç´ åŒ…å«<br>æ­£åˆ™è¡¨è¾¾å¼ regexp åŒ¹é…çš„å­å­—ç¬¦ä¸²; ä¸‹æ ‡ä¸º1çš„å…ƒç´ æ˜¯åˆ†ç»„1æ•è·çš„æ–‡æœ¬;<br>ä¸‹æ ‡ä¸º2çš„å…ƒç´ æ˜¯åˆ†ç»„2æ•è·çš„æ–‡æœ¬, ä»¥æ­¤ç±»æ¨. å¦‚æœåŒ¹é…å¤±è´¥åˆ™è¿”å›null.</p>\n<h3 id=\"regexp-test-string\"><a href=\"#regexp-test-string\" class=\"headerlink\" title=\"regexp.test(string)\"></a>regexp.test(string)</h3><p>test æ–¹æ³•æ˜¯ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼çš„æœ€ç®€å•(æœ€å¿«)çš„æ–¹æ³•. å¦‚æœè¯¥regexp ä¸ string<br>åŒ¹é…, å®ƒè¿”å› true, å¦åˆ™è¿”å› false. ä¸è¦å¯¹è¿™ä¸ªæ–¹æ³•ä½¿ç”¨ g æ ‡è¯†.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">let b = /&amp;.+/.test(&apos;frank &amp;amp; beans&apos;);</span><br><span class=\"line\"></span><br><span class=\"line\">console.log(b); // true</span><br></pre></td></tr></table></figure>\n<blockquote>\n<h2 id=\"String\"><a href=\"#String\" class=\"headerlink\" title=\"String\"></a>String</h2></blockquote>\n<h3 id=\"string-charAt-pos\"><a href=\"#string-charAt-pos\" class=\"headerlink\" title=\"string.charAt(pos)\"></a>string.charAt(pos)</h3><p>charAt æ–¹æ³•è¿”å›åœ¨ string ä¸­ pos ä½ç½®å¤„çš„å­—ç¬¦ä¸². å¦‚æœ pos å°äº0æˆ–è€…<br>å¤§äºç­‰äºå­—ç¬¦ä¸²çš„é•¿åº¦, å°†è¿”å›ç©ºå­—ç¬¦ä¸².</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> name = <span class=\"string\">'Cara'</span>;</span><br><span class=\"line\"><span class=\"keyword\">let</span> initial = name.charAt(<span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(initial); <span class=\"comment\">// 'C'</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"string-concat-stringâ€¦\"><a href=\"#string-concat-stringâ€¦\" class=\"headerlink\" title=\"string.concat(stringâ€¦)\"></a>string.concat(stringâ€¦)</h3><p>concat æ–¹æ³•æŠŠå…¶ä»–å­—ç¬¦ä¸²è¿æ¥èµ·æ¥è¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸². é€šå¸¸ç”¨<code>+</code></p>\n<h3 id=\"string-indexOf-searchString-position\"><a href=\"#string-indexOf-searchString-position\" class=\"headerlink\" title=\"string.indexOf(searchString, position)\"></a>string.indexOf(searchString, position)</h3><p>indexOf æ–¹æ³•åœ¨ string å†…æŸ¥æ‰¾å¦ä¸€ä¸ªå­—ç¬¦ä¸² searchString. å¦‚æœè¢«<br>æ‰¾åˆ°è¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…å­—ç¬¦ä¸²çš„ä½ç½®, å¦åˆ™è¿”å›-1. å¯é€‰å‚æ•° position<br>å¯è®¾ç½®ä» string çš„æŸä¸ªæŒ‡å®šä½ç½®å¼€å§‹æŸ¥æ‰¾.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> text = <span class=\"string\">'Mississippi'</span>;</span><br><span class=\"line\"><span class=\"keyword\">let</span> p = text.indexOf(<span class=\"string\">'ss'</span>); <span class=\"comment\">// 2</span></span><br><span class=\"line\">p = text.indexOf(<span class=\"string\">'ss'</span>, <span class=\"number\">3</span>); <span class=\"comment\">// 5</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"string-lastIndexOf-searchString-position\"><a href=\"#string-lastIndexOf-searchString-position\" class=\"headerlink\" title=\"string.lastIndexOf(searchString, position)\"></a>string.lastIndexOf(searchString, position)</h3><p>lastIndexOf è·Ÿ indexOf æ–¹æ³•ç›¸å, æ˜¯ä»æ•°ç»„çš„æœ«å°¾å¼€å§‹æŸ¥æ‰¾.<br>è¿”å›ä¸€ä¸ªæŒ‡å®šçš„å­—ç¬¦ä¸²å€¼æœ€åå‡ºç°çš„ä½ç½®, åœ¨ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­çš„æŒ‡å®šä½ç½®ä»åå‘å‰æœç´¢.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> text = <span class=\"string\">'Mississippi'</span>;</span><br><span class=\"line\"><span class=\"keyword\">let</span> p = text.lastIndexOf(<span class=\"string\">'ss'</span>); <span class=\"comment\">// 5</span></span><br><span class=\"line\">p = text.lastIndexOf(<span class=\"string\">'ss'</span>, <span class=\"number\">3</span>); <span class=\"comment\">// 2</span></span><br><span class=\"line\">p = text.lastIndexOf(<span class=\"string\">'ss'</span>, <span class=\"number\">6</span>); <span class=\"comment\">// 5</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"string-match-regexp\"><a href=\"#string-match-regexp\" class=\"headerlink\" title=\"string.match(regexp)\"></a>string.match(regexp)</h3><p>match æ–¹æ³•è®©å­—ç¬¦ä¸²å’Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼è¿›è¡ŒåŒ¹é…. å®ƒä¾æ®<code>g</code>æ ‡è¯†ç¬¦æ¥å†³å®šå¦‚ä½•<br>è¿›è¡ŒåŒ¹é…. å¦‚æœæ²¡æœ‰<code>g</code>æ ‡è¯†ç¬¦, é‚£ä¹ˆè°ƒç”¨ <code>string.match(regexp)</code>çš„ç»“æœä¸<br>è°ƒç”¨<code>regexp.exec(string)</code>çš„ç»“æœç›¸åŒ. å¦‚æœæœ‰<code>g</code>æ ‡è¯†ç¬¦, é‚£ä¹ˆå®ƒè¿”å›ä¸€ä¸ª<br>åŒ…å«æ‰€æœ‰åŒ¹é…é¡¹(é™¤æ•è·åˆ†ç»„)çš„æ•°ç»„.</p>\n<h3 id=\"string-replace-searchValue-replaceValue\"><a href=\"#string-replace-searchValue-replaceValue\" class=\"headerlink\" title=\"string.replace(searchValue, replaceValue)\"></a>string.replace(searchValue, replaceValue)</h3><p>replace æ–¹æ³•å¯¹ string è¿›è¡ŒæŸ¥æ‰¾å’Œæ›¿æ¢æ“ä½œ, å¹¶è¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸². å‚æ•°<br>searchValue å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡. å¦‚æœæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²,<br>é‚£ä¹ˆ searchValue åªä¼šæŠŠç¬¬ä¸€æ¬¡åŒ¹é…çš„å‡ºç°çš„åœ°æ–¹æ›¿æ¢æ‰; å¦‚æœæ˜¯æ­£åˆ™è¡¨è¾¾å¼<br>å¸¦æœ‰<code>g</code>æ ‡è¯†ç¬¦, åˆ™ä¼šæ›¿æ¢ç‚¹æ‰€æœ‰åŒ¹é…é¡¹.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> str = <span class=\"string\">'1-10-1001'</span>;</span><br><span class=\"line\"><span class=\"keyword\">let</span> reg = <span class=\"regexp\">/-(\\d+)-/</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">str.replace(reg, <span class=\"string\">'æ ‹$1å•å…ƒ'</span>);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(str); <span class=\"comment\">// 1æ ‹10å•å…ƒ1001</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"string-search-regexp\"><a href=\"#string-search-regexp\" class=\"headerlink\" title=\"string.search(regexp)\"></a>string.search(regexp)</h3><p>search æ–¹æ³•å’Œ indexOf æ–¹æ³•ç±»ä¼¼, åªæ˜¯å®ƒåªæ¥å—ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡ä½œä¸ºå‚æ•°<br>è€Œä¸æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸². å¦‚æœæ‰¾åˆ°åŒ¹é…, å®ƒè¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…çš„é¦–å­—ç¬¦ä½ç½®. å¦‚æœæ²¡æœ‰<br>è¿”å›-1. æ­¤æ–¹æ³•ä¼šå¿½ç•¥<code>g</code>æ ‡è¯†ç¬¦.</p>\n<h3 id=\"string-slice-start-end\"><a href=\"#string-slice-start-end\" class=\"headerlink\" title=\"string.slice(start, end)\"></a>string.slice(start, end)</h3><p>slice æ–¹æ³•å¤åˆ¶ string çš„ä¸€éƒ¨åˆ†æ„é€ æˆä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸². å¦‚æœ start å‚æ•°æ˜¯è´Ÿæ•°<br>, ä»–å°†ä¸ string.length ç›¸åŠ . end å‚æ•°æ˜¯å¯é€‰çš„, é»˜è®¤æ˜¯ string.length. å¦‚æœ<br>end å‚æ•°æ˜¯è´Ÿæ•°, ä¹Ÿä¼šä¸ string.length ç›¸åŠ . end å‚æ•°ç­‰äºä½ æƒ³å–çš„æœ€åä¸€ä¸ªå­—ç¬¦<br>çš„ä½ç½®åŠ 1.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// str.length == 39</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> str = <span class=\"string\">'and in it he says \"Any damn fool could'</span>;</span><br><span class=\"line\"><span class=\"keyword\">let</span> a = str.slice(<span class=\"number\">0</span>, <span class=\"number\">3</span>); <span class=\"comment\">// 'and'</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> b = str.slice(<span class=\"number\">-5</span>); <span class=\"comment\">// 'could'</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"string-split-separator-limit\"><a href=\"#string-split-separator-limit\" class=\"headerlink\" title=\"string.split(separator, limit)\"></a>string.split(separator, limit)</h3><p>split æ–¹æ³•æŠŠ string ä»¥æŒ‡å®šçš„åˆ†éš”ç¬¦æ„é€ æˆä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„. å¯é€‰å‚æ•°<br>limit å¯ä»¥é™åˆ¶è¢«åˆ†å‰²ç‰‡æ®µçš„æ•°é‡. separator å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…ä¸€ä¸ª<br>æ­£åˆ™è¡¨è¾¾å¼. æ­¤æ–¹æ³•ä¼šå¿½ç•¥<code>g</code>æ ‡è¯†ç¬¦.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> str = <span class=\"string\">'0123456789'</span>;</span><br><span class=\"line\"><span class=\"keyword\">let</span> a = str.split(<span class=\"string\">''</span>, <span class=\"number\">5</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(a); <span class=\"comment\">// ['0', '1', '2', '3', '4']</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"string-substring-start-end\"><a href=\"#string-substring-start-end\" class=\"headerlink\" title=\"string.substring(start, end)\"></a>string.substring(start, end)</h3><p>substring æ–¹æ³•å’Œ<code>slice</code> æ–¹æ³•ä¸€æ ·, åªæ˜¯ä¸èƒ½å¤„ç†è´Ÿæ•°. æ‰€ä»¥ç”¨<code>slice</code>ä»£æ›¿å®ƒ</p>\n<h3 id=\"string-toLocaleLowerCase\"><a href=\"#string-toLocaleLowerCase\" class=\"headerlink\" title=\"string.toLocaleLowerCase()\"></a>string.toLocaleLowerCase()</h3><p>toLocaleLowerCase æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸², å®ƒä½¿ç”¨æœ¬åœ°åŒ–çš„è§„åˆ™æŠŠè¿™ä¸ª string<br>ä¸­çš„æ‰€æœ‰å­—æ¯è½¬æ¢ä¸ºå°å†™æ ¼å¼.</p>\n<h3 id=\"string-toLocaleUpperCase\"><a href=\"#string-toLocaleUpperCase\" class=\"headerlink\" title=\"string.toLocaleUpperCase()\"></a>string.toLocaleUpperCase()</h3><p>toLocaleUpperCase æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸², å®ƒä½¿ç”¨æœ¬åœ°åŒ–çš„è§„åˆ™æŠŠè¿™ä¸ª string<br>ä¸­çš„æ‰€æœ‰å­—æ¯è½¬æ¢ä¸ºå¤§å†™æ ¼å¼.</p>\n<p>Created on 17/9/21 by Cara</p>\n","site":{"data":{}},"excerpt":"","more":"<p>JavaScriptåŒ…å«äº†ä¸€å¥—å°å‹çš„å¯ç”¨åœ¨æ ‡å‡†ç±»å‹ä¸Šçš„æ ‡å‡†æ–¹æ³•é›†,<br>ä¸»è¦æ˜¯é’ˆå¯¹æ•°ç»„/æ­£åˆ™åŠå­—ç¬¦ä¸²çš„ä¸€äº›å¤„ç†.</p>\n<blockquote>\n<h2 id=\"Array\"><a href=\"#Array\" class=\"headerlink\" title=\"Array\"></a>Array</h2></blockquote>\n<h3 id=\"array-concat-itemâ€¦\"><a href=\"#array-concat-itemâ€¦\" class=\"headerlink\" title=\"array.concat(itemâ€¦)\"></a>array.concat(itemâ€¦)</h3><p>concat æ–¹æ³•äº§ç”Ÿä¸€ä¸ªæ–°çš„æ•°ç»„, å®ƒåŒ…å«çš„æ˜¯ä¸€ä»½ array çš„æµ…å¤åˆ¶<br>å¹¶æŠŠå‚æ•° item è¿½åŠ åœ¨å…¶å. å¦‚æœ item æ˜¯æ•°ç»„, é‚£ä¹ˆè¿™ä¸ªæ•°ç»„çš„<br>æ¯ä¸ªå…ƒç´ éƒ½ä¼šè¢«æ·»åŠ .</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> arr = [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>];</span><br><span class=\"line\"><span class=\"keyword\">let</span> arr2 = [<span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>];</span><br><span class=\"line\"><span class=\"keyword\">let</span> result = arr.concat(arr2, <span class=\"string\">'wow'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(result); <span class=\"comment\">// [1, 2, 3, 4, 5, 6, 'wow'];</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"array-join-separator\"><a href=\"#array-join-separator\" class=\"headerlink\" title=\"array.join(separator)\"></a>array.join(separator)</h3><p>join æ–¹æ³•æ˜¯æŠŠä¸€ä¸ª array ä»¥æŒ‡å®šçš„åˆ†éš”ç¬¦æ„é€ æˆä¸€ä¸ªå­—ç¬¦ä¸².<br>å®ƒå…ˆæŠŠ array ä¸­çš„æ¯ä¸ªå…ƒç´ æ„é€ æˆä¸€ä¸ªå­—ç¬¦ä¸², ç„¶åä»¥æŒ‡å®šçš„<br>åˆ†éš”ç¬¦æŠŠå®ƒä»¬éƒ½è¿æ¥èµ·æ¥. é»˜è®¤çš„ separate æ˜¯é€—å·, å¯ä»¥ç”¨<br>ç©ºå­—ç¬¦ä¸²ä½œä¸º separate.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> array = [<span class=\"string\">\"a\"</span>, <span class=\"string\">\"b\"</span>, <span class=\"string\">\"c\"</span>];</span><br><span class=\"line\">array.push(<span class=\"string\">\"d\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> result = array(<span class=\"string\">\"|\"</span>);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(result); <span class=\"comment\">// \"a|b|c|d\"</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"array-pop\"><a href=\"#array-pop\" class=\"headerlink\" title=\"array.pop()\"></a>array.pop()</h3><p>pop å’Œ push æ–¹æ³•å¯ä»¥ä½¿ array åƒå †æ ˆä¸€æ ·å·¥ä½œ. pop æ–¹æ³•ç§»é™¤æ•°ç»„<br>ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ å¹¶è¿”å›è¯¥å…ƒç´ , å¦‚æœæ˜¯ç©ºæ•°ç»„, å®ƒå°†è¿”å› undefined.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> arr = [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>];</span><br><span class=\"line\">arr.pop()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(arr); <span class=\"comment\">// 3</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"array-push-itemâ€¦\"><a href=\"#array-push-itemâ€¦\" class=\"headerlink\" title=\"array.push(itemâ€¦)\"></a>array.push(itemâ€¦)</h3><p>push æ–¹æ³•å‘æ•°ç»„çš„æœ«å°¾æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ . å’Œ concat æ–¹æ³•ä¸åŒçš„æ˜¯,<br>ä»–ä¼šä¿®æ”¹ array, å¦‚æœ item æ˜¯ä¸€ä¸ªæ•°ç»„, ä¼šå°†æ•´ä¸ªå‚æ•°æ•°ç»„ä½œä¸ºä¸€ä¸ªå…ƒç´ <br>æ·»åŠ åˆ° array çš„æœ«å°¾, å¹¶è¿”å›è¿™ä¸ªæ–°æ•°ç»„çš„é•¿åº¦.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> array = [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>];</span><br><span class=\"line\"><span class=\"keyword\">let</span> arr = [<span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> result = array.push(arr. <span class=\"string\">'Hi'</span>);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(result); </span><br><span class=\"line\"><span class=\"comment\">// array: [1, 2, 3, [4, 5, 6], 'Hi']</span></span><br><span class=\"line\"><span class=\"comment\">// result: 5</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"array-reverse\"><a href=\"#array-reverse\" class=\"headerlink\" title=\"array.reverse()\"></a>array.reverse()</h3><p>reverse æ–¹æ³•åè½¬æ•°ç»„å…ƒç´ çš„é¡ºåº, å¹¶è¿”å›æ•°ç»„æœ¬èº«.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> array = [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> result = array.reverse();</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(result); <span class=\"comment\">// [3, 2, 1]</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"array-shift\"><a href=\"#array-shift\" class=\"headerlink\" title=\"array.shift()\"></a>array.shift()</h3><p>shift æ–¹æ³•ç§»é™¤æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ å¹¶è¿”å›è¯¥å…ƒç´ . å¦‚æœæ˜¯ç©ºæ•°ç»„<br>å°†ä¼šè¿”å› undefined. shift é€šå¸¸æ¯” pop æ…¢å¾—å¤š.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> array = [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>];</span><br><span class=\"line\"><span class=\"keyword\">let</span> result = array.shift();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(result); <span class=\"comment\">// 1</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"array-slice-start-end\"><a href=\"#array-slice-start-end\" class=\"headerlink\" title=\"array.slice(start, end)\"></a>array.slice(start, end)</h3><p>slice æ–¹æ³•æ˜¯æˆªå– array ä¸­çš„ä¸€æ®µåšæµ…å¤åˆ¶. å¤åˆ¶ array[start] å¼€å§‹<br>åˆ°å¤åˆ¶ array[end]ä¸ºæ­¢. end å‚æ•°æ˜¯å¯é€‰çš„, é»˜è®¤å€¼çš„é•¿åº¦æ˜¯ array.length.<br>å¦‚æœ start çš„å€¼å¤§äºç­‰äº array.length, ä¼šå¾—åˆ°ä¸€ä¸ªæ–°çš„ç©ºæ•°ç»„.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> array = [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> a  = array.slice(<span class=\"number\">0</span>, <span class=\"number\">1</span>); <span class=\"comment\">// [1]</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> b = array.slice(<span class=\"number\">1</span>); <span class=\"comment\">// [2, 3]</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> c = array.slice(<span class=\"number\">-1</span>); <span class=\"comment\">// [3]</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"array-sort-comparefn\"><a href=\"#array-sort-comparefn\" class=\"headerlink\" title=\"array.sort(comparefn)\"></a>array.sort(comparefn)</h3><p>sort æ–¹æ³•æ˜¯å¯¹æ•°ç»„ä¸­çš„å…ƒç´ æ’åºï¼Œä½†ä»–çš„é»˜è®¤æ¯”è¾ƒå‡½æ•°æ˜¯æŠŠè¢«æ’åºçš„å…ƒç´ éƒ½è§†ä¸º<br>å­—ç¬¦ä¸²ã€‚ æ‰€ä»¥é€šå¸¸éƒ½æ˜¯è‡ªå·±å®šä¹‰æ¯”è¾ƒå‡½æ•°.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// å¯¹å­—ç¬¦ä¸²å’Œæ•°å­—æ’åº</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> compare = <span class=\"function\">(<span class=\"params\">a, b</span>) =&gt;</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (a === b) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"number\">0</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> a === <span class=\"keyword\">typeof</span> b) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span>  a &lt; b ? <span class=\"number\">-1</span> : <span class=\"number\">1</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"keyword\">typeof</span> a &lt; <span class=\"keyword\">typeof</span> b ? <span class=\"number\">-1</span> :<span class=\"number\">1</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> array = [<span class=\"string\">'bb'</span>, <span class=\"string\">'aa'</span>, <span class=\"number\">2</span>, <span class=\"string\">'cc'</span>, <span class=\"number\">3</span>, <span class=\"number\">1</span>, <span class=\"number\">7</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(array.sort(compare())); <span class=\"comment\">// [ 1, 2, 3, 7, 'aa', 'bb', 'cc' ]</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>ç¨³å®šæ€§ï¼šæ’åºå2ä¸ªç›¸ç­‰é”®å€¼çš„é¡ºåºå’Œæ’åºä¹‹å‰å®ƒä»¬çš„é¡ºåºç›¸åŒ.</p>\n</blockquote>\n<ul>\n<li>ä¸ç¨³å®šæ’åº</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> by = <span class=\"function\"><span class=\"params\">name</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">// o/p æ¯ç»„ç›¸æ¯”è¾ƒçš„æ•°æ®</span></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"function\">(<span class=\"params\">o, p</span>) =&gt;</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> a, b;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(o &amp;&amp; p &amp;&amp; <span class=\"keyword\">typeof</span> o === <span class=\"string\">'object'</span> &amp;&amp; <span class=\"keyword\">typeof</span> p === <span class=\"string\">'object'</span>) &#123;</span><br><span class=\"line\">\t\t\ta = o[name];</span><br><span class=\"line\">\t\t\tb = p[name];</span><br><span class=\"line\">\t\t\t<span class=\"comment\">// å…¨ç­‰æ—¶</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (a === b) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> <span class=\"number\">0</span></span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">// åŒç±»å‹</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> a === <span class=\"keyword\">typeof</span> b) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> a &lt; b ? <span class=\"number\">-1</span> : <span class=\"number\">1</span> </span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">// ä¸åŒç±»å‹</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">typeof</span> a &lt; <span class=\"keyword\">typeof</span> b ? <span class=\"number\">-1</span> : <span class=\"number\">1</span></span><br><span class=\"line\">\t\t&#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">'æ’åºå¤±è´¥'</span>)</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> s = [</span><br><span class=\"line\">\t&#123;<span class=\"attr\">first</span>: <span class=\"string\">'Joe'</span>, <span class=\"attr\">last</span>: <span class=\"string\">'DeRita'</span>&#125;,</span><br><span class=\"line\">\t&#123;<span class=\"attr\">first</span>: <span class=\"string\">'Moe'</span>, <span class=\"attr\">last</span>: <span class=\"string\">'Howard'</span>&#125;,</span><br><span class=\"line\">\t&#123;<span class=\"attr\">first</span>: <span class=\"string\">'Joe'</span>, <span class=\"attr\">last</span>: <span class=\"string\">'Besser'</span>&#125;,</span><br><span class=\"line\">\t&#123;<span class=\"attr\">first</span>: <span class=\"string\">'Shemp'</span>, <span class=\"attr\">last</span>: <span class=\"string\">'Howard'</span>&#125;,</span><br><span class=\"line\">\t&#123;<span class=\"attr\">first</span>: <span class=\"string\">'Larry'</span>, <span class=\"attr\">last</span>: <span class=\"string\">'Fine'</span>&#125;,</span><br><span class=\"line\">\t&#123;<span class=\"attr\">first</span>: <span class=\"string\">'Curly'</span>, <span class=\"attr\">last</span>: <span class=\"string\">'Howard'</span>&#125;,</span><br><span class=\"line\">]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(s.sort(by(<span class=\"string\">'first'</span>)).sort(<span class=\"string\">'last'</span>));</span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">[ </span></span><br><span class=\"line\"><span class=\"comment\">\t&#123; first: 'Curly', last: 'Howard' &#125;,</span></span><br><span class=\"line\"><span class=\"comment\">\t&#123; first: 'Joe', last: 'DeRita' &#125;,</span></span><br><span class=\"line\"><span class=\"comment\">\t&#123; first: 'Joe', last: 'Besser' &#125;,</span></span><br><span class=\"line\"><span class=\"comment\">\t&#123; first: 'Larry', last: 'Fine' &#125;,</span></span><br><span class=\"line\"><span class=\"comment\">\t&#123; first: 'Moe', last: 'Howard' &#125;,</span></span><br><span class=\"line\"><span class=\"comment\">\t&#123; first: 'Shemp', last: 'Howard' &#125;  </span></span><br><span class=\"line\"><span class=\"comment\">]</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>ç¨³å®šæ’åº</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// è®©å‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°, å½“ç¬¬ä¸€ä¸ªå‡½æ•°ç›¸ç­‰æ—¶</span></span><br><span class=\"line\"><span class=\"comment\">// ç”±ç¬¬äºŒä¸ªå‚æ•°å†æ¬¡æ¯”è¾ƒ, ç¬¬äºŒä¸ªæ¬¡è¦æ¯”è¾ƒå‡½æ•°å¯é€‰</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> betterBy = <span class=\"function\">(<span class=\"params\">name, minor</span>) =&gt;</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"function\">(<span class=\"params\">o, p</span>) =&gt;</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> a, b;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (o &amp;&amp; p &amp;&amp; <span class=\"keyword\">typeof</span> o === <span class=\"string\">'object'</span> &amp;&amp; <span class=\"keyword\">typeof</span> <span class=\"string\">'object'</span>) &#123;</span><br><span class=\"line\">\t\t\ta = o[name];</span><br><span class=\"line\">\t\t\tb = p[name];</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (a === b) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"comment\">// ç”¨æ¬¡è¦æ¯”è¾ƒå‡½æ•°å†æ¬¡å¯¹æ¯”</span></span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">typeof</span> minor === <span class=\"string\">'function'</span> ? minor(o, p) : <span class=\"number\">0</span></span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> a === <span class=\"keyword\">typeof</span> b) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> a &lt; b ? <span class=\"number\">-1</span> : <span class=\"number\">1</span></span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">typeof</span> a &lt; <span class=\"keyword\">typeof</span> b ? <span class=\"number\">-1</span> : <span class=\"number\">1</span></span><br><span class=\"line\">\t\t&#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">'æ’åºå¤±è´¥'</span>);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> a = [</span><br><span class=\"line\">\t&#123;<span class=\"attr\">first</span>: <span class=\"string\">'Joe'</span>, <span class=\"attr\">last</span>: <span class=\"string\">'DeRita'</span>&#125;,</span><br><span class=\"line\">\t&#123;<span class=\"attr\">first</span>: <span class=\"string\">'Moe'</span>, <span class=\"attr\">last</span>: <span class=\"string\">'Howard'</span>&#125;,</span><br><span class=\"line\">\t&#123;<span class=\"attr\">first</span>: <span class=\"string\">'Joe'</span>, <span class=\"attr\">last</span>: <span class=\"string\">'Besser'</span>&#125;,</span><br><span class=\"line\">\t&#123;<span class=\"attr\">first</span>: <span class=\"string\">'Shemp'</span>, <span class=\"attr\">last</span>: <span class=\"string\">'Howard'</span>&#125;,</span><br><span class=\"line\">\t&#123;<span class=\"attr\">first</span>: <span class=\"string\">'Larry'</span>, <span class=\"attr\">last</span>: <span class=\"string\">'Fine'</span>&#125;,</span><br><span class=\"line\">\t&#123;<span class=\"attr\">first</span>: <span class=\"string\">'Curly'</span>, <span class=\"attr\">last</span>: <span class=\"string\">'Howard'</span>&#125;,</span><br><span class=\"line\">];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(a.sort(by(<span class=\"string\">'last'</span>,by(<span class=\"string\">'first'</span>))));</span><br><span class=\"line\"><span class=\"comment\">/*[ </span></span><br><span class=\"line\"><span class=\"comment\">\t&#123; first: 'Joe', last: 'Besser' &#125;,</span></span><br><span class=\"line\"><span class=\"comment\">\t&#123; first: 'Joe', last: 'DeRita' &#125;,</span></span><br><span class=\"line\"><span class=\"comment\">\t&#123; first: 'Larry', last: 'Fine' &#125;,</span></span><br><span class=\"line\"><span class=\"comment\">\t&#123; first: 'Moe', last: 'Howard' &#125;,</span></span><br><span class=\"line\"><span class=\"comment\">\t&#123; first: 'Shemp', last: 'Howard' &#125;,</span></span><br><span class=\"line\"><span class=\"comment\">\t&#123; first: 'Curly', last: 'Howard' &#125; </span></span><br><span class=\"line\"><span class=\"comment\">]</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"array-splice-start-deleteCount-itemâ€¦\"><a href=\"#array-splice-start-deleteCount-itemâ€¦\" class=\"headerlink\" title=\"array.splice(start, deleteCount, itemâ€¦)\"></a>array.splice(start, deleteCount, itemâ€¦)</h3><p>splice æ–¹æ³•ä» array ä¸­ç§»é™¤ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ , å¹¶ç”¨æ–°çš„ item æ›¿æ¢ä»–ä»¬.<br>start æ˜¯ä» array ä¸­ç§»é™¤å…ƒç´ çš„å¼€å§‹ä½ç½® ( ç´¢å¼• ) , deleteCount æ˜¯è¦<br>åˆ é™¤å…ƒç´ çš„ä¸ªæ•°, item å‚æ•°å¦‚æœæœ‰ä¼šè¢«æ’å…¥åˆ°è¢«åˆ é™¤å…ƒç´ çš„ä½ç½®ä¸Š. è¿”å›<br>è¢«åˆ é™¤çš„å…ƒç´ .</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> arr = [<span class=\"string\">'b'</span>, <span class=\"string\">'a'</span>, <span class=\"string\">'c'</span>, <span class=\"string\">'bug'</span>];</span><br><span class=\"line\"><span class=\"keyword\">let</span> remove = arr.splice(<span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"string\">'newItem'</span>, <span class=\"string\">'Hi'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(arr); <span class=\"comment\">// ['b', 'newItem', 'Hi','c', 'bug']</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(remove); <span class=\"comment\">// ['a']</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"array-unshift-itemâ€¦\"><a href=\"#array-unshift-itemâ€¦\" class=\"headerlink\" title=\"array.unshift(itemâ€¦)\"></a>array.unshift(itemâ€¦)</h3><p>unshift æ–¹æ³•å‘æ•°ç»„çš„å¼€å¤´æ’å…¥ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ å¹¶è¿”å›æ•°ç»„æ–°çš„é•¿åº¦.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> arr = [<span class=\"string\">'a'</span>, <span class=\"string\">'b'</span>, <span class=\"string\">'c'</span>];</span><br><span class=\"line\"><span class=\"keyword\">let</span> insert = arr.unshift(<span class=\"string\">'Hi'</span>, <span class=\"string\">'d'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(arr); <span class=\"comment\">// ['Hi', 'd', 'a', 'b', 'c']</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(insert); <span class=\"comment\">// 5</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<h2 id=\"RegExp\"><a href=\"#RegExp\" class=\"headerlink\" title=\"RegExp\"></a>RegExp</h2></blockquote>\n<h3 id=\"regexp-exec-string\"><a href=\"#regexp-exec-string\" class=\"headerlink\" title=\"regexp.exec(string)\"></a>regexp.exec(string)</h3><p>exec æ–¹æ³•æ˜¯ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼çš„æœ€å¼ºå¤§(æœ€æ…¢)çš„æ–¹æ³•. å¦‚æœå®ƒæˆåŠŸåŒ¹é…<br>regexp å’Œå­—ç¬¦ä¸² string, å°†è¿”å›ä¸€ä¸ªæ•°ç»„. æ•°ç»„ä¸­ä¸‹æ ‡ä¸º0çš„å…ƒç´ åŒ…å«<br>æ­£åˆ™è¡¨è¾¾å¼ regexp åŒ¹é…çš„å­å­—ç¬¦ä¸²; ä¸‹æ ‡ä¸º1çš„å…ƒç´ æ˜¯åˆ†ç»„1æ•è·çš„æ–‡æœ¬;<br>ä¸‹æ ‡ä¸º2çš„å…ƒç´ æ˜¯åˆ†ç»„2æ•è·çš„æ–‡æœ¬, ä»¥æ­¤ç±»æ¨. å¦‚æœåŒ¹é…å¤±è´¥åˆ™è¿”å›null.</p>\n<h3 id=\"regexp-test-string\"><a href=\"#regexp-test-string\" class=\"headerlink\" title=\"regexp.test(string)\"></a>regexp.test(string)</h3><p>test æ–¹æ³•æ˜¯ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼çš„æœ€ç®€å•(æœ€å¿«)çš„æ–¹æ³•. å¦‚æœè¯¥regexp ä¸ string<br>åŒ¹é…, å®ƒè¿”å› true, å¦åˆ™è¿”å› false. ä¸è¦å¯¹è¿™ä¸ªæ–¹æ³•ä½¿ç”¨ g æ ‡è¯†.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">let b = /&amp;.+/.test(&apos;frank &amp;amp; beans&apos;);</span><br><span class=\"line\"></span><br><span class=\"line\">console.log(b); // true</span><br></pre></td></tr></table></figure>\n<blockquote>\n<h2 id=\"String\"><a href=\"#String\" class=\"headerlink\" title=\"String\"></a>String</h2></blockquote>\n<h3 id=\"string-charAt-pos\"><a href=\"#string-charAt-pos\" class=\"headerlink\" title=\"string.charAt(pos)\"></a>string.charAt(pos)</h3><p>charAt æ–¹æ³•è¿”å›åœ¨ string ä¸­ pos ä½ç½®å¤„çš„å­—ç¬¦ä¸². å¦‚æœ pos å°äº0æˆ–è€…<br>å¤§äºç­‰äºå­—ç¬¦ä¸²çš„é•¿åº¦, å°†è¿”å›ç©ºå­—ç¬¦ä¸².</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> name = <span class=\"string\">'Cara'</span>;</span><br><span class=\"line\"><span class=\"keyword\">let</span> initial = name.charAt(<span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(initial); <span class=\"comment\">// 'C'</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"string-concat-stringâ€¦\"><a href=\"#string-concat-stringâ€¦\" class=\"headerlink\" title=\"string.concat(stringâ€¦)\"></a>string.concat(stringâ€¦)</h3><p>concat æ–¹æ³•æŠŠå…¶ä»–å­—ç¬¦ä¸²è¿æ¥èµ·æ¥è¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸². é€šå¸¸ç”¨<code>+</code></p>\n<h3 id=\"string-indexOf-searchString-position\"><a href=\"#string-indexOf-searchString-position\" class=\"headerlink\" title=\"string.indexOf(searchString, position)\"></a>string.indexOf(searchString, position)</h3><p>indexOf æ–¹æ³•åœ¨ string å†…æŸ¥æ‰¾å¦ä¸€ä¸ªå­—ç¬¦ä¸² searchString. å¦‚æœè¢«<br>æ‰¾åˆ°è¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…å­—ç¬¦ä¸²çš„ä½ç½®, å¦åˆ™è¿”å›-1. å¯é€‰å‚æ•° position<br>å¯è®¾ç½®ä» string çš„æŸä¸ªæŒ‡å®šä½ç½®å¼€å§‹æŸ¥æ‰¾.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> text = <span class=\"string\">'Mississippi'</span>;</span><br><span class=\"line\"><span class=\"keyword\">let</span> p = text.indexOf(<span class=\"string\">'ss'</span>); <span class=\"comment\">// 2</span></span><br><span class=\"line\">p = text.indexOf(<span class=\"string\">'ss'</span>, <span class=\"number\">3</span>); <span class=\"comment\">// 5</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"string-lastIndexOf-searchString-position\"><a href=\"#string-lastIndexOf-searchString-position\" class=\"headerlink\" title=\"string.lastIndexOf(searchString, position)\"></a>string.lastIndexOf(searchString, position)</h3><p>lastIndexOf è·Ÿ indexOf æ–¹æ³•ç›¸å, æ˜¯ä»æ•°ç»„çš„æœ«å°¾å¼€å§‹æŸ¥æ‰¾.<br>è¿”å›ä¸€ä¸ªæŒ‡å®šçš„å­—ç¬¦ä¸²å€¼æœ€åå‡ºç°çš„ä½ç½®, åœ¨ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­çš„æŒ‡å®šä½ç½®ä»åå‘å‰æœç´¢.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> text = <span class=\"string\">'Mississippi'</span>;</span><br><span class=\"line\"><span class=\"keyword\">let</span> p = text.lastIndexOf(<span class=\"string\">'ss'</span>); <span class=\"comment\">// 5</span></span><br><span class=\"line\">p = text.lastIndexOf(<span class=\"string\">'ss'</span>, <span class=\"number\">3</span>); <span class=\"comment\">// 2</span></span><br><span class=\"line\">p = text.lastIndexOf(<span class=\"string\">'ss'</span>, <span class=\"number\">6</span>); <span class=\"comment\">// 5</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"string-match-regexp\"><a href=\"#string-match-regexp\" class=\"headerlink\" title=\"string.match(regexp)\"></a>string.match(regexp)</h3><p>match æ–¹æ³•è®©å­—ç¬¦ä¸²å’Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼è¿›è¡ŒåŒ¹é…. å®ƒä¾æ®<code>g</code>æ ‡è¯†ç¬¦æ¥å†³å®šå¦‚ä½•<br>è¿›è¡ŒåŒ¹é…. å¦‚æœæ²¡æœ‰<code>g</code>æ ‡è¯†ç¬¦, é‚£ä¹ˆè°ƒç”¨ <code>string.match(regexp)</code>çš„ç»“æœä¸<br>è°ƒç”¨<code>regexp.exec(string)</code>çš„ç»“æœç›¸åŒ. å¦‚æœæœ‰<code>g</code>æ ‡è¯†ç¬¦, é‚£ä¹ˆå®ƒè¿”å›ä¸€ä¸ª<br>åŒ…å«æ‰€æœ‰åŒ¹é…é¡¹(é™¤æ•è·åˆ†ç»„)çš„æ•°ç»„.</p>\n<h3 id=\"string-replace-searchValue-replaceValue\"><a href=\"#string-replace-searchValue-replaceValue\" class=\"headerlink\" title=\"string.replace(searchValue, replaceValue)\"></a>string.replace(searchValue, replaceValue)</h3><p>replace æ–¹æ³•å¯¹ string è¿›è¡ŒæŸ¥æ‰¾å’Œæ›¿æ¢æ“ä½œ, å¹¶è¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸². å‚æ•°<br>searchValue å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡. å¦‚æœæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²,<br>é‚£ä¹ˆ searchValue åªä¼šæŠŠç¬¬ä¸€æ¬¡åŒ¹é…çš„å‡ºç°çš„åœ°æ–¹æ›¿æ¢æ‰; å¦‚æœæ˜¯æ­£åˆ™è¡¨è¾¾å¼<br>å¸¦æœ‰<code>g</code>æ ‡è¯†ç¬¦, åˆ™ä¼šæ›¿æ¢ç‚¹æ‰€æœ‰åŒ¹é…é¡¹.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> str = <span class=\"string\">'1-10-1001'</span>;</span><br><span class=\"line\"><span class=\"keyword\">let</span> reg = <span class=\"regexp\">/-(\\d+)-/</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">str.replace(reg, <span class=\"string\">'æ ‹$1å•å…ƒ'</span>);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(str); <span class=\"comment\">// 1æ ‹10å•å…ƒ1001</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"string-search-regexp\"><a href=\"#string-search-regexp\" class=\"headerlink\" title=\"string.search(regexp)\"></a>string.search(regexp)</h3><p>search æ–¹æ³•å’Œ indexOf æ–¹æ³•ç±»ä¼¼, åªæ˜¯å®ƒåªæ¥å—ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡ä½œä¸ºå‚æ•°<br>è€Œä¸æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸². å¦‚æœæ‰¾åˆ°åŒ¹é…, å®ƒè¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…çš„é¦–å­—ç¬¦ä½ç½®. å¦‚æœæ²¡æœ‰<br>è¿”å›-1. æ­¤æ–¹æ³•ä¼šå¿½ç•¥<code>g</code>æ ‡è¯†ç¬¦.</p>\n<h3 id=\"string-slice-start-end\"><a href=\"#string-slice-start-end\" class=\"headerlink\" title=\"string.slice(start, end)\"></a>string.slice(start, end)</h3><p>slice æ–¹æ³•å¤åˆ¶ string çš„ä¸€éƒ¨åˆ†æ„é€ æˆä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸². å¦‚æœ start å‚æ•°æ˜¯è´Ÿæ•°<br>, ä»–å°†ä¸ string.length ç›¸åŠ . end å‚æ•°æ˜¯å¯é€‰çš„, é»˜è®¤æ˜¯ string.length. å¦‚æœ<br>end å‚æ•°æ˜¯è´Ÿæ•°, ä¹Ÿä¼šä¸ string.length ç›¸åŠ . end å‚æ•°ç­‰äºä½ æƒ³å–çš„æœ€åä¸€ä¸ªå­—ç¬¦<br>çš„ä½ç½®åŠ 1.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// str.length == 39</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> str = <span class=\"string\">'and in it he says \"Any damn fool could'</span>;</span><br><span class=\"line\"><span class=\"keyword\">let</span> a = str.slice(<span class=\"number\">0</span>, <span class=\"number\">3</span>); <span class=\"comment\">// 'and'</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> b = str.slice(<span class=\"number\">-5</span>); <span class=\"comment\">// 'could'</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"string-split-separator-limit\"><a href=\"#string-split-separator-limit\" class=\"headerlink\" title=\"string.split(separator, limit)\"></a>string.split(separator, limit)</h3><p>split æ–¹æ³•æŠŠ string ä»¥æŒ‡å®šçš„åˆ†éš”ç¬¦æ„é€ æˆä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„. å¯é€‰å‚æ•°<br>limit å¯ä»¥é™åˆ¶è¢«åˆ†å‰²ç‰‡æ®µçš„æ•°é‡. separator å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…ä¸€ä¸ª<br>æ­£åˆ™è¡¨è¾¾å¼. æ­¤æ–¹æ³•ä¼šå¿½ç•¥<code>g</code>æ ‡è¯†ç¬¦.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> str = <span class=\"string\">'0123456789'</span>;</span><br><span class=\"line\"><span class=\"keyword\">let</span> a = str.split(<span class=\"string\">''</span>, <span class=\"number\">5</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(a); <span class=\"comment\">// ['0', '1', '2', '3', '4']</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"string-substring-start-end\"><a href=\"#string-substring-start-end\" class=\"headerlink\" title=\"string.substring(start, end)\"></a>string.substring(start, end)</h3><p>substring æ–¹æ³•å’Œ<code>slice</code> æ–¹æ³•ä¸€æ ·, åªæ˜¯ä¸èƒ½å¤„ç†è´Ÿæ•°. æ‰€ä»¥ç”¨<code>slice</code>ä»£æ›¿å®ƒ</p>\n<h3 id=\"string-toLocaleLowerCase\"><a href=\"#string-toLocaleLowerCase\" class=\"headerlink\" title=\"string.toLocaleLowerCase()\"></a>string.toLocaleLowerCase()</h3><p>toLocaleLowerCase æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸², å®ƒä½¿ç”¨æœ¬åœ°åŒ–çš„è§„åˆ™æŠŠè¿™ä¸ª string<br>ä¸­çš„æ‰€æœ‰å­—æ¯è½¬æ¢ä¸ºå°å†™æ ¼å¼.</p>\n<h3 id=\"string-toLocaleUpperCase\"><a href=\"#string-toLocaleUpperCase\" class=\"headerlink\" title=\"string.toLocaleUpperCase()\"></a>string.toLocaleUpperCase()</h3><p>toLocaleUpperCase æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸², å®ƒä½¿ç”¨æœ¬åœ°åŒ–çš„è§„åˆ™æŠŠè¿™ä¸ª string<br>ä¸­çš„æ‰€æœ‰å­—æ¯è½¬æ¢ä¸ºå¤§å†™æ ¼å¼.</p>\n<p>Created on 17/9/21 by Cara</p>\n"},{"title":"JavaScript å…³äºè¿ç®—çš„å°æŠ€å·§","date":"2017-10-17T14:10:33.000Z","_content":"> #### 1. ä½¿ç”¨ `!!` æ“ä½œç¬¦è½¬æ¢å¸ƒå°”å€¼\nç”¨äºæ£€æŸ¥ä¸€ä¸ªå˜é‡æ˜¯å¦å­˜åœ¨æˆ–è€…æ˜¯æœ‰æ•ˆå€¼, å¯¹å˜é‡ä½¿ç”¨ `!!variable` æ¥éªŒè¯,\nåªè¦å˜é‡çš„å€¼ä¸º: 0, null, undefined, NaNéƒ½å°†è¿”å› false, åä¹‹è¿”å› true. å¦‚: \n\n```javascript\n class Foo {\n    constructor ( count ) {\n        this.cash = count;\n        this.myCash = !!count;\n    }\n}\nvar emptyFoo = new Foo(0);\nconsole.log(foo.cash); // 0\nconsole.log(foo.myCash); // false\n\nvar foo = new Foo(100);\nconsole.log(foo.cash); // 100\nconsole.log(foo.myCash); // true\n```\n\n> #### 2. ä½¿ç”¨ `+` å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—\nåªé€‚åˆå°†å­—ç¬¦ä¸²æ•°æ®è½¬æ¢ä¸ºæ•°å­—, ç»™åå°ä¼ æ•°æ®çš„æ—¶å€™ç»å¸¸ç”¨åˆ°, \nå¦‚æœä¸æ˜¯å­—ç¬¦ä¸²æ•°æ®ä¼šè¿”å› NaN.\n\n```javascript\nvar toNumber = strNumber => {\n    return +strNumber;\n}\nconsole.log( toNumber(\"123\") ); // 123\nconsole.log( toNumber(\" abc\")); // NaN\n\n// Dateä¹Ÿå¯ä»¥ä½¿ç”¨\nconsole.log( +new Date() ); // è¿”å›æ—¶é—´æˆ³\n```\n\n> #### 3. å¹¶ç¬¦æ¡ä»¶\nç»å¸¸ç”¨åˆ°è¿™æ ·çš„æ¡ä»¶åˆ¤æ–­.\n\n```javascript\nif (isConcat) {\n    Login()\n}\n```\nå¯ä»¥ç®€å†™æˆè¿™æ · ` isConact && Login() `\n\n### 4. è·å–æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ \n`Array.prototype.slice (begin, end)` ç»å¸¸ç”¨è¿™æ ·çš„æ–¹å¼æ¥æˆªå–æ•°ç»„çš„å…ƒç´ , \nå¦‚æœä¸è®¾ç½® end çš„å€¼, é‚£ä¹ˆé»˜è®¤ä¼šå°†æ•°ç»„çš„é•¿åº¦ä½œä¸º end å€¼. \nå¦‚æœå°†è´Ÿæ•°ä½œä¸ºå‚æ•°çš„ begin å€¼, å°±å¯ä»¥è·å–æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ .\n\n```javascript\nvar arr = [1,2,3,4,5];\nconsole.log( arr.slice(-1) ); // [5]\nconosle.log( arr.slice(-2) ); // [4,5]\nä»¥æ­¤ç±»æ¨\n```\n> #### 5. æˆªæ–­æ•°ç»„\nç”¨æ¥é”å®šæ•°ç»„çš„é•¿åº¦, åˆ é™¤æ•°ç»„ä¸­çš„ä¸€äº›å…ƒç´ . æ¯”å¦‚æ•°ç»„ä¸€å…±æœ‰10ä¸ªå…ƒç´ , \nä½†æˆ‘åªéœ€è¦å‰5ä¸ªå…ƒç´ , å°±å¯ä»¥é€šè¿‡ `array.length = 5 ` æ¥æˆªæ–­æ•°ç»„, å¦‚: \n\n```javascript\nvar arr = [1,2,3,4,5];\nconsole.log( arr.length); // 5\narr.length = 3;\nconsole.log( arr.length ); // 3\nconsole.log( arr ); // [1,2,3]\n```\n\n> #### 6. å°†NodeListè½¬æ¢ä¸ºæ•°ç»„\nå¦‚æœé€šè¿‡ ` doucment.querySelectorAll('p') ` è·å–å…ƒç´ , å®ƒè¿”å›çš„æ˜¯ä¸€ä¸ªDOMå…ƒç´ çš„\næ•°ç»„ ( NodeList ) å¯¹è±¡, ä½†æ˜¯è¿™ä¸ªæ•°ç»„ä¸å…·æœ‰æ•°ç»„çš„åŠŸèƒ½,\næ¯”å¦‚ ` push() / sort() ` ç­‰. è¿™å°±éœ€è¦å°†è¿™ä¸ª NodeList è½¬æ¢ä¸ºçœŸæ­£çš„æ•°ç»„.\nå¯ä»¥ä½¿ç”¨ ` [].slice.call( NodeList ) ` æ¥å®ç°. å¦‚:\n\n```javascript\nvar els = document.querySelectorAll( 'p' );\n[].slice.call( els );\nOR:\nvar arrElement = Array.from( els );\nES6:\nvar arr = [...els]\n```\n> #### 7. æ•°ç»„å…ƒç´ é‡æ’\n```javascript\nvar list = [1,2,3];\nconsole.log(list.sort(()=>{ Math.random() - 0.5}))\n```\n\nCreated on 2017-6-14 by Cara\n","source":"_posts/JavaScript-å…³äºè¿ç®—çš„å°æŠ€å·§.md","raw":"---\ntitle: JavaScript å…³äºè¿ç®—çš„å°æŠ€å·§\ndate: 2017-10-17 22:10:33\ntags:\n- JavaScript\ncategories:\n- ç¬”è®°ğŸ“’\n- å¤ä¹ \n---\n> #### 1. ä½¿ç”¨ `!!` æ“ä½œç¬¦è½¬æ¢å¸ƒå°”å€¼\nç”¨äºæ£€æŸ¥ä¸€ä¸ªå˜é‡æ˜¯å¦å­˜åœ¨æˆ–è€…æ˜¯æœ‰æ•ˆå€¼, å¯¹å˜é‡ä½¿ç”¨ `!!variable` æ¥éªŒè¯,\nåªè¦å˜é‡çš„å€¼ä¸º: 0, null, undefined, NaNéƒ½å°†è¿”å› false, åä¹‹è¿”å› true. å¦‚: \n\n```javascript\n class Foo {\n    constructor ( count ) {\n        this.cash = count;\n        this.myCash = !!count;\n    }\n}\nvar emptyFoo = new Foo(0);\nconsole.log(foo.cash); // 0\nconsole.log(foo.myCash); // false\n\nvar foo = new Foo(100);\nconsole.log(foo.cash); // 100\nconsole.log(foo.myCash); // true\n```\n\n> #### 2. ä½¿ç”¨ `+` å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—\nåªé€‚åˆå°†å­—ç¬¦ä¸²æ•°æ®è½¬æ¢ä¸ºæ•°å­—, ç»™åå°ä¼ æ•°æ®çš„æ—¶å€™ç»å¸¸ç”¨åˆ°, \nå¦‚æœä¸æ˜¯å­—ç¬¦ä¸²æ•°æ®ä¼šè¿”å› NaN.\n\n```javascript\nvar toNumber = strNumber => {\n    return +strNumber;\n}\nconsole.log( toNumber(\"123\") ); // 123\nconsole.log( toNumber(\" abc\")); // NaN\n\n// Dateä¹Ÿå¯ä»¥ä½¿ç”¨\nconsole.log( +new Date() ); // è¿”å›æ—¶é—´æˆ³\n```\n\n> #### 3. å¹¶ç¬¦æ¡ä»¶\nç»å¸¸ç”¨åˆ°è¿™æ ·çš„æ¡ä»¶åˆ¤æ–­.\n\n```javascript\nif (isConcat) {\n    Login()\n}\n```\nå¯ä»¥ç®€å†™æˆè¿™æ · ` isConact && Login() `\n\n### 4. è·å–æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ \n`Array.prototype.slice (begin, end)` ç»å¸¸ç”¨è¿™æ ·çš„æ–¹å¼æ¥æˆªå–æ•°ç»„çš„å…ƒç´ , \nå¦‚æœä¸è®¾ç½® end çš„å€¼, é‚£ä¹ˆé»˜è®¤ä¼šå°†æ•°ç»„çš„é•¿åº¦ä½œä¸º end å€¼. \nå¦‚æœå°†è´Ÿæ•°ä½œä¸ºå‚æ•°çš„ begin å€¼, å°±å¯ä»¥è·å–æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ .\n\n```javascript\nvar arr = [1,2,3,4,5];\nconsole.log( arr.slice(-1) ); // [5]\nconosle.log( arr.slice(-2) ); // [4,5]\nä»¥æ­¤ç±»æ¨\n```\n> #### 5. æˆªæ–­æ•°ç»„\nç”¨æ¥é”å®šæ•°ç»„çš„é•¿åº¦, åˆ é™¤æ•°ç»„ä¸­çš„ä¸€äº›å…ƒç´ . æ¯”å¦‚æ•°ç»„ä¸€å…±æœ‰10ä¸ªå…ƒç´ , \nä½†æˆ‘åªéœ€è¦å‰5ä¸ªå…ƒç´ , å°±å¯ä»¥é€šè¿‡ `array.length = 5 ` æ¥æˆªæ–­æ•°ç»„, å¦‚: \n\n```javascript\nvar arr = [1,2,3,4,5];\nconsole.log( arr.length); // 5\narr.length = 3;\nconsole.log( arr.length ); // 3\nconsole.log( arr ); // [1,2,3]\n```\n\n> #### 6. å°†NodeListè½¬æ¢ä¸ºæ•°ç»„\nå¦‚æœé€šè¿‡ ` doucment.querySelectorAll('p') ` è·å–å…ƒç´ , å®ƒè¿”å›çš„æ˜¯ä¸€ä¸ªDOMå…ƒç´ çš„\næ•°ç»„ ( NodeList ) å¯¹è±¡, ä½†æ˜¯è¿™ä¸ªæ•°ç»„ä¸å…·æœ‰æ•°ç»„çš„åŠŸèƒ½,\næ¯”å¦‚ ` push() / sort() ` ç­‰. è¿™å°±éœ€è¦å°†è¿™ä¸ª NodeList è½¬æ¢ä¸ºçœŸæ­£çš„æ•°ç»„.\nå¯ä»¥ä½¿ç”¨ ` [].slice.call( NodeList ) ` æ¥å®ç°. å¦‚:\n\n```javascript\nvar els = document.querySelectorAll( 'p' );\n[].slice.call( els );\nOR:\nvar arrElement = Array.from( els );\nES6:\nvar arr = [...els]\n```\n> #### 7. æ•°ç»„å…ƒç´ é‡æ’\n```javascript\nvar list = [1,2,3];\nconsole.log(list.sort(()=>{ Math.random() - 0.5}))\n```\n\nCreated on 2017-6-14 by Cara\n","slug":"JavaScript-å…³äºè¿ç®—çš„å°æŠ€å·§","published":1,"updated":"2018-05-05T09:23:03.658Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjgurolsc000cklu0grv9im7h","content":"<blockquote>\n<h4 id=\"1-ä½¿ç”¨-æ“ä½œç¬¦è½¬æ¢å¸ƒå°”å€¼\"><a href=\"#1-ä½¿ç”¨-æ“ä½œç¬¦è½¬æ¢å¸ƒå°”å€¼\" class=\"headerlink\" title=\"1. ä½¿ç”¨ !! æ“ä½œç¬¦è½¬æ¢å¸ƒå°”å€¼\"></a>1. ä½¿ç”¨ <code>!!</code> æ“ä½œç¬¦è½¬æ¢å¸ƒå°”å€¼</h4><p>ç”¨äºæ£€æŸ¥ä¸€ä¸ªå˜é‡æ˜¯å¦å­˜åœ¨æˆ–è€…æ˜¯æœ‰æ•ˆå€¼, å¯¹å˜é‡ä½¿ç”¨ <code>!!variable</code> æ¥éªŒè¯,<br>åªè¦å˜é‡çš„å€¼ä¸º: 0, null, undefined, NaNéƒ½å°†è¿”å› false, åä¹‹è¿”å› true. å¦‚: </p>\n</blockquote>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Foo</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">constructor</span> ( count ) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.cash = count;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.myCash = !!count;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">var</span> emptyFoo = <span class=\"keyword\">new</span> Foo(<span class=\"number\">0</span>);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(foo.cash); <span class=\"comment\">// 0</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(foo.myCash); <span class=\"comment\">// false</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> foo = <span class=\"keyword\">new</span> Foo(<span class=\"number\">100</span>);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(foo.cash); <span class=\"comment\">// 100</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(foo.myCash); <span class=\"comment\">// true</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<h4 id=\"2-ä½¿ç”¨-å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—\"><a href=\"#2-ä½¿ç”¨-å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—\" class=\"headerlink\" title=\"2. ä½¿ç”¨ + å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—\"></a>2. ä½¿ç”¨ <code>+</code> å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—</h4><p>åªé€‚åˆå°†å­—ç¬¦ä¸²æ•°æ®è½¬æ¢ä¸ºæ•°å­—, ç»™åå°ä¼ æ•°æ®çš„æ—¶å€™ç»å¸¸ç”¨åˆ°,<br>å¦‚æœä¸æ˜¯å­—ç¬¦ä¸²æ•°æ®ä¼šè¿”å› NaN.</p>\n</blockquote>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> toNumber = <span class=\"function\"><span class=\"params\">strNumber</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> +strNumber;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log( toNumber(<span class=\"string\">\"123\"</span>) ); <span class=\"comment\">// 123</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log( toNumber(<span class=\"string\">\" abc\"</span>)); <span class=\"comment\">// NaN</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Dateä¹Ÿå¯ä»¥ä½¿ç”¨</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log( +<span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>() ); <span class=\"comment\">// è¿”å›æ—¶é—´æˆ³</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<h4 id=\"3-å¹¶ç¬¦æ¡ä»¶\"><a href=\"#3-å¹¶ç¬¦æ¡ä»¶\" class=\"headerlink\" title=\"3. å¹¶ç¬¦æ¡ä»¶\"></a>3. å¹¶ç¬¦æ¡ä»¶</h4><p>ç»å¸¸ç”¨åˆ°è¿™æ ·çš„æ¡ä»¶åˆ¤æ–­.</p>\n</blockquote>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> (isConcat) &#123;</span><br><span class=\"line\">    Login()</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>å¯ä»¥ç®€å†™æˆè¿™æ · <code>isConact &amp;&amp; Login()</code></p>\n<h3 id=\"4-è·å–æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ \"><a href=\"#4-è·å–æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ \" class=\"headerlink\" title=\"4. è·å–æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ \"></a>4. è·å–æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ </h3><p><code>Array.prototype.slice (begin, end)</code> ç»å¸¸ç”¨è¿™æ ·çš„æ–¹å¼æ¥æˆªå–æ•°ç»„çš„å…ƒç´ ,<br>å¦‚æœä¸è®¾ç½® end çš„å€¼, é‚£ä¹ˆé»˜è®¤ä¼šå°†æ•°ç»„çš„é•¿åº¦ä½œä¸º end å€¼.<br>å¦‚æœå°†è´Ÿæ•°ä½œä¸ºå‚æ•°çš„ begin å€¼, å°±å¯ä»¥è·å–æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ .</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> arr = [<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>];</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log( arr.slice(<span class=\"number\">-1</span>) ); <span class=\"comment\">// [5]</span></span><br><span class=\"line\">conosle.log( arr.slice(<span class=\"number\">-2</span>) ); <span class=\"comment\">// [4,5]</span></span><br><span class=\"line\">ä»¥æ­¤ç±»æ¨</span><br></pre></td></tr></table></figure>\n<blockquote>\n<h4 id=\"5-æˆªæ–­æ•°ç»„\"><a href=\"#5-æˆªæ–­æ•°ç»„\" class=\"headerlink\" title=\"5. æˆªæ–­æ•°ç»„\"></a>5. æˆªæ–­æ•°ç»„</h4><p>ç”¨æ¥é”å®šæ•°ç»„çš„é•¿åº¦, åˆ é™¤æ•°ç»„ä¸­çš„ä¸€äº›å…ƒç´ . æ¯”å¦‚æ•°ç»„ä¸€å…±æœ‰10ä¸ªå…ƒç´ ,<br>ä½†æˆ‘åªéœ€è¦å‰5ä¸ªå…ƒç´ , å°±å¯ä»¥é€šè¿‡ <code>array.length = 5</code> æ¥æˆªæ–­æ•°ç»„, å¦‚: </p>\n</blockquote>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> arr = [<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>];</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log( arr.length); <span class=\"comment\">// 5</span></span><br><span class=\"line\">arr.length = <span class=\"number\">3</span>;</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log( arr.length ); <span class=\"comment\">// 3</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log( arr ); <span class=\"comment\">// [1,2,3]</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<h4 id=\"6-å°†NodeListè½¬æ¢ä¸ºæ•°ç»„\"><a href=\"#6-å°†NodeListè½¬æ¢ä¸ºæ•°ç»„\" class=\"headerlink\" title=\"6. å°†NodeListè½¬æ¢ä¸ºæ•°ç»„\"></a>6. å°†NodeListè½¬æ¢ä¸ºæ•°ç»„</h4><p>å¦‚æœé€šè¿‡ <code>doucment.querySelectorAll(&#39;p&#39;)</code> è·å–å…ƒç´ , å®ƒè¿”å›çš„æ˜¯ä¸€ä¸ªDOMå…ƒç´ çš„<br>æ•°ç»„ ( NodeList ) å¯¹è±¡, ä½†æ˜¯è¿™ä¸ªæ•°ç»„ä¸å…·æœ‰æ•°ç»„çš„åŠŸèƒ½,<br>æ¯”å¦‚ <code>push() / sort()</code> ç­‰. è¿™å°±éœ€è¦å°†è¿™ä¸ª NodeList è½¬æ¢ä¸ºçœŸæ­£çš„æ•°ç»„.<br>å¯ä»¥ä½¿ç”¨ <code>[].slice.call( NodeList )</code> æ¥å®ç°. å¦‚:</p>\n</blockquote>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> els = <span class=\"built_in\">document</span>.querySelectorAll( <span class=\"string\">'p'</span> );</span><br><span class=\"line\">[].slice.call( els );</span><br><span class=\"line\">OR:</span><br><span class=\"line\"><span class=\"keyword\">var</span> arrElement = <span class=\"built_in\">Array</span>.from( els );</span><br><span class=\"line\">ES6:</span><br><span class=\"line\"><span class=\"keyword\">var</span> arr = [...els]</span><br></pre></td></tr></table></figure>\n<blockquote>\n<h4 id=\"7-æ•°ç»„å…ƒç´ é‡æ’\"><a href=\"#7-æ•°ç»„å…ƒç´ é‡æ’\" class=\"headerlink\" title=\"7. æ•°ç»„å…ƒç´ é‡æ’\"></a>7. æ•°ç»„å…ƒç´ é‡æ’</h4><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> list = [<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>];</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(list.sort(<span class=\"function\"><span class=\"params\">()</span>=&gt;</span>&#123; <span class=\"built_in\">Math</span>.random() - <span class=\"number\">0.5</span>&#125;))</span><br></pre></td></tr></table></figure>\n</blockquote>\n<p>Created on 2017-6-14 by Cara</p>\n","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<h4 id=\"1-ä½¿ç”¨-æ“ä½œç¬¦è½¬æ¢å¸ƒå°”å€¼\"><a href=\"#1-ä½¿ç”¨-æ“ä½œç¬¦è½¬æ¢å¸ƒå°”å€¼\" class=\"headerlink\" title=\"1. ä½¿ç”¨ !! æ“ä½œç¬¦è½¬æ¢å¸ƒå°”å€¼\"></a>1. ä½¿ç”¨ <code>!!</code> æ“ä½œç¬¦è½¬æ¢å¸ƒå°”å€¼</h4><p>ç”¨äºæ£€æŸ¥ä¸€ä¸ªå˜é‡æ˜¯å¦å­˜åœ¨æˆ–è€…æ˜¯æœ‰æ•ˆå€¼, å¯¹å˜é‡ä½¿ç”¨ <code>!!variable</code> æ¥éªŒè¯,<br>åªè¦å˜é‡çš„å€¼ä¸º: 0, null, undefined, NaNéƒ½å°†è¿”å› false, åä¹‹è¿”å› true. å¦‚: </p>\n</blockquote>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Foo</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">constructor</span> ( count ) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.cash = count;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.myCash = !!count;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">var</span> emptyFoo = <span class=\"keyword\">new</span> Foo(<span class=\"number\">0</span>);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(foo.cash); <span class=\"comment\">// 0</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(foo.myCash); <span class=\"comment\">// false</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> foo = <span class=\"keyword\">new</span> Foo(<span class=\"number\">100</span>);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(foo.cash); <span class=\"comment\">// 100</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(foo.myCash); <span class=\"comment\">// true</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<h4 id=\"2-ä½¿ç”¨-å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—\"><a href=\"#2-ä½¿ç”¨-å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—\" class=\"headerlink\" title=\"2. ä½¿ç”¨ + å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—\"></a>2. ä½¿ç”¨ <code>+</code> å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—</h4><p>åªé€‚åˆå°†å­—ç¬¦ä¸²æ•°æ®è½¬æ¢ä¸ºæ•°å­—, ç»™åå°ä¼ æ•°æ®çš„æ—¶å€™ç»å¸¸ç”¨åˆ°,<br>å¦‚æœä¸æ˜¯å­—ç¬¦ä¸²æ•°æ®ä¼šè¿”å› NaN.</p>\n</blockquote>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> toNumber = <span class=\"function\"><span class=\"params\">strNumber</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> +strNumber;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log( toNumber(<span class=\"string\">\"123\"</span>) ); <span class=\"comment\">// 123</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log( toNumber(<span class=\"string\">\" abc\"</span>)); <span class=\"comment\">// NaN</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Dateä¹Ÿå¯ä»¥ä½¿ç”¨</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log( +<span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>() ); <span class=\"comment\">// è¿”å›æ—¶é—´æˆ³</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<h4 id=\"3-å¹¶ç¬¦æ¡ä»¶\"><a href=\"#3-å¹¶ç¬¦æ¡ä»¶\" class=\"headerlink\" title=\"3. å¹¶ç¬¦æ¡ä»¶\"></a>3. å¹¶ç¬¦æ¡ä»¶</h4><p>ç»å¸¸ç”¨åˆ°è¿™æ ·çš„æ¡ä»¶åˆ¤æ–­.</p>\n</blockquote>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> (isConcat) &#123;</span><br><span class=\"line\">    Login()</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>å¯ä»¥ç®€å†™æˆè¿™æ · <code>isConact &amp;&amp; Login()</code></p>\n<h3 id=\"4-è·å–æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ \"><a href=\"#4-è·å–æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ \" class=\"headerlink\" title=\"4. è·å–æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ \"></a>4. è·å–æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ </h3><p><code>Array.prototype.slice (begin, end)</code> ç»å¸¸ç”¨è¿™æ ·çš„æ–¹å¼æ¥æˆªå–æ•°ç»„çš„å…ƒç´ ,<br>å¦‚æœä¸è®¾ç½® end çš„å€¼, é‚£ä¹ˆé»˜è®¤ä¼šå°†æ•°ç»„çš„é•¿åº¦ä½œä¸º end å€¼.<br>å¦‚æœå°†è´Ÿæ•°ä½œä¸ºå‚æ•°çš„ begin å€¼, å°±å¯ä»¥è·å–æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ .</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> arr = [<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>];</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log( arr.slice(<span class=\"number\">-1</span>) ); <span class=\"comment\">// [5]</span></span><br><span class=\"line\">conosle.log( arr.slice(<span class=\"number\">-2</span>) ); <span class=\"comment\">// [4,5]</span></span><br><span class=\"line\">ä»¥æ­¤ç±»æ¨</span><br></pre></td></tr></table></figure>\n<blockquote>\n<h4 id=\"5-æˆªæ–­æ•°ç»„\"><a href=\"#5-æˆªæ–­æ•°ç»„\" class=\"headerlink\" title=\"5. æˆªæ–­æ•°ç»„\"></a>5. æˆªæ–­æ•°ç»„</h4><p>ç”¨æ¥é”å®šæ•°ç»„çš„é•¿åº¦, åˆ é™¤æ•°ç»„ä¸­çš„ä¸€äº›å…ƒç´ . æ¯”å¦‚æ•°ç»„ä¸€å…±æœ‰10ä¸ªå…ƒç´ ,<br>ä½†æˆ‘åªéœ€è¦å‰5ä¸ªå…ƒç´ , å°±å¯ä»¥é€šè¿‡ <code>array.length = 5</code> æ¥æˆªæ–­æ•°ç»„, å¦‚: </p>\n</blockquote>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> arr = [<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>];</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log( arr.length); <span class=\"comment\">// 5</span></span><br><span class=\"line\">arr.length = <span class=\"number\">3</span>;</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log( arr.length ); <span class=\"comment\">// 3</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log( arr ); <span class=\"comment\">// [1,2,3]</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<h4 id=\"6-å°†NodeListè½¬æ¢ä¸ºæ•°ç»„\"><a href=\"#6-å°†NodeListè½¬æ¢ä¸ºæ•°ç»„\" class=\"headerlink\" title=\"6. å°†NodeListè½¬æ¢ä¸ºæ•°ç»„\"></a>6. å°†NodeListè½¬æ¢ä¸ºæ•°ç»„</h4><p>å¦‚æœé€šè¿‡ <code>doucment.querySelectorAll(&#39;p&#39;)</code> è·å–å…ƒç´ , å®ƒè¿”å›çš„æ˜¯ä¸€ä¸ªDOMå…ƒç´ çš„<br>æ•°ç»„ ( NodeList ) å¯¹è±¡, ä½†æ˜¯è¿™ä¸ªæ•°ç»„ä¸å…·æœ‰æ•°ç»„çš„åŠŸèƒ½,<br>æ¯”å¦‚ <code>push() / sort()</code> ç­‰. è¿™å°±éœ€è¦å°†è¿™ä¸ª NodeList è½¬æ¢ä¸ºçœŸæ­£çš„æ•°ç»„.<br>å¯ä»¥ä½¿ç”¨ <code>[].slice.call( NodeList )</code> æ¥å®ç°. å¦‚:</p>\n</blockquote>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> els = <span class=\"built_in\">document</span>.querySelectorAll( <span class=\"string\">'p'</span> );</span><br><span class=\"line\">[].slice.call( els );</span><br><span class=\"line\">OR:</span><br><span class=\"line\"><span class=\"keyword\">var</span> arrElement = <span class=\"built_in\">Array</span>.from( els );</span><br><span class=\"line\">ES6:</span><br><span class=\"line\"><span class=\"keyword\">var</span> arr = [...els]</span><br></pre></td></tr></table></figure>\n<blockquote>\n<h4 id=\"7-æ•°ç»„å…ƒç´ é‡æ’\"><a href=\"#7-æ•°ç»„å…ƒç´ é‡æ’\" class=\"headerlink\" title=\"7. æ•°ç»„å…ƒç´ é‡æ’\"></a>7. æ•°ç»„å…ƒç´ é‡æ’</h4><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> list = [<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>];</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(list.sort(<span class=\"function\"><span class=\"params\">()</span>=&gt;</span>&#123; <span class=\"built_in\">Math</span>.random() - <span class=\"number\">0.5</span>&#125;))</span><br></pre></td></tr></table></figure>\n</blockquote>\n<p>Created on 2017-6-14 by Cara</p>\n"},{"title":"Inheritance ç»§æ‰¿","date":"2017-10-16T14:37:47.000Z","_content":"> # ç»§æ‰¿\nåœ¨é‚£äº›åŸºäºç±»çš„è¯­è¨€, ç»§æ‰¿æ˜¯ä¸€ç§ä»£ç é‡ç”¨çš„å½¢å¼, å¦‚æœä¸€ä¸ªæ–°çš„ç±»ä¸ä¸€ä¸ªå·²å­˜\nåœ¨çš„ç±»æ‹¥æœ‰å¤§éƒ¨åˆ†ç›¸åŒçš„åŠŸèƒ½, é‚£ä¹ˆå°±åªéœ€è¦è¯´æ˜ä¸¤è€…ä¹‹é—´çš„åŒºåˆ«å³å¯. ä½†æ˜¯\n JavaScript å¹¶æ²¡æœ‰ç±»çš„æ¦‚å¿µ, ä½†æ˜¯æœ‰å¾ˆå¤šä»£ç é‡ç”¨çš„æ¨¡å¼, å®ƒå¯ä»¥æ¨¡æ‹Ÿç±»çš„\næ¨¡å¼, ä¹Ÿå¯ä»¥æ”¯æŒå…¶ä»–çš„æ¨¡å¼.\n\n### ä¼ªç±»\nåœ¨ C++ å’Œ Javaä¸­éƒ½æ˜¯ç”¨ new å‘½ä»¤æ¥ç”Ÿæˆç¤ºå®ä¾‹, åœ¨ä½¿ç”¨ new å‘½ä»¤æ—¶éƒ½ä¼šè°ƒç”¨ç±»çš„\næ„é€ å‡½æ•°(constructor), å› æ­¤ Brendan Eich ( JavaScript ä½œè€…)å°† new å¼•å…¥äº† JavaScript,\nä»åŸå‹å¯¹è±¡ä¸Šç”Ÿæˆä¸€ä¸ªå®ä¾‹å¯¹è±¡. å› ä¸º js æ²¡æœ‰ç±», æ‰€ä»¥åœ¨ new å‘½ä»¤åé¢è·Ÿçš„æ˜¯æ„é€ å‡½æ•°,\nè€Œä¸æ˜¯åƒ Java ä¸€æ ·è·Ÿçš„æ˜¯ç±». ç®€å•çš„æ¥è¯´å°±æ˜¯é€šè¿‡æ„é€ å™¨ç”Ÿäº§å¯¹è±¡.\n\n```javascript\n// å…ˆæ‰©å±•ä¸€ä¸ªæ–¹æ³•, æ‡’å¾—æ¯æ¬¡æ‰“prototype\n// è¿™ä¸ªä¸æ˜¯å¿…é¡»çš„\nFunction.prototype.method = function (name, fn) {\n\tthis.prototype[name] = fn;\n\treturn this\t\n}\n\n// è¯­è¨€ç²¾ç²¹é‡Œçš„ä¾‹å­ (å…¶å®è¿™ä¸€æ­¥å°±æ˜¯åœ¨æ¨¡ä»¿ new çš„å®ç°)\nFunction.method('new', function () {\n\n\t// åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡, å®ƒç»§æ‰¿æ„é€ å™¨å‡½æ•°çš„åŸå‹å¯¹è±¡\n\tlet that = Object.create(this.prototype);\n\n\t// è°ƒç”¨æ„é€ å™¨å‡½æ•°, å°† this ç»‘å®šåˆ°æ–°å¯¹è±¡ä¸Š\n\tlet other = this.apply(that, arguments);\n\n\treturn (typeof other === 'object' && other) || that\n})\n\n// ç°åœ¨å®šä¹‰ä¸€ä¸ªæ„é€ å™¨\nlet Bar = function (name) {\n\tthis.name = name;\n}\n\n// æ‰©å±•è¿™ä¸ªæ„é€ å‡½æ•°çš„åŸå‹\nBar.prototype.get_name = function () {\n\treturn this.name\n}\nBar.prototype.say = function () {\n\tthis.saying || '';\n} \n\n// ç„¶åæ„é€ ä¸€ä¸ªå®ä¾‹\nlet myBar = new Bar('å¦²å·±');\nconsole.log(myBar.get_name()) // å¦²å·±\n\n/**\n *  æ©ç›–æ‰ä¸‘é™‹çš„ prototype\n */\n\n// å€ŸåŠ©ä¸€ä¸ªè¾…åŠ©å‡½æ•°\nFunction.method('inherit', function (parent) {\n\tthis.prototype = new parent();\n\treturn this\n})\n\n// é‡æ–°å®šä¹‰ä¸€ä¸ªæ„é€ å‡½æ•°\n// å»ç»§æ‰¿ä¸Šé¢çš„ Bar\nlet Foo = function (name) {\n\tthis.saying = 'wow';\n}\n// è¿™é‡Œ inherit å’Œ method éƒ½ç›´æ¥è¿”å› this\n// æ‰€ä»¥å¯ä»¥é‡‡ç”¨è”çº§\n.inherit(Bar)\n.method('noise', function () {\n\treturn this.name + this.say()\n})\n\n```\nä¼ªç±»æ¨¡å¼åœ¨é€šè¿‡new å‘½ä»¤ç”Ÿäº§å¯¹è±¡æ—¶, ä¼šäº§ç”Ÿå†…å­˜æµªè´¹. å¦‚ä¸Šé¢çš„ä¾‹å­, Foo æ„é€ å‡½æ•°\nå°±å›å»é‡å¤æ„é€ å™¨ Bar å·²ç»å®Œæˆçš„å·¥ä½œ.\n\n### åŸå‹\nåœ¨ä¸€ä¸ªçº¯ç²¹çš„åŸå‹æ¨¡å¼ä¸­, å°†æ‘’å¼ƒç±»ä¸“æ³¨äºå¯¹è±¡. åŸºäºåŸå‹çš„ç»§æ‰¿ç›¸æ¯”äºç±»çš„\nç»§æ‰¿åœ¨æ¦‚å¿µä¸Šæ›´ä¸ºç®€å•: ä¸€ä¸ªæ–°å¯¹è±¡å¯ä»¥ç»§æ‰¿ä¸€ä¸ªæ—§å¯¹è±¡çš„å±æ€§. é€šè¿‡æ„é€ ä¸€ä¸ªæœ‰ç”¨\nçš„å¯¹è±¡å¼€å§‹, æ¥ç€å¯ä»¥æ„é€ å‡ºæ›´å¤šå’Œè¿™ä¸ªå¯¹è±¡ç›¸ä¼¼çš„å¯¹è±¡.   ----<JavaScriptè¯­è¨€ç²¾ç²¹> \n\n```javascript\n// å…ˆæ„é€ ä¸€ä¸ªåŸºç¡€å¯¹è±¡\nconst baseObject = {\n\tname: 'base',\n\tget_name: function () {\n\t\treturn this.name\n\t}\n}\n\n// æ¥ä¸‹æ¥æ„é€ å®šåˆ¶åŒ–çš„å¯¹è±¡\nlet myObj = Object.create(baseObject);\nmyObj.name = 'wow';\nmyObj.saying = 'Hi';\nmyObj.purr = n => {\n\tlet str = '';\n\tfor (let i = 0; i < n; i++) {\n\t\tif (str) {\n\t\t\tstr += 'hello'\n\t\t}\n\t\tstr += 'world'\n\t}\n\treturn str\n}\n```\n\nè¿™æ˜¯ä¸€ç§'å·®å¼‚åŒ–ç»§æ‰¿', é€šè¿‡åˆ¶å®šä¸€ä¸ªæ–°çš„å¯¹è±¡, æŒ‡æ˜å®ƒä¸åŸºæœ¬å¯¹è±¡çš„ä¸åŒ.\n\n\n\n### å‡½æ•°åŒ–\nä»¥ä¸Šä¸¤ç§ç»§æ‰¿æ¨¡å¼éƒ½æ²¡æœ‰å®ç°ç§æœ‰åŒ–, ä¹Ÿå°±æ˜¯è¯´æ‰€æœ‰çš„å˜é‡å’Œæ–¹æ³•éƒ½æ˜¯å…¬å¼€çš„, æ‰€ä»¥å°±\nå¯ä»¥å¼€å§‹è¿ç”¨æ¨¡å—æ¨¡å¼. è¿™ä¸ªå‡½æ•°ä¸»è¦åˆ†ä¸ºå››ä¸ªæ­¥éª¤:\n\n1. åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡\n\n2. å®šä¹‰ç§æœ‰å±æ€§.\n\n3. ç»™è¿™ä¸ªæ–°å¯¹è±¡æ‰©å……ç‰¹æƒå‡½æ•° (æš´éœ²æ¥å£)\n\n4. è¿”å›è¿™ä¸ªå¯¹è±¡\n\n```javascript\n// spec å¯¹è±¡åŒ…å«æ„é€ å™¨æ‰€éœ€è¦çš„æ‰€æœ‰ä¿¡æ¯\n// my å¯¹è±¡å…è®¸å…¶ä»–æ„é€ å™¨åˆ†äº«ä»–ä»¬çš„ç§æœ‰å±æ€§\n// ä»¥ä¾¿åœ¨æˆ‘ä»¬çš„æ„é€ å™¨ä¸­ä½¿ç”¨\nlet constructor = (spec, my) => {\n\tlet that = {}; // ç§æœ‰å®ä¾‹å˜é‡\n\n\tlet my = my || {};\n\t\n\t// æ‰©å±•å…±äº«çš„å˜é‡å’Œæ–¹æ³•\n\t...\n\n\tthat = ä¸€ä¸ªæ–°å¯¹è±¡\n\n\t// ç»™ that æ·»åŠ ç‰¹æƒæ–¹æ³• \n\t...\n\n\t// è¿”å›è¿™ä¸ªå¯¹è±¡\n\treturn that\n}\n```\n\n> è¯­è¨€ç²¾ç²¹é‡Œçš„ä¾‹å­\n\n1. æ„é€ å™¨\n```javascript\nconst mammal = spec => {\n\tlet that = {};\n\n\tthat.get_name = _ => spec.name;\n\tthat.says = _ => spec.saying || '';\n\n\treturn that\n}\n\nlet myMammal = mammal({name: 'Herb'});\n```\n\n2. å¦ä¸€ä¸ªæ„é€ å™¨\n```javascript\nlet cat = spec =>{\n\tspec.saying = spec.saying || 'meow';\n\t// ç»§æ‰¿\n\tlet that = mammal(spec);\n\t\n\tthat.purr = n => {\n\t\tlet i, s = '';\n\n\t\tfor (i = 0; i < n; i++) {\n\t\t\tif (s) {\n\t\t\t\ts += '-';\t\n\t\t\t}\n\t\t\ts += 'r';\n\t\t}\n\t\treturn s\n\t};\n\tthat.get_name = _ => {\n\t\treturn that.says() + ' ' + spec.name + ' ' + that.says();\n\t}\n\n\treturn that\n}\n\nlet myCat = car({name: 'Henrietta'});\n```\n\n### è¶…ç±»\nä»¥ä¸Šå‡½æ•°åŒ–çš„æ–¹å¼è¿˜ä¸èƒ½å¤Ÿè°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•å¹¶å‘çˆ¶ç±»æ–¹æ³•ä¼ é€’å‚æ•°. ä»¥ä¸‹æ˜¯æµ‹è¯•ä»£ç \nåœ¨`è¯­è¨€ç²¾ç²¹`çš„ä¾‹å­çš„åŸºç¡€ä¸Šç¨ä½œæ”¹åŠ¨, ä¾¿äºè‡ªå·±ç†è§£:\n\n```javascript\n// æ„é€ å™¨\nconst mammal = spec => {\n\tlet that = {};\n\n\tthat.get_name = _ => spec.name;\n\tthat.says = _ => spec.saying || 'Hi';\n\n\treturn that\n}\n\nlet myMammal = mammal({name: 'Cara'});\n\nconsole.log(myMammal.says()) // 'Hi'\n\n\n// æ„é€ å™¨2\nconst cat = spec => {\n\tspec.saying = spec.saying || 'meow';\n\n\t// æ­¤æ—¶ that å·²ç»åŒ…å«: get_name å’Œ says æ–¹æ³•\n\tlet that = mammal(spec);\n\n\tthat.purr = n => {\n\t\tlet str = '';\n\n\t\tfor (let i = 0; i < n; i++) {\n\t\t\tif (str) {\n\t\t\t\tstr += '-';\n\t\t\t}\n\t\t\tstr += 'r';\n\t\t}\n\t\treturn str\n\t};\n\tthat.get_name = n => {\n\t\treturn n || \"i dont't have name\"\n\t};\n\n\treturn that\n}\n\nlet myCat = cat({name: 'Henrietta'});\n\n// i dont't have name\nconsole.log(myCat.get_name())\n\n// è¿™ä¸ªæ—¶å€™ cat è¿˜ä¸èƒ½è®¿é—®çˆ¶ç±»æ–¹æ³•çš„èƒ½åŠ›\n// æ‰€ä»¥è¶…ç±» super è¿˜æ˜¯æœ‰å¿…è¦çš„\n\n// å…ˆæ‰©å±•ä¸¤ä¸ªæ–¹æ³•\n// è¿™ä¸ªæ–¹æ³•ä¸èƒ½ç”¨ç®­å¤´å‡½æ•°æ¥å®šä¹‰, å¦åˆ™ this æŒ‡å‘çš„window\n// è¿™é‡Œ this éœ€è¦çš„æ˜¯è¢«è°ƒç”¨çš„å¯¹è±¡\nFunction.prototype.method =  function (name, fn) {\n\tthis.prototype[name] = fn;\n\treturn this\n}\n\n// å®šä¹‰è°ƒç”¨çˆ¶ç±»çš„å‡½æ•°\nObject.method('superior', function (name) {\n\tvar that = this,\n        method = that[name];\n    return n => {\n    \t// this cat function\n    \tconsole.log(n)\n        return method.call(that, n);\n    };\n})\n\n// æ¥è¯•è¯•è°ƒç”¨çˆ¶ç±»\nconst coolCat = spec => {\n\tlet that = cat(spec);\n\tlet\tsuper_get_name = that.superior('get_name');\n\n\t// n ç»™çˆ¶ç±»æ–¹æ³•ä¼ å‚\n\tthat.get_name = n => {\n        return 'like ' + super_get_name.call(this, n) + ' baby';\n    };\n\n\treturn that\n}\n\nlet myCoolCat = coolCat({name: 'Bix', saying: 'Hi'});\n\nlet name = myCoolCat.get_name('this cat function');\n\nconsole.log(name) // like this cat function baby\n```\n\n#### æœ€åéšä¾¿æä¸€ä¸‹\nç®­å¤´å‡½æ•°çš„å‡ ä¸ªä½¿ç”¨æ³¨æ„ç‚¹:\n\n1. å‡½æ•°ä½“å†…çš„ `this` å¯¹è±¡, å°±æ˜¯å®šä¹‰æ—¶æ‰€åœ¨çš„å¯¹è±¡, è€Œä¸æ˜¯ä½¿ç”¨æ—¶æ‰€åœ¨çš„å¯¹è±¡.\n\n2. ä¸å¯ä»¥å½“ä½œæ„é€ å‡½æ•°, ä¹Ÿå°±æ˜¯è¯´, ä¸å¯ä»¥ä½¿ç”¨newå‘½ä»¤, å¦åˆ™ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯.\nå› ä¸ºç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„ `this`, è€Œæ˜¯ç»§æ‰¿å¤–å±‚å‡½æ•°çš„`this`.\n\n3. ä¸å¯ä»¥ä½¿ç”¨ `arguments` å¯¹è±¡, è¯¥å¯¹è±¡åœ¨å‡½æ•°ä½“å†…ä¸å­˜åœ¨.\n\n4. ä¸å¯ä»¥ä½¿ç”¨ `yield` å‘½ä»¤, å› æ­¤ç®­å¤´å‡½æ•°ä¸èƒ½ç”¨ä½œGeneratorå‡½æ•°.\n\nCeated on 2017-9-15 by Cara ","source":"_posts/Inheritance-ç»§æ‰¿.md","raw":"---\ntitle: Inheritance ç»§æ‰¿\ndate: 2017-10-16 22:37:47\ntags:\n- JavaScript\ncategories:\n- å¤ä¹ \n- ç¬”è®°ğŸ“’\n---\n> # ç»§æ‰¿\nåœ¨é‚£äº›åŸºäºç±»çš„è¯­è¨€, ç»§æ‰¿æ˜¯ä¸€ç§ä»£ç é‡ç”¨çš„å½¢å¼, å¦‚æœä¸€ä¸ªæ–°çš„ç±»ä¸ä¸€ä¸ªå·²å­˜\nåœ¨çš„ç±»æ‹¥æœ‰å¤§éƒ¨åˆ†ç›¸åŒçš„åŠŸèƒ½, é‚£ä¹ˆå°±åªéœ€è¦è¯´æ˜ä¸¤è€…ä¹‹é—´çš„åŒºåˆ«å³å¯. ä½†æ˜¯\n JavaScript å¹¶æ²¡æœ‰ç±»çš„æ¦‚å¿µ, ä½†æ˜¯æœ‰å¾ˆå¤šä»£ç é‡ç”¨çš„æ¨¡å¼, å®ƒå¯ä»¥æ¨¡æ‹Ÿç±»çš„\næ¨¡å¼, ä¹Ÿå¯ä»¥æ”¯æŒå…¶ä»–çš„æ¨¡å¼.\n\n### ä¼ªç±»\nåœ¨ C++ å’Œ Javaä¸­éƒ½æ˜¯ç”¨ new å‘½ä»¤æ¥ç”Ÿæˆç¤ºå®ä¾‹, åœ¨ä½¿ç”¨ new å‘½ä»¤æ—¶éƒ½ä¼šè°ƒç”¨ç±»çš„\næ„é€ å‡½æ•°(constructor), å› æ­¤ Brendan Eich ( JavaScript ä½œè€…)å°† new å¼•å…¥äº† JavaScript,\nä»åŸå‹å¯¹è±¡ä¸Šç”Ÿæˆä¸€ä¸ªå®ä¾‹å¯¹è±¡. å› ä¸º js æ²¡æœ‰ç±», æ‰€ä»¥åœ¨ new å‘½ä»¤åé¢è·Ÿçš„æ˜¯æ„é€ å‡½æ•°,\nè€Œä¸æ˜¯åƒ Java ä¸€æ ·è·Ÿçš„æ˜¯ç±». ç®€å•çš„æ¥è¯´å°±æ˜¯é€šè¿‡æ„é€ å™¨ç”Ÿäº§å¯¹è±¡.\n\n```javascript\n// å…ˆæ‰©å±•ä¸€ä¸ªæ–¹æ³•, æ‡’å¾—æ¯æ¬¡æ‰“prototype\n// è¿™ä¸ªä¸æ˜¯å¿…é¡»çš„\nFunction.prototype.method = function (name, fn) {\n\tthis.prototype[name] = fn;\n\treturn this\t\n}\n\n// è¯­è¨€ç²¾ç²¹é‡Œçš„ä¾‹å­ (å…¶å®è¿™ä¸€æ­¥å°±æ˜¯åœ¨æ¨¡ä»¿ new çš„å®ç°)\nFunction.method('new', function () {\n\n\t// åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡, å®ƒç»§æ‰¿æ„é€ å™¨å‡½æ•°çš„åŸå‹å¯¹è±¡\n\tlet that = Object.create(this.prototype);\n\n\t// è°ƒç”¨æ„é€ å™¨å‡½æ•°, å°† this ç»‘å®šåˆ°æ–°å¯¹è±¡ä¸Š\n\tlet other = this.apply(that, arguments);\n\n\treturn (typeof other === 'object' && other) || that\n})\n\n// ç°åœ¨å®šä¹‰ä¸€ä¸ªæ„é€ å™¨\nlet Bar = function (name) {\n\tthis.name = name;\n}\n\n// æ‰©å±•è¿™ä¸ªæ„é€ å‡½æ•°çš„åŸå‹\nBar.prototype.get_name = function () {\n\treturn this.name\n}\nBar.prototype.say = function () {\n\tthis.saying || '';\n} \n\n// ç„¶åæ„é€ ä¸€ä¸ªå®ä¾‹\nlet myBar = new Bar('å¦²å·±');\nconsole.log(myBar.get_name()) // å¦²å·±\n\n/**\n *  æ©ç›–æ‰ä¸‘é™‹çš„ prototype\n */\n\n// å€ŸåŠ©ä¸€ä¸ªè¾…åŠ©å‡½æ•°\nFunction.method('inherit', function (parent) {\n\tthis.prototype = new parent();\n\treturn this\n})\n\n// é‡æ–°å®šä¹‰ä¸€ä¸ªæ„é€ å‡½æ•°\n// å»ç»§æ‰¿ä¸Šé¢çš„ Bar\nlet Foo = function (name) {\n\tthis.saying = 'wow';\n}\n// è¿™é‡Œ inherit å’Œ method éƒ½ç›´æ¥è¿”å› this\n// æ‰€ä»¥å¯ä»¥é‡‡ç”¨è”çº§\n.inherit(Bar)\n.method('noise', function () {\n\treturn this.name + this.say()\n})\n\n```\nä¼ªç±»æ¨¡å¼åœ¨é€šè¿‡new å‘½ä»¤ç”Ÿäº§å¯¹è±¡æ—¶, ä¼šäº§ç”Ÿå†…å­˜æµªè´¹. å¦‚ä¸Šé¢çš„ä¾‹å­, Foo æ„é€ å‡½æ•°\nå°±å›å»é‡å¤æ„é€ å™¨ Bar å·²ç»å®Œæˆçš„å·¥ä½œ.\n\n### åŸå‹\nåœ¨ä¸€ä¸ªçº¯ç²¹çš„åŸå‹æ¨¡å¼ä¸­, å°†æ‘’å¼ƒç±»ä¸“æ³¨äºå¯¹è±¡. åŸºäºåŸå‹çš„ç»§æ‰¿ç›¸æ¯”äºç±»çš„\nç»§æ‰¿åœ¨æ¦‚å¿µä¸Šæ›´ä¸ºç®€å•: ä¸€ä¸ªæ–°å¯¹è±¡å¯ä»¥ç»§æ‰¿ä¸€ä¸ªæ—§å¯¹è±¡çš„å±æ€§. é€šè¿‡æ„é€ ä¸€ä¸ªæœ‰ç”¨\nçš„å¯¹è±¡å¼€å§‹, æ¥ç€å¯ä»¥æ„é€ å‡ºæ›´å¤šå’Œè¿™ä¸ªå¯¹è±¡ç›¸ä¼¼çš„å¯¹è±¡.   ----<JavaScriptè¯­è¨€ç²¾ç²¹> \n\n```javascript\n// å…ˆæ„é€ ä¸€ä¸ªåŸºç¡€å¯¹è±¡\nconst baseObject = {\n\tname: 'base',\n\tget_name: function () {\n\t\treturn this.name\n\t}\n}\n\n// æ¥ä¸‹æ¥æ„é€ å®šåˆ¶åŒ–çš„å¯¹è±¡\nlet myObj = Object.create(baseObject);\nmyObj.name = 'wow';\nmyObj.saying = 'Hi';\nmyObj.purr = n => {\n\tlet str = '';\n\tfor (let i = 0; i < n; i++) {\n\t\tif (str) {\n\t\t\tstr += 'hello'\n\t\t}\n\t\tstr += 'world'\n\t}\n\treturn str\n}\n```\n\nè¿™æ˜¯ä¸€ç§'å·®å¼‚åŒ–ç»§æ‰¿', é€šè¿‡åˆ¶å®šä¸€ä¸ªæ–°çš„å¯¹è±¡, æŒ‡æ˜å®ƒä¸åŸºæœ¬å¯¹è±¡çš„ä¸åŒ.\n\n\n\n### å‡½æ•°åŒ–\nä»¥ä¸Šä¸¤ç§ç»§æ‰¿æ¨¡å¼éƒ½æ²¡æœ‰å®ç°ç§æœ‰åŒ–, ä¹Ÿå°±æ˜¯è¯´æ‰€æœ‰çš„å˜é‡å’Œæ–¹æ³•éƒ½æ˜¯å…¬å¼€çš„, æ‰€ä»¥å°±\nå¯ä»¥å¼€å§‹è¿ç”¨æ¨¡å—æ¨¡å¼. è¿™ä¸ªå‡½æ•°ä¸»è¦åˆ†ä¸ºå››ä¸ªæ­¥éª¤:\n\n1. åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡\n\n2. å®šä¹‰ç§æœ‰å±æ€§.\n\n3. ç»™è¿™ä¸ªæ–°å¯¹è±¡æ‰©å……ç‰¹æƒå‡½æ•° (æš´éœ²æ¥å£)\n\n4. è¿”å›è¿™ä¸ªå¯¹è±¡\n\n```javascript\n// spec å¯¹è±¡åŒ…å«æ„é€ å™¨æ‰€éœ€è¦çš„æ‰€æœ‰ä¿¡æ¯\n// my å¯¹è±¡å…è®¸å…¶ä»–æ„é€ å™¨åˆ†äº«ä»–ä»¬çš„ç§æœ‰å±æ€§\n// ä»¥ä¾¿åœ¨æˆ‘ä»¬çš„æ„é€ å™¨ä¸­ä½¿ç”¨\nlet constructor = (spec, my) => {\n\tlet that = {}; // ç§æœ‰å®ä¾‹å˜é‡\n\n\tlet my = my || {};\n\t\n\t// æ‰©å±•å…±äº«çš„å˜é‡å’Œæ–¹æ³•\n\t...\n\n\tthat = ä¸€ä¸ªæ–°å¯¹è±¡\n\n\t// ç»™ that æ·»åŠ ç‰¹æƒæ–¹æ³• \n\t...\n\n\t// è¿”å›è¿™ä¸ªå¯¹è±¡\n\treturn that\n}\n```\n\n> è¯­è¨€ç²¾ç²¹é‡Œçš„ä¾‹å­\n\n1. æ„é€ å™¨\n```javascript\nconst mammal = spec => {\n\tlet that = {};\n\n\tthat.get_name = _ => spec.name;\n\tthat.says = _ => spec.saying || '';\n\n\treturn that\n}\n\nlet myMammal = mammal({name: 'Herb'});\n```\n\n2. å¦ä¸€ä¸ªæ„é€ å™¨\n```javascript\nlet cat = spec =>{\n\tspec.saying = spec.saying || 'meow';\n\t// ç»§æ‰¿\n\tlet that = mammal(spec);\n\t\n\tthat.purr = n => {\n\t\tlet i, s = '';\n\n\t\tfor (i = 0; i < n; i++) {\n\t\t\tif (s) {\n\t\t\t\ts += '-';\t\n\t\t\t}\n\t\t\ts += 'r';\n\t\t}\n\t\treturn s\n\t};\n\tthat.get_name = _ => {\n\t\treturn that.says() + ' ' + spec.name + ' ' + that.says();\n\t}\n\n\treturn that\n}\n\nlet myCat = car({name: 'Henrietta'});\n```\n\n### è¶…ç±»\nä»¥ä¸Šå‡½æ•°åŒ–çš„æ–¹å¼è¿˜ä¸èƒ½å¤Ÿè°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•å¹¶å‘çˆ¶ç±»æ–¹æ³•ä¼ é€’å‚æ•°. ä»¥ä¸‹æ˜¯æµ‹è¯•ä»£ç \nåœ¨`è¯­è¨€ç²¾ç²¹`çš„ä¾‹å­çš„åŸºç¡€ä¸Šç¨ä½œæ”¹åŠ¨, ä¾¿äºè‡ªå·±ç†è§£:\n\n```javascript\n// æ„é€ å™¨\nconst mammal = spec => {\n\tlet that = {};\n\n\tthat.get_name = _ => spec.name;\n\tthat.says = _ => spec.saying || 'Hi';\n\n\treturn that\n}\n\nlet myMammal = mammal({name: 'Cara'});\n\nconsole.log(myMammal.says()) // 'Hi'\n\n\n// æ„é€ å™¨2\nconst cat = spec => {\n\tspec.saying = spec.saying || 'meow';\n\n\t// æ­¤æ—¶ that å·²ç»åŒ…å«: get_name å’Œ says æ–¹æ³•\n\tlet that = mammal(spec);\n\n\tthat.purr = n => {\n\t\tlet str = '';\n\n\t\tfor (let i = 0; i < n; i++) {\n\t\t\tif (str) {\n\t\t\t\tstr += '-';\n\t\t\t}\n\t\t\tstr += 'r';\n\t\t}\n\t\treturn str\n\t};\n\tthat.get_name = n => {\n\t\treturn n || \"i dont't have name\"\n\t};\n\n\treturn that\n}\n\nlet myCat = cat({name: 'Henrietta'});\n\n// i dont't have name\nconsole.log(myCat.get_name())\n\n// è¿™ä¸ªæ—¶å€™ cat è¿˜ä¸èƒ½è®¿é—®çˆ¶ç±»æ–¹æ³•çš„èƒ½åŠ›\n// æ‰€ä»¥è¶…ç±» super è¿˜æ˜¯æœ‰å¿…è¦çš„\n\n// å…ˆæ‰©å±•ä¸¤ä¸ªæ–¹æ³•\n// è¿™ä¸ªæ–¹æ³•ä¸èƒ½ç”¨ç®­å¤´å‡½æ•°æ¥å®šä¹‰, å¦åˆ™ this æŒ‡å‘çš„window\n// è¿™é‡Œ this éœ€è¦çš„æ˜¯è¢«è°ƒç”¨çš„å¯¹è±¡\nFunction.prototype.method =  function (name, fn) {\n\tthis.prototype[name] = fn;\n\treturn this\n}\n\n// å®šä¹‰è°ƒç”¨çˆ¶ç±»çš„å‡½æ•°\nObject.method('superior', function (name) {\n\tvar that = this,\n        method = that[name];\n    return n => {\n    \t// this cat function\n    \tconsole.log(n)\n        return method.call(that, n);\n    };\n})\n\n// æ¥è¯•è¯•è°ƒç”¨çˆ¶ç±»\nconst coolCat = spec => {\n\tlet that = cat(spec);\n\tlet\tsuper_get_name = that.superior('get_name');\n\n\t// n ç»™çˆ¶ç±»æ–¹æ³•ä¼ å‚\n\tthat.get_name = n => {\n        return 'like ' + super_get_name.call(this, n) + ' baby';\n    };\n\n\treturn that\n}\n\nlet myCoolCat = coolCat({name: 'Bix', saying: 'Hi'});\n\nlet name = myCoolCat.get_name('this cat function');\n\nconsole.log(name) // like this cat function baby\n```\n\n#### æœ€åéšä¾¿æä¸€ä¸‹\nç®­å¤´å‡½æ•°çš„å‡ ä¸ªä½¿ç”¨æ³¨æ„ç‚¹:\n\n1. å‡½æ•°ä½“å†…çš„ `this` å¯¹è±¡, å°±æ˜¯å®šä¹‰æ—¶æ‰€åœ¨çš„å¯¹è±¡, è€Œä¸æ˜¯ä½¿ç”¨æ—¶æ‰€åœ¨çš„å¯¹è±¡.\n\n2. ä¸å¯ä»¥å½“ä½œæ„é€ å‡½æ•°, ä¹Ÿå°±æ˜¯è¯´, ä¸å¯ä»¥ä½¿ç”¨newå‘½ä»¤, å¦åˆ™ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯.\nå› ä¸ºç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„ `this`, è€Œæ˜¯ç»§æ‰¿å¤–å±‚å‡½æ•°çš„`this`.\n\n3. ä¸å¯ä»¥ä½¿ç”¨ `arguments` å¯¹è±¡, è¯¥å¯¹è±¡åœ¨å‡½æ•°ä½“å†…ä¸å­˜åœ¨.\n\n4. ä¸å¯ä»¥ä½¿ç”¨ `yield` å‘½ä»¤, å› æ­¤ç®­å¤´å‡½æ•°ä¸èƒ½ç”¨ä½œGeneratorå‡½æ•°.\n\nCeated on 2017-9-15 by Cara ","slug":"Inheritance-ç»§æ‰¿","published":1,"updated":"2018-05-05T09:23:03.657Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjgurolse000hklu0ne588sj0","content":"<blockquote>\n<h1 id=\"ç»§æ‰¿\"><a href=\"#ç»§æ‰¿\" class=\"headerlink\" title=\"ç»§æ‰¿\"></a>ç»§æ‰¿</h1><p>åœ¨é‚£äº›åŸºäºç±»çš„è¯­è¨€, ç»§æ‰¿æ˜¯ä¸€ç§ä»£ç é‡ç”¨çš„å½¢å¼, å¦‚æœä¸€ä¸ªæ–°çš„ç±»ä¸ä¸€ä¸ªå·²å­˜<br>åœ¨çš„ç±»æ‹¥æœ‰å¤§éƒ¨åˆ†ç›¸åŒçš„åŠŸèƒ½, é‚£ä¹ˆå°±åªéœ€è¦è¯´æ˜ä¸¤è€…ä¹‹é—´çš„åŒºåˆ«å³å¯. ä½†æ˜¯<br> JavaScript å¹¶æ²¡æœ‰ç±»çš„æ¦‚å¿µ, ä½†æ˜¯æœ‰å¾ˆå¤šä»£ç é‡ç”¨çš„æ¨¡å¼, å®ƒå¯ä»¥æ¨¡æ‹Ÿç±»çš„<br>æ¨¡å¼, ä¹Ÿå¯ä»¥æ”¯æŒå…¶ä»–çš„æ¨¡å¼.</p>\n</blockquote>\n<h3 id=\"ä¼ªç±»\"><a href=\"#ä¼ªç±»\" class=\"headerlink\" title=\"ä¼ªç±»\"></a>ä¼ªç±»</h3><p>åœ¨ C++ å’Œ Javaä¸­éƒ½æ˜¯ç”¨ new å‘½ä»¤æ¥ç”Ÿæˆç¤ºå®ä¾‹, åœ¨ä½¿ç”¨ new å‘½ä»¤æ—¶éƒ½ä¼šè°ƒç”¨ç±»çš„<br>æ„é€ å‡½æ•°(constructor), å› æ­¤ Brendan Eich ( JavaScript ä½œè€…)å°† new å¼•å…¥äº† JavaScript,<br>ä»åŸå‹å¯¹è±¡ä¸Šç”Ÿæˆä¸€ä¸ªå®ä¾‹å¯¹è±¡. å› ä¸º js æ²¡æœ‰ç±», æ‰€ä»¥åœ¨ new å‘½ä»¤åé¢è·Ÿçš„æ˜¯æ„é€ å‡½æ•°,<br>è€Œä¸æ˜¯åƒ Java ä¸€æ ·è·Ÿçš„æ˜¯ç±». ç®€å•çš„æ¥è¯´å°±æ˜¯é€šè¿‡æ„é€ å™¨ç”Ÿäº§å¯¹è±¡.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// å…ˆæ‰©å±•ä¸€ä¸ªæ–¹æ³•, æ‡’å¾—æ¯æ¬¡æ‰“prototype</span></span><br><span class=\"line\"><span class=\"comment\">// è¿™ä¸ªä¸æ˜¯å¿…é¡»çš„</span></span><br><span class=\"line\"><span class=\"built_in\">Function</span>.prototype.method = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">name, fn</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">this</span>.prototype[name] = fn;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"keyword\">this</span>\t</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// è¯­è¨€ç²¾ç²¹é‡Œçš„ä¾‹å­ (å…¶å®è¿™ä¸€æ­¥å°±æ˜¯åœ¨æ¨¡ä»¿ new çš„å®ç°)</span></span><br><span class=\"line\"><span class=\"built_in\">Function</span>.method(<span class=\"string\">'new'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡, å®ƒç»§æ‰¿æ„é€ å™¨å‡½æ•°çš„åŸå‹å¯¹è±¡</span></span><br><span class=\"line\">\t<span class=\"keyword\">let</span> that = <span class=\"built_in\">Object</span>.create(<span class=\"keyword\">this</span>.prototype);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// è°ƒç”¨æ„é€ å™¨å‡½æ•°, å°† this ç»‘å®šåˆ°æ–°å¯¹è±¡ä¸Š</span></span><br><span class=\"line\">\t<span class=\"keyword\">let</span> other = <span class=\"keyword\">this</span>.apply(that, <span class=\"built_in\">arguments</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> (<span class=\"keyword\">typeof</span> other === <span class=\"string\">'object'</span> &amp;&amp; other) || that</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ç°åœ¨å®šä¹‰ä¸€ä¸ªæ„é€ å™¨</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> Bar = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">name</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æ‰©å±•è¿™ä¸ªæ„é€ å‡½æ•°çš„åŸå‹</span></span><br><span class=\"line\">Bar.prototype.get_name = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.name</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">Bar.prototype.say = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">this</span>.saying || <span class=\"string\">''</span>;</span><br><span class=\"line\">&#125; </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ç„¶åæ„é€ ä¸€ä¸ªå®ä¾‹</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> myBar = <span class=\"keyword\">new</span> Bar(<span class=\"string\">'å¦²å·±'</span>);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(myBar.get_name()) <span class=\"comment\">// å¦²å·±</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  æ©ç›–æ‰ä¸‘é™‹çš„ prototype</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å€ŸåŠ©ä¸€ä¸ªè¾…åŠ©å‡½æ•°</span></span><br><span class=\"line\"><span class=\"built_in\">Function</span>.method(<span class=\"string\">'inherit'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">parent</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">this</span>.prototype = <span class=\"keyword\">new</span> parent();</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"keyword\">this</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// é‡æ–°å®šä¹‰ä¸€ä¸ªæ„é€ å‡½æ•°</span></span><br><span class=\"line\"><span class=\"comment\">// å»ç»§æ‰¿ä¸Šé¢çš„ Bar</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> Foo = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">name</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">this</span>.saying = <span class=\"string\">'wow'</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// è¿™é‡Œ inherit å’Œ method éƒ½ç›´æ¥è¿”å› this</span></span><br><span class=\"line\"><span class=\"comment\">// æ‰€ä»¥å¯ä»¥é‡‡ç”¨è”çº§</span></span><br><span class=\"line\">.inherit(Bar)</span><br><span class=\"line\">.method(<span class=\"string\">'noise'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.name + <span class=\"keyword\">this</span>.say()</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p>ä¼ªç±»æ¨¡å¼åœ¨é€šè¿‡new å‘½ä»¤ç”Ÿäº§å¯¹è±¡æ—¶, ä¼šäº§ç”Ÿå†…å­˜æµªè´¹. å¦‚ä¸Šé¢çš„ä¾‹å­, Foo æ„é€ å‡½æ•°<br>å°±å›å»é‡å¤æ„é€ å™¨ Bar å·²ç»å®Œæˆçš„å·¥ä½œ.</p>\n<h3 id=\"åŸå‹\"><a href=\"#åŸå‹\" class=\"headerlink\" title=\"åŸå‹\"></a>åŸå‹</h3><p>åœ¨ä¸€ä¸ªçº¯ç²¹çš„åŸå‹æ¨¡å¼ä¸­, å°†æ‘’å¼ƒç±»ä¸“æ³¨äºå¯¹è±¡. åŸºäºåŸå‹çš„ç»§æ‰¿ç›¸æ¯”äºç±»çš„<br>ç»§æ‰¿åœ¨æ¦‚å¿µä¸Šæ›´ä¸ºç®€å•: ä¸€ä¸ªæ–°å¯¹è±¡å¯ä»¥ç»§æ‰¿ä¸€ä¸ªæ—§å¯¹è±¡çš„å±æ€§. é€šè¿‡æ„é€ ä¸€ä¸ªæœ‰ç”¨<br>çš„å¯¹è±¡å¼€å§‹, æ¥ç€å¯ä»¥æ„é€ å‡ºæ›´å¤šå’Œè¿™ä¸ªå¯¹è±¡ç›¸ä¼¼çš„å¯¹è±¡.   â€”-&lt;JavaScriptè¯­è¨€ç²¾ç²¹&gt; </p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// å…ˆæ„é€ ä¸€ä¸ªåŸºç¡€å¯¹è±¡</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> baseObject = &#123;</span><br><span class=\"line\">\tname: <span class=\"string\">'base'</span>,</span><br><span class=\"line\">\tget_name: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.name</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æ¥ä¸‹æ¥æ„é€ å®šåˆ¶åŒ–çš„å¯¹è±¡</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> myObj = <span class=\"built_in\">Object</span>.create(baseObject);</span><br><span class=\"line\">myObj.name = <span class=\"string\">'wow'</span>;</span><br><span class=\"line\">myObj.saying = <span class=\"string\">'Hi'</span>;</span><br><span class=\"line\">myObj.purr = <span class=\"function\"><span class=\"params\">n</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">let</span> str = <span class=\"string\">''</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; n; i++) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (str) &#123;</span><br><span class=\"line\">\t\t\tstr += <span class=\"string\">'hello'</span></span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\tstr += <span class=\"string\">'world'</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> str</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>è¿™æ˜¯ä¸€ç§â€™å·®å¼‚åŒ–ç»§æ‰¿â€™, é€šè¿‡åˆ¶å®šä¸€ä¸ªæ–°çš„å¯¹è±¡, æŒ‡æ˜å®ƒä¸åŸºæœ¬å¯¹è±¡çš„ä¸åŒ.</p>\n<h3 id=\"å‡½æ•°åŒ–\"><a href=\"#å‡½æ•°åŒ–\" class=\"headerlink\" title=\"å‡½æ•°åŒ–\"></a>å‡½æ•°åŒ–</h3><p>ä»¥ä¸Šä¸¤ç§ç»§æ‰¿æ¨¡å¼éƒ½æ²¡æœ‰å®ç°ç§æœ‰åŒ–, ä¹Ÿå°±æ˜¯è¯´æ‰€æœ‰çš„å˜é‡å’Œæ–¹æ³•éƒ½æ˜¯å…¬å¼€çš„, æ‰€ä»¥å°±<br>å¯ä»¥å¼€å§‹è¿ç”¨æ¨¡å—æ¨¡å¼. è¿™ä¸ªå‡½æ•°ä¸»è¦åˆ†ä¸ºå››ä¸ªæ­¥éª¤:</p>\n<ol>\n<li><p>åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡</p>\n</li>\n<li><p>å®šä¹‰ç§æœ‰å±æ€§.</p>\n</li>\n<li><p>ç»™è¿™ä¸ªæ–°å¯¹è±¡æ‰©å……ç‰¹æƒå‡½æ•° (æš´éœ²æ¥å£)</p>\n</li>\n<li><p>è¿”å›è¿™ä¸ªå¯¹è±¡</p>\n</li>\n</ol>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// spec å¯¹è±¡åŒ…å«æ„é€ å™¨æ‰€éœ€è¦çš„æ‰€æœ‰ä¿¡æ¯</span></span><br><span class=\"line\"><span class=\"comment\">// my å¯¹è±¡å…è®¸å…¶ä»–æ„é€ å™¨åˆ†äº«ä»–ä»¬çš„ç§æœ‰å±æ€§</span></span><br><span class=\"line\"><span class=\"comment\">// ä»¥ä¾¿åœ¨æˆ‘ä»¬çš„æ„é€ å™¨ä¸­ä½¿ç”¨</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> <span class=\"keyword\">constructor</span> = (spec, my) =&gt; &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">let</span> that = &#123;&#125;; <span class=\"comment\">// ç§æœ‰å®ä¾‹å˜é‡</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">let</span> my = my || &#123;&#125;;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"comment\">// æ‰©å±•å…±äº«çš„å˜é‡å’Œæ–¹æ³•</span></span><br><span class=\"line\">\t...</span><br><span class=\"line\"></span><br><span class=\"line\">\tthat = ä¸€ä¸ªæ–°å¯¹è±¡</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// ç»™ that æ·»åŠ ç‰¹æƒæ–¹æ³• </span></span><br><span class=\"line\">\t...</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// è¿”å›è¿™ä¸ªå¯¹è±¡</span></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> that</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>è¯­è¨€ç²¾ç²¹é‡Œçš„ä¾‹å­</p>\n</blockquote>\n<ol>\n<li><p>æ„é€ å™¨</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> mammal = <span class=\"function\"><span class=\"params\">spec</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">let</span> that = &#123;&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">\tthat.get_name = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> spec.name;</span><br><span class=\"line\">\tthat.says = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> spec.saying || <span class=\"string\">''</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> that</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> myMammal = mammal(&#123;<span class=\"attr\">name</span>: <span class=\"string\">'Herb'</span>&#125;);</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>å¦ä¸€ä¸ªæ„é€ å™¨</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> cat = <span class=\"function\"><span class=\"params\">spec</span> =&gt;</span>&#123;</span><br><span class=\"line\">\tspec.saying = spec.saying || <span class=\"string\">'meow'</span>;</span><br><span class=\"line\">\t<span class=\"comment\">// ç»§æ‰¿</span></span><br><span class=\"line\">\t<span class=\"keyword\">let</span> that = mammal(spec);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tthat.purr = <span class=\"function\"><span class=\"params\">n</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> i, s = <span class=\"string\">''</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (i = <span class=\"number\">0</span>; i &lt; n; i++) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (s) &#123;</span><br><span class=\"line\">\t\t\t\ts += <span class=\"string\">'-'</span>;\t</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\ts += <span class=\"string\">'r'</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> s</span><br><span class=\"line\">\t&#125;;</span><br><span class=\"line\">\tthat.get_name = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> that.says() + <span class=\"string\">' '</span> + spec.name + <span class=\"string\">' '</span> + that.says();</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> that</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> myCat = car(&#123;<span class=\"attr\">name</span>: <span class=\"string\">'Henrietta'</span>&#125;);</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<h3 id=\"è¶…ç±»\"><a href=\"#è¶…ç±»\" class=\"headerlink\" title=\"è¶…ç±»\"></a>è¶…ç±»</h3><p>ä»¥ä¸Šå‡½æ•°åŒ–çš„æ–¹å¼è¿˜ä¸èƒ½å¤Ÿè°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•å¹¶å‘çˆ¶ç±»æ–¹æ³•ä¼ é€’å‚æ•°. ä»¥ä¸‹æ˜¯æµ‹è¯•ä»£ç <br>åœ¨<code>è¯­è¨€ç²¾ç²¹</code>çš„ä¾‹å­çš„åŸºç¡€ä¸Šç¨ä½œæ”¹åŠ¨, ä¾¿äºè‡ªå·±ç†è§£:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// æ„é€ å™¨</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> mammal = <span class=\"function\"><span class=\"params\">spec</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">let</span> that = &#123;&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">\tthat.get_name = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> spec.name;</span><br><span class=\"line\">\tthat.says = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> spec.saying || <span class=\"string\">'Hi'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> that</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> myMammal = mammal(&#123;<span class=\"attr\">name</span>: <span class=\"string\">'Cara'</span>&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(myMammal.says()) <span class=\"comment\">// 'Hi'</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æ„é€ å™¨2</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> cat = <span class=\"function\"><span class=\"params\">spec</span> =&gt;</span> &#123;</span><br><span class=\"line\">\tspec.saying = spec.saying || <span class=\"string\">'meow'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// æ­¤æ—¶ that å·²ç»åŒ…å«: get_name å’Œ says æ–¹æ³•</span></span><br><span class=\"line\">\t<span class=\"keyword\">let</span> that = mammal(spec);</span><br><span class=\"line\"></span><br><span class=\"line\">\tthat.purr = <span class=\"function\"><span class=\"params\">n</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> str = <span class=\"string\">''</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; n; i++) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (str) &#123;</span><br><span class=\"line\">\t\t\t\tstr += <span class=\"string\">'-'</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\tstr += <span class=\"string\">'r'</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> str</span><br><span class=\"line\">\t&#125;;</span><br><span class=\"line\">\tthat.get_name = <span class=\"function\"><span class=\"params\">n</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> n || <span class=\"string\">\"i dont't have name\"</span></span><br><span class=\"line\">\t&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> that</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> myCat = cat(&#123;<span class=\"attr\">name</span>: <span class=\"string\">'Henrietta'</span>&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// i dont't have name</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(myCat.get_name())</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// è¿™ä¸ªæ—¶å€™ cat è¿˜ä¸èƒ½è®¿é—®çˆ¶ç±»æ–¹æ³•çš„èƒ½åŠ›</span></span><br><span class=\"line\"><span class=\"comment\">// æ‰€ä»¥è¶…ç±» super è¿˜æ˜¯æœ‰å¿…è¦çš„</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å…ˆæ‰©å±•ä¸¤ä¸ªæ–¹æ³•</span></span><br><span class=\"line\"><span class=\"comment\">// è¿™ä¸ªæ–¹æ³•ä¸èƒ½ç”¨ç®­å¤´å‡½æ•°æ¥å®šä¹‰, å¦åˆ™ this æŒ‡å‘çš„window</span></span><br><span class=\"line\"><span class=\"comment\">// è¿™é‡Œ this éœ€è¦çš„æ˜¯è¢«è°ƒç”¨çš„å¯¹è±¡</span></span><br><span class=\"line\"><span class=\"built_in\">Function</span>.prototype.method =  <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">name, fn</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">this</span>.prototype[name] = fn;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"keyword\">this</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å®šä¹‰è°ƒç”¨çˆ¶ç±»çš„å‡½æ•°</span></span><br><span class=\"line\"><span class=\"built_in\">Object</span>.method(<span class=\"string\">'superior'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">name</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">var</span> that = <span class=\"keyword\">this</span>,</span><br><span class=\"line\">        method = that[name];</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"params\">n</span> =&gt;</span> &#123;</span><br><span class=\"line\">    \t<span class=\"comment\">// this cat function</span></span><br><span class=\"line\">    \t<span class=\"built_in\">console</span>.log(n)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> method.call(that, n);</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æ¥è¯•è¯•è°ƒç”¨çˆ¶ç±»</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> coolCat = <span class=\"function\"><span class=\"params\">spec</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">let</span> that = cat(spec);</span><br><span class=\"line\">\t<span class=\"keyword\">let</span>\tsuper_get_name = that.superior(<span class=\"string\">'get_name'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// n ç»™çˆ¶ç±»æ–¹æ³•ä¼ å‚</span></span><br><span class=\"line\">\tthat.get_name = <span class=\"function\"><span class=\"params\">n</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">'like '</span> + super_get_name.call(<span class=\"keyword\">this</span>, n) + <span class=\"string\">' baby'</span>;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> that</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> myCoolCat = coolCat(&#123;<span class=\"attr\">name</span>: <span class=\"string\">'Bix'</span>, <span class=\"attr\">saying</span>: <span class=\"string\">'Hi'</span>&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> name = myCoolCat.get_name(<span class=\"string\">'this cat function'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(name) <span class=\"comment\">// like this cat function baby</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"æœ€åéšä¾¿æä¸€ä¸‹\"><a href=\"#æœ€åéšä¾¿æä¸€ä¸‹\" class=\"headerlink\" title=\"æœ€åéšä¾¿æä¸€ä¸‹\"></a>æœ€åéšä¾¿æä¸€ä¸‹</h4><p>ç®­å¤´å‡½æ•°çš„å‡ ä¸ªä½¿ç”¨æ³¨æ„ç‚¹:</p>\n<ol>\n<li><p>å‡½æ•°ä½“å†…çš„ <code>this</code> å¯¹è±¡, å°±æ˜¯å®šä¹‰æ—¶æ‰€åœ¨çš„å¯¹è±¡, è€Œä¸æ˜¯ä½¿ç”¨æ—¶æ‰€åœ¨çš„å¯¹è±¡.</p>\n</li>\n<li><p>ä¸å¯ä»¥å½“ä½œæ„é€ å‡½æ•°, ä¹Ÿå°±æ˜¯è¯´, ä¸å¯ä»¥ä½¿ç”¨newå‘½ä»¤, å¦åˆ™ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯.<br>å› ä¸ºç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„ <code>this</code>, è€Œæ˜¯ç»§æ‰¿å¤–å±‚å‡½æ•°çš„<code>this</code>.</p>\n</li>\n<li><p>ä¸å¯ä»¥ä½¿ç”¨ <code>arguments</code> å¯¹è±¡, è¯¥å¯¹è±¡åœ¨å‡½æ•°ä½“å†…ä¸å­˜åœ¨.</p>\n</li>\n<li><p>ä¸å¯ä»¥ä½¿ç”¨ <code>yield</code> å‘½ä»¤, å› æ­¤ç®­å¤´å‡½æ•°ä¸èƒ½ç”¨ä½œGeneratorå‡½æ•°.</p>\n</li>\n</ol>\n<p>Ceated on 2017-9-15 by Cara </p>\n","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<h1 id=\"ç»§æ‰¿\"><a href=\"#ç»§æ‰¿\" class=\"headerlink\" title=\"ç»§æ‰¿\"></a>ç»§æ‰¿</h1><p>åœ¨é‚£äº›åŸºäºç±»çš„è¯­è¨€, ç»§æ‰¿æ˜¯ä¸€ç§ä»£ç é‡ç”¨çš„å½¢å¼, å¦‚æœä¸€ä¸ªæ–°çš„ç±»ä¸ä¸€ä¸ªå·²å­˜<br>åœ¨çš„ç±»æ‹¥æœ‰å¤§éƒ¨åˆ†ç›¸åŒçš„åŠŸèƒ½, é‚£ä¹ˆå°±åªéœ€è¦è¯´æ˜ä¸¤è€…ä¹‹é—´çš„åŒºåˆ«å³å¯. ä½†æ˜¯<br> JavaScript å¹¶æ²¡æœ‰ç±»çš„æ¦‚å¿µ, ä½†æ˜¯æœ‰å¾ˆå¤šä»£ç é‡ç”¨çš„æ¨¡å¼, å®ƒå¯ä»¥æ¨¡æ‹Ÿç±»çš„<br>æ¨¡å¼, ä¹Ÿå¯ä»¥æ”¯æŒå…¶ä»–çš„æ¨¡å¼.</p>\n</blockquote>\n<h3 id=\"ä¼ªç±»\"><a href=\"#ä¼ªç±»\" class=\"headerlink\" title=\"ä¼ªç±»\"></a>ä¼ªç±»</h3><p>åœ¨ C++ å’Œ Javaä¸­éƒ½æ˜¯ç”¨ new å‘½ä»¤æ¥ç”Ÿæˆç¤ºå®ä¾‹, åœ¨ä½¿ç”¨ new å‘½ä»¤æ—¶éƒ½ä¼šè°ƒç”¨ç±»çš„<br>æ„é€ å‡½æ•°(constructor), å› æ­¤ Brendan Eich ( JavaScript ä½œè€…)å°† new å¼•å…¥äº† JavaScript,<br>ä»åŸå‹å¯¹è±¡ä¸Šç”Ÿæˆä¸€ä¸ªå®ä¾‹å¯¹è±¡. å› ä¸º js æ²¡æœ‰ç±», æ‰€ä»¥åœ¨ new å‘½ä»¤åé¢è·Ÿçš„æ˜¯æ„é€ å‡½æ•°,<br>è€Œä¸æ˜¯åƒ Java ä¸€æ ·è·Ÿçš„æ˜¯ç±». ç®€å•çš„æ¥è¯´å°±æ˜¯é€šè¿‡æ„é€ å™¨ç”Ÿäº§å¯¹è±¡.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// å…ˆæ‰©å±•ä¸€ä¸ªæ–¹æ³•, æ‡’å¾—æ¯æ¬¡æ‰“prototype</span></span><br><span class=\"line\"><span class=\"comment\">// è¿™ä¸ªä¸æ˜¯å¿…é¡»çš„</span></span><br><span class=\"line\"><span class=\"built_in\">Function</span>.prototype.method = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">name, fn</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">this</span>.prototype[name] = fn;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"keyword\">this</span>\t</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// è¯­è¨€ç²¾ç²¹é‡Œçš„ä¾‹å­ (å…¶å®è¿™ä¸€æ­¥å°±æ˜¯åœ¨æ¨¡ä»¿ new çš„å®ç°)</span></span><br><span class=\"line\"><span class=\"built_in\">Function</span>.method(<span class=\"string\">'new'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡, å®ƒç»§æ‰¿æ„é€ å™¨å‡½æ•°çš„åŸå‹å¯¹è±¡</span></span><br><span class=\"line\">\t<span class=\"keyword\">let</span> that = <span class=\"built_in\">Object</span>.create(<span class=\"keyword\">this</span>.prototype);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// è°ƒç”¨æ„é€ å™¨å‡½æ•°, å°† this ç»‘å®šåˆ°æ–°å¯¹è±¡ä¸Š</span></span><br><span class=\"line\">\t<span class=\"keyword\">let</span> other = <span class=\"keyword\">this</span>.apply(that, <span class=\"built_in\">arguments</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> (<span class=\"keyword\">typeof</span> other === <span class=\"string\">'object'</span> &amp;&amp; other) || that</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ç°åœ¨å®šä¹‰ä¸€ä¸ªæ„é€ å™¨</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> Bar = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">name</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æ‰©å±•è¿™ä¸ªæ„é€ å‡½æ•°çš„åŸå‹</span></span><br><span class=\"line\">Bar.prototype.get_name = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.name</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">Bar.prototype.say = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">this</span>.saying || <span class=\"string\">''</span>;</span><br><span class=\"line\">&#125; </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ç„¶åæ„é€ ä¸€ä¸ªå®ä¾‹</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> myBar = <span class=\"keyword\">new</span> Bar(<span class=\"string\">'å¦²å·±'</span>);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(myBar.get_name()) <span class=\"comment\">// å¦²å·±</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  æ©ç›–æ‰ä¸‘é™‹çš„ prototype</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å€ŸåŠ©ä¸€ä¸ªè¾…åŠ©å‡½æ•°</span></span><br><span class=\"line\"><span class=\"built_in\">Function</span>.method(<span class=\"string\">'inherit'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">parent</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">this</span>.prototype = <span class=\"keyword\">new</span> parent();</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"keyword\">this</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// é‡æ–°å®šä¹‰ä¸€ä¸ªæ„é€ å‡½æ•°</span></span><br><span class=\"line\"><span class=\"comment\">// å»ç»§æ‰¿ä¸Šé¢çš„ Bar</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> Foo = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">name</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">this</span>.saying = <span class=\"string\">'wow'</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// è¿™é‡Œ inherit å’Œ method éƒ½ç›´æ¥è¿”å› this</span></span><br><span class=\"line\"><span class=\"comment\">// æ‰€ä»¥å¯ä»¥é‡‡ç”¨è”çº§</span></span><br><span class=\"line\">.inherit(Bar)</span><br><span class=\"line\">.method(<span class=\"string\">'noise'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.name + <span class=\"keyword\">this</span>.say()</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p>ä¼ªç±»æ¨¡å¼åœ¨é€šè¿‡new å‘½ä»¤ç”Ÿäº§å¯¹è±¡æ—¶, ä¼šäº§ç”Ÿå†…å­˜æµªè´¹. å¦‚ä¸Šé¢çš„ä¾‹å­, Foo æ„é€ å‡½æ•°<br>å°±å›å»é‡å¤æ„é€ å™¨ Bar å·²ç»å®Œæˆçš„å·¥ä½œ.</p>\n<h3 id=\"åŸå‹\"><a href=\"#åŸå‹\" class=\"headerlink\" title=\"åŸå‹\"></a>åŸå‹</h3><p>åœ¨ä¸€ä¸ªçº¯ç²¹çš„åŸå‹æ¨¡å¼ä¸­, å°†æ‘’å¼ƒç±»ä¸“æ³¨äºå¯¹è±¡. åŸºäºåŸå‹çš„ç»§æ‰¿ç›¸æ¯”äºç±»çš„<br>ç»§æ‰¿åœ¨æ¦‚å¿µä¸Šæ›´ä¸ºç®€å•: ä¸€ä¸ªæ–°å¯¹è±¡å¯ä»¥ç»§æ‰¿ä¸€ä¸ªæ—§å¯¹è±¡çš„å±æ€§. é€šè¿‡æ„é€ ä¸€ä¸ªæœ‰ç”¨<br>çš„å¯¹è±¡å¼€å§‹, æ¥ç€å¯ä»¥æ„é€ å‡ºæ›´å¤šå’Œè¿™ä¸ªå¯¹è±¡ç›¸ä¼¼çš„å¯¹è±¡.   â€”-&lt;JavaScriptè¯­è¨€ç²¾ç²¹&gt; </p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// å…ˆæ„é€ ä¸€ä¸ªåŸºç¡€å¯¹è±¡</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> baseObject = &#123;</span><br><span class=\"line\">\tname: <span class=\"string\">'base'</span>,</span><br><span class=\"line\">\tget_name: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.name</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æ¥ä¸‹æ¥æ„é€ å®šåˆ¶åŒ–çš„å¯¹è±¡</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> myObj = <span class=\"built_in\">Object</span>.create(baseObject);</span><br><span class=\"line\">myObj.name = <span class=\"string\">'wow'</span>;</span><br><span class=\"line\">myObj.saying = <span class=\"string\">'Hi'</span>;</span><br><span class=\"line\">myObj.purr = <span class=\"function\"><span class=\"params\">n</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">let</span> str = <span class=\"string\">''</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; n; i++) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (str) &#123;</span><br><span class=\"line\">\t\t\tstr += <span class=\"string\">'hello'</span></span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\tstr += <span class=\"string\">'world'</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> str</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>è¿™æ˜¯ä¸€ç§â€™å·®å¼‚åŒ–ç»§æ‰¿â€™, é€šè¿‡åˆ¶å®šä¸€ä¸ªæ–°çš„å¯¹è±¡, æŒ‡æ˜å®ƒä¸åŸºæœ¬å¯¹è±¡çš„ä¸åŒ.</p>\n<h3 id=\"å‡½æ•°åŒ–\"><a href=\"#å‡½æ•°åŒ–\" class=\"headerlink\" title=\"å‡½æ•°åŒ–\"></a>å‡½æ•°åŒ–</h3><p>ä»¥ä¸Šä¸¤ç§ç»§æ‰¿æ¨¡å¼éƒ½æ²¡æœ‰å®ç°ç§æœ‰åŒ–, ä¹Ÿå°±æ˜¯è¯´æ‰€æœ‰çš„å˜é‡å’Œæ–¹æ³•éƒ½æ˜¯å…¬å¼€çš„, æ‰€ä»¥å°±<br>å¯ä»¥å¼€å§‹è¿ç”¨æ¨¡å—æ¨¡å¼. è¿™ä¸ªå‡½æ•°ä¸»è¦åˆ†ä¸ºå››ä¸ªæ­¥éª¤:</p>\n<ol>\n<li><p>åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡</p>\n</li>\n<li><p>å®šä¹‰ç§æœ‰å±æ€§.</p>\n</li>\n<li><p>ç»™è¿™ä¸ªæ–°å¯¹è±¡æ‰©å……ç‰¹æƒå‡½æ•° (æš´éœ²æ¥å£)</p>\n</li>\n<li><p>è¿”å›è¿™ä¸ªå¯¹è±¡</p>\n</li>\n</ol>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// spec å¯¹è±¡åŒ…å«æ„é€ å™¨æ‰€éœ€è¦çš„æ‰€æœ‰ä¿¡æ¯</span></span><br><span class=\"line\"><span class=\"comment\">// my å¯¹è±¡å…è®¸å…¶ä»–æ„é€ å™¨åˆ†äº«ä»–ä»¬çš„ç§æœ‰å±æ€§</span></span><br><span class=\"line\"><span class=\"comment\">// ä»¥ä¾¿åœ¨æˆ‘ä»¬çš„æ„é€ å™¨ä¸­ä½¿ç”¨</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> <span class=\"keyword\">constructor</span> = (spec, my) =&gt; &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">let</span> that = &#123;&#125;; <span class=\"comment\">// ç§æœ‰å®ä¾‹å˜é‡</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">let</span> my = my || &#123;&#125;;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"comment\">// æ‰©å±•å…±äº«çš„å˜é‡å’Œæ–¹æ³•</span></span><br><span class=\"line\">\t...</span><br><span class=\"line\"></span><br><span class=\"line\">\tthat = ä¸€ä¸ªæ–°å¯¹è±¡</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// ç»™ that æ·»åŠ ç‰¹æƒæ–¹æ³• </span></span><br><span class=\"line\">\t...</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// è¿”å›è¿™ä¸ªå¯¹è±¡</span></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> that</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>è¯­è¨€ç²¾ç²¹é‡Œçš„ä¾‹å­</p>\n</blockquote>\n<ol>\n<li><p>æ„é€ å™¨</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> mammal = <span class=\"function\"><span class=\"params\">spec</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">let</span> that = &#123;&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">\tthat.get_name = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> spec.name;</span><br><span class=\"line\">\tthat.says = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> spec.saying || <span class=\"string\">''</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> that</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> myMammal = mammal(&#123;<span class=\"attr\">name</span>: <span class=\"string\">'Herb'</span>&#125;);</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>å¦ä¸€ä¸ªæ„é€ å™¨</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> cat = <span class=\"function\"><span class=\"params\">spec</span> =&gt;</span>&#123;</span><br><span class=\"line\">\tspec.saying = spec.saying || <span class=\"string\">'meow'</span>;</span><br><span class=\"line\">\t<span class=\"comment\">// ç»§æ‰¿</span></span><br><span class=\"line\">\t<span class=\"keyword\">let</span> that = mammal(spec);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tthat.purr = <span class=\"function\"><span class=\"params\">n</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> i, s = <span class=\"string\">''</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (i = <span class=\"number\">0</span>; i &lt; n; i++) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (s) &#123;</span><br><span class=\"line\">\t\t\t\ts += <span class=\"string\">'-'</span>;\t</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\ts += <span class=\"string\">'r'</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> s</span><br><span class=\"line\">\t&#125;;</span><br><span class=\"line\">\tthat.get_name = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> that.says() + <span class=\"string\">' '</span> + spec.name + <span class=\"string\">' '</span> + that.says();</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> that</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> myCat = car(&#123;<span class=\"attr\">name</span>: <span class=\"string\">'Henrietta'</span>&#125;);</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<h3 id=\"è¶…ç±»\"><a href=\"#è¶…ç±»\" class=\"headerlink\" title=\"è¶…ç±»\"></a>è¶…ç±»</h3><p>ä»¥ä¸Šå‡½æ•°åŒ–çš„æ–¹å¼è¿˜ä¸èƒ½å¤Ÿè°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•å¹¶å‘çˆ¶ç±»æ–¹æ³•ä¼ é€’å‚æ•°. ä»¥ä¸‹æ˜¯æµ‹è¯•ä»£ç <br>åœ¨<code>è¯­è¨€ç²¾ç²¹</code>çš„ä¾‹å­çš„åŸºç¡€ä¸Šç¨ä½œæ”¹åŠ¨, ä¾¿äºè‡ªå·±ç†è§£:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// æ„é€ å™¨</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> mammal = <span class=\"function\"><span class=\"params\">spec</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">let</span> that = &#123;&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">\tthat.get_name = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> spec.name;</span><br><span class=\"line\">\tthat.says = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> spec.saying || <span class=\"string\">'Hi'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> that</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> myMammal = mammal(&#123;<span class=\"attr\">name</span>: <span class=\"string\">'Cara'</span>&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(myMammal.says()) <span class=\"comment\">// 'Hi'</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æ„é€ å™¨2</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> cat = <span class=\"function\"><span class=\"params\">spec</span> =&gt;</span> &#123;</span><br><span class=\"line\">\tspec.saying = spec.saying || <span class=\"string\">'meow'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// æ­¤æ—¶ that å·²ç»åŒ…å«: get_name å’Œ says æ–¹æ³•</span></span><br><span class=\"line\">\t<span class=\"keyword\">let</span> that = mammal(spec);</span><br><span class=\"line\"></span><br><span class=\"line\">\tthat.purr = <span class=\"function\"><span class=\"params\">n</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> str = <span class=\"string\">''</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; n; i++) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (str) &#123;</span><br><span class=\"line\">\t\t\t\tstr += <span class=\"string\">'-'</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\tstr += <span class=\"string\">'r'</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> str</span><br><span class=\"line\">\t&#125;;</span><br><span class=\"line\">\tthat.get_name = <span class=\"function\"><span class=\"params\">n</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> n || <span class=\"string\">\"i dont't have name\"</span></span><br><span class=\"line\">\t&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> that</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> myCat = cat(&#123;<span class=\"attr\">name</span>: <span class=\"string\">'Henrietta'</span>&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// i dont't have name</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(myCat.get_name())</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// è¿™ä¸ªæ—¶å€™ cat è¿˜ä¸èƒ½è®¿é—®çˆ¶ç±»æ–¹æ³•çš„èƒ½åŠ›</span></span><br><span class=\"line\"><span class=\"comment\">// æ‰€ä»¥è¶…ç±» super è¿˜æ˜¯æœ‰å¿…è¦çš„</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å…ˆæ‰©å±•ä¸¤ä¸ªæ–¹æ³•</span></span><br><span class=\"line\"><span class=\"comment\">// è¿™ä¸ªæ–¹æ³•ä¸èƒ½ç”¨ç®­å¤´å‡½æ•°æ¥å®šä¹‰, å¦åˆ™ this æŒ‡å‘çš„window</span></span><br><span class=\"line\"><span class=\"comment\">// è¿™é‡Œ this éœ€è¦çš„æ˜¯è¢«è°ƒç”¨çš„å¯¹è±¡</span></span><br><span class=\"line\"><span class=\"built_in\">Function</span>.prototype.method =  <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">name, fn</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">this</span>.prototype[name] = fn;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"keyword\">this</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å®šä¹‰è°ƒç”¨çˆ¶ç±»çš„å‡½æ•°</span></span><br><span class=\"line\"><span class=\"built_in\">Object</span>.method(<span class=\"string\">'superior'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">name</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">var</span> that = <span class=\"keyword\">this</span>,</span><br><span class=\"line\">        method = that[name];</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"params\">n</span> =&gt;</span> &#123;</span><br><span class=\"line\">    \t<span class=\"comment\">// this cat function</span></span><br><span class=\"line\">    \t<span class=\"built_in\">console</span>.log(n)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> method.call(that, n);</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æ¥è¯•è¯•è°ƒç”¨çˆ¶ç±»</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> coolCat = <span class=\"function\"><span class=\"params\">spec</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">let</span> that = cat(spec);</span><br><span class=\"line\">\t<span class=\"keyword\">let</span>\tsuper_get_name = that.superior(<span class=\"string\">'get_name'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// n ç»™çˆ¶ç±»æ–¹æ³•ä¼ å‚</span></span><br><span class=\"line\">\tthat.get_name = <span class=\"function\"><span class=\"params\">n</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">'like '</span> + super_get_name.call(<span class=\"keyword\">this</span>, n) + <span class=\"string\">' baby'</span>;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> that</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> myCoolCat = coolCat(&#123;<span class=\"attr\">name</span>: <span class=\"string\">'Bix'</span>, <span class=\"attr\">saying</span>: <span class=\"string\">'Hi'</span>&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> name = myCoolCat.get_name(<span class=\"string\">'this cat function'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(name) <span class=\"comment\">// like this cat function baby</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"æœ€åéšä¾¿æä¸€ä¸‹\"><a href=\"#æœ€åéšä¾¿æä¸€ä¸‹\" class=\"headerlink\" title=\"æœ€åéšä¾¿æä¸€ä¸‹\"></a>æœ€åéšä¾¿æä¸€ä¸‹</h4><p>ç®­å¤´å‡½æ•°çš„å‡ ä¸ªä½¿ç”¨æ³¨æ„ç‚¹:</p>\n<ol>\n<li><p>å‡½æ•°ä½“å†…çš„ <code>this</code> å¯¹è±¡, å°±æ˜¯å®šä¹‰æ—¶æ‰€åœ¨çš„å¯¹è±¡, è€Œä¸æ˜¯ä½¿ç”¨æ—¶æ‰€åœ¨çš„å¯¹è±¡.</p>\n</li>\n<li><p>ä¸å¯ä»¥å½“ä½œæ„é€ å‡½æ•°, ä¹Ÿå°±æ˜¯è¯´, ä¸å¯ä»¥ä½¿ç”¨newå‘½ä»¤, å¦åˆ™ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯.<br>å› ä¸ºç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„ <code>this</code>, è€Œæ˜¯ç»§æ‰¿å¤–å±‚å‡½æ•°çš„<code>this</code>.</p>\n</li>\n<li><p>ä¸å¯ä»¥ä½¿ç”¨ <code>arguments</code> å¯¹è±¡, è¯¥å¯¹è±¡åœ¨å‡½æ•°ä½“å†…ä¸å­˜åœ¨.</p>\n</li>\n<li><p>ä¸å¯ä»¥ä½¿ç”¨ <code>yield</code> å‘½ä»¤, å› æ­¤ç®­å¤´å‡½æ•°ä¸èƒ½ç”¨ä½œGeneratorå‡½æ•°.</p>\n</li>\n</ol>\n<p>Ceated on 2017-9-15 by Cara </p>\n"},{"title":" JavaScript æ¨¡å—åŒ–","date":"2017-10-17T13:49:59.000Z","_content":"ä½¿ç”¨å‡½æ•°å’Œé—­åŒ…æ¥æ„é€ æ¨¡å—. æ¨¡å—æ˜¯ä¸€ä¸ªæä¾›æ¥å£å´éšè—çŠ¶æ€ä¸ç°å®çš„å‡½æ•°æˆ–å¯¹è±¡.\né€šè¿‡æ¨¡å—å¯ä»¥æ‘’å¼ƒå…¨å±€å˜é‡çš„ä½¿ç”¨, æ¨¡å—æ¨¡å¼çš„ä¸€èˆ¬å½¢å¼æ˜¯: ä¸€ä¸ªå®šä¹‰ç§æœ‰å˜é‡å’Œå‡½æ•°çš„å‡½æ•°;\nåˆ©ç”¨é—­åŒ…åˆ›å»ºå¯ä»¥è®¿é—®ç§æœ‰å˜é‡å’Œå‡½æ•°çš„ç‰¹æƒå‡½æ•°. \n------ << JavaScriptè¯­è¨€ç²¾ç²¹ >>\n\n```javascript\nconst serial_maker = _ => {\n\t// ç§æœ‰å˜é‡\n\tlet prefix = '';\n\tlet num = 0;\n\n\treturn {\n\t\t// ç‰¹æƒæ–¹æ³•\n\t\tset_prefix: str => {\n\t\t\tprefix = String(str);\n\t\t},\n\t\tset_num: n => {\n\t\t\tnum = +n;\n\t\t},\n\t\tget_sum: _ => {\n\t\t\tlet result = prefix + num;\n\t\t\tnum++;\n\t\t\treturn result;\n\t\t}\n\t}\n}\n\nlet seqer = serial_maker();\nseqer.set_prefix('Hi');\nseqer.set_num(0101);\n\nconsole.log(seqer.get_sum()) // 'Hi0101'\n```\n\n### CommonJs ä¸ AMD\nå› ä¸ºæœ‰äº†æ¨¡å—çš„æ¦‚å¿µ, æ‰€ä»¥æˆ‘ä»¬èƒ½å°†å¾ˆå¤šé‡å¤æ€§çš„ä»£ç å°è£…æˆä¸€ä¸ªæ¨¡å—, æƒ³ç”¨ä»€ä¹ˆ\nåŠŸèƒ½å°±åŠ è½½ä»€ä¹ˆæ¨¡å—, ä¹Ÿèƒ½æ›´æ–¹ä¾¿æ˜¯ä½¿ç”¨åˆ«äººçš„ä»£ç . ä½†æ˜¯è¿™æ ·å°±ä¼šè¦æ±‚å¤§å®¶éƒ½ç”¨\nåŒæ ·çš„æ–¹å¼å°è£…æ¨¡å—, æ‰€ä»¥å°±æœ‰äº† CommonJs å’Œ AMD æ¥è§„èŒƒå¤§å®¶çš„å†™æ³•.\n\n- CommonJs\nNode.jsçš„æ¨¡å—å°±æ˜¯å‚ç…§ CommonJs æ¥å®ç°çš„, åœ¨æœåŠ¡å™¨ç«¯æ˜¯ä¸€å®šä¼šç”¨åˆ°æ¨¡å—çš„. CommonJs\n æ˜¯åŒæ­¥åŠ è½½, ä¹Ÿå°±æ˜¯è¯´å½“å¼•å…¥ä¸€ä¸ªæ¨¡å—å¿…é¡»ç­‰å¾…è¯¥æ¨¡å—åŠ è½½å®Œæˆä¹‹å, æ‰ä¼šæ‰§è¡Œæ¥ä¸‹æ¥çš„ä»£ç .\nå¯¹äºæœåŠ¡å™¨æ¥è¯´æ‰€æœ‰çš„æ¨¡å—éƒ½æ”¾åœ¨æœ¬åœ°, æ‰€ä»¥ç­‰å¾…çš„æ—¶é—´å¾ˆçŸ­; ä½†å¯¹äºæµè§ˆå™¨æ¥è¯´, æ‰€æœ‰çš„æ¨¡å—\néƒ½æ”¾åœ¨æœåŠ¡å™¨, æ‰€ä»¥ç­‰å¾…çš„æ—¶é—´å®Œå…¨å–å†³äºç½‘é€Ÿ, å°±å¾ˆå®¹æ˜“å‡ºç°å‡æ­»çš„çŠ¶æ€.\n\n```javascript\nvar math = require('math');\n\nmath.add(2, 3);\n```\n\n- AMD\nAMDæ˜¯\"Asynchronous Module Definition\"çš„ç¼©å†™, æ„æ€å°±æ˜¯\"å¼‚æ­¥æ¨¡å—å®šä¹‰\". å®ƒå°±æ˜¯é‡‡ç”¨å¼‚æ­¥\nåŠ è½½, å› æ­¤æ¨¡å—çš„åŠ è½½å¹¶ä¸å½±å“åé¢çš„è¯­å¥æ‰§è¡Œ. å°†æ‰€æœ‰ä¾èµ–äºè¿™ä¸ªæ¨¡å—çš„è¯­å¥éƒ½æ”¾åœ¨ä¸€ä¸ªå®šä¹‰çš„å›è°ƒ\nå‡½æ•°ä¸­æ‰§è¡Œ, è¿™æ ·ç­‰å¾…æ¨¡å—åŠ è½½å®Œæˆä¹‹åå°±ä¼šå»æ‰§è¡Œè¿™ä¸ªå›è°ƒå‡½æ•°.\n\n```javascript\nrequire([module], callback);\n\nrequire(['module'], module => {\n\tmodule.increment(1, 2)\n}) \n\n```\n\n### export / export default \nåœ¨JavaScript ES6ä¸­ï¼Œexportä¸export defaultå‡å¯ç”¨äºå¯¼å‡ºå¸¸é‡/å‡½æ•°/æ–‡ä»¶/æ¨¡å—ç­‰,\nä»¥ä¾¿åœ¨å…¶å®ƒæ–‡ä»¶æˆ–æ¨¡å—ä¸­é€šè¿‡importå°†å…¶å¯¼å…¥ä½¿ç”¨.\n\n- export \nexport å¯ä»¥å¯¼å‡ºå¤šä¸ª\n\n```javascript\n// types.js\nexport const foo = 'foo';\nexport const fn = n => n+1;\n\n// åœ¨ index.html å¼•å…¥\nimport {foo, fn} from 'types.js'\n```\n\n- export default\nåªèƒ½å¯¼å‡ºä¸€ä¸ª\n\n```javascript\n// types.js\nexport default const foo = 'foo';\n\n// åœ¨ index.html å¼•å…¥\nimport foo from 'types.js'\n// ç­‰ä»·äº\nimport {default as foo} from 'types.js'\n```\n\nCreated on 2017-9-15 by Cara\n","source":"_posts/JavaScript-æ¨¡å—åŒ–.md","raw":"---\ntitle: ' JavaScript æ¨¡å—åŒ–'\ndate: 2017-10-17 21:49:59\ntags:\n- JavaScript\ncategories:\n- ç¬”è®°ğŸ“’\n- å¤ä¹ \n---\nä½¿ç”¨å‡½æ•°å’Œé—­åŒ…æ¥æ„é€ æ¨¡å—. æ¨¡å—æ˜¯ä¸€ä¸ªæä¾›æ¥å£å´éšè—çŠ¶æ€ä¸ç°å®çš„å‡½æ•°æˆ–å¯¹è±¡.\né€šè¿‡æ¨¡å—å¯ä»¥æ‘’å¼ƒå…¨å±€å˜é‡çš„ä½¿ç”¨, æ¨¡å—æ¨¡å¼çš„ä¸€èˆ¬å½¢å¼æ˜¯: ä¸€ä¸ªå®šä¹‰ç§æœ‰å˜é‡å’Œå‡½æ•°çš„å‡½æ•°;\nåˆ©ç”¨é—­åŒ…åˆ›å»ºå¯ä»¥è®¿é—®ç§æœ‰å˜é‡å’Œå‡½æ•°çš„ç‰¹æƒå‡½æ•°. \n------ << JavaScriptè¯­è¨€ç²¾ç²¹ >>\n\n```javascript\nconst serial_maker = _ => {\n\t// ç§æœ‰å˜é‡\n\tlet prefix = '';\n\tlet num = 0;\n\n\treturn {\n\t\t// ç‰¹æƒæ–¹æ³•\n\t\tset_prefix: str => {\n\t\t\tprefix = String(str);\n\t\t},\n\t\tset_num: n => {\n\t\t\tnum = +n;\n\t\t},\n\t\tget_sum: _ => {\n\t\t\tlet result = prefix + num;\n\t\t\tnum++;\n\t\t\treturn result;\n\t\t}\n\t}\n}\n\nlet seqer = serial_maker();\nseqer.set_prefix('Hi');\nseqer.set_num(0101);\n\nconsole.log(seqer.get_sum()) // 'Hi0101'\n```\n\n### CommonJs ä¸ AMD\nå› ä¸ºæœ‰äº†æ¨¡å—çš„æ¦‚å¿µ, æ‰€ä»¥æˆ‘ä»¬èƒ½å°†å¾ˆå¤šé‡å¤æ€§çš„ä»£ç å°è£…æˆä¸€ä¸ªæ¨¡å—, æƒ³ç”¨ä»€ä¹ˆ\nåŠŸèƒ½å°±åŠ è½½ä»€ä¹ˆæ¨¡å—, ä¹Ÿèƒ½æ›´æ–¹ä¾¿æ˜¯ä½¿ç”¨åˆ«äººçš„ä»£ç . ä½†æ˜¯è¿™æ ·å°±ä¼šè¦æ±‚å¤§å®¶éƒ½ç”¨\nåŒæ ·çš„æ–¹å¼å°è£…æ¨¡å—, æ‰€ä»¥å°±æœ‰äº† CommonJs å’Œ AMD æ¥è§„èŒƒå¤§å®¶çš„å†™æ³•.\n\n- CommonJs\nNode.jsçš„æ¨¡å—å°±æ˜¯å‚ç…§ CommonJs æ¥å®ç°çš„, åœ¨æœåŠ¡å™¨ç«¯æ˜¯ä¸€å®šä¼šç”¨åˆ°æ¨¡å—çš„. CommonJs\n æ˜¯åŒæ­¥åŠ è½½, ä¹Ÿå°±æ˜¯è¯´å½“å¼•å…¥ä¸€ä¸ªæ¨¡å—å¿…é¡»ç­‰å¾…è¯¥æ¨¡å—åŠ è½½å®Œæˆä¹‹å, æ‰ä¼šæ‰§è¡Œæ¥ä¸‹æ¥çš„ä»£ç .\nå¯¹äºæœåŠ¡å™¨æ¥è¯´æ‰€æœ‰çš„æ¨¡å—éƒ½æ”¾åœ¨æœ¬åœ°, æ‰€ä»¥ç­‰å¾…çš„æ—¶é—´å¾ˆçŸ­; ä½†å¯¹äºæµè§ˆå™¨æ¥è¯´, æ‰€æœ‰çš„æ¨¡å—\néƒ½æ”¾åœ¨æœåŠ¡å™¨, æ‰€ä»¥ç­‰å¾…çš„æ—¶é—´å®Œå…¨å–å†³äºç½‘é€Ÿ, å°±å¾ˆå®¹æ˜“å‡ºç°å‡æ­»çš„çŠ¶æ€.\n\n```javascript\nvar math = require('math');\n\nmath.add(2, 3);\n```\n\n- AMD\nAMDæ˜¯\"Asynchronous Module Definition\"çš„ç¼©å†™, æ„æ€å°±æ˜¯\"å¼‚æ­¥æ¨¡å—å®šä¹‰\". å®ƒå°±æ˜¯é‡‡ç”¨å¼‚æ­¥\nåŠ è½½, å› æ­¤æ¨¡å—çš„åŠ è½½å¹¶ä¸å½±å“åé¢çš„è¯­å¥æ‰§è¡Œ. å°†æ‰€æœ‰ä¾èµ–äºè¿™ä¸ªæ¨¡å—çš„è¯­å¥éƒ½æ”¾åœ¨ä¸€ä¸ªå®šä¹‰çš„å›è°ƒ\nå‡½æ•°ä¸­æ‰§è¡Œ, è¿™æ ·ç­‰å¾…æ¨¡å—åŠ è½½å®Œæˆä¹‹åå°±ä¼šå»æ‰§è¡Œè¿™ä¸ªå›è°ƒå‡½æ•°.\n\n```javascript\nrequire([module], callback);\n\nrequire(['module'], module => {\n\tmodule.increment(1, 2)\n}) \n\n```\n\n### export / export default \nåœ¨JavaScript ES6ä¸­ï¼Œexportä¸export defaultå‡å¯ç”¨äºå¯¼å‡ºå¸¸é‡/å‡½æ•°/æ–‡ä»¶/æ¨¡å—ç­‰,\nä»¥ä¾¿åœ¨å…¶å®ƒæ–‡ä»¶æˆ–æ¨¡å—ä¸­é€šè¿‡importå°†å…¶å¯¼å…¥ä½¿ç”¨.\n\n- export \nexport å¯ä»¥å¯¼å‡ºå¤šä¸ª\n\n```javascript\n// types.js\nexport const foo = 'foo';\nexport const fn = n => n+1;\n\n// åœ¨ index.html å¼•å…¥\nimport {foo, fn} from 'types.js'\n```\n\n- export default\nåªèƒ½å¯¼å‡ºä¸€ä¸ª\n\n```javascript\n// types.js\nexport default const foo = 'foo';\n\n// åœ¨ index.html å¼•å…¥\nimport foo from 'types.js'\n// ç­‰ä»·äº\nimport {default as foo} from 'types.js'\n```\n\nCreated on 2017-9-15 by Cara\n","slug":"JavaScript-æ¨¡å—åŒ–","published":1,"updated":"2018-05-05T09:23:03.660Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjgurolsg000kklu03dfn3foi","content":"<p>ä½¿ç”¨å‡½æ•°å’Œé—­åŒ…æ¥æ„é€ æ¨¡å—. æ¨¡å—æ˜¯ä¸€ä¸ªæä¾›æ¥å£å´éšè—çŠ¶æ€ä¸ç°å®çš„å‡½æ•°æˆ–å¯¹è±¡.<br>é€šè¿‡æ¨¡å—å¯ä»¥æ‘’å¼ƒå…¨å±€å˜é‡çš„ä½¿ç”¨, æ¨¡å—æ¨¡å¼çš„ä¸€èˆ¬å½¢å¼æ˜¯: ä¸€ä¸ªå®šä¹‰ç§æœ‰å˜é‡å’Œå‡½æ•°çš„å‡½æ•°;<br>åˆ©ç”¨é—­åŒ…åˆ›å»ºå¯ä»¥è®¿é—®ç§æœ‰å˜é‡å’Œå‡½æ•°çš„ç‰¹æƒå‡½æ•°.<br>â€”â€” &lt;&lt; JavaScriptè¯­è¨€ç²¾ç²¹ &gt;&gt;</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> serial_maker = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">// ç§æœ‰å˜é‡</span></span><br><span class=\"line\">\t<span class=\"keyword\">let</span> prefix = <span class=\"string\">''</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">let</span> num = <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">// ç‰¹æƒæ–¹æ³•</span></span><br><span class=\"line\">\t\tset_prefix: <span class=\"function\"><span class=\"params\">str</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t\t\tprefix = <span class=\"built_in\">String</span>(str);</span><br><span class=\"line\">\t\t&#125;,</span><br><span class=\"line\">\t\tset_num: <span class=\"function\"><span class=\"params\">n</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t\t\tnum = +n;</span><br><span class=\"line\">\t\t&#125;,</span><br><span class=\"line\">\t\tget_sum: <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">let</span> result = prefix + num;</span><br><span class=\"line\">\t\t\tnum++;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> result;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> seqer = serial_maker();</span><br><span class=\"line\">seqer.set_prefix(<span class=\"string\">'Hi'</span>);</span><br><span class=\"line\">seqer.set_num(<span class=\"number\">0101</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(seqer.get_sum()) <span class=\"comment\">// 'Hi0101'</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"CommonJs-ä¸-AMD\"><a href=\"#CommonJs-ä¸-AMD\" class=\"headerlink\" title=\"CommonJs ä¸ AMD\"></a>CommonJs ä¸ AMD</h3><p>å› ä¸ºæœ‰äº†æ¨¡å—çš„æ¦‚å¿µ, æ‰€ä»¥æˆ‘ä»¬èƒ½å°†å¾ˆå¤šé‡å¤æ€§çš„ä»£ç å°è£…æˆä¸€ä¸ªæ¨¡å—, æƒ³ç”¨ä»€ä¹ˆ<br>åŠŸèƒ½å°±åŠ è½½ä»€ä¹ˆæ¨¡å—, ä¹Ÿèƒ½æ›´æ–¹ä¾¿æ˜¯ä½¿ç”¨åˆ«äººçš„ä»£ç . ä½†æ˜¯è¿™æ ·å°±ä¼šè¦æ±‚å¤§å®¶éƒ½ç”¨<br>åŒæ ·çš„æ–¹å¼å°è£…æ¨¡å—, æ‰€ä»¥å°±æœ‰äº† CommonJs å’Œ AMD æ¥è§„èŒƒå¤§å®¶çš„å†™æ³•.</p>\n<ul>\n<li>CommonJs<br>Node.jsçš„æ¨¡å—å°±æ˜¯å‚ç…§ CommonJs æ¥å®ç°çš„, åœ¨æœåŠ¡å™¨ç«¯æ˜¯ä¸€å®šä¼šç”¨åˆ°æ¨¡å—çš„. CommonJs<br>æ˜¯åŒæ­¥åŠ è½½, ä¹Ÿå°±æ˜¯è¯´å½“å¼•å…¥ä¸€ä¸ªæ¨¡å—å¿…é¡»ç­‰å¾…è¯¥æ¨¡å—åŠ è½½å®Œæˆä¹‹å, æ‰ä¼šæ‰§è¡Œæ¥ä¸‹æ¥çš„ä»£ç .<br>å¯¹äºæœåŠ¡å™¨æ¥è¯´æ‰€æœ‰çš„æ¨¡å—éƒ½æ”¾åœ¨æœ¬åœ°, æ‰€ä»¥ç­‰å¾…çš„æ—¶é—´å¾ˆçŸ­; ä½†å¯¹äºæµè§ˆå™¨æ¥è¯´, æ‰€æœ‰çš„æ¨¡å—<br>éƒ½æ”¾åœ¨æœåŠ¡å™¨, æ‰€ä»¥ç­‰å¾…çš„æ—¶é—´å®Œå…¨å–å†³äºç½‘é€Ÿ, å°±å¾ˆå®¹æ˜“å‡ºç°å‡æ­»çš„çŠ¶æ€.</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> math = <span class=\"built_in\">require</span>(<span class=\"string\">'math'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">math.add(<span class=\"number\">2</span>, <span class=\"number\">3</span>);</span><br></pre></td></tr></table></figure>\n<ul>\n<li>AMD<br>AMDæ˜¯â€Asynchronous Module Definitionâ€çš„ç¼©å†™, æ„æ€å°±æ˜¯â€å¼‚æ­¥æ¨¡å—å®šä¹‰â€. å®ƒå°±æ˜¯é‡‡ç”¨å¼‚æ­¥<br>åŠ è½½, å› æ­¤æ¨¡å—çš„åŠ è½½å¹¶ä¸å½±å“åé¢çš„è¯­å¥æ‰§è¡Œ. å°†æ‰€æœ‰ä¾èµ–äºè¿™ä¸ªæ¨¡å—çš„è¯­å¥éƒ½æ”¾åœ¨ä¸€ä¸ªå®šä¹‰çš„å›è°ƒ<br>å‡½æ•°ä¸­æ‰§è¡Œ, è¿™æ ·ç­‰å¾…æ¨¡å—åŠ è½½å®Œæˆä¹‹åå°±ä¼šå»æ‰§è¡Œè¿™ä¸ªå›è°ƒå‡½æ•°.</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">require</span>([<span class=\"built_in\">module</span>], callback);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">require</span>([<span class=\"string\">'module'</span>], <span class=\"built_in\">module</span> =&gt; &#123;</span><br><span class=\"line\">\t<span class=\"built_in\">module</span>.increment(<span class=\"number\">1</span>, <span class=\"number\">2</span>)</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<h3 id=\"export-export-default\"><a href=\"#export-export-default\" class=\"headerlink\" title=\"export / export default\"></a>export / export default</h3><p>åœ¨JavaScript ES6ä¸­ï¼Œexportä¸export defaultå‡å¯ç”¨äºå¯¼å‡ºå¸¸é‡/å‡½æ•°/æ–‡ä»¶/æ¨¡å—ç­‰,<br>ä»¥ä¾¿åœ¨å…¶å®ƒæ–‡ä»¶æˆ–æ¨¡å—ä¸­é€šè¿‡importå°†å…¶å¯¼å…¥ä½¿ç”¨.</p>\n<ul>\n<li>export<br>export å¯ä»¥å¯¼å‡ºå¤šä¸ª</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// types.js</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> foo = <span class=\"string\">'foo'</span>;</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> fn = <span class=\"function\"><span class=\"params\">n</span> =&gt;</span> n+<span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// åœ¨ index.html å¼•å…¥</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123;foo, fn&#125; <span class=\"keyword\">from</span> <span class=\"string\">'types.js'</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>export default<br>åªèƒ½å¯¼å‡ºä¸€ä¸ª</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// types.js</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"keyword\">const</span> foo = <span class=\"string\">'foo'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// åœ¨ index.html å¼•å…¥</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> foo <span class=\"keyword\">from</span> <span class=\"string\">'types.js'</span></span><br><span class=\"line\"><span class=\"comment\">// ç­‰ä»·äº</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123;<span class=\"keyword\">default</span> <span class=\"keyword\">as</span> foo&#125; <span class=\"keyword\">from</span> <span class=\"string\">'types.js'</span></span><br></pre></td></tr></table></figure>\n<p>Created on 2017-9-15 by Cara</p>\n","site":{"data":{}},"excerpt":"","more":"<p>ä½¿ç”¨å‡½æ•°å’Œé—­åŒ…æ¥æ„é€ æ¨¡å—. æ¨¡å—æ˜¯ä¸€ä¸ªæä¾›æ¥å£å´éšè—çŠ¶æ€ä¸ç°å®çš„å‡½æ•°æˆ–å¯¹è±¡.<br>é€šè¿‡æ¨¡å—å¯ä»¥æ‘’å¼ƒå…¨å±€å˜é‡çš„ä½¿ç”¨, æ¨¡å—æ¨¡å¼çš„ä¸€èˆ¬å½¢å¼æ˜¯: ä¸€ä¸ªå®šä¹‰ç§æœ‰å˜é‡å’Œå‡½æ•°çš„å‡½æ•°;<br>åˆ©ç”¨é—­åŒ…åˆ›å»ºå¯ä»¥è®¿é—®ç§æœ‰å˜é‡å’Œå‡½æ•°çš„ç‰¹æƒå‡½æ•°.<br>â€”â€” &lt;&lt; JavaScriptè¯­è¨€ç²¾ç²¹ &gt;&gt;</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> serial_maker = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">// ç§æœ‰å˜é‡</span></span><br><span class=\"line\">\t<span class=\"keyword\">let</span> prefix = <span class=\"string\">''</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">let</span> num = <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">// ç‰¹æƒæ–¹æ³•</span></span><br><span class=\"line\">\t\tset_prefix: <span class=\"function\"><span class=\"params\">str</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t\t\tprefix = <span class=\"built_in\">String</span>(str);</span><br><span class=\"line\">\t\t&#125;,</span><br><span class=\"line\">\t\tset_num: <span class=\"function\"><span class=\"params\">n</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t\t\tnum = +n;</span><br><span class=\"line\">\t\t&#125;,</span><br><span class=\"line\">\t\tget_sum: <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">let</span> result = prefix + num;</span><br><span class=\"line\">\t\t\tnum++;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> result;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> seqer = serial_maker();</span><br><span class=\"line\">seqer.set_prefix(<span class=\"string\">'Hi'</span>);</span><br><span class=\"line\">seqer.set_num(<span class=\"number\">0101</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(seqer.get_sum()) <span class=\"comment\">// 'Hi0101'</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"CommonJs-ä¸-AMD\"><a href=\"#CommonJs-ä¸-AMD\" class=\"headerlink\" title=\"CommonJs ä¸ AMD\"></a>CommonJs ä¸ AMD</h3><p>å› ä¸ºæœ‰äº†æ¨¡å—çš„æ¦‚å¿µ, æ‰€ä»¥æˆ‘ä»¬èƒ½å°†å¾ˆå¤šé‡å¤æ€§çš„ä»£ç å°è£…æˆä¸€ä¸ªæ¨¡å—, æƒ³ç”¨ä»€ä¹ˆ<br>åŠŸèƒ½å°±åŠ è½½ä»€ä¹ˆæ¨¡å—, ä¹Ÿèƒ½æ›´æ–¹ä¾¿æ˜¯ä½¿ç”¨åˆ«äººçš„ä»£ç . ä½†æ˜¯è¿™æ ·å°±ä¼šè¦æ±‚å¤§å®¶éƒ½ç”¨<br>åŒæ ·çš„æ–¹å¼å°è£…æ¨¡å—, æ‰€ä»¥å°±æœ‰äº† CommonJs å’Œ AMD æ¥è§„èŒƒå¤§å®¶çš„å†™æ³•.</p>\n<ul>\n<li>CommonJs<br>Node.jsçš„æ¨¡å—å°±æ˜¯å‚ç…§ CommonJs æ¥å®ç°çš„, åœ¨æœåŠ¡å™¨ç«¯æ˜¯ä¸€å®šä¼šç”¨åˆ°æ¨¡å—çš„. CommonJs<br>æ˜¯åŒæ­¥åŠ è½½, ä¹Ÿå°±æ˜¯è¯´å½“å¼•å…¥ä¸€ä¸ªæ¨¡å—å¿…é¡»ç­‰å¾…è¯¥æ¨¡å—åŠ è½½å®Œæˆä¹‹å, æ‰ä¼šæ‰§è¡Œæ¥ä¸‹æ¥çš„ä»£ç .<br>å¯¹äºæœåŠ¡å™¨æ¥è¯´æ‰€æœ‰çš„æ¨¡å—éƒ½æ”¾åœ¨æœ¬åœ°, æ‰€ä»¥ç­‰å¾…çš„æ—¶é—´å¾ˆçŸ­; ä½†å¯¹äºæµè§ˆå™¨æ¥è¯´, æ‰€æœ‰çš„æ¨¡å—<br>éƒ½æ”¾åœ¨æœåŠ¡å™¨, æ‰€ä»¥ç­‰å¾…çš„æ—¶é—´å®Œå…¨å–å†³äºç½‘é€Ÿ, å°±å¾ˆå®¹æ˜“å‡ºç°å‡æ­»çš„çŠ¶æ€.</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> math = <span class=\"built_in\">require</span>(<span class=\"string\">'math'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">math.add(<span class=\"number\">2</span>, <span class=\"number\">3</span>);</span><br></pre></td></tr></table></figure>\n<ul>\n<li>AMD<br>AMDæ˜¯â€Asynchronous Module Definitionâ€çš„ç¼©å†™, æ„æ€å°±æ˜¯â€å¼‚æ­¥æ¨¡å—å®šä¹‰â€. å®ƒå°±æ˜¯é‡‡ç”¨å¼‚æ­¥<br>åŠ è½½, å› æ­¤æ¨¡å—çš„åŠ è½½å¹¶ä¸å½±å“åé¢çš„è¯­å¥æ‰§è¡Œ. å°†æ‰€æœ‰ä¾èµ–äºè¿™ä¸ªæ¨¡å—çš„è¯­å¥éƒ½æ”¾åœ¨ä¸€ä¸ªå®šä¹‰çš„å›è°ƒ<br>å‡½æ•°ä¸­æ‰§è¡Œ, è¿™æ ·ç­‰å¾…æ¨¡å—åŠ è½½å®Œæˆä¹‹åå°±ä¼šå»æ‰§è¡Œè¿™ä¸ªå›è°ƒå‡½æ•°.</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">require</span>([<span class=\"built_in\">module</span>], callback);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">require</span>([<span class=\"string\">'module'</span>], <span class=\"built_in\">module</span> =&gt; &#123;</span><br><span class=\"line\">\t<span class=\"built_in\">module</span>.increment(<span class=\"number\">1</span>, <span class=\"number\">2</span>)</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<h3 id=\"export-export-default\"><a href=\"#export-export-default\" class=\"headerlink\" title=\"export / export default\"></a>export / export default</h3><p>åœ¨JavaScript ES6ä¸­ï¼Œexportä¸export defaultå‡å¯ç”¨äºå¯¼å‡ºå¸¸é‡/å‡½æ•°/æ–‡ä»¶/æ¨¡å—ç­‰,<br>ä»¥ä¾¿åœ¨å…¶å®ƒæ–‡ä»¶æˆ–æ¨¡å—ä¸­é€šè¿‡importå°†å…¶å¯¼å…¥ä½¿ç”¨.</p>\n<ul>\n<li>export<br>export å¯ä»¥å¯¼å‡ºå¤šä¸ª</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// types.js</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> foo = <span class=\"string\">'foo'</span>;</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> fn = <span class=\"function\"><span class=\"params\">n</span> =&gt;</span> n+<span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// åœ¨ index.html å¼•å…¥</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123;foo, fn&#125; <span class=\"keyword\">from</span> <span class=\"string\">'types.js'</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>export default<br>åªèƒ½å¯¼å‡ºä¸€ä¸ª</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// types.js</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"keyword\">const</span> foo = <span class=\"string\">'foo'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// åœ¨ index.html å¼•å…¥</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> foo <span class=\"keyword\">from</span> <span class=\"string\">'types.js'</span></span><br><span class=\"line\"><span class=\"comment\">// ç­‰ä»·äº</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123;<span class=\"keyword\">default</span> <span class=\"keyword\">as</span> foo&#125; <span class=\"keyword\">from</span> <span class=\"string\">'types.js'</span></span><br></pre></td></tr></table></figure>\n<p>Created on 2017-9-15 by Cara</p>\n"},{"title":"JavaScript æ·±æµ…æ‹·è´","date":"2017-10-16T13:45:01.000Z","_content":"\n> ### æµ…æ‹·è´\næµ…æ‹·è´åªèƒ½æ‹·è´é¡¶å±‚å±æ€§åŸºæœ¬æ•°æ®ç±»å‹, ä¹Ÿå°±æ˜¯å¦‚æœçˆ¶å¯¹è±¡çš„å±æ€§æ˜¯ä¸€ä¸ªå¯¹è±¡æˆ–æ•°ç»„, é‚£ä¹ˆå­å¯¹è±¡è·å–åˆ°çš„åªæ˜¯ä¸€ä¸ªå†…å­˜åœ°å€è€Œä¸æ˜¯ä¸€ä¸ªçœŸæ­£çš„å¯¹è±¡, æ‰€ä»¥ä¸€æ—¦ä¿®æ”¹çˆ¶å¯¹è±¡ä¹Ÿä¼šè·Ÿç€è¢«ç¯¡æ”¹.\n\n```javascript\n    function shallowCopy ( parent ) {\n        let o = {};\n        for (let i in parent) {\n             o[i] = parent[i]\n        }\n        return o\n    }\n```\n\n> ### æ·±æ‹·è´\næ·±æ‹·è´ä¹Ÿå°±æ˜¯èƒ½å¤Ÿå®ç°æ•°ç»„å’Œå¯¹è±¡æ‹·è´, æ·±æ‹·è´ä¸æµ…æ‹·è´å¯¹æ¯”, æ·±æ‹·è´ä¼šåœ¨å †åŒºå¼€è¾Ÿæ–°çš„ä¸€å—æ¥å‚¨å­˜æ–°çš„å¯¹è±¡. ä¸¤ä¸ªå¯¹è±¡å¯¹åº”çš„æ˜¯ä¸¤ä¸ªä¸åŒçš„å†…å­˜åœ°å€, æ‰€ä»¥ä¿®æ”¹å…¶ä¸­ä¸€ä¸ªå¯¹è±¡çš„å±æ€§å¹¶ä¸ä¼šå½±å“åˆ°å¦ä¸€ä¸ªå¯¹è±¡çš„å±æ€§. å®ç°æ·±æ‹·è´ä¹Ÿæœ‰ä¸¤ç§æ–¹å¼: ä¸€ç§æ˜¯é€’å½’/ ä¸€ç§æ˜¯JSON.\n\n1. é€’å½’\n```javascript\n    function deepCopy (parent, child = {}) {\n        for (let i in parent) {\n            if (typeof parent[i] === 'object') {\n                child[i] = (parent[i].constructor == Array) ? [] : {};\n                deepCopy(parent[i], child[i])\n            } else {\n                 child[i] = parent[i]\n            }\n        }\n    }\n```\n\n2. JSONè§£æ(ä¸¥æ ¼çš„ JSON æ ¼å¼)\n```javascript\n    var o = {\n        age: '18',\n        friends: ['è€å¼ ', 'è€ç‹'],\n        job: {\n           main: 'ç¡è§‰',\n           sub: 'èººç€'\n        }\n    };\n    var result = JSON.parse( JSON.stringify(o));\n    result.name = 'cara';\n    result.friends.push('è€æ');\n    console.dir(o);\n    console.dir(result)\n```\n\nä»¥ä¸Šä¸¤ç§æ–¹å¼æ— æ³•è§£æä¸€ä¸‹å‡ ç§æƒ…å†µ:\n- RegExp å¯¹è±¡\n- å‡½æ•°\n- ä¼šæ‘’å¼ƒå¯¹è±¡çš„ constructor , æ‰€æœ‰æ„é€ å‡½æ•°éƒ½ä¼šæŒ‡å‘ Object\n- å¯¹è±¡å¾ªç¯å¼•ç”¨ä¹Ÿä¼šæŠ¥é”™\n\næ‰€ä»¥è¦é¢å¯¹ä¸åŒçš„å¯¹è±¡, åšä¸åŒçš„å¤„ç†æ–¹å¼, å°±éœ€è¦æ£€æŸ¥ä¸€ä¸‹å¯¹è±¡çš„ç±»å‹:\n\n```js\n// æ£€æŸ¥ç±»å‹\nconst Type = _ => {\n    const Types = {}\n    for (let i = 0, type; type = ['Array', 'Date', 'RegExp'][i++];) {\n        Types['is' + type] = (obj) => {\n            if (typeof obj !== 'object') return\n            return Object.prototype.toString.call(obj) === `[object ${type}]`\n        }\n    }\n    return Types\n}\nconst types = Type()\n\n// è·å–æ­£åˆ™å½±å“èŒƒå›´\nconst getRegExp = (reg) => {\n    if (reg.globlal) return 'g'\n    if (reg.ignoreCase) return 'i'\n    if (reg.multiline) return 'm'\n}\n\nconst clone = (oldObj = {}) => {\n    let oldObjs = []\n\n    const _clone = oldObj => {\n        let newObj, proto\n        // ä¸åŒç±»å‹, ä¸åŒå¤„ç†æ–¹å¼\n        if (types.isArray(oldObj)) {\n            newObj = []\n        }\n        if (types.isDate(oldObj)) {\n            newObj = new Date(oldObj.getTime())\n        }\n        if (types.isRegExp(oldObj)) {\n            newObj = new RegExp(oldObj.source, getRegExp(oldObj))\n        } else {\n            // æ–©æ–­åŸå‹é“¾\n            proto = Object.getPrototypeOf(oldObj)\n            newObj = Object.create(proto)\n        }\n        // å¦‚æœä¹‹å‰å·²ç»éå†è¿‡è¯¥å¯¹è±¡, ç›´æ¥è¿”å›è¯¥å¯¹è±¡\n        let hasBeen = oldObjs.indexOf(oldObj)\n        if (hasBeen !== -1) {\n            return oldObjs[hasBeen]\n        }\n        // è®°å½•æ“ä½œè¿‡çš„å¯¹è±¡\n        oldObjs.push(oldObj)\n        // é€’å½’\n        for (let i in oldObj) {\n            newObj[i] = _clone(oldObj[i])\n        }\n        return newObj\n    }\n    return _clone(oldObj)\n}\n```\n\nğŸ‘‡æµ‹è¯•ä¸€æ³¢:\n```js\n// æµ‹è¯•\nfunction person(name) {\n    this.name = name;\n}\nconst Cara = new person('Cara');\n\nfunction say() {\n    console.log('hello world!');\n}\n\nconst oldObj = {\n    a: say,\n    c: new RegExp('ab+c', 'i'),\n    d: Cara,\n};\noldObj.b = oldObj;\n\n\nconst newObj = clone(oldObj)\n\nconsole.log(newObj.a, oldObj.a) \n// [Function: say] [Function: say]\nconsole.log(newObj.b, oldObj.b)\n// { \n//     a: [Function: say], \n//     c: /ab+c/i, \n//     d: person { name: 'Messi' }, \n//     b: [Circular] \n// } \n// { \n//     a: [Function: say], \n//     c: /ab+c/i, \n//     d: person { name: 'Messi' }, \n//     b: [Circular] \n// }\nconsole.log(newObj.c, oldObj.c)\n// /ab+c/i /ab+c/i\nconsole.log(newObj.d.constructor, oldObj.d.constructor)\n// [Function: person][Function: person] \n```\nç›®å‰æˆ‘ä»¬ä¸Šé¢è¯´çš„å‡ ç§å‘å°±å¾—ä»¥è§£å†³, ä¸è¿‡è¿™è¿˜ä¸æ˜¯æœ€å®Œæ•´çš„æ–¹æ¡ˆ, è¿˜æœ‰ä¸€äº› ES6 é‡Œé¢çš„å¯¹è±¡ä¹Ÿéœ€è¦æˆ‘ä»¬åšç‰¹æ®Šçš„å¤„ç†, ä¸è¿‡ç°åœ¨è¿™ä¸ªç‰ˆæœ¬åœ¨æ—¥å¸¸è¿˜æ˜¯å¤Ÿç”¨äº†. å¦å¤–åœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿˜æ˜¯å»ºè®®ç”¨ `lodash` çš„ `_.cloneDeep`\n\nCreated on 2017-8-15 by cara","source":"_posts/JavaScript-æ·±æµ…æ‹·è´.md","raw":"---\ntitle: JavaScript æ·±æµ…æ‹·è´\ndate: 2017-10-16 21:45:01\ntags:\n- JavaScript\ncategories:\n- ç¬”è®°ğŸ“’\n---\n\n> ### æµ…æ‹·è´\næµ…æ‹·è´åªèƒ½æ‹·è´é¡¶å±‚å±æ€§åŸºæœ¬æ•°æ®ç±»å‹, ä¹Ÿå°±æ˜¯å¦‚æœçˆ¶å¯¹è±¡çš„å±æ€§æ˜¯ä¸€ä¸ªå¯¹è±¡æˆ–æ•°ç»„, é‚£ä¹ˆå­å¯¹è±¡è·å–åˆ°çš„åªæ˜¯ä¸€ä¸ªå†…å­˜åœ°å€è€Œä¸æ˜¯ä¸€ä¸ªçœŸæ­£çš„å¯¹è±¡, æ‰€ä»¥ä¸€æ—¦ä¿®æ”¹çˆ¶å¯¹è±¡ä¹Ÿä¼šè·Ÿç€è¢«ç¯¡æ”¹.\n\n```javascript\n    function shallowCopy ( parent ) {\n        let o = {};\n        for (let i in parent) {\n             o[i] = parent[i]\n        }\n        return o\n    }\n```\n\n> ### æ·±æ‹·è´\næ·±æ‹·è´ä¹Ÿå°±æ˜¯èƒ½å¤Ÿå®ç°æ•°ç»„å’Œå¯¹è±¡æ‹·è´, æ·±æ‹·è´ä¸æµ…æ‹·è´å¯¹æ¯”, æ·±æ‹·è´ä¼šåœ¨å †åŒºå¼€è¾Ÿæ–°çš„ä¸€å—æ¥å‚¨å­˜æ–°çš„å¯¹è±¡. ä¸¤ä¸ªå¯¹è±¡å¯¹åº”çš„æ˜¯ä¸¤ä¸ªä¸åŒçš„å†…å­˜åœ°å€, æ‰€ä»¥ä¿®æ”¹å…¶ä¸­ä¸€ä¸ªå¯¹è±¡çš„å±æ€§å¹¶ä¸ä¼šå½±å“åˆ°å¦ä¸€ä¸ªå¯¹è±¡çš„å±æ€§. å®ç°æ·±æ‹·è´ä¹Ÿæœ‰ä¸¤ç§æ–¹å¼: ä¸€ç§æ˜¯é€’å½’/ ä¸€ç§æ˜¯JSON.\n\n1. é€’å½’\n```javascript\n    function deepCopy (parent, child = {}) {\n        for (let i in parent) {\n            if (typeof parent[i] === 'object') {\n                child[i] = (parent[i].constructor == Array) ? [] : {};\n                deepCopy(parent[i], child[i])\n            } else {\n                 child[i] = parent[i]\n            }\n        }\n    }\n```\n\n2. JSONè§£æ(ä¸¥æ ¼çš„ JSON æ ¼å¼)\n```javascript\n    var o = {\n        age: '18',\n        friends: ['è€å¼ ', 'è€ç‹'],\n        job: {\n           main: 'ç¡è§‰',\n           sub: 'èººç€'\n        }\n    };\n    var result = JSON.parse( JSON.stringify(o));\n    result.name = 'cara';\n    result.friends.push('è€æ');\n    console.dir(o);\n    console.dir(result)\n```\n\nä»¥ä¸Šä¸¤ç§æ–¹å¼æ— æ³•è§£æä¸€ä¸‹å‡ ç§æƒ…å†µ:\n- RegExp å¯¹è±¡\n- å‡½æ•°\n- ä¼šæ‘’å¼ƒå¯¹è±¡çš„ constructor , æ‰€æœ‰æ„é€ å‡½æ•°éƒ½ä¼šæŒ‡å‘ Object\n- å¯¹è±¡å¾ªç¯å¼•ç”¨ä¹Ÿä¼šæŠ¥é”™\n\næ‰€ä»¥è¦é¢å¯¹ä¸åŒçš„å¯¹è±¡, åšä¸åŒçš„å¤„ç†æ–¹å¼, å°±éœ€è¦æ£€æŸ¥ä¸€ä¸‹å¯¹è±¡çš„ç±»å‹:\n\n```js\n// æ£€æŸ¥ç±»å‹\nconst Type = _ => {\n    const Types = {}\n    for (let i = 0, type; type = ['Array', 'Date', 'RegExp'][i++];) {\n        Types['is' + type] = (obj) => {\n            if (typeof obj !== 'object') return\n            return Object.prototype.toString.call(obj) === `[object ${type}]`\n        }\n    }\n    return Types\n}\nconst types = Type()\n\n// è·å–æ­£åˆ™å½±å“èŒƒå›´\nconst getRegExp = (reg) => {\n    if (reg.globlal) return 'g'\n    if (reg.ignoreCase) return 'i'\n    if (reg.multiline) return 'm'\n}\n\nconst clone = (oldObj = {}) => {\n    let oldObjs = []\n\n    const _clone = oldObj => {\n        let newObj, proto\n        // ä¸åŒç±»å‹, ä¸åŒå¤„ç†æ–¹å¼\n        if (types.isArray(oldObj)) {\n            newObj = []\n        }\n        if (types.isDate(oldObj)) {\n            newObj = new Date(oldObj.getTime())\n        }\n        if (types.isRegExp(oldObj)) {\n            newObj = new RegExp(oldObj.source, getRegExp(oldObj))\n        } else {\n            // æ–©æ–­åŸå‹é“¾\n            proto = Object.getPrototypeOf(oldObj)\n            newObj = Object.create(proto)\n        }\n        // å¦‚æœä¹‹å‰å·²ç»éå†è¿‡è¯¥å¯¹è±¡, ç›´æ¥è¿”å›è¯¥å¯¹è±¡\n        let hasBeen = oldObjs.indexOf(oldObj)\n        if (hasBeen !== -1) {\n            return oldObjs[hasBeen]\n        }\n        // è®°å½•æ“ä½œè¿‡çš„å¯¹è±¡\n        oldObjs.push(oldObj)\n        // é€’å½’\n        for (let i in oldObj) {\n            newObj[i] = _clone(oldObj[i])\n        }\n        return newObj\n    }\n    return _clone(oldObj)\n}\n```\n\nğŸ‘‡æµ‹è¯•ä¸€æ³¢:\n```js\n// æµ‹è¯•\nfunction person(name) {\n    this.name = name;\n}\nconst Cara = new person('Cara');\n\nfunction say() {\n    console.log('hello world!');\n}\n\nconst oldObj = {\n    a: say,\n    c: new RegExp('ab+c', 'i'),\n    d: Cara,\n};\noldObj.b = oldObj;\n\n\nconst newObj = clone(oldObj)\n\nconsole.log(newObj.a, oldObj.a) \n// [Function: say] [Function: say]\nconsole.log(newObj.b, oldObj.b)\n// { \n//     a: [Function: say], \n//     c: /ab+c/i, \n//     d: person { name: 'Messi' }, \n//     b: [Circular] \n// } \n// { \n//     a: [Function: say], \n//     c: /ab+c/i, \n//     d: person { name: 'Messi' }, \n//     b: [Circular] \n// }\nconsole.log(newObj.c, oldObj.c)\n// /ab+c/i /ab+c/i\nconsole.log(newObj.d.constructor, oldObj.d.constructor)\n// [Function: person][Function: person] \n```\nç›®å‰æˆ‘ä»¬ä¸Šé¢è¯´çš„å‡ ç§å‘å°±å¾—ä»¥è§£å†³, ä¸è¿‡è¿™è¿˜ä¸æ˜¯æœ€å®Œæ•´çš„æ–¹æ¡ˆ, è¿˜æœ‰ä¸€äº› ES6 é‡Œé¢çš„å¯¹è±¡ä¹Ÿéœ€è¦æˆ‘ä»¬åšç‰¹æ®Šçš„å¤„ç†, ä¸è¿‡ç°åœ¨è¿™ä¸ªç‰ˆæœ¬åœ¨æ—¥å¸¸è¿˜æ˜¯å¤Ÿç”¨äº†. å¦å¤–åœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿˜æ˜¯å»ºè®®ç”¨ `lodash` çš„ `_.cloneDeep`\n\nCreated on 2017-8-15 by cara","slug":"JavaScript-æ·±æµ…æ‹·è´","published":1,"updated":"2018-05-05T09:23:03.661Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjgurolsj000pklu0tofsng0m","content":"<blockquote>\n<h3 id=\"æµ…æ‹·è´\"><a href=\"#æµ…æ‹·è´\" class=\"headerlink\" title=\"æµ…æ‹·è´\"></a>æµ…æ‹·è´</h3><p>æµ…æ‹·è´åªèƒ½æ‹·è´é¡¶å±‚å±æ€§åŸºæœ¬æ•°æ®ç±»å‹, ä¹Ÿå°±æ˜¯å¦‚æœçˆ¶å¯¹è±¡çš„å±æ€§æ˜¯ä¸€ä¸ªå¯¹è±¡æˆ–æ•°ç»„, é‚£ä¹ˆå­å¯¹è±¡è·å–åˆ°çš„åªæ˜¯ä¸€ä¸ªå†…å­˜åœ°å€è€Œä¸æ˜¯ä¸€ä¸ªçœŸæ­£çš„å¯¹è±¡, æ‰€ä»¥ä¸€æ—¦ä¿®æ”¹çˆ¶å¯¹è±¡ä¹Ÿä¼šè·Ÿç€è¢«ç¯¡æ”¹.</p>\n</blockquote>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">shallowCopy</span> (<span class=\"params\"> parent </span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> o = &#123;&#125;;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i <span class=\"keyword\">in</span> parent) &#123;</span><br><span class=\"line\">         o[i] = parent[i]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> o</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<h3 id=\"æ·±æ‹·è´\"><a href=\"#æ·±æ‹·è´\" class=\"headerlink\" title=\"æ·±æ‹·è´\"></a>æ·±æ‹·è´</h3><p>æ·±æ‹·è´ä¹Ÿå°±æ˜¯èƒ½å¤Ÿå®ç°æ•°ç»„å’Œå¯¹è±¡æ‹·è´, æ·±æ‹·è´ä¸æµ…æ‹·è´å¯¹æ¯”, æ·±æ‹·è´ä¼šåœ¨å †åŒºå¼€è¾Ÿæ–°çš„ä¸€å—æ¥å‚¨å­˜æ–°çš„å¯¹è±¡. ä¸¤ä¸ªå¯¹è±¡å¯¹åº”çš„æ˜¯ä¸¤ä¸ªä¸åŒçš„å†…å­˜åœ°å€, æ‰€ä»¥ä¿®æ”¹å…¶ä¸­ä¸€ä¸ªå¯¹è±¡çš„å±æ€§å¹¶ä¸ä¼šå½±å“åˆ°å¦ä¸€ä¸ªå¯¹è±¡çš„å±æ€§. å®ç°æ·±æ‹·è´ä¹Ÿæœ‰ä¸¤ç§æ–¹å¼: ä¸€ç§æ˜¯é€’å½’/ ä¸€ç§æ˜¯JSON.</p>\n</blockquote>\n<ol>\n<li><p>é€’å½’</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">deepCopy</span> (<span class=\"params\">parent, child = &#123;&#125;</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i <span class=\"keyword\">in</span> parent) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> parent[i] === <span class=\"string\">'object'</span>) &#123;</span><br><span class=\"line\">            child[i] = (parent[i].constructor == <span class=\"built_in\">Array</span>) ? [] : &#123;&#125;;</span><br><span class=\"line\">            deepCopy(parent[i], child[i])</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">             child[i] = parent[i]</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>JSONè§£æ(ä¸¥æ ¼çš„ JSON æ ¼å¼)</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> o = &#123;</span><br><span class=\"line\">    age: <span class=\"string\">'18'</span>,</span><br><span class=\"line\">    friends: [<span class=\"string\">'è€å¼ '</span>, <span class=\"string\">'è€ç‹'</span>],</span><br><span class=\"line\">    job: &#123;</span><br><span class=\"line\">       main: <span class=\"string\">'ç¡è§‰'</span>,</span><br><span class=\"line\">       sub: <span class=\"string\">'èººç€'</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">var</span> result = <span class=\"built_in\">JSON</span>.parse( <span class=\"built_in\">JSON</span>.stringify(o));</span><br><span class=\"line\">result.name = <span class=\"string\">'cara'</span>;</span><br><span class=\"line\">result.friends.push(<span class=\"string\">'è€æ'</span>);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.dir(o);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.dir(result)</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<p>ä»¥ä¸Šä¸¤ç§æ–¹å¼æ— æ³•è§£æä¸€ä¸‹å‡ ç§æƒ…å†µ:</p>\n<ul>\n<li>RegExp å¯¹è±¡</li>\n<li>å‡½æ•°</li>\n<li>ä¼šæ‘’å¼ƒå¯¹è±¡çš„ constructor , æ‰€æœ‰æ„é€ å‡½æ•°éƒ½ä¼šæŒ‡å‘ Object</li>\n<li>å¯¹è±¡å¾ªç¯å¼•ç”¨ä¹Ÿä¼šæŠ¥é”™</li>\n</ul>\n<p>æ‰€ä»¥è¦é¢å¯¹ä¸åŒçš„å¯¹è±¡, åšä¸åŒçš„å¤„ç†æ–¹å¼, å°±éœ€è¦æ£€æŸ¥ä¸€ä¸‹å¯¹è±¡çš„ç±»å‹:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// æ£€æŸ¥ç±»å‹</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> Type = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> Types = &#123;&#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>, type; type = [<span class=\"string\">'Array'</span>, <span class=\"string\">'Date'</span>, <span class=\"string\">'RegExp'</span>][i++];) &#123;</span><br><span class=\"line\">        Types[<span class=\"string\">'is'</span> + type] = <span class=\"function\">(<span class=\"params\">obj</span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> obj !== <span class=\"string\">'object'</span>) <span class=\"keyword\">return</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">Object</span>.prototype.toString.call(obj) === <span class=\"string\">`[object <span class=\"subst\">$&#123;type&#125;</span>]`</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> Types</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">const</span> types = Type()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// è·å–æ­£åˆ™å½±å“èŒƒå›´</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> getRegExp = <span class=\"function\">(<span class=\"params\">reg</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (reg.globlal) <span class=\"keyword\">return</span> <span class=\"string\">'g'</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (reg.ignoreCase) <span class=\"keyword\">return</span> <span class=\"string\">'i'</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (reg.multiline) <span class=\"keyword\">return</span> <span class=\"string\">'m'</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> clone = <span class=\"function\">(<span class=\"params\">oldObj = &#123;&#125;</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> oldObjs = []</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">const</span> _clone = <span class=\"function\"><span class=\"params\">oldObj</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">let</span> newObj, proto</span><br><span class=\"line\">        <span class=\"comment\">// ä¸åŒç±»å‹, ä¸åŒå¤„ç†æ–¹å¼</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (types.isArray(oldObj)) &#123;</span><br><span class=\"line\">            newObj = []</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (types.isDate(oldObj)) &#123;</span><br><span class=\"line\">            newObj = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>(oldObj.getTime())</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (types.isRegExp(oldObj)) &#123;</span><br><span class=\"line\">            newObj = <span class=\"keyword\">new</span> <span class=\"built_in\">RegExp</span>(oldObj.source, getRegExp(oldObj))</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// æ–©æ–­åŸå‹é“¾</span></span><br><span class=\"line\">            proto = <span class=\"built_in\">Object</span>.getPrototypeOf(oldObj)</span><br><span class=\"line\">            newObj = <span class=\"built_in\">Object</span>.create(proto)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// å¦‚æœä¹‹å‰å·²ç»éå†è¿‡è¯¥å¯¹è±¡, ç›´æ¥è¿”å›è¯¥å¯¹è±¡</span></span><br><span class=\"line\">        <span class=\"keyword\">let</span> hasBeen = oldObjs.indexOf(oldObj)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (hasBeen !== <span class=\"number\">-1</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> oldObjs[hasBeen]</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// è®°å½•æ“ä½œè¿‡çš„å¯¹è±¡</span></span><br><span class=\"line\">        oldObjs.push(oldObj)</span><br><span class=\"line\">        <span class=\"comment\">// é€’å½’</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i <span class=\"keyword\">in</span> oldObj) &#123;</span><br><span class=\"line\">            newObj[i] = _clone(oldObj[i])</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> newObj</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> _clone(oldObj)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ğŸ‘‡æµ‹è¯•ä¸€æ³¢:<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// æµ‹è¯•</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">person</span>(<span class=\"params\">name</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">const</span> Cara = <span class=\"keyword\">new</span> person(<span class=\"string\">'Cara'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">say</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'hello world!'</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> oldObj = &#123;</span><br><span class=\"line\">    a: say,</span><br><span class=\"line\">    c: <span class=\"keyword\">new</span> <span class=\"built_in\">RegExp</span>(<span class=\"string\">'ab+c'</span>, <span class=\"string\">'i'</span>),</span><br><span class=\"line\">    d: Cara,</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">oldObj.b = oldObj;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> newObj = clone(oldObj)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(newObj.a, oldObj.a) </span><br><span class=\"line\"><span class=\"comment\">// [Function: say] [Function: say]</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(newObj.b, oldObj.b)</span><br><span class=\"line\"><span class=\"comment\">// &#123; </span></span><br><span class=\"line\"><span class=\"comment\">//     a: [Function: say], </span></span><br><span class=\"line\"><span class=\"comment\">//     c: /ab+c/i, </span></span><br><span class=\"line\"><span class=\"comment\">//     d: person &#123; name: 'Messi' &#125;, </span></span><br><span class=\"line\"><span class=\"comment\">//     b: [Circular] </span></span><br><span class=\"line\"><span class=\"comment\">// &#125; </span></span><br><span class=\"line\"><span class=\"comment\">// &#123; </span></span><br><span class=\"line\"><span class=\"comment\">//     a: [Function: say], </span></span><br><span class=\"line\"><span class=\"comment\">//     c: /ab+c/i, </span></span><br><span class=\"line\"><span class=\"comment\">//     d: person &#123; name: 'Messi' &#125;, </span></span><br><span class=\"line\"><span class=\"comment\">//     b: [Circular] </span></span><br><span class=\"line\"><span class=\"comment\">// &#125;</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(newObj.c, oldObj.c)</span><br><span class=\"line\"><span class=\"comment\">// /ab+c/i /ab+c/i</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(newObj.d.constructor, oldObj.d.constructor)</span><br><span class=\"line\"><span class=\"comment\">// [Function: person][Function: person]</span></span><br></pre></td></tr></table></figure></p>\n<p>ç›®å‰æˆ‘ä»¬ä¸Šé¢è¯´çš„å‡ ç§å‘å°±å¾—ä»¥è§£å†³, ä¸è¿‡è¿™è¿˜ä¸æ˜¯æœ€å®Œæ•´çš„æ–¹æ¡ˆ, è¿˜æœ‰ä¸€äº› ES6 é‡Œé¢çš„å¯¹è±¡ä¹Ÿéœ€è¦æˆ‘ä»¬åšç‰¹æ®Šçš„å¤„ç†, ä¸è¿‡ç°åœ¨è¿™ä¸ªç‰ˆæœ¬åœ¨æ—¥å¸¸è¿˜æ˜¯å¤Ÿç”¨äº†. å¦å¤–åœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿˜æ˜¯å»ºè®®ç”¨ <code>lodash</code> çš„ <code>_.cloneDeep</code></p>\n<p>Created on 2017-8-15 by cara</p>\n","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<h3 id=\"æµ…æ‹·è´\"><a href=\"#æµ…æ‹·è´\" class=\"headerlink\" title=\"æµ…æ‹·è´\"></a>æµ…æ‹·è´</h3><p>æµ…æ‹·è´åªèƒ½æ‹·è´é¡¶å±‚å±æ€§åŸºæœ¬æ•°æ®ç±»å‹, ä¹Ÿå°±æ˜¯å¦‚æœçˆ¶å¯¹è±¡çš„å±æ€§æ˜¯ä¸€ä¸ªå¯¹è±¡æˆ–æ•°ç»„, é‚£ä¹ˆå­å¯¹è±¡è·å–åˆ°çš„åªæ˜¯ä¸€ä¸ªå†…å­˜åœ°å€è€Œä¸æ˜¯ä¸€ä¸ªçœŸæ­£çš„å¯¹è±¡, æ‰€ä»¥ä¸€æ—¦ä¿®æ”¹çˆ¶å¯¹è±¡ä¹Ÿä¼šè·Ÿç€è¢«ç¯¡æ”¹.</p>\n</blockquote>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">shallowCopy</span> (<span class=\"params\"> parent </span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> o = &#123;&#125;;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i <span class=\"keyword\">in</span> parent) &#123;</span><br><span class=\"line\">         o[i] = parent[i]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> o</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<h3 id=\"æ·±æ‹·è´\"><a href=\"#æ·±æ‹·è´\" class=\"headerlink\" title=\"æ·±æ‹·è´\"></a>æ·±æ‹·è´</h3><p>æ·±æ‹·è´ä¹Ÿå°±æ˜¯èƒ½å¤Ÿå®ç°æ•°ç»„å’Œå¯¹è±¡æ‹·è´, æ·±æ‹·è´ä¸æµ…æ‹·è´å¯¹æ¯”, æ·±æ‹·è´ä¼šåœ¨å †åŒºå¼€è¾Ÿæ–°çš„ä¸€å—æ¥å‚¨å­˜æ–°çš„å¯¹è±¡. ä¸¤ä¸ªå¯¹è±¡å¯¹åº”çš„æ˜¯ä¸¤ä¸ªä¸åŒçš„å†…å­˜åœ°å€, æ‰€ä»¥ä¿®æ”¹å…¶ä¸­ä¸€ä¸ªå¯¹è±¡çš„å±æ€§å¹¶ä¸ä¼šå½±å“åˆ°å¦ä¸€ä¸ªå¯¹è±¡çš„å±æ€§. å®ç°æ·±æ‹·è´ä¹Ÿæœ‰ä¸¤ç§æ–¹å¼: ä¸€ç§æ˜¯é€’å½’/ ä¸€ç§æ˜¯JSON.</p>\n</blockquote>\n<ol>\n<li><p>é€’å½’</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">deepCopy</span> (<span class=\"params\">parent, child = &#123;&#125;</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i <span class=\"keyword\">in</span> parent) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> parent[i] === <span class=\"string\">'object'</span>) &#123;</span><br><span class=\"line\">            child[i] = (parent[i].constructor == <span class=\"built_in\">Array</span>) ? [] : &#123;&#125;;</span><br><span class=\"line\">            deepCopy(parent[i], child[i])</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">             child[i] = parent[i]</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>JSONè§£æ(ä¸¥æ ¼çš„ JSON æ ¼å¼)</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> o = &#123;</span><br><span class=\"line\">    age: <span class=\"string\">'18'</span>,</span><br><span class=\"line\">    friends: [<span class=\"string\">'è€å¼ '</span>, <span class=\"string\">'è€ç‹'</span>],</span><br><span class=\"line\">    job: &#123;</span><br><span class=\"line\">       main: <span class=\"string\">'ç¡è§‰'</span>,</span><br><span class=\"line\">       sub: <span class=\"string\">'èººç€'</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">var</span> result = <span class=\"built_in\">JSON</span>.parse( <span class=\"built_in\">JSON</span>.stringify(o));</span><br><span class=\"line\">result.name = <span class=\"string\">'cara'</span>;</span><br><span class=\"line\">result.friends.push(<span class=\"string\">'è€æ'</span>);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.dir(o);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.dir(result)</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<p>ä»¥ä¸Šä¸¤ç§æ–¹å¼æ— æ³•è§£æä¸€ä¸‹å‡ ç§æƒ…å†µ:</p>\n<ul>\n<li>RegExp å¯¹è±¡</li>\n<li>å‡½æ•°</li>\n<li>ä¼šæ‘’å¼ƒå¯¹è±¡çš„ constructor , æ‰€æœ‰æ„é€ å‡½æ•°éƒ½ä¼šæŒ‡å‘ Object</li>\n<li>å¯¹è±¡å¾ªç¯å¼•ç”¨ä¹Ÿä¼šæŠ¥é”™</li>\n</ul>\n<p>æ‰€ä»¥è¦é¢å¯¹ä¸åŒçš„å¯¹è±¡, åšä¸åŒçš„å¤„ç†æ–¹å¼, å°±éœ€è¦æ£€æŸ¥ä¸€ä¸‹å¯¹è±¡çš„ç±»å‹:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// æ£€æŸ¥ç±»å‹</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> Type = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> Types = &#123;&#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>, type; type = [<span class=\"string\">'Array'</span>, <span class=\"string\">'Date'</span>, <span class=\"string\">'RegExp'</span>][i++];) &#123;</span><br><span class=\"line\">        Types[<span class=\"string\">'is'</span> + type] = <span class=\"function\">(<span class=\"params\">obj</span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> obj !== <span class=\"string\">'object'</span>) <span class=\"keyword\">return</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">Object</span>.prototype.toString.call(obj) === <span class=\"string\">`[object <span class=\"subst\">$&#123;type&#125;</span>]`</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> Types</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">const</span> types = Type()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// è·å–æ­£åˆ™å½±å“èŒƒå›´</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> getRegExp = <span class=\"function\">(<span class=\"params\">reg</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (reg.globlal) <span class=\"keyword\">return</span> <span class=\"string\">'g'</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (reg.ignoreCase) <span class=\"keyword\">return</span> <span class=\"string\">'i'</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (reg.multiline) <span class=\"keyword\">return</span> <span class=\"string\">'m'</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> clone = <span class=\"function\">(<span class=\"params\">oldObj = &#123;&#125;</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> oldObjs = []</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">const</span> _clone = <span class=\"function\"><span class=\"params\">oldObj</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">let</span> newObj, proto</span><br><span class=\"line\">        <span class=\"comment\">// ä¸åŒç±»å‹, ä¸åŒå¤„ç†æ–¹å¼</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (types.isArray(oldObj)) &#123;</span><br><span class=\"line\">            newObj = []</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (types.isDate(oldObj)) &#123;</span><br><span class=\"line\">            newObj = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>(oldObj.getTime())</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (types.isRegExp(oldObj)) &#123;</span><br><span class=\"line\">            newObj = <span class=\"keyword\">new</span> <span class=\"built_in\">RegExp</span>(oldObj.source, getRegExp(oldObj))</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// æ–©æ–­åŸå‹é“¾</span></span><br><span class=\"line\">            proto = <span class=\"built_in\">Object</span>.getPrototypeOf(oldObj)</span><br><span class=\"line\">            newObj = <span class=\"built_in\">Object</span>.create(proto)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// å¦‚æœä¹‹å‰å·²ç»éå†è¿‡è¯¥å¯¹è±¡, ç›´æ¥è¿”å›è¯¥å¯¹è±¡</span></span><br><span class=\"line\">        <span class=\"keyword\">let</span> hasBeen = oldObjs.indexOf(oldObj)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (hasBeen !== <span class=\"number\">-1</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> oldObjs[hasBeen]</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// è®°å½•æ“ä½œè¿‡çš„å¯¹è±¡</span></span><br><span class=\"line\">        oldObjs.push(oldObj)</span><br><span class=\"line\">        <span class=\"comment\">// é€’å½’</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i <span class=\"keyword\">in</span> oldObj) &#123;</span><br><span class=\"line\">            newObj[i] = _clone(oldObj[i])</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> newObj</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> _clone(oldObj)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ğŸ‘‡æµ‹è¯•ä¸€æ³¢:<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// æµ‹è¯•</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">person</span>(<span class=\"params\">name</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">const</span> Cara = <span class=\"keyword\">new</span> person(<span class=\"string\">'Cara'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">say</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'hello world!'</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> oldObj = &#123;</span><br><span class=\"line\">    a: say,</span><br><span class=\"line\">    c: <span class=\"keyword\">new</span> <span class=\"built_in\">RegExp</span>(<span class=\"string\">'ab+c'</span>, <span class=\"string\">'i'</span>),</span><br><span class=\"line\">    d: Cara,</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">oldObj.b = oldObj;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> newObj = clone(oldObj)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(newObj.a, oldObj.a) </span><br><span class=\"line\"><span class=\"comment\">// [Function: say] [Function: say]</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(newObj.b, oldObj.b)</span><br><span class=\"line\"><span class=\"comment\">// &#123; </span></span><br><span class=\"line\"><span class=\"comment\">//     a: [Function: say], </span></span><br><span class=\"line\"><span class=\"comment\">//     c: /ab+c/i, </span></span><br><span class=\"line\"><span class=\"comment\">//     d: person &#123; name: 'Messi' &#125;, </span></span><br><span class=\"line\"><span class=\"comment\">//     b: [Circular] </span></span><br><span class=\"line\"><span class=\"comment\">// &#125; </span></span><br><span class=\"line\"><span class=\"comment\">// &#123; </span></span><br><span class=\"line\"><span class=\"comment\">//     a: [Function: say], </span></span><br><span class=\"line\"><span class=\"comment\">//     c: /ab+c/i, </span></span><br><span class=\"line\"><span class=\"comment\">//     d: person &#123; name: 'Messi' &#125;, </span></span><br><span class=\"line\"><span class=\"comment\">//     b: [Circular] </span></span><br><span class=\"line\"><span class=\"comment\">// &#125;</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(newObj.c, oldObj.c)</span><br><span class=\"line\"><span class=\"comment\">// /ab+c/i /ab+c/i</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(newObj.d.constructor, oldObj.d.constructor)</span><br><span class=\"line\"><span class=\"comment\">// [Function: person][Function: person]</span></span><br></pre></td></tr></table></figure></p>\n<p>ç›®å‰æˆ‘ä»¬ä¸Šé¢è¯´çš„å‡ ç§å‘å°±å¾—ä»¥è§£å†³, ä¸è¿‡è¿™è¿˜ä¸æ˜¯æœ€å®Œæ•´çš„æ–¹æ¡ˆ, è¿˜æœ‰ä¸€äº› ES6 é‡Œé¢çš„å¯¹è±¡ä¹Ÿéœ€è¦æˆ‘ä»¬åšç‰¹æ®Šçš„å¤„ç†, ä¸è¿‡ç°åœ¨è¿™ä¸ªç‰ˆæœ¬åœ¨æ—¥å¸¸è¿˜æ˜¯å¤Ÿç”¨äº†. å¦å¤–åœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿˜æ˜¯å»ºè®®ç”¨ <code>lodash</code> çš„ <code>_.cloneDeep</code></p>\n<p>Created on 2017-8-15 by cara</p>\n"},{"title":"Quick Sort","date":"2017-10-17T13:42:33.000Z","_content":"\nå¿«é€Ÿæ’åºçš„å®ç°, å‚è€ƒèµ„æ–™[é˜®ä¸€å³°](http://www.ruanyifeng.com/blog/2011/04/quicksort_in_javascript.html)\n\n> ## æ€è·¯\nå¿«æ’æ³•çš„æ€æƒ³ï¼Œ åˆ†ä¸ºä»¥ä¸‹ä¸‰æ­¥\n1.  åœ¨æ•°æ®é›†ä¸­ï¼Œ é€‰æ‹©ä»»æ„ä¸€ä¸ªæ•°æ®ä½œä¸ºå‚ç…§ç‰©ï¼ˆä¸€èˆ¬å–ä¸­é—´ä½ç½®çš„å…ƒç´ ï¼‰ã€‚\n2. æ‰€æœ‰å°äºå‚ç…§ç‰©çš„å…ƒç´ éƒ½æ”¾åœ¨å·¦è¾¹ï¼Œå¤§äºå‚ç…§ç‰©çš„å…ƒç´ éƒ½æ”¾åœ¨å³è¾¹ã€‚\n3. å¯¹å·¦å³ä¸¤è¾¹çš„å­é›†é€’å½’ï¼Œ è‡³åˆ°æ’åºå®Œæˆã€‚\n\n## ä¾‹å­\n- éåŸåœ°å¿«é€Ÿæ’åº\n```javascript\nvar array = [11, 65, 23, 108, 99, 11, 55, 11, 33, 100, 108, 100];\n\nconsole.time('å¿«æ’');\nconst quickSort = array => {\n    // æ•°ç»„åªå‰©ä¸€ä¸ªå…ƒç´ æ—¶åœæ­¢\n    if (array.length <= 1) return array;\n    // å–å‚ç…§ç‰©\n    let pivotIndex = Math.floor(array.length / 2),\n        // è¿™é‡Œç”¨spliceåˆ é™¤å‚ç…§ç‰©é¿å…é‡å¤å¾ªç¯\n        pivot = array.splice(pivotIndex, 1),\n        leftArr = [],\n        rightArr = [];\n    // åˆ†åŒº\n    for (let i = 0; i < array.length; i++) {\n        if (array[i] < pivot) {\n            leftArr.push(array[i]);\n        } else {\n            rightArr.push(array[i]);\n        }\n    }\n    return quickSort(leftArr).concat(pivot, quickSort(rightArr));\n}\nconsole.log(quickSort(array)); // [ 11, 11, 11, 23, 33, 55, 65, 99, 100, 100, 108, 108 ]\n\nconsole.timeEnd('å¿«æ’'); // 4ms å·¦å³\n```\n- åŸåœ°å¿«é€Ÿæ’åº\n```javascript\nconsole.time('å¿«æ’2');\n// äº’æ¢\nconst swap = (items, firstIndex, secondIndex) => {\n    let temp = items[firstIndex];\n    items[firstIndex] = items[secondIndex];\n    items[secondIndex] = temp;\n}\n// åˆ†åŒº\nconst partition = (items, left, right) => {\n    let pivot = items[Math.floor((right + left) / 2)],\n        i = left,\n        j = right;\n\n    while (i <= j) {\n        while (items[i] < pivot) {\n            i++;\n        }\n        while (items[j] > pivot) {\n            j--;\n        }\n        if (i <= j) {   \n            swap(items, i, j);\n            i++;\n            j--;\n        }\n    }\n    return i;\n}\n// æ’åº\nconst quickSortTwo = (items, left, right) => {\n    let index;\n    if (items.length > 1) {\n        left = typeof left != \"number\" ? 0 : left;\n        right = typeof right != \"number\" ? items.length - 1 : right;\n\n        index = partition(items, left, right);\n\n        if (left < index - 1) {\n            quickSortTwo(items, left, index - 1);\n        }\n\n        if (index < right) {\n            quickSortTwo(items, index, right);\n        }\n    }\n    return items;\n}\n\nconsole.log(quickSortTwo(array));\nconsole.timeEnd('å¿«æ’2');\n```\n\n- åŸç”Ÿsort\n```javascript\nconsole.time('åŸç”Ÿ');\narray.sort((a, b) => {\n    if (a > b) return 1\n    else if (a < b) return -1\n    else return 0\n});\nconsole.log(array);\n// 5ms å·¦å³\nconsole.timeEnd('åŸç”Ÿ')\n```\nä¸‰ç§æ–¹æ³•ï¼Œ å½“æ•°ç»„è¾¾åˆ°1Wæ—¶å·®è·å°±æ¯”è¾ƒå¤§äº†ï¼ŒåŸç”Ÿéœ€è¦17mså·¦å³ï¼ŒåŸåœ°å¿«æ’éœ€è¦13mså·¦å³ï¼Œè€ŒéåŸåœ°å¿«æ’åˆ™éœ€è¦88mså·¦å³ã€‚\n\nCreated on 2017-9-7 by Cara","source":"_posts/Quick-Sort.md","raw":"---\ntitle: Quick Sort\ndate: 2017-10-17 21:42:33\ntags:\n- JavaScript\ncategories:\n- ç¬”è®°ğŸ“’\n---\n\nå¿«é€Ÿæ’åºçš„å®ç°, å‚è€ƒèµ„æ–™[é˜®ä¸€å³°](http://www.ruanyifeng.com/blog/2011/04/quicksort_in_javascript.html)\n\n> ## æ€è·¯\nå¿«æ’æ³•çš„æ€æƒ³ï¼Œ åˆ†ä¸ºä»¥ä¸‹ä¸‰æ­¥\n1.  åœ¨æ•°æ®é›†ä¸­ï¼Œ é€‰æ‹©ä»»æ„ä¸€ä¸ªæ•°æ®ä½œä¸ºå‚ç…§ç‰©ï¼ˆä¸€èˆ¬å–ä¸­é—´ä½ç½®çš„å…ƒç´ ï¼‰ã€‚\n2. æ‰€æœ‰å°äºå‚ç…§ç‰©çš„å…ƒç´ éƒ½æ”¾åœ¨å·¦è¾¹ï¼Œå¤§äºå‚ç…§ç‰©çš„å…ƒç´ éƒ½æ”¾åœ¨å³è¾¹ã€‚\n3. å¯¹å·¦å³ä¸¤è¾¹çš„å­é›†é€’å½’ï¼Œ è‡³åˆ°æ’åºå®Œæˆã€‚\n\n## ä¾‹å­\n- éåŸåœ°å¿«é€Ÿæ’åº\n```javascript\nvar array = [11, 65, 23, 108, 99, 11, 55, 11, 33, 100, 108, 100];\n\nconsole.time('å¿«æ’');\nconst quickSort = array => {\n    // æ•°ç»„åªå‰©ä¸€ä¸ªå…ƒç´ æ—¶åœæ­¢\n    if (array.length <= 1) return array;\n    // å–å‚ç…§ç‰©\n    let pivotIndex = Math.floor(array.length / 2),\n        // è¿™é‡Œç”¨spliceåˆ é™¤å‚ç…§ç‰©é¿å…é‡å¤å¾ªç¯\n        pivot = array.splice(pivotIndex, 1),\n        leftArr = [],\n        rightArr = [];\n    // åˆ†åŒº\n    for (let i = 0; i < array.length; i++) {\n        if (array[i] < pivot) {\n            leftArr.push(array[i]);\n        } else {\n            rightArr.push(array[i]);\n        }\n    }\n    return quickSort(leftArr).concat(pivot, quickSort(rightArr));\n}\nconsole.log(quickSort(array)); // [ 11, 11, 11, 23, 33, 55, 65, 99, 100, 100, 108, 108 ]\n\nconsole.timeEnd('å¿«æ’'); // 4ms å·¦å³\n```\n- åŸåœ°å¿«é€Ÿæ’åº\n```javascript\nconsole.time('å¿«æ’2');\n// äº’æ¢\nconst swap = (items, firstIndex, secondIndex) => {\n    let temp = items[firstIndex];\n    items[firstIndex] = items[secondIndex];\n    items[secondIndex] = temp;\n}\n// åˆ†åŒº\nconst partition = (items, left, right) => {\n    let pivot = items[Math.floor((right + left) / 2)],\n        i = left,\n        j = right;\n\n    while (i <= j) {\n        while (items[i] < pivot) {\n            i++;\n        }\n        while (items[j] > pivot) {\n            j--;\n        }\n        if (i <= j) {   \n            swap(items, i, j);\n            i++;\n            j--;\n        }\n    }\n    return i;\n}\n// æ’åº\nconst quickSortTwo = (items, left, right) => {\n    let index;\n    if (items.length > 1) {\n        left = typeof left != \"number\" ? 0 : left;\n        right = typeof right != \"number\" ? items.length - 1 : right;\n\n        index = partition(items, left, right);\n\n        if (left < index - 1) {\n            quickSortTwo(items, left, index - 1);\n        }\n\n        if (index < right) {\n            quickSortTwo(items, index, right);\n        }\n    }\n    return items;\n}\n\nconsole.log(quickSortTwo(array));\nconsole.timeEnd('å¿«æ’2');\n```\n\n- åŸç”Ÿsort\n```javascript\nconsole.time('åŸç”Ÿ');\narray.sort((a, b) => {\n    if (a > b) return 1\n    else if (a < b) return -1\n    else return 0\n});\nconsole.log(array);\n// 5ms å·¦å³\nconsole.timeEnd('åŸç”Ÿ')\n```\nä¸‰ç§æ–¹æ³•ï¼Œ å½“æ•°ç»„è¾¾åˆ°1Wæ—¶å·®è·å°±æ¯”è¾ƒå¤§äº†ï¼ŒåŸç”Ÿéœ€è¦17mså·¦å³ï¼ŒåŸåœ°å¿«æ’éœ€è¦13mså·¦å³ï¼Œè€ŒéåŸåœ°å¿«æ’åˆ™éœ€è¦88mså·¦å³ã€‚\n\nCreated on 2017-9-7 by Cara","slug":"Quick-Sort","published":1,"updated":"2018-05-05T09:23:03.664Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjgurolsk000rklu0nd1xop63","content":"<p>å¿«é€Ÿæ’åºçš„å®ç°, å‚è€ƒèµ„æ–™<a href=\"http://www.ruanyifeng.com/blog/2011/04/quicksort_in_javascript.html\" target=\"_blank\" rel=\"noopener\">é˜®ä¸€å³°</a></p>\n<blockquote>\n<h2 id=\"æ€è·¯\"><a href=\"#æ€è·¯\" class=\"headerlink\" title=\"æ€è·¯\"></a>æ€è·¯</h2><p>å¿«æ’æ³•çš„æ€æƒ³ï¼Œ åˆ†ä¸ºä»¥ä¸‹ä¸‰æ­¥</p>\n<ol>\n<li>åœ¨æ•°æ®é›†ä¸­ï¼Œ é€‰æ‹©ä»»æ„ä¸€ä¸ªæ•°æ®ä½œä¸ºå‚ç…§ç‰©ï¼ˆä¸€èˆ¬å–ä¸­é—´ä½ç½®çš„å…ƒç´ ï¼‰ã€‚</li>\n<li>æ‰€æœ‰å°äºå‚ç…§ç‰©çš„å…ƒç´ éƒ½æ”¾åœ¨å·¦è¾¹ï¼Œå¤§äºå‚ç…§ç‰©çš„å…ƒç´ éƒ½æ”¾åœ¨å³è¾¹ã€‚</li>\n<li>å¯¹å·¦å³ä¸¤è¾¹çš„å­é›†é€’å½’ï¼Œ è‡³åˆ°æ’åºå®Œæˆã€‚</li>\n</ol>\n</blockquote>\n<h2 id=\"ä¾‹å­\"><a href=\"#ä¾‹å­\" class=\"headerlink\" title=\"ä¾‹å­\"></a>ä¾‹å­</h2><ul>\n<li><p>éåŸåœ°å¿«é€Ÿæ’åº</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> array = [<span class=\"number\">11</span>, <span class=\"number\">65</span>, <span class=\"number\">23</span>, <span class=\"number\">108</span>, <span class=\"number\">99</span>, <span class=\"number\">11</span>, <span class=\"number\">55</span>, <span class=\"number\">11</span>, <span class=\"number\">33</span>, <span class=\"number\">100</span>, <span class=\"number\">108</span>, <span class=\"number\">100</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.time(<span class=\"string\">'å¿«æ’'</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> quickSort = <span class=\"function\"><span class=\"params\">array</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// æ•°ç»„åªå‰©ä¸€ä¸ªå…ƒç´ æ—¶åœæ­¢</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (array.length &lt;= <span class=\"number\">1</span>) <span class=\"keyword\">return</span> array;</span><br><span class=\"line\">    <span class=\"comment\">// å–å‚ç…§ç‰©</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> pivotIndex = <span class=\"built_in\">Math</span>.floor(array.length / <span class=\"number\">2</span>),</span><br><span class=\"line\">        <span class=\"comment\">// è¿™é‡Œç”¨spliceåˆ é™¤å‚ç…§ç‰©é¿å…é‡å¤å¾ªç¯</span></span><br><span class=\"line\">        pivot = array.splice(pivotIndex, <span class=\"number\">1</span>),</span><br><span class=\"line\">        leftArr = [],</span><br><span class=\"line\">        rightArr = [];</span><br><span class=\"line\">    <span class=\"comment\">// åˆ†åŒº</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; array.length; i++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (array[i] &lt; pivot) &#123;</span><br><span class=\"line\">            leftArr.push(array[i]);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            rightArr.push(array[i]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> quickSort(leftArr).concat(pivot, quickSort(rightArr));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(quickSort(array)); <span class=\"comment\">// [ 11, 11, 11, 23, 33, 55, 65, 99, 100, 100, 108, 108 ]</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.timeEnd(<span class=\"string\">'å¿«æ’'</span>); <span class=\"comment\">// 4ms å·¦å³</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>åŸåœ°å¿«é€Ÿæ’åº</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">console</span>.time(<span class=\"string\">'å¿«æ’2'</span>);</span><br><span class=\"line\"><span class=\"comment\">// äº’æ¢</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> swap = <span class=\"function\">(<span class=\"params\">items, firstIndex, secondIndex</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> temp = items[firstIndex];</span><br><span class=\"line\">    items[firstIndex] = items[secondIndex];</span><br><span class=\"line\">    items[secondIndex] = temp;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// åˆ†åŒº</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> partition = <span class=\"function\">(<span class=\"params\">items, left, right</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> pivot = items[<span class=\"built_in\">Math</span>.floor((right + left) / <span class=\"number\">2</span>)],</span><br><span class=\"line\">        i = left,</span><br><span class=\"line\">        j = right;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">while</span> (i &lt;= j) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (items[i] &lt; pivot) &#123;</span><br><span class=\"line\">            i++;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (items[j] &gt; pivot) &#123;</span><br><span class=\"line\">            j--;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (i &lt;= j) &#123;   </span><br><span class=\"line\">            swap(items, i, j);</span><br><span class=\"line\">            i++;</span><br><span class=\"line\">            j--;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> i;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// æ’åº</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> quickSortTwo = <span class=\"function\">(<span class=\"params\">items, left, right</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> index;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (items.length &gt; <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        left = <span class=\"keyword\">typeof</span> left != <span class=\"string\">\"number\"</span> ? <span class=\"number\">0</span> : left;</span><br><span class=\"line\">        right = <span class=\"keyword\">typeof</span> right != <span class=\"string\">\"number\"</span> ? items.length - <span class=\"number\">1</span> : right;</span><br><span class=\"line\"></span><br><span class=\"line\">        index = partition(items, left, right);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (left &lt; index - <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">            quickSortTwo(items, left, index - <span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (index &lt; right) &#123;</span><br><span class=\"line\">            quickSortTwo(items, index, right);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> items;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(quickSortTwo(array));</span><br><span class=\"line\"><span class=\"built_in\">console</span>.timeEnd(<span class=\"string\">'å¿«æ’2'</span>);</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>åŸç”Ÿsort</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">console</span>.time(<span class=\"string\">'åŸç”Ÿ'</span>);</span><br><span class=\"line\">array.sort(<span class=\"function\">(<span class=\"params\">a, b</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (a &gt; b) <span class=\"keyword\">return</span> <span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (a &lt; b) <span class=\"keyword\">return</span> <span class=\"number\">-1</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">return</span> <span class=\"number\">0</span></span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(array);</span><br><span class=\"line\"><span class=\"comment\">// 5ms å·¦å³</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.timeEnd(<span class=\"string\">'åŸç”Ÿ'</span>)</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>ä¸‰ç§æ–¹æ³•ï¼Œ å½“æ•°ç»„è¾¾åˆ°1Wæ—¶å·®è·å°±æ¯”è¾ƒå¤§äº†ï¼ŒåŸç”Ÿéœ€è¦17mså·¦å³ï¼ŒåŸåœ°å¿«æ’éœ€è¦13mså·¦å³ï¼Œè€ŒéåŸåœ°å¿«æ’åˆ™éœ€è¦88mså·¦å³ã€‚</p>\n<p>Created on 2017-9-7 by Cara</p>\n","site":{"data":{}},"excerpt":"","more":"<p>å¿«é€Ÿæ’åºçš„å®ç°, å‚è€ƒèµ„æ–™<a href=\"http://www.ruanyifeng.com/blog/2011/04/quicksort_in_javascript.html\" target=\"_blank\" rel=\"noopener\">é˜®ä¸€å³°</a></p>\n<blockquote>\n<h2 id=\"æ€è·¯\"><a href=\"#æ€è·¯\" class=\"headerlink\" title=\"æ€è·¯\"></a>æ€è·¯</h2><p>å¿«æ’æ³•çš„æ€æƒ³ï¼Œ åˆ†ä¸ºä»¥ä¸‹ä¸‰æ­¥</p>\n<ol>\n<li>åœ¨æ•°æ®é›†ä¸­ï¼Œ é€‰æ‹©ä»»æ„ä¸€ä¸ªæ•°æ®ä½œä¸ºå‚ç…§ç‰©ï¼ˆä¸€èˆ¬å–ä¸­é—´ä½ç½®çš„å…ƒç´ ï¼‰ã€‚</li>\n<li>æ‰€æœ‰å°äºå‚ç…§ç‰©çš„å…ƒç´ éƒ½æ”¾åœ¨å·¦è¾¹ï¼Œå¤§äºå‚ç…§ç‰©çš„å…ƒç´ éƒ½æ”¾åœ¨å³è¾¹ã€‚</li>\n<li>å¯¹å·¦å³ä¸¤è¾¹çš„å­é›†é€’å½’ï¼Œ è‡³åˆ°æ’åºå®Œæˆã€‚</li>\n</ol>\n</blockquote>\n<h2 id=\"ä¾‹å­\"><a href=\"#ä¾‹å­\" class=\"headerlink\" title=\"ä¾‹å­\"></a>ä¾‹å­</h2><ul>\n<li><p>éåŸåœ°å¿«é€Ÿæ’åº</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> array = [<span class=\"number\">11</span>, <span class=\"number\">65</span>, <span class=\"number\">23</span>, <span class=\"number\">108</span>, <span class=\"number\">99</span>, <span class=\"number\">11</span>, <span class=\"number\">55</span>, <span class=\"number\">11</span>, <span class=\"number\">33</span>, <span class=\"number\">100</span>, <span class=\"number\">108</span>, <span class=\"number\">100</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.time(<span class=\"string\">'å¿«æ’'</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> quickSort = <span class=\"function\"><span class=\"params\">array</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// æ•°ç»„åªå‰©ä¸€ä¸ªå…ƒç´ æ—¶åœæ­¢</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (array.length &lt;= <span class=\"number\">1</span>) <span class=\"keyword\">return</span> array;</span><br><span class=\"line\">    <span class=\"comment\">// å–å‚ç…§ç‰©</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> pivotIndex = <span class=\"built_in\">Math</span>.floor(array.length / <span class=\"number\">2</span>),</span><br><span class=\"line\">        <span class=\"comment\">// è¿™é‡Œç”¨spliceåˆ é™¤å‚ç…§ç‰©é¿å…é‡å¤å¾ªç¯</span></span><br><span class=\"line\">        pivot = array.splice(pivotIndex, <span class=\"number\">1</span>),</span><br><span class=\"line\">        leftArr = [],</span><br><span class=\"line\">        rightArr = [];</span><br><span class=\"line\">    <span class=\"comment\">// åˆ†åŒº</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; array.length; i++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (array[i] &lt; pivot) &#123;</span><br><span class=\"line\">            leftArr.push(array[i]);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            rightArr.push(array[i]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> quickSort(leftArr).concat(pivot, quickSort(rightArr));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(quickSort(array)); <span class=\"comment\">// [ 11, 11, 11, 23, 33, 55, 65, 99, 100, 100, 108, 108 ]</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.timeEnd(<span class=\"string\">'å¿«æ’'</span>); <span class=\"comment\">// 4ms å·¦å³</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>åŸåœ°å¿«é€Ÿæ’åº</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">console</span>.time(<span class=\"string\">'å¿«æ’2'</span>);</span><br><span class=\"line\"><span class=\"comment\">// äº’æ¢</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> swap = <span class=\"function\">(<span class=\"params\">items, firstIndex, secondIndex</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> temp = items[firstIndex];</span><br><span class=\"line\">    items[firstIndex] = items[secondIndex];</span><br><span class=\"line\">    items[secondIndex] = temp;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// åˆ†åŒº</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> partition = <span class=\"function\">(<span class=\"params\">items, left, right</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> pivot = items[<span class=\"built_in\">Math</span>.floor((right + left) / <span class=\"number\">2</span>)],</span><br><span class=\"line\">        i = left,</span><br><span class=\"line\">        j = right;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">while</span> (i &lt;= j) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (items[i] &lt; pivot) &#123;</span><br><span class=\"line\">            i++;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (items[j] &gt; pivot) &#123;</span><br><span class=\"line\">            j--;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (i &lt;= j) &#123;   </span><br><span class=\"line\">            swap(items, i, j);</span><br><span class=\"line\">            i++;</span><br><span class=\"line\">            j--;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> i;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// æ’åº</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> quickSortTwo = <span class=\"function\">(<span class=\"params\">items, left, right</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> index;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (items.length &gt; <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        left = <span class=\"keyword\">typeof</span> left != <span class=\"string\">\"number\"</span> ? <span class=\"number\">0</span> : left;</span><br><span class=\"line\">        right = <span class=\"keyword\">typeof</span> right != <span class=\"string\">\"number\"</span> ? items.length - <span class=\"number\">1</span> : right;</span><br><span class=\"line\"></span><br><span class=\"line\">        index = partition(items, left, right);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (left &lt; index - <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">            quickSortTwo(items, left, index - <span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (index &lt; right) &#123;</span><br><span class=\"line\">            quickSortTwo(items, index, right);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> items;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(quickSortTwo(array));</span><br><span class=\"line\"><span class=\"built_in\">console</span>.timeEnd(<span class=\"string\">'å¿«æ’2'</span>);</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>åŸç”Ÿsort</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">console</span>.time(<span class=\"string\">'åŸç”Ÿ'</span>);</span><br><span class=\"line\">array.sort(<span class=\"function\">(<span class=\"params\">a, b</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (a &gt; b) <span class=\"keyword\">return</span> <span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (a &lt; b) <span class=\"keyword\">return</span> <span class=\"number\">-1</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">return</span> <span class=\"number\">0</span></span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(array);</span><br><span class=\"line\"><span class=\"comment\">// 5ms å·¦å³</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.timeEnd(<span class=\"string\">'åŸç”Ÿ'</span>)</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>ä¸‰ç§æ–¹æ³•ï¼Œ å½“æ•°ç»„è¾¾åˆ°1Wæ—¶å·®è·å°±æ¯”è¾ƒå¤§äº†ï¼ŒåŸç”Ÿéœ€è¦17mså·¦å³ï¼ŒåŸåœ°å¿«æ’éœ€è¦13mså·¦å³ï¼Œè€ŒéåŸåœ°å¿«æ’åˆ™éœ€è¦88mså·¦å³ã€‚</p>\n<p>Created on 2017-9-7 by Cara</p>\n"},{"title":"Promise åˆ†æåŠå®ç°","date":"2018-01-04T11:07:22.000Z","_content":"Promise æ˜¯ ES6ä¸­ä¸­æ”¶å½•çš„å¼‚æ­¥æ“ä½œå°è£…, é€šå¸¸åœ¨å›è°ƒ/ äº‹ä»¶/ æ¶ˆæ¯ç­‰å¼‚æ­¥æ“ä½œä¸­æœ‰æ˜¾è‘—çš„ä¼˜åŠ¿, è®©æˆ‘ä»¬åœ¨æ›´æ–¹ä¾¿çš„æ“ä½œå¼‚æ­¥ä¹Ÿè®©ä»£ç æ›´åŠ æ¸…æ™°.åŒ…æ‹¬ ES7ä¸­çš„ Async/Await ä¹Ÿæ˜¯å¯¹å¼‚æ­¥æ“ä½œçš„å°è£…, ä¸è¿‡ Async æ›´åƒæ˜¯ Generator çš„è¯­æ³•ç³–.\n\n### åŸºç¡€å®ç°\nå­¦ä¹ [å‰–æ Promise ä¹‹åŸºç¡€ç¯‡](https://tech.meituan.com/promise-insight.html)ç”¨ä¸€ä¸ªæœ€å¸¸è§çš„åº”ç”¨æ¥å‰–æ `Promise`, é€šè¿‡å¼‚æ­¥è·å–ç”¨æˆ· Id, ç„¶åä½œä¸€äº›å¤„ç†. å¹³å¸¸æˆ‘ä»¬æœ€å¸¸ç”¨çš„æ˜¯å›è°ƒçš„æ–¹å¼æ¥å¤„ç†, ä¸‹é¢ç”¨ `Promise` çš„æ–¹å¼æ¥å¤„ç†.\n```javascript\nconst getUserId = _ => {\n    new Promise((resolve, reject) => {\n        axios.get('http://example.com/api', params: param).then(res => {\n            resolve(JSON.parse(res).id)\n        })\n    })\n}\ngetUserId().then(id => {\n    console.log(id)\n    // do something...\n})\n```\ngetUserId å‡½æ•°è¿”å›ä¸€ä¸ª `Promise`, åœ¨ä»–çš„ `then` æ–¹æ³•ä¸­æ”¾å…¥å¼‚æ­¥æ“ä½œæˆåŠŸä¹‹åçš„å›è°ƒå‡½æ•°. è¿™ç§æ–¹å¼æ˜æ˜¾æ¯”æˆ‘ä»¬ä¹‹å‰å¸¸ç”¨çš„å›è°ƒå‡½æ•°æ›´åŠ æ–¹ä¾¿è€Œä¸”æ˜“è¯», ä¹Ÿæ›´åŠ å®¹æ˜“é¿å… callback hell.\n\né‚£ä¹ˆæ»¡è¶³è¿™æ ·çš„åœºæ™¯çš„`Promise`æ˜¯æ€æ ·å®ç°çš„å‘¢, ä¸‹é¢æˆ‘ä»¬å¯ä»¥ç®€å•çš„å®ç°ä¸€ä¸‹æœ€åŸºç¡€çš„`Promise`:\n```javascript\nfunction Promise (fn) {\n    let value = null\n    let deferreds = []\n    \n    // 4. å­˜å…¥å¼‚æ­¥æˆåŠŸéœ€è¦çš„å›è°ƒå‡½æ•°\n    // æ­¤æ—¶æŒ‡å‘ä¸¤ä¸ªå›è°ƒå‡½æ•° id => {}\n    this.then = function (onFulfilled) {\n        deferreds.push(onFulfilled)\n        return this\n    }\n    \n    // 3. æ‰§è¡Œ deferreds é˜Ÿåˆ—ä¸­çš„å›è°ƒå‡½æ•°\n    // æ­¤æ—¶ value ä¸º123\n    function resolve (value) {\n        deferreds.map(deferred => {\n            deferred(value)\n        })\n    }\n    \n    // 1. æ‰§è¡Œåˆ›å»º Promise å®ä¾‹æ—¶ä¼ å…¥çš„å‡½æ•°\n    // å¹¶ä¼ å…¥ resolve ä¾›åœ¨é€‚å½“æ—¶è§¦å‘å›è°ƒ\n    fn(resolve)\n}\n\nconst getUserId = _ => {\n    return new Promise(resolve => {\n        // 2. æ‰§è¡Œ resolve\n        resolve(123)\n    })\n}\ngetUserId().then( id => {\n    console.log('this is callback!')\n    console.log(id) // 123\n}).then(id => {\n    console.log('this is second callback!')\n    console.log(id) // 123\n})\n```\n - è°ƒç”¨ `then` æ–¹æ³•å°†å›è°ƒå‡½æ•°å­˜å…¥ deferreds é˜Ÿåˆ—.\n - åˆ›å»º `Promise` å®ä¾‹æ—¶ä¼ å…¥å‡½æ•°å’Œ `resolve`, `resolve` ç”¨äºåœ¨é€‚å½“çš„æ—¶é—´è§¦å‘å›è°ƒå‡½æ•°.\n - çœŸæ­£æ‰§è¡Œå›è°ƒå‡½æ•°çš„æ˜¯ `deferreds` é˜Ÿåˆ—ä¸­çš„å…ƒç´ .\n - `resolve` å‡½æ•°æ¥å—ä¸€ä¸ªå‚æ•°, ç”¨äºå›è°ƒå‡½æ•°ä½¿ç”¨, å³å¼‚æ­¥æ“ä½œçš„è¿”å›ç»“æœ.\n\nå¯èƒ½å¤§å®¶å·²ç»å‘ç°, ä»¥ä¸Šä»£ç å¹¶ä¸èƒ½çœŸæ­£æ‰§è¡Œåˆ°å›è°ƒå‡½æ•°.æ ¹æ®ä¸Šé¢æ ‡æ³¨çš„åºå·å°±æ˜¯ä»£ç çš„æ‰§è¡Œé¡ºåº, è¿™æ˜¯å› ä¸ºç°åœ¨è¿˜æ˜¯åŒæ­¥å‡½æ•°, `Promise` å‡½æ•°ä¸­çš„ `resolve` å‡½æ•°ä¼šå…ˆäº `this.then` å‡½æ•°æ‰§è¡Œ,æ­¤æ—¶ `deferreds` é˜Ÿåˆ—ä¸­è¿˜æ˜¯ç©ºçš„, ä»¥è‡³äºåé¢çš„å›è°ƒå‡½æ•°ä¹Ÿæ— æ³•æ‰§è¡Œ. æ‰€ä»¥æˆ‘ä»¬è¦ä¿è¯å›è°ƒä»¥å¼‚æ­¥çš„æ–¹å¼æ‰§è¡Œ, ä»¥ä¿è¯æ‰§è¡Œé¡ºåº. å¯ä»¥é€šè¿‡ `setTimeout` å°† `resolve` ä¸­çš„å›è°ƒå‡½æ•°æ”¾åœ¨æ‰§è¡Œæ ˆçš„æœ«å°¾.\n```javascript\nfunction resolve (value) {\n    // å°†æ‰§è¡Œçš„å›è°ƒçš„é€»è¾‘æ”¾å…¥æ‰§è¡Œæ ˆæœ«å°¾\n    setTimeout(function () {\n        deferreds.map(deferred => {\n            deferred(value)\n        })    \n    }, 0)\n}\n```\nç°åœ¨å°±å¯ä»¥çœ‹åˆ°, then ä¸­çš„å›è°ƒå‡½æ•°èƒ½å¤Ÿæ­£å¸¸æ‰§è¡Œäº†.\n\n#### å¼•å…¥çŠ¶æ€\nç°åœ¨æˆ‘ä»¬å¼•å…¥è§„èŒƒ `Promises/A+` ä¸­æ‰€è¯´çš„ States, å®ƒæœ‰ä¸‰ä¸ªäº’æ–¥çš„çŠ¶æ€: pending/ fulfilled/ rejected.\n\nç°åœ¨æˆ‘ä»¬æ¥æ”¹è¿›ä¸‹ä»£ç :\n```javascript\nfunction Promise (fn) {\n    let value = null\n    let deferreds = []\n    let state = 'pending'\n    \n    this.then = function (onFulfilled) {\n        if (state === 'pending') {\n            deferreds.push(onFulfilled)\n            return this\n        }\n        onFulfilled(value)\n        return this\n    }\n    \n    function resolve (newValue) {\n        value = newValue\n        state = 'fulfilled'\n        setTimeout(_ => {\n            deferreds.map(deferred => {\n                deferred(value)\n            })\n        }, 0)\n    }\n    fn(resolve)\n}\n```\n\n### ä¸²è¡Œ Promise\nä¸²è¡Œ `Promise` æ˜¯æŒ‡å½“ promise è¾¾åˆ° fuifilled çŠ¶æ€ä¹‹å, å†è¿›è¡Œä¸‹ä¸€ä¸ª promise. æ¯”å¦‚ä¸Šä¾‹ä¸­çš„æˆ‘ä»¬æ‹¿åˆ° userId ä¹‹åè¿˜éœ€è¦ç”¨è¿™ä¸ª userId å»è·å–ç”¨æˆ·çš„åç§°/ ä½å€/ æ‰‹æœºå·ç­‰å…¶ä»–ä¿¡æ¯.\n\nä½¿ç”¨çš„ä¼ªä»£ç ç±»ä¼¼è¿™æ ·:\n```javascript\ngetUserId()\n    .then(getUserInfoById)\n    .then(userInfo => {\n        // do something\n    })\n    \nconst getUserInfoById = id => {\n    return new Promise(resolve => {\n        axios.get('http://example.com/api', params: {\n            id: 123\n        }).then(response => {\n            resolve(JSON.parse(response).info)\n        })\n    })\n}\nconst getUserId = _ => {\n    return new Promise(resolve => {\n        resolve(123)\n    })\n}\n```\nä¸²è¡Œçš„å›°éš¾åœ¨äºå¦‚ä½•å°†å‰åçš„ `Promise` è¡”æ¥èµ·æ¥, é¦–å…ˆå¯¹ `then` æ–¹æ³•æ”¹é€ :\n```javascript\nthis.then = function (onFulfilled) {\n    // bridge promise\n    return new Promise(resolve => {\n        handle({\n            onFulfilled: onFulfilled || null,\n            resolve: resolve\n        })\n    })\n}\n\nlet handle = deferred => {\n    if (state === 'pending') {\n        deferreds.push(deferred)\n        return\n    }\n    let ret = deferred.onFulfilled(value)\n    deferred.resolve(ret)\n}\n```\n- `then` æ–¹æ³•ä¸­è¿”å›ä¸€ä¸ªæ–°åˆ›å»ºçš„ Promise å®ä¾‹ä½œä¸ºè¿”å›å€¼, è¿™æ˜¯ä¸²è¡Œçš„åŸºç¡€, ç”±äºè¿”å›ç±»å‹ä¸€æ ·æ‰€ä»¥ä¾ç„¶æ”¯æŒé“¾å¼.\n- `then` æ–¹æ³•ä¸­çš„å½¢å‚ `onFulfilled` å’Œæ–°åˆ›å»ºçš„ Promise å®ä¾‹ä¸­çš„ `resolve` å‡æ”¾å…¥å½“å‰ promise çš„ deferreds é˜Ÿåˆ—ä¸­.\n- `handle` æ–¹æ³•ä½œä¸ºå½“å‰ promise çš„å†…éƒ¨æ–¹æ³•, è¾ƒä¹‹å‰çš„ `then` æ–¹æ³•åªå¢åŠ äº†ä¸€è¡Œ`deferred.resolve(ret)`.\n\nåœ¨å½“å‰ promise çš„å¼‚æ­¥æˆåŠŸä¹‹åæ‰§è¡Œ `handle` æ–¹æ³•æ—¶, å…ˆæ‰§è¡Œ `onFulfilled` æ–¹æ³•, ç„¶åå°†å…¶è¿”å›å€¼ä½œä¸º `resolve` æ–¹æ³•çš„å®å‚ä¼ å…¥.\n\nå†æ”¹é€  `resolve` æ–¹æ³•, æŠŠä»£ç æ•´ç†ä¸€ä¸‹:\n```javascript\nfunction Promise (fn) {\n    let value = null\n    let deferreds = []\n    let state = 'pending'\n    \n    this.then = function (onFulfilled) {\n        // åˆ›å»ºä¸€ä¸ªæ–°çš„ Promiseä½œä¸ºè¿”å›å€¼\n        // å°†å½“å‰ promise çš„å›è°ƒå‡½æ•°å’Œæ–°åˆ›å»ºçš„ resolve\n        // æ”¾å…¥ deferreds é˜Ÿåˆ—\n        return new Promise (resolve => {\n            handle({\n                onFulfilled: onFulfilled || null\n                resolve: resolve\n            })\n        })\n    }\n    const handle = deferred => {\n        // åˆå§‹åŒ–çŠ¶æ€æ—¶, å¾€ deferreds é˜Ÿåˆ—æ·»åŠ \n        if (state === 'pending') {\n            deferreds.push(deferred)\n            return\n        }\n        // å½“å‰ promise è¾¾åˆ° 'fulfilled' çŠ¶æ€ä¹‹å\n        // å…ˆæ‰§è¡Œå›è°ƒå‡½æ•°, å†å°†å›è°ƒå‡½æ•°çš„è¿”å›å€¼(ret)\n        // ä¼ é€’ç»™ resolve å‡½æ•°\n        let ret = deferred.onFulfilled(value)\n        deferred.resolve(ret)\n    }\n    \n    const resolve = newValue => {\n        if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n            let then = newValue.then\n            if (typeof then === 'function') {\n                then.call(newValue, resolve)\n                return\n            }\n        }\n        value = newValue\n        state = 'fulfilled'\n        setTimeout(_ => {\n            deferreds.map(deferred => {\n                handle(deferred)\n            })\n        }, 0)\n    }\n    // æ‰§è¡Œ promise å®ä¾‹ä¸­çš„å›è°ƒå‡½æ•°\n    fn(resolve)\n}\n\ngetUserId()\n    .then(getUserInfoById)\n    .then(userInfo => {\n        // do something\n        console.log('this is second callback')\n    })\n```\nç°åœ¨ `resolve` æ”¯æŒä¼ å…¥ä¸€ä¸ª promise å®ä¾‹çš„å‚æ•°äº†, æ‰§è¡Œé¡ºåºå¦‚ä¸‹:\n1. `getUserId` ç”Ÿæˆçš„ promise1, è¿›å…¥ Promise å‡½æ•°æ‰§è¡Œ `fn(resolve)` ç”±äº`getUserId` çš„å†…éƒ¨æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œ, ä¸‹ä¸€æ­¥ä¼šç›´æ¥æ‰§è¡Œ `this.then(onFulfilled)`.\n2. `this.then()` è¿”å›ä¸€ä¸ªæ–°çš„ promise2 å‡½æ•°( å³: bridge promise)ä½œä¸ºé“¾å¼è°ƒç”¨, promise2 é‡æ–°å®ä¾‹åŒ–å†æ‰§è¡Œ `fn(resolve)`, åˆ™è¿›å…¥`handle({...})` æ­¤æ—¶ handle çš„å‚æ•°ä¸º getUserInfoById å’Œ resolve2, æ¥ç€è¢« push åˆ° `deferreds1` é˜Ÿåˆ—ä¸­; å†æ¥ç€æ‰§è¡Œä¸‹ä¸€ä¸ª`this.then()` ç”Ÿæˆ promise3, `deferreds2` é˜Ÿåˆ—ä¸­ push è¿›ç¬¬äºŒä¸ª then çš„åŒ¿åå‡½æ•°(userInfo => {...}) å’Œ resolve3.\n3. æ‰§è¡Œ`resolve(123)`, è¿›å…¥ `resolve(newValue)` æ‰§è¡Œ`handle(deferred)` æ­¤æ—¶ deferred ä¸º getUserInfoById å’Œ resolve2, æ‰§è¡Œ handle å†…éƒ¨çš„ `deferred.onFulfilled(value)` ä¹Ÿå°±æ˜¯ getUserInfoById æ–¹æ³•ä»è€Œç”Ÿæˆ promise4, å†åˆ° `deferred.resolve(ret)` è¿™ä¸ªæ—¶å€™ ret å°±ä¸º promise4, ä¼ å…¥ `resolve(newValue)` æ‰§è¡Œ `then.call(promise4, resolve2)`.\n4. æ¥ç€ä¸Šä¸€æ­¥è¿›å…¥ `this.then()` ç”Ÿæˆ promise5(bridge promise), deferred4 å‹å…¥ resolve2 å’Œ resolve5; åœ¨æ‰§è¡Œ getUserInfoById ä¸­çš„ `resolve({name: 'cara'...})`, è¿›å…¥ setTimeout ä¸­çš„ `handle(deferred)`, åˆ° handle å‡½æ•°å†…éƒ¨ `deferred.onFulfilled(value)` å…¶å®æ‰§è¡Œçš„æ˜¯ `resolve2({...})` resolve2ä¸­çš„ `deferred` ä¿å­˜çš„æ˜¯çš„ `uerInfo => {}` åŒ¿åå‡½æ•°å’Œ `resolve3`; `deferred.resolve` å…¶å®æ‰§è¡Œçš„æ˜¯ `resolve5`, ç”±äº resolve3 å’Œ resolve5 ä¸­çš„ `deferred` éƒ½æ˜¯ç©ºçš„äºæ˜¯å®Œæˆæ•´ä¸ªæµç¨‹.\n\næ¥ä¸‹æ¥å†åŠ å…¥é”™è¯¯å¤„ç†å’Œå¼‚å¸¸åˆ¤æ–­:\n```javascript\nfunction Promise(fn) {\n    var state = 'pending',\n        value = null,\n        deferreds = [];\n\n    this.then = function (onFulfilled, onRejected) {\n        return new Promise(function (resolve, reject) {\n            handle({\n                onFulfilled: onFulfilled || null,\n                onRejected: onRejected || null,\n                resolve: resolve,\n                reject: reject\n            });\n        });\n    };\n\n    function handle(deferred) {\n        if (state === 'pending') {\n            deferreds.push(deferred);\n            return;\n        }\n\n        var cb = state === 'fulfilled' \n            ? deferred.onFulfilled \n            : deferred.onRejected,\n                ret;\n        if (cb === null) {\n            cb = state === 'fulfilled' \n                ? deferred.resolve \n                : deferred.reject;\n            cb(value);\n            return;\n        }\n        try {\n            ret = cb(value);\n            deferred.resolve(ret);\n        } catch (e) {\n            deferred.reject(e);\n        }\n    }\n\n    function resolve(newValue) {\n        if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n            var then = newValue.then;\n            if (typeof then === 'function') {\n                then.call(newValue, resolve, reject);\n                return;\n            }\n        }\n        state = 'fulfilled';\n        value = newValue;\n        finale();\n    }\n\n    function reject(reason) {\n        state = 'rejected';\n        value = reason;\n        finale();\n    }\n\n    function finale() {\n        setTimeout(function () {\n            deferreds.forEach(function (deferred) {\n                handle(deferred);\n            });\n        }, 0);\n    }\n\n    fn(resolve, reject);\n}\n```\n**ä¹‹å‰çš„æ–‡å­—æè¿°ä¸å¥½ç†è§£, æ‰€ä»¥è¿˜æ˜¯ç”»äº†ä¸€ä¸ªæ‰§è¡Œæµç¨‹å›¾**\n![promiseæ‰§è¡Œè¿‡ç¨‹](/img/Promiseæ‰§è¡Œè¿‡ç¨‹.png)\n\næ²¡æœ‰ç”» `reject` çš„æƒ…å†µ, å› ä¸º`reject` è·Ÿ `resolve` çš„æµç¨‹æ˜¯ä¸€æ ·çš„, ä¸¤ä¸ªä¸€èµ·ç”»æ˜¾å¾—æ›´ä¹±å°±å•ç‹¬æŠŠ `resolve` æ‹å‡ºæ¥. åœ¨åŠ å…¥ `handle` å’Œ `resolve` åœ¨ promise å‡½æ•°ä¸­ä½œä¸ºå†…éƒ¨æ–¹æ³•åå®åœ¨ä¸æ˜“ç†è§£. ä¸»è¦å°±æ˜¯é€šè¿‡é—­åŒ…æ¥ä¿å­˜ promise å¯¹è±¡çš„å˜é‡å¼•ç”¨, å°†å›è°ƒå‡½æ•°å’Œ resolve å‡½æ•°ä¿å­˜åœ¨ç¼“å­˜é˜Ÿåˆ—ä¸­, åœ¨é€šè¿‡ resolve å®Œæˆé“¾å¼è°ƒç”¨.\n    \n## å…¶ä»–å®ç°\nçœ‹å®Œä¹‹å‰çš„é‚£ç¯‡æ–‡ç« å®åœ¨è§‰å¾—æœ‰ç‚¹éš¾ç†è§£, äºæ˜¯åˆæ‰¾äº†å…¶ä»–çš„å®ç°æ–¹å¼[JS Promiseçš„å®ç°åŸç†](http://bruce-xu.github.io/blogs/js/promise)æ¯”ä¹‹å‰é‚£ç¯‡æ›´å¥½ç†è§£ä¸€äº›, æ‰€ä»¥è¿˜æ˜¯è®°å½•ä¸€ä¸‹å¥½äº†.\n\n> è¿™ç¯‡æ–‡ç« ä½œè€…è¯´åˆ°çš„ `Promise` é‡ç‚¹:\n> 1. `Promise` æ˜¯ä¸€ä¸ªæ‰¿è¯º, æ‰€ä»¥ä¸ç®¡æˆåŠŸä¸å¦éƒ½è¦æœ‰ä¸€ä¸ªæ‰§è¡Œç»“æœ, å› æ­¤ Promise æ„é€ å‡½æ•°æœ‰ä¸€ä¸ªå‡½æ•°ç±»å‹çš„å‚æ•° `resolver` æ¥ä½œä¸ºä¸è¯¥ promise å¯¹è±¡å…³è”çš„ä»»åŠ¡.\n> 2. ä¸‰ç§çŠ¶æ€ä¸å¯é€†è½¬.\n> 3. `resolver` å‡½æ•°å°è£…äº†éœ€è¦æ‰§è¡Œçš„å¼‚æ­¥æ“ä½œ, å†…éƒ¨: `resolve` å’Œ `reject` ä¸¤ä¸ªå‚æ•°; åˆ†åˆ«ä»£è¡¨æ‰§è¡ŒæˆåŠŸå’Œæ‰§è¡Œå¤±è´¥éœ€è¦æ‰§è¡Œçš„æ“ä½œ.\n> 4. `then` æä¾›æˆåŠŸæˆ–å¤±è´¥çš„å“åº”å¤„ç†, äºæ˜¯æœ‰äº†`onResolve` å’Œ `onReject`.\n> 5. `then` æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°çš„ promise(bridge promise), æä¾›é“¾å¼æ“ä½œåŠä¸²è¡Œ, å¦‚æœç›´æ¥è¿”å› this é‚£ä¹ˆå°±æ˜¯å¹¶è¡Œæ˜¾ç„¶ä¸ç¬¦åˆæˆ‘ä»¬çš„éœ€æ±‚. å‰ä¸€ä¸ª promise éœ€è¦çŸ¥é“ä¸‹ä¸€ä¸ª promise å¯¹è±¡æ˜¯è°åŠå…¶ä»»åŠ¡å¼•ç”¨, è€Œåä¸€ä¸ª promise è¦æä¾›ä¸€ä¸ªç»™å‰ä¸€ä¸ª promise æˆåŠŸæˆ–å¤±è´¥æ—¶éœ€è¦æ‰§è¡Œçš„ä»»åŠ¡, å› æ­¤æ·»åŠ ä¸€ä¸ªé—­åŒ…\n> 6. `makeCallback` è°ƒç”¨å°† promise åŠå…¶å…³è”ä»»åŠ¡ä¼ é€’è¿›å», è¿”å›ä¸€ä¸ªæ–°å‡½æ•°, å‰ä¸€ä¸ª promise å¯¹è±¡å°±å°†æŒæœ‰è¿”å›å‡½æ•°çš„å¼•ç”¨, è°ƒç”¨è¿”å›å‡½æ•°æ—¶å°±èƒ½è®¿é—®åˆ° promise å¯¹è±¡å’Œå…³è”ä»»åŠ¡.\n> 7. `resolve` å’Œ `reject` å‡½æ•°åœ¨å¼‚æ­¥æˆåŠŸæˆ–å¤±è´¥çš„æ—¶å€™è°ƒç”¨, å¹¶ä¼ é€’æˆåŠŸçš„æ•°æ®å’Œå¤±è´¥çš„åŸå› .\n> 8. `run` å‡½æ•°æ‰§è¡Œå¼‚æ­¥ç›¸å…³çš„å›è°ƒå‡½æ•°.\n\n### ä»£ç ç»“æ„\n\n- æ„é€ å‡½æ•°\n\n```javascript\nfunction Promise (resolver) {\n    // çŠ¶æ€\n    this._status = 'pending'\n    \n    // æˆåŠŸé˜Ÿåˆ—\n    this._doneCallbacks = []\n    // å¤±è´¥é˜Ÿåˆ—\n    this._failCallbacks = []\n    \n    // ä¼ é€’å…³è”ä»»åŠ¡\n    resolver(resolve, reject)\n}\n```\n- `then` æ–¹æ³•\n\n```javascript\nthis.prototype.then = function (onResolve, onReject) {\n    // æ·»åŠ é—­åŒ…è°ƒç”¨\n    let promise = new Promise(_ => {})\n    \n    // ä¿å­˜å¯¹ä¸Šä¸€ä¸ª promise çš„å¼•ç”¨\n    this._doneCallbacks.push(makeCallback(promise, onResolve, 'reslove'))\n    this._failCallbacks.push(makeCallback(promise, onReject, 'reject'))\n    \n    return promise\n}\n```\n- `makeCallback` å‡½æ•°\n\n```javascript\n// promise å¯¹è±¡/ å›è°ƒå‡½æ•°(å…³è”ä»»åŠ¡)/ ç±»å‹\nfunction makeCallback (promise, callback, action) {\n    return function promiseCallback (value) {\n    \n    }\n}\n```\n- `resolve` å‡½æ•°å’Œ `reject` å‡½æ•°\nè¿™ä¸¤ä¸ªå‡½æ•°éƒ½éœ€è¦ä¸€ä¸ªå‚æ•°æ¥æ¥æ”¶ç»“æœ, ç”±äºçŠ¶æ€åªèƒ½è½¬æ¢ä¸€æ¬¡æ‰€ä»¥ä¸¤ä¸ªå‡½æ•°éƒ½éœ€è¦åˆ¤æ–­çŠ¶æ€.\n\n```javascript\n// æˆåŠŸ\n// promise: å±äºå“ªä¸ª promise å¯¹è±¡\n// data: å¼‚æ­¥æ“ä½œçš„ç»“æœ\nfunction resolve (promise, data) {\n    // å·²ç»è¢« resolve è¿‡çš„è¯ç›´æ¥è¿”å›\n    if (promise._status !== 'pending') return\n    \n    // ä¿®æ”¹ promise çŠ¶æ€\n    promise._status = 'fulfilled'\n    // ä¿å­˜å¼‚æ­¥æ“ä½œçš„å€¼\n    promise._value = data\n    \n    // æ‰§è¡Œç›¸å…³å›è°ƒå‡½æ•°\n    run(promise)\n}\n\n// å¤±è´¥\n// promise: å±äºå“ªä¸ª promise å¯¹è±¡\n// reason: å¤±è´¥åŸå› \nfunction reject (promise, reason) {\n    if (promise._status !== 'pending') return\n    \n    promise._status = 'rejected'\n    promise._value = reason\n    \n    run(promise)\n}\n```\n- `run` å‡½æ•°\nç”¨æ¥æ‰§è¡Œå¼‚æ­¥ç›¸å…³çš„å›è°ƒå‡½æ•°.\n\n```javascript\nfunction run (promise) {\n    // then æ–¹æ³•ä¸­ä¹Ÿä¼šè°ƒç”¨, æ­¤å¤„å†åšä¸€æ¬¡åˆ¤æ–­\n    if (promise._status === 'pending') return\n    \n    let value = promise._value\n    // æ˜¯å¦æˆåŠŸ\n    let callbacks = promise._status === 'fulfilled'\n        ? promise._doneCallbacks\n        : promise._failCallbacks\n    \n    // è¿™é‡Œéœ€è¦å¼‚æ­¥\n    setTimeout(_ => {\n        // æ‰§è¡Œå›è°ƒå‡½æ•°\n        callbacks.map(cb => cb(value))\n    }, 0)\n    \n    promise._doneCallbacks = []\n    promise._failCallbacks = []\n}\n```\n**`run` å‡½æ•°ä¸­çš„ callbacks å°±æ˜¯ `makeCallback` æ‰€è¿”å›çš„å‡½æ•°**\n\n- å®Œå–„ `makeCallback` å‡½æ•°\n\n```javascript\nfunction makeCallback (promise, callback, action) {\n    return function promiseCallback (value) {\n        // å¦‚æœ callback æ˜¯ä¸ªå‡½æ•°, ä½¿ç”¨å‰ä¸€ä¸ª promise\n        // ä¼ é€’çš„å€¼ä½œä¸º callback çš„å‚æ•°\n        if (typeof callback === 'function') {\n            let x\n            try {\n                x = callback(value)\n            }catch (e) {\n                // å¼‚å¸¸æ—¶, ç”¨å½“å‰ promise çš„ reject\n                reject(promise, e)\n            }\n            \n            // å¦‚æœ callback è¿”å›çš„æ˜¯å½“å‰çš„ promise\n            // è¦æŠ›å‡ºå¼‚å¸¸\n            if (x === promise) {\n                let reason = new Error('Error: return value could not be same with the promise')\n                reject(promise, reason)\n            }\n            // å¦‚æœè¿”å›å€¼æ˜¯ä¸€ä¸ª promise å¯¹è±¡\n            // åˆ™å½“è¿”å› promise å¯¹è±¡è¢« reoslve/ rejectå\n            // å†æ‰§è¡Œå½“å‰çš„ promise çš„ resolve/ reject\n            else if (x instanceof Promise) {\n                x.then(\n                    function (data) {\n                        resolve(promise, data)\n                    },\n                    function (reason) {\n                        reject(promise, reason)\n                    }\n                )\n            }else {\n                let then\n                (function resolveThenable (x) {\n                    // å¦‚æœè¿”å›çš„æ˜¯ä¸€ä¸ª Thenable å¯¹è±¡\n                    if (x && (typeof x === 'object' || typeof x === 'function')) {\n                        try {\n                            then = x.then\n                        }catch (e) {\n                            reject(promise, e)\n                            return\n                        }\n                        \n                        if (typeof then === 'function') {\n                            // è°ƒç”¨ Thenable å¯¹è±¡çš„ thenæ–¹æ³•\n                            // ä¼ é€’è¿›å»çš„ resolvePromise å’Œ rejectPromise ä»¥åŠä¸‹é¢ä¸¤ä¸ªåŒ¿åå‡½æ•°\n                            // å¯èƒ½ä¼šé‡å¤è°ƒç”¨, ä½†æ˜¯è§„èŒƒåªèƒ½æœ‰å…¶ä¸­ä¸€ä¸ªè¢«è°ƒç”¨ä¸€æ¬¡, å…¶ä»–è¦è¢«å¿½ç•¥\n                            let invoked = false\n                            try {\n                                then.call(x,\n                                    function (y) {\n                                        if (invoked) return\n                                        invoked = true\n                                        \n                                        // é¿å…ä¸¤ä¸ª promise æ’ç­‰\n                                        if (y === x) {\n                                            throw new Error('Error: return value could not be same with the promise')\n                                        }\n                                        \n                                    // y æœ‰å¯èƒ½è¿˜æ˜¯ thenable å¯¹è±¡    \n                                    resolveThenable(y)\n                                    },\n                                    function (e) {\n                                        if (invoked) return\n                                        invoked = true\n                                        \n                                        reject(promise, e)\n                                    }\n                                )\n                            }catch (e) {\n                                    // å¦‚æœ`resolvePromise`å’Œ`rejectPromise`æ–¹æ³•è¢«è°ƒç”¨åï¼Œå†æŠ›å‡ºå¼‚å¸¸ï¼Œåˆ™å¿½ç•¥å¼‚å¸¸\n                                    // å¦åˆ™ç”¨å¼‚å¸¸å¯¹è±¡rejectæ­¤Promiseå¯¹è±¡\n                                if (!invoked) {\n                                    reject(promise, e)\n                                }\n                            }\n                        }else {\n                            resolve(promise, x)\n                        }\n                    }else {\n                        resolve(promise, x)\n                    }\n                }(x))\n            }\n        }\n        // å¦‚æœæ²¡æœ‰ä¼  callbackç›´æ¥ä½¿ç”¨å‰ä¸€ä¸ª promise\n        // ä¼ è¿‡æ¥çš„å€¼ resolve/reject å½“å‰ promise å¯¹è±¡\n        else {\n            action === 'resolve'\n                ? resolve(promise, value)\n                : reject(promise, value)\n        }\n    }\n}\n```\n\n#### æ€»ç»“\næˆ‘ä¸€å¼€å§‹æ˜¯å…ˆçœ‹çš„**å‰–æ Promise ä¹‹åŸºç¡€ç¯‡**, å‰åŠéƒ¨åˆ†ç¡®å®å¾ˆäº²æ°‘, ä½†æ˜¯åˆ°åŠ å…¥ `hanlde` å’Œæ”¹é€  `resolve` å‡½æ•° å°±å¼€å§‹æ‡µäº†, ç„¶åæ‡µæ‡µæ‡‚æ‡‚çš„å»çœ‹**JS Promise çš„åŸç†å®ç°**, ä¸è¿‡åœ¨æœ€å¤æ‚çš„ `makeCallback` å‡½æ•°ä¸­è§£é‡Šæœ‰ç‚¹ä¸€ç¬”å¸¦è¿‡çš„æ„æ€. ä¸è¿‡çœ‹äº†è¿™ç¯‡å¸®åŠ©æˆ‘ç†è§£ä¹‹å‰çš„**å‰–æ Promise ä¹‹åŸºç¡€ç¯‡**, å°±è¿”å›å»çœ‹åŸºç¡€ç¯‡ç”»äº†ä¸€éæµç¨‹å›¾æ‰ç®—çœ‹æ‡‚, é‡Œé¢çš„é—­åŒ…ç”¨çš„å¤ªç²¾å¦™äº†.\n\n> å‚è€ƒæ–‡ç« \n> [å‰–æ Promise ä¹‹åŸºç¡€ç¯‡](https://tech.meituan.com/promise-insight.html)\n> [JS Promise çš„åŸç†å®ç°](http://bruce-xu.github.io/blogs/js/promise)\n> [å‰–æPromiseå†…éƒ¨ç»“æ„](https://github.com/xieranmaya/blog/issues/3)\n\nCreated on 2017-12-26 by Cara\n","source":"_posts/Promise-åˆ†æåŠå®ç°.md","raw":"---\ntitle: Promise åˆ†æåŠå®ç°\ndate: 2018-01-04 19:07:22\ntags:\n- JavaScript\ncategories:\n- ç¬”è®°ğŸ“’\n---\nPromise æ˜¯ ES6ä¸­ä¸­æ”¶å½•çš„å¼‚æ­¥æ“ä½œå°è£…, é€šå¸¸åœ¨å›è°ƒ/ äº‹ä»¶/ æ¶ˆæ¯ç­‰å¼‚æ­¥æ“ä½œä¸­æœ‰æ˜¾è‘—çš„ä¼˜åŠ¿, è®©æˆ‘ä»¬åœ¨æ›´æ–¹ä¾¿çš„æ“ä½œå¼‚æ­¥ä¹Ÿè®©ä»£ç æ›´åŠ æ¸…æ™°.åŒ…æ‹¬ ES7ä¸­çš„ Async/Await ä¹Ÿæ˜¯å¯¹å¼‚æ­¥æ“ä½œçš„å°è£…, ä¸è¿‡ Async æ›´åƒæ˜¯ Generator çš„è¯­æ³•ç³–.\n\n### åŸºç¡€å®ç°\nå­¦ä¹ [å‰–æ Promise ä¹‹åŸºç¡€ç¯‡](https://tech.meituan.com/promise-insight.html)ç”¨ä¸€ä¸ªæœ€å¸¸è§çš„åº”ç”¨æ¥å‰–æ `Promise`, é€šè¿‡å¼‚æ­¥è·å–ç”¨æˆ· Id, ç„¶åä½œä¸€äº›å¤„ç†. å¹³å¸¸æˆ‘ä»¬æœ€å¸¸ç”¨çš„æ˜¯å›è°ƒçš„æ–¹å¼æ¥å¤„ç†, ä¸‹é¢ç”¨ `Promise` çš„æ–¹å¼æ¥å¤„ç†.\n```javascript\nconst getUserId = _ => {\n    new Promise((resolve, reject) => {\n        axios.get('http://example.com/api', params: param).then(res => {\n            resolve(JSON.parse(res).id)\n        })\n    })\n}\ngetUserId().then(id => {\n    console.log(id)\n    // do something...\n})\n```\ngetUserId å‡½æ•°è¿”å›ä¸€ä¸ª `Promise`, åœ¨ä»–çš„ `then` æ–¹æ³•ä¸­æ”¾å…¥å¼‚æ­¥æ“ä½œæˆåŠŸä¹‹åçš„å›è°ƒå‡½æ•°. è¿™ç§æ–¹å¼æ˜æ˜¾æ¯”æˆ‘ä»¬ä¹‹å‰å¸¸ç”¨çš„å›è°ƒå‡½æ•°æ›´åŠ æ–¹ä¾¿è€Œä¸”æ˜“è¯», ä¹Ÿæ›´åŠ å®¹æ˜“é¿å… callback hell.\n\né‚£ä¹ˆæ»¡è¶³è¿™æ ·çš„åœºæ™¯çš„`Promise`æ˜¯æ€æ ·å®ç°çš„å‘¢, ä¸‹é¢æˆ‘ä»¬å¯ä»¥ç®€å•çš„å®ç°ä¸€ä¸‹æœ€åŸºç¡€çš„`Promise`:\n```javascript\nfunction Promise (fn) {\n    let value = null\n    let deferreds = []\n    \n    // 4. å­˜å…¥å¼‚æ­¥æˆåŠŸéœ€è¦çš„å›è°ƒå‡½æ•°\n    // æ­¤æ—¶æŒ‡å‘ä¸¤ä¸ªå›è°ƒå‡½æ•° id => {}\n    this.then = function (onFulfilled) {\n        deferreds.push(onFulfilled)\n        return this\n    }\n    \n    // 3. æ‰§è¡Œ deferreds é˜Ÿåˆ—ä¸­çš„å›è°ƒå‡½æ•°\n    // æ­¤æ—¶ value ä¸º123\n    function resolve (value) {\n        deferreds.map(deferred => {\n            deferred(value)\n        })\n    }\n    \n    // 1. æ‰§è¡Œåˆ›å»º Promise å®ä¾‹æ—¶ä¼ å…¥çš„å‡½æ•°\n    // å¹¶ä¼ å…¥ resolve ä¾›åœ¨é€‚å½“æ—¶è§¦å‘å›è°ƒ\n    fn(resolve)\n}\n\nconst getUserId = _ => {\n    return new Promise(resolve => {\n        // 2. æ‰§è¡Œ resolve\n        resolve(123)\n    })\n}\ngetUserId().then( id => {\n    console.log('this is callback!')\n    console.log(id) // 123\n}).then(id => {\n    console.log('this is second callback!')\n    console.log(id) // 123\n})\n```\n - è°ƒç”¨ `then` æ–¹æ³•å°†å›è°ƒå‡½æ•°å­˜å…¥ deferreds é˜Ÿåˆ—.\n - åˆ›å»º `Promise` å®ä¾‹æ—¶ä¼ å…¥å‡½æ•°å’Œ `resolve`, `resolve` ç”¨äºåœ¨é€‚å½“çš„æ—¶é—´è§¦å‘å›è°ƒå‡½æ•°.\n - çœŸæ­£æ‰§è¡Œå›è°ƒå‡½æ•°çš„æ˜¯ `deferreds` é˜Ÿåˆ—ä¸­çš„å…ƒç´ .\n - `resolve` å‡½æ•°æ¥å—ä¸€ä¸ªå‚æ•°, ç”¨äºå›è°ƒå‡½æ•°ä½¿ç”¨, å³å¼‚æ­¥æ“ä½œçš„è¿”å›ç»“æœ.\n\nå¯èƒ½å¤§å®¶å·²ç»å‘ç°, ä»¥ä¸Šä»£ç å¹¶ä¸èƒ½çœŸæ­£æ‰§è¡Œåˆ°å›è°ƒå‡½æ•°.æ ¹æ®ä¸Šé¢æ ‡æ³¨çš„åºå·å°±æ˜¯ä»£ç çš„æ‰§è¡Œé¡ºåº, è¿™æ˜¯å› ä¸ºç°åœ¨è¿˜æ˜¯åŒæ­¥å‡½æ•°, `Promise` å‡½æ•°ä¸­çš„ `resolve` å‡½æ•°ä¼šå…ˆäº `this.then` å‡½æ•°æ‰§è¡Œ,æ­¤æ—¶ `deferreds` é˜Ÿåˆ—ä¸­è¿˜æ˜¯ç©ºçš„, ä»¥è‡³äºåé¢çš„å›è°ƒå‡½æ•°ä¹Ÿæ— æ³•æ‰§è¡Œ. æ‰€ä»¥æˆ‘ä»¬è¦ä¿è¯å›è°ƒä»¥å¼‚æ­¥çš„æ–¹å¼æ‰§è¡Œ, ä»¥ä¿è¯æ‰§è¡Œé¡ºåº. å¯ä»¥é€šè¿‡ `setTimeout` å°† `resolve` ä¸­çš„å›è°ƒå‡½æ•°æ”¾åœ¨æ‰§è¡Œæ ˆçš„æœ«å°¾.\n```javascript\nfunction resolve (value) {\n    // å°†æ‰§è¡Œçš„å›è°ƒçš„é€»è¾‘æ”¾å…¥æ‰§è¡Œæ ˆæœ«å°¾\n    setTimeout(function () {\n        deferreds.map(deferred => {\n            deferred(value)\n        })    \n    }, 0)\n}\n```\nç°åœ¨å°±å¯ä»¥çœ‹åˆ°, then ä¸­çš„å›è°ƒå‡½æ•°èƒ½å¤Ÿæ­£å¸¸æ‰§è¡Œäº†.\n\n#### å¼•å…¥çŠ¶æ€\nç°åœ¨æˆ‘ä»¬å¼•å…¥è§„èŒƒ `Promises/A+` ä¸­æ‰€è¯´çš„ States, å®ƒæœ‰ä¸‰ä¸ªäº’æ–¥çš„çŠ¶æ€: pending/ fulfilled/ rejected.\n\nç°åœ¨æˆ‘ä»¬æ¥æ”¹è¿›ä¸‹ä»£ç :\n```javascript\nfunction Promise (fn) {\n    let value = null\n    let deferreds = []\n    let state = 'pending'\n    \n    this.then = function (onFulfilled) {\n        if (state === 'pending') {\n            deferreds.push(onFulfilled)\n            return this\n        }\n        onFulfilled(value)\n        return this\n    }\n    \n    function resolve (newValue) {\n        value = newValue\n        state = 'fulfilled'\n        setTimeout(_ => {\n            deferreds.map(deferred => {\n                deferred(value)\n            })\n        }, 0)\n    }\n    fn(resolve)\n}\n```\n\n### ä¸²è¡Œ Promise\nä¸²è¡Œ `Promise` æ˜¯æŒ‡å½“ promise è¾¾åˆ° fuifilled çŠ¶æ€ä¹‹å, å†è¿›è¡Œä¸‹ä¸€ä¸ª promise. æ¯”å¦‚ä¸Šä¾‹ä¸­çš„æˆ‘ä»¬æ‹¿åˆ° userId ä¹‹åè¿˜éœ€è¦ç”¨è¿™ä¸ª userId å»è·å–ç”¨æˆ·çš„åç§°/ ä½å€/ æ‰‹æœºå·ç­‰å…¶ä»–ä¿¡æ¯.\n\nä½¿ç”¨çš„ä¼ªä»£ç ç±»ä¼¼è¿™æ ·:\n```javascript\ngetUserId()\n    .then(getUserInfoById)\n    .then(userInfo => {\n        // do something\n    })\n    \nconst getUserInfoById = id => {\n    return new Promise(resolve => {\n        axios.get('http://example.com/api', params: {\n            id: 123\n        }).then(response => {\n            resolve(JSON.parse(response).info)\n        })\n    })\n}\nconst getUserId = _ => {\n    return new Promise(resolve => {\n        resolve(123)\n    })\n}\n```\nä¸²è¡Œçš„å›°éš¾åœ¨äºå¦‚ä½•å°†å‰åçš„ `Promise` è¡”æ¥èµ·æ¥, é¦–å…ˆå¯¹ `then` æ–¹æ³•æ”¹é€ :\n```javascript\nthis.then = function (onFulfilled) {\n    // bridge promise\n    return new Promise(resolve => {\n        handle({\n            onFulfilled: onFulfilled || null,\n            resolve: resolve\n        })\n    })\n}\n\nlet handle = deferred => {\n    if (state === 'pending') {\n        deferreds.push(deferred)\n        return\n    }\n    let ret = deferred.onFulfilled(value)\n    deferred.resolve(ret)\n}\n```\n- `then` æ–¹æ³•ä¸­è¿”å›ä¸€ä¸ªæ–°åˆ›å»ºçš„ Promise å®ä¾‹ä½œä¸ºè¿”å›å€¼, è¿™æ˜¯ä¸²è¡Œçš„åŸºç¡€, ç”±äºè¿”å›ç±»å‹ä¸€æ ·æ‰€ä»¥ä¾ç„¶æ”¯æŒé“¾å¼.\n- `then` æ–¹æ³•ä¸­çš„å½¢å‚ `onFulfilled` å’Œæ–°åˆ›å»ºçš„ Promise å®ä¾‹ä¸­çš„ `resolve` å‡æ”¾å…¥å½“å‰ promise çš„ deferreds é˜Ÿåˆ—ä¸­.\n- `handle` æ–¹æ³•ä½œä¸ºå½“å‰ promise çš„å†…éƒ¨æ–¹æ³•, è¾ƒä¹‹å‰çš„ `then` æ–¹æ³•åªå¢åŠ äº†ä¸€è¡Œ`deferred.resolve(ret)`.\n\nåœ¨å½“å‰ promise çš„å¼‚æ­¥æˆåŠŸä¹‹åæ‰§è¡Œ `handle` æ–¹æ³•æ—¶, å…ˆæ‰§è¡Œ `onFulfilled` æ–¹æ³•, ç„¶åå°†å…¶è¿”å›å€¼ä½œä¸º `resolve` æ–¹æ³•çš„å®å‚ä¼ å…¥.\n\nå†æ”¹é€  `resolve` æ–¹æ³•, æŠŠä»£ç æ•´ç†ä¸€ä¸‹:\n```javascript\nfunction Promise (fn) {\n    let value = null\n    let deferreds = []\n    let state = 'pending'\n    \n    this.then = function (onFulfilled) {\n        // åˆ›å»ºä¸€ä¸ªæ–°çš„ Promiseä½œä¸ºè¿”å›å€¼\n        // å°†å½“å‰ promise çš„å›è°ƒå‡½æ•°å’Œæ–°åˆ›å»ºçš„ resolve\n        // æ”¾å…¥ deferreds é˜Ÿåˆ—\n        return new Promise (resolve => {\n            handle({\n                onFulfilled: onFulfilled || null\n                resolve: resolve\n            })\n        })\n    }\n    const handle = deferred => {\n        // åˆå§‹åŒ–çŠ¶æ€æ—¶, å¾€ deferreds é˜Ÿåˆ—æ·»åŠ \n        if (state === 'pending') {\n            deferreds.push(deferred)\n            return\n        }\n        // å½“å‰ promise è¾¾åˆ° 'fulfilled' çŠ¶æ€ä¹‹å\n        // å…ˆæ‰§è¡Œå›è°ƒå‡½æ•°, å†å°†å›è°ƒå‡½æ•°çš„è¿”å›å€¼(ret)\n        // ä¼ é€’ç»™ resolve å‡½æ•°\n        let ret = deferred.onFulfilled(value)\n        deferred.resolve(ret)\n    }\n    \n    const resolve = newValue => {\n        if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n            let then = newValue.then\n            if (typeof then === 'function') {\n                then.call(newValue, resolve)\n                return\n            }\n        }\n        value = newValue\n        state = 'fulfilled'\n        setTimeout(_ => {\n            deferreds.map(deferred => {\n                handle(deferred)\n            })\n        }, 0)\n    }\n    // æ‰§è¡Œ promise å®ä¾‹ä¸­çš„å›è°ƒå‡½æ•°\n    fn(resolve)\n}\n\ngetUserId()\n    .then(getUserInfoById)\n    .then(userInfo => {\n        // do something\n        console.log('this is second callback')\n    })\n```\nç°åœ¨ `resolve` æ”¯æŒä¼ å…¥ä¸€ä¸ª promise å®ä¾‹çš„å‚æ•°äº†, æ‰§è¡Œé¡ºåºå¦‚ä¸‹:\n1. `getUserId` ç”Ÿæˆçš„ promise1, è¿›å…¥ Promise å‡½æ•°æ‰§è¡Œ `fn(resolve)` ç”±äº`getUserId` çš„å†…éƒ¨æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œ, ä¸‹ä¸€æ­¥ä¼šç›´æ¥æ‰§è¡Œ `this.then(onFulfilled)`.\n2. `this.then()` è¿”å›ä¸€ä¸ªæ–°çš„ promise2 å‡½æ•°( å³: bridge promise)ä½œä¸ºé“¾å¼è°ƒç”¨, promise2 é‡æ–°å®ä¾‹åŒ–å†æ‰§è¡Œ `fn(resolve)`, åˆ™è¿›å…¥`handle({...})` æ­¤æ—¶ handle çš„å‚æ•°ä¸º getUserInfoById å’Œ resolve2, æ¥ç€è¢« push åˆ° `deferreds1` é˜Ÿåˆ—ä¸­; å†æ¥ç€æ‰§è¡Œä¸‹ä¸€ä¸ª`this.then()` ç”Ÿæˆ promise3, `deferreds2` é˜Ÿåˆ—ä¸­ push è¿›ç¬¬äºŒä¸ª then çš„åŒ¿åå‡½æ•°(userInfo => {...}) å’Œ resolve3.\n3. æ‰§è¡Œ`resolve(123)`, è¿›å…¥ `resolve(newValue)` æ‰§è¡Œ`handle(deferred)` æ­¤æ—¶ deferred ä¸º getUserInfoById å’Œ resolve2, æ‰§è¡Œ handle å†…éƒ¨çš„ `deferred.onFulfilled(value)` ä¹Ÿå°±æ˜¯ getUserInfoById æ–¹æ³•ä»è€Œç”Ÿæˆ promise4, å†åˆ° `deferred.resolve(ret)` è¿™ä¸ªæ—¶å€™ ret å°±ä¸º promise4, ä¼ å…¥ `resolve(newValue)` æ‰§è¡Œ `then.call(promise4, resolve2)`.\n4. æ¥ç€ä¸Šä¸€æ­¥è¿›å…¥ `this.then()` ç”Ÿæˆ promise5(bridge promise), deferred4 å‹å…¥ resolve2 å’Œ resolve5; åœ¨æ‰§è¡Œ getUserInfoById ä¸­çš„ `resolve({name: 'cara'...})`, è¿›å…¥ setTimeout ä¸­çš„ `handle(deferred)`, åˆ° handle å‡½æ•°å†…éƒ¨ `deferred.onFulfilled(value)` å…¶å®æ‰§è¡Œçš„æ˜¯ `resolve2({...})` resolve2ä¸­çš„ `deferred` ä¿å­˜çš„æ˜¯çš„ `uerInfo => {}` åŒ¿åå‡½æ•°å’Œ `resolve3`; `deferred.resolve` å…¶å®æ‰§è¡Œçš„æ˜¯ `resolve5`, ç”±äº resolve3 å’Œ resolve5 ä¸­çš„ `deferred` éƒ½æ˜¯ç©ºçš„äºæ˜¯å®Œæˆæ•´ä¸ªæµç¨‹.\n\næ¥ä¸‹æ¥å†åŠ å…¥é”™è¯¯å¤„ç†å’Œå¼‚å¸¸åˆ¤æ–­:\n```javascript\nfunction Promise(fn) {\n    var state = 'pending',\n        value = null,\n        deferreds = [];\n\n    this.then = function (onFulfilled, onRejected) {\n        return new Promise(function (resolve, reject) {\n            handle({\n                onFulfilled: onFulfilled || null,\n                onRejected: onRejected || null,\n                resolve: resolve,\n                reject: reject\n            });\n        });\n    };\n\n    function handle(deferred) {\n        if (state === 'pending') {\n            deferreds.push(deferred);\n            return;\n        }\n\n        var cb = state === 'fulfilled' \n            ? deferred.onFulfilled \n            : deferred.onRejected,\n                ret;\n        if (cb === null) {\n            cb = state === 'fulfilled' \n                ? deferred.resolve \n                : deferred.reject;\n            cb(value);\n            return;\n        }\n        try {\n            ret = cb(value);\n            deferred.resolve(ret);\n        } catch (e) {\n            deferred.reject(e);\n        }\n    }\n\n    function resolve(newValue) {\n        if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n            var then = newValue.then;\n            if (typeof then === 'function') {\n                then.call(newValue, resolve, reject);\n                return;\n            }\n        }\n        state = 'fulfilled';\n        value = newValue;\n        finale();\n    }\n\n    function reject(reason) {\n        state = 'rejected';\n        value = reason;\n        finale();\n    }\n\n    function finale() {\n        setTimeout(function () {\n            deferreds.forEach(function (deferred) {\n                handle(deferred);\n            });\n        }, 0);\n    }\n\n    fn(resolve, reject);\n}\n```\n**ä¹‹å‰çš„æ–‡å­—æè¿°ä¸å¥½ç†è§£, æ‰€ä»¥è¿˜æ˜¯ç”»äº†ä¸€ä¸ªæ‰§è¡Œæµç¨‹å›¾**\n![promiseæ‰§è¡Œè¿‡ç¨‹](/img/Promiseæ‰§è¡Œè¿‡ç¨‹.png)\n\næ²¡æœ‰ç”» `reject` çš„æƒ…å†µ, å› ä¸º`reject` è·Ÿ `resolve` çš„æµç¨‹æ˜¯ä¸€æ ·çš„, ä¸¤ä¸ªä¸€èµ·ç”»æ˜¾å¾—æ›´ä¹±å°±å•ç‹¬æŠŠ `resolve` æ‹å‡ºæ¥. åœ¨åŠ å…¥ `handle` å’Œ `resolve` åœ¨ promise å‡½æ•°ä¸­ä½œä¸ºå†…éƒ¨æ–¹æ³•åå®åœ¨ä¸æ˜“ç†è§£. ä¸»è¦å°±æ˜¯é€šè¿‡é—­åŒ…æ¥ä¿å­˜ promise å¯¹è±¡çš„å˜é‡å¼•ç”¨, å°†å›è°ƒå‡½æ•°å’Œ resolve å‡½æ•°ä¿å­˜åœ¨ç¼“å­˜é˜Ÿåˆ—ä¸­, åœ¨é€šè¿‡ resolve å®Œæˆé“¾å¼è°ƒç”¨.\n    \n## å…¶ä»–å®ç°\nçœ‹å®Œä¹‹å‰çš„é‚£ç¯‡æ–‡ç« å®åœ¨è§‰å¾—æœ‰ç‚¹éš¾ç†è§£, äºæ˜¯åˆæ‰¾äº†å…¶ä»–çš„å®ç°æ–¹å¼[JS Promiseçš„å®ç°åŸç†](http://bruce-xu.github.io/blogs/js/promise)æ¯”ä¹‹å‰é‚£ç¯‡æ›´å¥½ç†è§£ä¸€äº›, æ‰€ä»¥è¿˜æ˜¯è®°å½•ä¸€ä¸‹å¥½äº†.\n\n> è¿™ç¯‡æ–‡ç« ä½œè€…è¯´åˆ°çš„ `Promise` é‡ç‚¹:\n> 1. `Promise` æ˜¯ä¸€ä¸ªæ‰¿è¯º, æ‰€ä»¥ä¸ç®¡æˆåŠŸä¸å¦éƒ½è¦æœ‰ä¸€ä¸ªæ‰§è¡Œç»“æœ, å› æ­¤ Promise æ„é€ å‡½æ•°æœ‰ä¸€ä¸ªå‡½æ•°ç±»å‹çš„å‚æ•° `resolver` æ¥ä½œä¸ºä¸è¯¥ promise å¯¹è±¡å…³è”çš„ä»»åŠ¡.\n> 2. ä¸‰ç§çŠ¶æ€ä¸å¯é€†è½¬.\n> 3. `resolver` å‡½æ•°å°è£…äº†éœ€è¦æ‰§è¡Œçš„å¼‚æ­¥æ“ä½œ, å†…éƒ¨: `resolve` å’Œ `reject` ä¸¤ä¸ªå‚æ•°; åˆ†åˆ«ä»£è¡¨æ‰§è¡ŒæˆåŠŸå’Œæ‰§è¡Œå¤±è´¥éœ€è¦æ‰§è¡Œçš„æ“ä½œ.\n> 4. `then` æä¾›æˆåŠŸæˆ–å¤±è´¥çš„å“åº”å¤„ç†, äºæ˜¯æœ‰äº†`onResolve` å’Œ `onReject`.\n> 5. `then` æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°çš„ promise(bridge promise), æä¾›é“¾å¼æ“ä½œåŠä¸²è¡Œ, å¦‚æœç›´æ¥è¿”å› this é‚£ä¹ˆå°±æ˜¯å¹¶è¡Œæ˜¾ç„¶ä¸ç¬¦åˆæˆ‘ä»¬çš„éœ€æ±‚. å‰ä¸€ä¸ª promise éœ€è¦çŸ¥é“ä¸‹ä¸€ä¸ª promise å¯¹è±¡æ˜¯è°åŠå…¶ä»»åŠ¡å¼•ç”¨, è€Œåä¸€ä¸ª promise è¦æä¾›ä¸€ä¸ªç»™å‰ä¸€ä¸ª promise æˆåŠŸæˆ–å¤±è´¥æ—¶éœ€è¦æ‰§è¡Œçš„ä»»åŠ¡, å› æ­¤æ·»åŠ ä¸€ä¸ªé—­åŒ…\n> 6. `makeCallback` è°ƒç”¨å°† promise åŠå…¶å…³è”ä»»åŠ¡ä¼ é€’è¿›å», è¿”å›ä¸€ä¸ªæ–°å‡½æ•°, å‰ä¸€ä¸ª promise å¯¹è±¡å°±å°†æŒæœ‰è¿”å›å‡½æ•°çš„å¼•ç”¨, è°ƒç”¨è¿”å›å‡½æ•°æ—¶å°±èƒ½è®¿é—®åˆ° promise å¯¹è±¡å’Œå…³è”ä»»åŠ¡.\n> 7. `resolve` å’Œ `reject` å‡½æ•°åœ¨å¼‚æ­¥æˆåŠŸæˆ–å¤±è´¥çš„æ—¶å€™è°ƒç”¨, å¹¶ä¼ é€’æˆåŠŸçš„æ•°æ®å’Œå¤±è´¥çš„åŸå› .\n> 8. `run` å‡½æ•°æ‰§è¡Œå¼‚æ­¥ç›¸å…³çš„å›è°ƒå‡½æ•°.\n\n### ä»£ç ç»“æ„\n\n- æ„é€ å‡½æ•°\n\n```javascript\nfunction Promise (resolver) {\n    // çŠ¶æ€\n    this._status = 'pending'\n    \n    // æˆåŠŸé˜Ÿåˆ—\n    this._doneCallbacks = []\n    // å¤±è´¥é˜Ÿåˆ—\n    this._failCallbacks = []\n    \n    // ä¼ é€’å…³è”ä»»åŠ¡\n    resolver(resolve, reject)\n}\n```\n- `then` æ–¹æ³•\n\n```javascript\nthis.prototype.then = function (onResolve, onReject) {\n    // æ·»åŠ é—­åŒ…è°ƒç”¨\n    let promise = new Promise(_ => {})\n    \n    // ä¿å­˜å¯¹ä¸Šä¸€ä¸ª promise çš„å¼•ç”¨\n    this._doneCallbacks.push(makeCallback(promise, onResolve, 'reslove'))\n    this._failCallbacks.push(makeCallback(promise, onReject, 'reject'))\n    \n    return promise\n}\n```\n- `makeCallback` å‡½æ•°\n\n```javascript\n// promise å¯¹è±¡/ å›è°ƒå‡½æ•°(å…³è”ä»»åŠ¡)/ ç±»å‹\nfunction makeCallback (promise, callback, action) {\n    return function promiseCallback (value) {\n    \n    }\n}\n```\n- `resolve` å‡½æ•°å’Œ `reject` å‡½æ•°\nè¿™ä¸¤ä¸ªå‡½æ•°éƒ½éœ€è¦ä¸€ä¸ªå‚æ•°æ¥æ¥æ”¶ç»“æœ, ç”±äºçŠ¶æ€åªèƒ½è½¬æ¢ä¸€æ¬¡æ‰€ä»¥ä¸¤ä¸ªå‡½æ•°éƒ½éœ€è¦åˆ¤æ–­çŠ¶æ€.\n\n```javascript\n// æˆåŠŸ\n// promise: å±äºå“ªä¸ª promise å¯¹è±¡\n// data: å¼‚æ­¥æ“ä½œçš„ç»“æœ\nfunction resolve (promise, data) {\n    // å·²ç»è¢« resolve è¿‡çš„è¯ç›´æ¥è¿”å›\n    if (promise._status !== 'pending') return\n    \n    // ä¿®æ”¹ promise çŠ¶æ€\n    promise._status = 'fulfilled'\n    // ä¿å­˜å¼‚æ­¥æ“ä½œçš„å€¼\n    promise._value = data\n    \n    // æ‰§è¡Œç›¸å…³å›è°ƒå‡½æ•°\n    run(promise)\n}\n\n// å¤±è´¥\n// promise: å±äºå“ªä¸ª promise å¯¹è±¡\n// reason: å¤±è´¥åŸå› \nfunction reject (promise, reason) {\n    if (promise._status !== 'pending') return\n    \n    promise._status = 'rejected'\n    promise._value = reason\n    \n    run(promise)\n}\n```\n- `run` å‡½æ•°\nç”¨æ¥æ‰§è¡Œå¼‚æ­¥ç›¸å…³çš„å›è°ƒå‡½æ•°.\n\n```javascript\nfunction run (promise) {\n    // then æ–¹æ³•ä¸­ä¹Ÿä¼šè°ƒç”¨, æ­¤å¤„å†åšä¸€æ¬¡åˆ¤æ–­\n    if (promise._status === 'pending') return\n    \n    let value = promise._value\n    // æ˜¯å¦æˆåŠŸ\n    let callbacks = promise._status === 'fulfilled'\n        ? promise._doneCallbacks\n        : promise._failCallbacks\n    \n    // è¿™é‡Œéœ€è¦å¼‚æ­¥\n    setTimeout(_ => {\n        // æ‰§è¡Œå›è°ƒå‡½æ•°\n        callbacks.map(cb => cb(value))\n    }, 0)\n    \n    promise._doneCallbacks = []\n    promise._failCallbacks = []\n}\n```\n**`run` å‡½æ•°ä¸­çš„ callbacks å°±æ˜¯ `makeCallback` æ‰€è¿”å›çš„å‡½æ•°**\n\n- å®Œå–„ `makeCallback` å‡½æ•°\n\n```javascript\nfunction makeCallback (promise, callback, action) {\n    return function promiseCallback (value) {\n        // å¦‚æœ callback æ˜¯ä¸ªå‡½æ•°, ä½¿ç”¨å‰ä¸€ä¸ª promise\n        // ä¼ é€’çš„å€¼ä½œä¸º callback çš„å‚æ•°\n        if (typeof callback === 'function') {\n            let x\n            try {\n                x = callback(value)\n            }catch (e) {\n                // å¼‚å¸¸æ—¶, ç”¨å½“å‰ promise çš„ reject\n                reject(promise, e)\n            }\n            \n            // å¦‚æœ callback è¿”å›çš„æ˜¯å½“å‰çš„ promise\n            // è¦æŠ›å‡ºå¼‚å¸¸\n            if (x === promise) {\n                let reason = new Error('Error: return value could not be same with the promise')\n                reject(promise, reason)\n            }\n            // å¦‚æœè¿”å›å€¼æ˜¯ä¸€ä¸ª promise å¯¹è±¡\n            // åˆ™å½“è¿”å› promise å¯¹è±¡è¢« reoslve/ rejectå\n            // å†æ‰§è¡Œå½“å‰çš„ promise çš„ resolve/ reject\n            else if (x instanceof Promise) {\n                x.then(\n                    function (data) {\n                        resolve(promise, data)\n                    },\n                    function (reason) {\n                        reject(promise, reason)\n                    }\n                )\n            }else {\n                let then\n                (function resolveThenable (x) {\n                    // å¦‚æœè¿”å›çš„æ˜¯ä¸€ä¸ª Thenable å¯¹è±¡\n                    if (x && (typeof x === 'object' || typeof x === 'function')) {\n                        try {\n                            then = x.then\n                        }catch (e) {\n                            reject(promise, e)\n                            return\n                        }\n                        \n                        if (typeof then === 'function') {\n                            // è°ƒç”¨ Thenable å¯¹è±¡çš„ thenæ–¹æ³•\n                            // ä¼ é€’è¿›å»çš„ resolvePromise å’Œ rejectPromise ä»¥åŠä¸‹é¢ä¸¤ä¸ªåŒ¿åå‡½æ•°\n                            // å¯èƒ½ä¼šé‡å¤è°ƒç”¨, ä½†æ˜¯è§„èŒƒåªèƒ½æœ‰å…¶ä¸­ä¸€ä¸ªè¢«è°ƒç”¨ä¸€æ¬¡, å…¶ä»–è¦è¢«å¿½ç•¥\n                            let invoked = false\n                            try {\n                                then.call(x,\n                                    function (y) {\n                                        if (invoked) return\n                                        invoked = true\n                                        \n                                        // é¿å…ä¸¤ä¸ª promise æ’ç­‰\n                                        if (y === x) {\n                                            throw new Error('Error: return value could not be same with the promise')\n                                        }\n                                        \n                                    // y æœ‰å¯èƒ½è¿˜æ˜¯ thenable å¯¹è±¡    \n                                    resolveThenable(y)\n                                    },\n                                    function (e) {\n                                        if (invoked) return\n                                        invoked = true\n                                        \n                                        reject(promise, e)\n                                    }\n                                )\n                            }catch (e) {\n                                    // å¦‚æœ`resolvePromise`å’Œ`rejectPromise`æ–¹æ³•è¢«è°ƒç”¨åï¼Œå†æŠ›å‡ºå¼‚å¸¸ï¼Œåˆ™å¿½ç•¥å¼‚å¸¸\n                                    // å¦åˆ™ç”¨å¼‚å¸¸å¯¹è±¡rejectæ­¤Promiseå¯¹è±¡\n                                if (!invoked) {\n                                    reject(promise, e)\n                                }\n                            }\n                        }else {\n                            resolve(promise, x)\n                        }\n                    }else {\n                        resolve(promise, x)\n                    }\n                }(x))\n            }\n        }\n        // å¦‚æœæ²¡æœ‰ä¼  callbackç›´æ¥ä½¿ç”¨å‰ä¸€ä¸ª promise\n        // ä¼ è¿‡æ¥çš„å€¼ resolve/reject å½“å‰ promise å¯¹è±¡\n        else {\n            action === 'resolve'\n                ? resolve(promise, value)\n                : reject(promise, value)\n        }\n    }\n}\n```\n\n#### æ€»ç»“\næˆ‘ä¸€å¼€å§‹æ˜¯å…ˆçœ‹çš„**å‰–æ Promise ä¹‹åŸºç¡€ç¯‡**, å‰åŠéƒ¨åˆ†ç¡®å®å¾ˆäº²æ°‘, ä½†æ˜¯åˆ°åŠ å…¥ `hanlde` å’Œæ”¹é€  `resolve` å‡½æ•° å°±å¼€å§‹æ‡µäº†, ç„¶åæ‡µæ‡µæ‡‚æ‡‚çš„å»çœ‹**JS Promise çš„åŸç†å®ç°**, ä¸è¿‡åœ¨æœ€å¤æ‚çš„ `makeCallback` å‡½æ•°ä¸­è§£é‡Šæœ‰ç‚¹ä¸€ç¬”å¸¦è¿‡çš„æ„æ€. ä¸è¿‡çœ‹äº†è¿™ç¯‡å¸®åŠ©æˆ‘ç†è§£ä¹‹å‰çš„**å‰–æ Promise ä¹‹åŸºç¡€ç¯‡**, å°±è¿”å›å»çœ‹åŸºç¡€ç¯‡ç”»äº†ä¸€éæµç¨‹å›¾æ‰ç®—çœ‹æ‡‚, é‡Œé¢çš„é—­åŒ…ç”¨çš„å¤ªç²¾å¦™äº†.\n\n> å‚è€ƒæ–‡ç« \n> [å‰–æ Promise ä¹‹åŸºç¡€ç¯‡](https://tech.meituan.com/promise-insight.html)\n> [JS Promise çš„åŸç†å®ç°](http://bruce-xu.github.io/blogs/js/promise)\n> [å‰–æPromiseå†…éƒ¨ç»“æ„](https://github.com/xieranmaya/blog/issues/3)\n\nCreated on 2017-12-26 by Cara\n","slug":"Promise-åˆ†æåŠå®ç°","published":1,"updated":"2018-05-05T09:23:03.663Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjgurolsm000wklu0gz2f09vg","content":"<p>Promise æ˜¯ ES6ä¸­ä¸­æ”¶å½•çš„å¼‚æ­¥æ“ä½œå°è£…, é€šå¸¸åœ¨å›è°ƒ/ äº‹ä»¶/ æ¶ˆæ¯ç­‰å¼‚æ­¥æ“ä½œä¸­æœ‰æ˜¾è‘—çš„ä¼˜åŠ¿, è®©æˆ‘ä»¬åœ¨æ›´æ–¹ä¾¿çš„æ“ä½œå¼‚æ­¥ä¹Ÿè®©ä»£ç æ›´åŠ æ¸…æ™°.åŒ…æ‹¬ ES7ä¸­çš„ Async/Await ä¹Ÿæ˜¯å¯¹å¼‚æ­¥æ“ä½œçš„å°è£…, ä¸è¿‡ Async æ›´åƒæ˜¯ Generator çš„è¯­æ³•ç³–.</p>\n<h3 id=\"åŸºç¡€å®ç°\"><a href=\"#åŸºç¡€å®ç°\" class=\"headerlink\" title=\"åŸºç¡€å®ç°\"></a>åŸºç¡€å®ç°</h3><p>å­¦ä¹ <a href=\"https://tech.meituan.com/promise-insight.html\" target=\"_blank\" rel=\"noopener\">å‰–æ Promise ä¹‹åŸºç¡€ç¯‡</a>ç”¨ä¸€ä¸ªæœ€å¸¸è§çš„åº”ç”¨æ¥å‰–æ <code>Promise</code>, é€šè¿‡å¼‚æ­¥è·å–ç”¨æˆ· Id, ç„¶åä½œä¸€äº›å¤„ç†. å¹³å¸¸æˆ‘ä»¬æœ€å¸¸ç”¨çš„æ˜¯å›è°ƒçš„æ–¹å¼æ¥å¤„ç†, ä¸‹é¢ç”¨ <code>Promise</code> çš„æ–¹å¼æ¥å¤„ç†.<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> getUserId = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        axios.get(<span class=\"string\">'http://example.com/api'</span>, <span class=\"attr\">params</span>: param).then(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">            resolve(<span class=\"built_in\">JSON</span>.parse(res).id)</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">getUserId().then(<span class=\"function\"><span class=\"params\">id</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(id)</span><br><span class=\"line\">    <span class=\"comment\">// do something...</span></span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure></p>\n<p>getUserId å‡½æ•°è¿”å›ä¸€ä¸ª <code>Promise</code>, åœ¨ä»–çš„ <code>then</code> æ–¹æ³•ä¸­æ”¾å…¥å¼‚æ­¥æ“ä½œæˆåŠŸä¹‹åçš„å›è°ƒå‡½æ•°. è¿™ç§æ–¹å¼æ˜æ˜¾æ¯”æˆ‘ä»¬ä¹‹å‰å¸¸ç”¨çš„å›è°ƒå‡½æ•°æ›´åŠ æ–¹ä¾¿è€Œä¸”æ˜“è¯», ä¹Ÿæ›´åŠ å®¹æ˜“é¿å… callback hell.</p>\n<p>é‚£ä¹ˆæ»¡è¶³è¿™æ ·çš„åœºæ™¯çš„<code>Promise</code>æ˜¯æ€æ ·å®ç°çš„å‘¢, ä¸‹é¢æˆ‘ä»¬å¯ä»¥ç®€å•çš„å®ç°ä¸€ä¸‹æœ€åŸºç¡€çš„<code>Promise</code>:<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Promise</span> (<span class=\"params\">fn</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> value = <span class=\"literal\">null</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> deferreds = []</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// 4. å­˜å…¥å¼‚æ­¥æˆåŠŸéœ€è¦çš„å›è°ƒå‡½æ•°</span></span><br><span class=\"line\">    <span class=\"comment\">// æ­¤æ—¶æŒ‡å‘ä¸¤ä¸ªå›è°ƒå‡½æ•° id =&gt; &#123;&#125;</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.then = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">onFulfilled</span>) </span>&#123;</span><br><span class=\"line\">        deferreds.push(onFulfilled)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">this</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// 3. æ‰§è¡Œ deferreds é˜Ÿåˆ—ä¸­çš„å›è°ƒå‡½æ•°</span></span><br><span class=\"line\">    <span class=\"comment\">// æ­¤æ—¶ value ä¸º123</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">resolve</span> (<span class=\"params\">value</span>) </span>&#123;</span><br><span class=\"line\">        deferreds.map(<span class=\"function\"><span class=\"params\">deferred</span> =&gt;</span> &#123;</span><br><span class=\"line\">            deferred(value)</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// 1. æ‰§è¡Œåˆ›å»º Promise å®ä¾‹æ—¶ä¼ å…¥çš„å‡½æ•°</span></span><br><span class=\"line\">    <span class=\"comment\">// å¹¶ä¼ å…¥ resolve ä¾›åœ¨é€‚å½“æ—¶è§¦å‘å›è°ƒ</span></span><br><span class=\"line\">    fn(resolve)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> getUserId = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\"><span class=\"params\">resolve</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 2. æ‰§è¡Œ resolve</span></span><br><span class=\"line\">        resolve(<span class=\"number\">123</span>)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">getUserId().then( <span class=\"function\"><span class=\"params\">id</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'this is callback!'</span>)</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(id) <span class=\"comment\">// 123</span></span><br><span class=\"line\">&#125;).then(<span class=\"function\"><span class=\"params\">id</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'this is second callback!'</span>)</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(id) <span class=\"comment\">// 123</span></span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>è°ƒç”¨ <code>then</code> æ–¹æ³•å°†å›è°ƒå‡½æ•°å­˜å…¥ deferreds é˜Ÿåˆ—.</li>\n<li>åˆ›å»º <code>Promise</code> å®ä¾‹æ—¶ä¼ å…¥å‡½æ•°å’Œ <code>resolve</code>, <code>resolve</code> ç”¨äºåœ¨é€‚å½“çš„æ—¶é—´è§¦å‘å›è°ƒå‡½æ•°.</li>\n<li>çœŸæ­£æ‰§è¡Œå›è°ƒå‡½æ•°çš„æ˜¯ <code>deferreds</code> é˜Ÿåˆ—ä¸­çš„å…ƒç´ .</li>\n<li><code>resolve</code> å‡½æ•°æ¥å—ä¸€ä¸ªå‚æ•°, ç”¨äºå›è°ƒå‡½æ•°ä½¿ç”¨, å³å¼‚æ­¥æ“ä½œçš„è¿”å›ç»“æœ.</li>\n</ul>\n<p>å¯èƒ½å¤§å®¶å·²ç»å‘ç°, ä»¥ä¸Šä»£ç å¹¶ä¸èƒ½çœŸæ­£æ‰§è¡Œåˆ°å›è°ƒå‡½æ•°.æ ¹æ®ä¸Šé¢æ ‡æ³¨çš„åºå·å°±æ˜¯ä»£ç çš„æ‰§è¡Œé¡ºåº, è¿™æ˜¯å› ä¸ºç°åœ¨è¿˜æ˜¯åŒæ­¥å‡½æ•°, <code>Promise</code> å‡½æ•°ä¸­çš„ <code>resolve</code> å‡½æ•°ä¼šå…ˆäº <code>this.then</code> å‡½æ•°æ‰§è¡Œ,æ­¤æ—¶ <code>deferreds</code> é˜Ÿåˆ—ä¸­è¿˜æ˜¯ç©ºçš„, ä»¥è‡³äºåé¢çš„å›è°ƒå‡½æ•°ä¹Ÿæ— æ³•æ‰§è¡Œ. æ‰€ä»¥æˆ‘ä»¬è¦ä¿è¯å›è°ƒä»¥å¼‚æ­¥çš„æ–¹å¼æ‰§è¡Œ, ä»¥ä¿è¯æ‰§è¡Œé¡ºåº. å¯ä»¥é€šè¿‡ <code>setTimeout</code> å°† <code>resolve</code> ä¸­çš„å›è°ƒå‡½æ•°æ”¾åœ¨æ‰§è¡Œæ ˆçš„æœ«å°¾.<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">resolve</span> (<span class=\"params\">value</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// å°†æ‰§è¡Œçš„å›è°ƒçš„é€»è¾‘æ”¾å…¥æ‰§è¡Œæ ˆæœ«å°¾</span></span><br><span class=\"line\">    setTimeout(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        deferreds.map(<span class=\"function\"><span class=\"params\">deferred</span> =&gt;</span> &#123;</span><br><span class=\"line\">            deferred(value)</span><br><span class=\"line\">        &#125;)    </span><br><span class=\"line\">    &#125;, <span class=\"number\">0</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>ç°åœ¨å°±å¯ä»¥çœ‹åˆ°, then ä¸­çš„å›è°ƒå‡½æ•°èƒ½å¤Ÿæ­£å¸¸æ‰§è¡Œäº†.</p>\n<h4 id=\"å¼•å…¥çŠ¶æ€\"><a href=\"#å¼•å…¥çŠ¶æ€\" class=\"headerlink\" title=\"å¼•å…¥çŠ¶æ€\"></a>å¼•å…¥çŠ¶æ€</h4><p>ç°åœ¨æˆ‘ä»¬å¼•å…¥è§„èŒƒ <code>Promises/A+</code> ä¸­æ‰€è¯´çš„ States, å®ƒæœ‰ä¸‰ä¸ªäº’æ–¥çš„çŠ¶æ€: pending/ fulfilled/ rejected.</p>\n<p>ç°åœ¨æˆ‘ä»¬æ¥æ”¹è¿›ä¸‹ä»£ç :<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Promise</span> (<span class=\"params\">fn</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> value = <span class=\"literal\">null</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> deferreds = []</span><br><span class=\"line\">    <span class=\"keyword\">let</span> state = <span class=\"string\">'pending'</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">this</span>.then = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">onFulfilled</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (state === <span class=\"string\">'pending'</span>) &#123;</span><br><span class=\"line\">            deferreds.push(onFulfilled)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">this</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        onFulfilled(value)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">this</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">resolve</span> (<span class=\"params\">newValue</span>) </span>&#123;</span><br><span class=\"line\">        value = newValue</span><br><span class=\"line\">        state = <span class=\"string\">'fulfilled'</span></span><br><span class=\"line\">        setTimeout(<span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">            deferreds.map(<span class=\"function\"><span class=\"params\">deferred</span> =&gt;</span> &#123;</span><br><span class=\"line\">                deferred(value)</span><br><span class=\"line\">            &#125;)</span><br><span class=\"line\">        &#125;, <span class=\"number\">0</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    fn(resolve)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"ä¸²è¡Œ-Promise\"><a href=\"#ä¸²è¡Œ-Promise\" class=\"headerlink\" title=\"ä¸²è¡Œ Promise\"></a>ä¸²è¡Œ Promise</h3><p>ä¸²è¡Œ <code>Promise</code> æ˜¯æŒ‡å½“ promise è¾¾åˆ° fuifilled çŠ¶æ€ä¹‹å, å†è¿›è¡Œä¸‹ä¸€ä¸ª promise. æ¯”å¦‚ä¸Šä¾‹ä¸­çš„æˆ‘ä»¬æ‹¿åˆ° userId ä¹‹åè¿˜éœ€è¦ç”¨è¿™ä¸ª userId å»è·å–ç”¨æˆ·çš„åç§°/ ä½å€/ æ‰‹æœºå·ç­‰å…¶ä»–ä¿¡æ¯.</p>\n<p>ä½¿ç”¨çš„ä¼ªä»£ç ç±»ä¼¼è¿™æ ·:<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">getUserId()</span><br><span class=\"line\">    .then(getUserInfoById)</span><br><span class=\"line\">    .then(<span class=\"function\"><span class=\"params\">userInfo</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// do something</span></span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"keyword\">const</span> getUserInfoById = <span class=\"function\"><span class=\"params\">id</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\"><span class=\"params\">resolve</span> =&gt;</span> &#123;</span><br><span class=\"line\">        axios.get(<span class=\"string\">'http://example.com/api'</span>, <span class=\"attr\">params</span>: &#123;</span><br><span class=\"line\">            id: <span class=\"number\">123</span></span><br><span class=\"line\">        &#125;).then(<span class=\"function\"><span class=\"params\">response</span> =&gt;</span> &#123;</span><br><span class=\"line\">            resolve(<span class=\"built_in\">JSON</span>.parse(response).info)</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">const</span> getUserId = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\"><span class=\"params\">resolve</span> =&gt;</span> &#123;</span><br><span class=\"line\">        resolve(<span class=\"number\">123</span>)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>ä¸²è¡Œçš„å›°éš¾åœ¨äºå¦‚ä½•å°†å‰åçš„ <code>Promise</code> è¡”æ¥èµ·æ¥, é¦–å…ˆå¯¹ <code>then</code> æ–¹æ³•æ”¹é€ :<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">this</span>.then = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">onFulfilled</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// bridge promise</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\"><span class=\"params\">resolve</span> =&gt;</span> &#123;</span><br><span class=\"line\">        handle(&#123;</span><br><span class=\"line\">            onFulfilled: onFulfilled || <span class=\"literal\">null</span>,</span><br><span class=\"line\">            resolve: resolve</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> handle = <span class=\"function\"><span class=\"params\">deferred</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (state === <span class=\"string\">'pending'</span>) &#123;</span><br><span class=\"line\">        deferreds.push(deferred)</span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> ret = deferred.onFulfilled(value)</span><br><span class=\"line\">    deferred.resolve(ret)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li><code>then</code> æ–¹æ³•ä¸­è¿”å›ä¸€ä¸ªæ–°åˆ›å»ºçš„ Promise å®ä¾‹ä½œä¸ºè¿”å›å€¼, è¿™æ˜¯ä¸²è¡Œçš„åŸºç¡€, ç”±äºè¿”å›ç±»å‹ä¸€æ ·æ‰€ä»¥ä¾ç„¶æ”¯æŒé“¾å¼.</li>\n<li><code>then</code> æ–¹æ³•ä¸­çš„å½¢å‚ <code>onFulfilled</code> å’Œæ–°åˆ›å»ºçš„ Promise å®ä¾‹ä¸­çš„ <code>resolve</code> å‡æ”¾å…¥å½“å‰ promise çš„ deferreds é˜Ÿåˆ—ä¸­.</li>\n<li><code>handle</code> æ–¹æ³•ä½œä¸ºå½“å‰ promise çš„å†…éƒ¨æ–¹æ³•, è¾ƒä¹‹å‰çš„ <code>then</code> æ–¹æ³•åªå¢åŠ äº†ä¸€è¡Œ<code>deferred.resolve(ret)</code>.</li>\n</ul>\n<p>åœ¨å½“å‰ promise çš„å¼‚æ­¥æˆåŠŸä¹‹åæ‰§è¡Œ <code>handle</code> æ–¹æ³•æ—¶, å…ˆæ‰§è¡Œ <code>onFulfilled</code> æ–¹æ³•, ç„¶åå°†å…¶è¿”å›å€¼ä½œä¸º <code>resolve</code> æ–¹æ³•çš„å®å‚ä¼ å…¥.</p>\n<p>å†æ”¹é€  <code>resolve</code> æ–¹æ³•, æŠŠä»£ç æ•´ç†ä¸€ä¸‹:<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Promise</span> (<span class=\"params\">fn</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> value = <span class=\"literal\">null</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> deferreds = []</span><br><span class=\"line\">    <span class=\"keyword\">let</span> state = <span class=\"string\">'pending'</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">this</span>.then = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">onFulfilled</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// åˆ›å»ºä¸€ä¸ªæ–°çš„ Promiseä½œä¸ºè¿”å›å€¼</span></span><br><span class=\"line\">        <span class=\"comment\">// å°†å½“å‰ promise çš„å›è°ƒå‡½æ•°å’Œæ–°åˆ›å»ºçš„ resolve</span></span><br><span class=\"line\">        <span class=\"comment\">// æ”¾å…¥ deferreds é˜Ÿåˆ—</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span> (<span class=\"function\"><span class=\"params\">resolve</span> =&gt;</span> &#123;</span><br><span class=\"line\">            handle(&#123;</span><br><span class=\"line\">                onFulfilled: onFulfilled || <span class=\"literal\">null</span></span><br><span class=\"line\">                resolve: resolve</span><br><span class=\"line\">            &#125;)</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> handle = <span class=\"function\"><span class=\"params\">deferred</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// åˆå§‹åŒ–çŠ¶æ€æ—¶, å¾€ deferreds é˜Ÿåˆ—æ·»åŠ </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (state === <span class=\"string\">'pending'</span>) &#123;</span><br><span class=\"line\">            deferreds.push(deferred)</span><br><span class=\"line\">            <span class=\"keyword\">return</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// å½“å‰ promise è¾¾åˆ° 'fulfilled' çŠ¶æ€ä¹‹å</span></span><br><span class=\"line\">        <span class=\"comment\">// å…ˆæ‰§è¡Œå›è°ƒå‡½æ•°, å†å°†å›è°ƒå‡½æ•°çš„è¿”å›å€¼(ret)</span></span><br><span class=\"line\">        <span class=\"comment\">// ä¼ é€’ç»™ resolve å‡½æ•°</span></span><br><span class=\"line\">        <span class=\"keyword\">let</span> ret = deferred.onFulfilled(value)</span><br><span class=\"line\">        deferred.resolve(ret)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">const</span> resolve = <span class=\"function\"><span class=\"params\">newValue</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (newValue &amp;&amp; (<span class=\"keyword\">typeof</span> newValue === <span class=\"string\">'object'</span> || <span class=\"keyword\">typeof</span> newValue === <span class=\"string\">'function'</span>)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">let</span> then = newValue.then</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> then === <span class=\"string\">'function'</span>) &#123;</span><br><span class=\"line\">                then.call(newValue, resolve)</span><br><span class=\"line\">                <span class=\"keyword\">return</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        value = newValue</span><br><span class=\"line\">        state = <span class=\"string\">'fulfilled'</span></span><br><span class=\"line\">        setTimeout(<span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">            deferreds.map(<span class=\"function\"><span class=\"params\">deferred</span> =&gt;</span> &#123;</span><br><span class=\"line\">                handle(deferred)</span><br><span class=\"line\">            &#125;)</span><br><span class=\"line\">        &#125;, <span class=\"number\">0</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// æ‰§è¡Œ promise å®ä¾‹ä¸­çš„å›è°ƒå‡½æ•°</span></span><br><span class=\"line\">    fn(resolve)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">getUserId()</span><br><span class=\"line\">    .then(getUserInfoById)</span><br><span class=\"line\">    .then(<span class=\"function\"><span class=\"params\">userInfo</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// do something</span></span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(<span class=\"string\">'this is second callback'</span>)</span><br><span class=\"line\">    &#125;)</span><br></pre></td></tr></table></figure></p>\n<p>ç°åœ¨ <code>resolve</code> æ”¯æŒä¼ å…¥ä¸€ä¸ª promise å®ä¾‹çš„å‚æ•°äº†, æ‰§è¡Œé¡ºåºå¦‚ä¸‹:</p>\n<ol>\n<li><code>getUserId</code> ç”Ÿæˆçš„ promise1, è¿›å…¥ Promise å‡½æ•°æ‰§è¡Œ <code>fn(resolve)</code> ç”±äº<code>getUserId</code> çš„å†…éƒ¨æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œ, ä¸‹ä¸€æ­¥ä¼šç›´æ¥æ‰§è¡Œ <code>this.then(onFulfilled)</code>.</li>\n<li><code>this.then()</code> è¿”å›ä¸€ä¸ªæ–°çš„ promise2 å‡½æ•°( å³: bridge promise)ä½œä¸ºé“¾å¼è°ƒç”¨, promise2 é‡æ–°å®ä¾‹åŒ–å†æ‰§è¡Œ <code>fn(resolve)</code>, åˆ™è¿›å…¥<code>handle({...})</code> æ­¤æ—¶ handle çš„å‚æ•°ä¸º getUserInfoById å’Œ resolve2, æ¥ç€è¢« push åˆ° <code>deferreds1</code> é˜Ÿåˆ—ä¸­; å†æ¥ç€æ‰§è¡Œä¸‹ä¸€ä¸ª<code>this.then()</code> ç”Ÿæˆ promise3, <code>deferreds2</code> é˜Ÿåˆ—ä¸­ push è¿›ç¬¬äºŒä¸ª then çš„åŒ¿åå‡½æ•°(userInfo =&gt; {â€¦}) å’Œ resolve3.</li>\n<li>æ‰§è¡Œ<code>resolve(123)</code>, è¿›å…¥ <code>resolve(newValue)</code> æ‰§è¡Œ<code>handle(deferred)</code> æ­¤æ—¶ deferred ä¸º getUserInfoById å’Œ resolve2, æ‰§è¡Œ handle å†…éƒ¨çš„ <code>deferred.onFulfilled(value)</code> ä¹Ÿå°±æ˜¯ getUserInfoById æ–¹æ³•ä»è€Œç”Ÿæˆ promise4, å†åˆ° <code>deferred.resolve(ret)</code> è¿™ä¸ªæ—¶å€™ ret å°±ä¸º promise4, ä¼ å…¥ <code>resolve(newValue)</code> æ‰§è¡Œ <code>then.call(promise4, resolve2)</code>.</li>\n<li>æ¥ç€ä¸Šä¸€æ­¥è¿›å…¥ <code>this.then()</code> ç”Ÿæˆ promise5(bridge promise), deferred4 å‹å…¥ resolve2 å’Œ resolve5; åœ¨æ‰§è¡Œ getUserInfoById ä¸­çš„ <code>resolve({name: &#39;cara&#39;...})</code>, è¿›å…¥ setTimeout ä¸­çš„ <code>handle(deferred)</code>, åˆ° handle å‡½æ•°å†…éƒ¨ <code>deferred.onFulfilled(value)</code> å…¶å®æ‰§è¡Œçš„æ˜¯ <code>resolve2({...})</code> resolve2ä¸­çš„ <code>deferred</code> ä¿å­˜çš„æ˜¯çš„ <code>uerInfo =&gt; {}</code> åŒ¿åå‡½æ•°å’Œ <code>resolve3</code>; <code>deferred.resolve</code> å…¶å®æ‰§è¡Œçš„æ˜¯ <code>resolve5</code>, ç”±äº resolve3 å’Œ resolve5 ä¸­çš„ <code>deferred</code> éƒ½æ˜¯ç©ºçš„äºæ˜¯å®Œæˆæ•´ä¸ªæµç¨‹.</li>\n</ol>\n<p>æ¥ä¸‹æ¥å†åŠ å…¥é”™è¯¯å¤„ç†å’Œå¼‚å¸¸åˆ¤æ–­:<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Promise</span>(<span class=\"params\">fn</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> state = <span class=\"string\">'pending'</span>,</span><br><span class=\"line\">        value = <span class=\"literal\">null</span>,</span><br><span class=\"line\">        deferreds = [];</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.then = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">onFulfilled, onRejected</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">resolve, reject</span>) </span>&#123;</span><br><span class=\"line\">            handle(&#123;</span><br><span class=\"line\">                onFulfilled: onFulfilled || <span class=\"literal\">null</span>,</span><br><span class=\"line\">                onRejected: onRejected || <span class=\"literal\">null</span>,</span><br><span class=\"line\">                resolve: resolve,</span><br><span class=\"line\">                reject: reject</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">handle</span>(<span class=\"params\">deferred</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (state === <span class=\"string\">'pending'</span>) &#123;</span><br><span class=\"line\">            deferreds.push(deferred);</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">var</span> cb = state === <span class=\"string\">'fulfilled'</span> </span><br><span class=\"line\">            ? deferred.onFulfilled </span><br><span class=\"line\">            : deferred.onRejected,</span><br><span class=\"line\">                ret;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (cb === <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">            cb = state === <span class=\"string\">'fulfilled'</span> </span><br><span class=\"line\">                ? deferred.resolve </span><br><span class=\"line\">                : deferred.reject;</span><br><span class=\"line\">            cb(value);</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            ret = cb(value);</span><br><span class=\"line\">            deferred.resolve(ret);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">            deferred.reject(e);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">resolve</span>(<span class=\"params\">newValue</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (newValue &amp;&amp; (<span class=\"keyword\">typeof</span> newValue === <span class=\"string\">'object'</span> || <span class=\"keyword\">typeof</span> newValue === <span class=\"string\">'function'</span>)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> then = newValue.then;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> then === <span class=\"string\">'function'</span>) &#123;</span><br><span class=\"line\">                then.call(newValue, resolve, reject);</span><br><span class=\"line\">                <span class=\"keyword\">return</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        state = <span class=\"string\">'fulfilled'</span>;</span><br><span class=\"line\">        value = newValue;</span><br><span class=\"line\">        finale();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">reject</span>(<span class=\"params\">reason</span>) </span>&#123;</span><br><span class=\"line\">        state = <span class=\"string\">'rejected'</span>;</span><br><span class=\"line\">        value = reason;</span><br><span class=\"line\">        finale();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">finale</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        setTimeout(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">            deferreds.forEach(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">deferred</span>) </span>&#123;</span><br><span class=\"line\">                handle(deferred);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;, <span class=\"number\">0</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    fn(resolve, reject);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><strong>ä¹‹å‰çš„æ–‡å­—æè¿°ä¸å¥½ç†è§£, æ‰€ä»¥è¿˜æ˜¯ç”»äº†ä¸€ä¸ªæ‰§è¡Œæµç¨‹å›¾</strong><br><img src=\"/img/Promiseæ‰§è¡Œè¿‡ç¨‹.png\" alt=\"promiseæ‰§è¡Œè¿‡ç¨‹\"></p>\n<p>æ²¡æœ‰ç”» <code>reject</code> çš„æƒ…å†µ, å› ä¸º<code>reject</code> è·Ÿ <code>resolve</code> çš„æµç¨‹æ˜¯ä¸€æ ·çš„, ä¸¤ä¸ªä¸€èµ·ç”»æ˜¾å¾—æ›´ä¹±å°±å•ç‹¬æŠŠ <code>resolve</code> æ‹å‡ºæ¥. åœ¨åŠ å…¥ <code>handle</code> å’Œ <code>resolve</code> åœ¨ promise å‡½æ•°ä¸­ä½œä¸ºå†…éƒ¨æ–¹æ³•åå®åœ¨ä¸æ˜“ç†è§£. ä¸»è¦å°±æ˜¯é€šè¿‡é—­åŒ…æ¥ä¿å­˜ promise å¯¹è±¡çš„å˜é‡å¼•ç”¨, å°†å›è°ƒå‡½æ•°å’Œ resolve å‡½æ•°ä¿å­˜åœ¨ç¼“å­˜é˜Ÿåˆ—ä¸­, åœ¨é€šè¿‡ resolve å®Œæˆé“¾å¼è°ƒç”¨.</p>\n<h2 id=\"å…¶ä»–å®ç°\"><a href=\"#å…¶ä»–å®ç°\" class=\"headerlink\" title=\"å…¶ä»–å®ç°\"></a>å…¶ä»–å®ç°</h2><p>çœ‹å®Œä¹‹å‰çš„é‚£ç¯‡æ–‡ç« å®åœ¨è§‰å¾—æœ‰ç‚¹éš¾ç†è§£, äºæ˜¯åˆæ‰¾äº†å…¶ä»–çš„å®ç°æ–¹å¼<a href=\"http://bruce-xu.github.io/blogs/js/promise\" target=\"_blank\" rel=\"noopener\">JS Promiseçš„å®ç°åŸç†</a>æ¯”ä¹‹å‰é‚£ç¯‡æ›´å¥½ç†è§£ä¸€äº›, æ‰€ä»¥è¿˜æ˜¯è®°å½•ä¸€ä¸‹å¥½äº†.</p>\n<blockquote>\n<p>è¿™ç¯‡æ–‡ç« ä½œè€…è¯´åˆ°çš„ <code>Promise</code> é‡ç‚¹:</p>\n<ol>\n<li><code>Promise</code> æ˜¯ä¸€ä¸ªæ‰¿è¯º, æ‰€ä»¥ä¸ç®¡æˆåŠŸä¸å¦éƒ½è¦æœ‰ä¸€ä¸ªæ‰§è¡Œç»“æœ, å› æ­¤ Promise æ„é€ å‡½æ•°æœ‰ä¸€ä¸ªå‡½æ•°ç±»å‹çš„å‚æ•° <code>resolver</code> æ¥ä½œä¸ºä¸è¯¥ promise å¯¹è±¡å…³è”çš„ä»»åŠ¡.</li>\n<li>ä¸‰ç§çŠ¶æ€ä¸å¯é€†è½¬.</li>\n<li><code>resolver</code> å‡½æ•°å°è£…äº†éœ€è¦æ‰§è¡Œçš„å¼‚æ­¥æ“ä½œ, å†…éƒ¨: <code>resolve</code> å’Œ <code>reject</code> ä¸¤ä¸ªå‚æ•°; åˆ†åˆ«ä»£è¡¨æ‰§è¡ŒæˆåŠŸå’Œæ‰§è¡Œå¤±è´¥éœ€è¦æ‰§è¡Œçš„æ“ä½œ.</li>\n<li><code>then</code> æä¾›æˆåŠŸæˆ–å¤±è´¥çš„å“åº”å¤„ç†, äºæ˜¯æœ‰äº†<code>onResolve</code> å’Œ <code>onReject</code>.</li>\n<li><code>then</code> æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°çš„ promise(bridge promise), æä¾›é“¾å¼æ“ä½œåŠä¸²è¡Œ, å¦‚æœç›´æ¥è¿”å› this é‚£ä¹ˆå°±æ˜¯å¹¶è¡Œæ˜¾ç„¶ä¸ç¬¦åˆæˆ‘ä»¬çš„éœ€æ±‚. å‰ä¸€ä¸ª promise éœ€è¦çŸ¥é“ä¸‹ä¸€ä¸ª promise å¯¹è±¡æ˜¯è°åŠå…¶ä»»åŠ¡å¼•ç”¨, è€Œåä¸€ä¸ª promise è¦æä¾›ä¸€ä¸ªç»™å‰ä¸€ä¸ª promise æˆåŠŸæˆ–å¤±è´¥æ—¶éœ€è¦æ‰§è¡Œçš„ä»»åŠ¡, å› æ­¤æ·»åŠ ä¸€ä¸ªé—­åŒ…</li>\n<li><code>makeCallback</code> è°ƒç”¨å°† promise åŠå…¶å…³è”ä»»åŠ¡ä¼ é€’è¿›å», è¿”å›ä¸€ä¸ªæ–°å‡½æ•°, å‰ä¸€ä¸ª promise å¯¹è±¡å°±å°†æŒæœ‰è¿”å›å‡½æ•°çš„å¼•ç”¨, è°ƒç”¨è¿”å›å‡½æ•°æ—¶å°±èƒ½è®¿é—®åˆ° promise å¯¹è±¡å’Œå…³è”ä»»åŠ¡.</li>\n<li><code>resolve</code> å’Œ <code>reject</code> å‡½æ•°åœ¨å¼‚æ­¥æˆåŠŸæˆ–å¤±è´¥çš„æ—¶å€™è°ƒç”¨, å¹¶ä¼ é€’æˆåŠŸçš„æ•°æ®å’Œå¤±è´¥çš„åŸå› .</li>\n<li><code>run</code> å‡½æ•°æ‰§è¡Œå¼‚æ­¥ç›¸å…³çš„å›è°ƒå‡½æ•°.</li>\n</ol>\n</blockquote>\n<h3 id=\"ä»£ç ç»“æ„\"><a href=\"#ä»£ç ç»“æ„\" class=\"headerlink\" title=\"ä»£ç ç»“æ„\"></a>ä»£ç ç»“æ„</h3><ul>\n<li>æ„é€ å‡½æ•°</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Promise</span> (<span class=\"params\">resolver</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// çŠ¶æ€</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>._status = <span class=\"string\">'pending'</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// æˆåŠŸé˜Ÿåˆ—</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>._doneCallbacks = []</span><br><span class=\"line\">    <span class=\"comment\">// å¤±è´¥é˜Ÿåˆ—</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>._failCallbacks = []</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// ä¼ é€’å…³è”ä»»åŠ¡</span></span><br><span class=\"line\">    resolver(resolve, reject)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li><code>then</code> æ–¹æ³•</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">this</span>.prototype.then = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">onResolve, onReject</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// æ·»åŠ é—­åŒ…è°ƒç”¨</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> promise = <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;&#125;)</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// ä¿å­˜å¯¹ä¸Šä¸€ä¸ª promise çš„å¼•ç”¨</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>._doneCallbacks.push(makeCallback(promise, onResolve, <span class=\"string\">'reslove'</span>))</span><br><span class=\"line\">    <span class=\"keyword\">this</span>._failCallbacks.push(makeCallback(promise, onReject, <span class=\"string\">'reject'</span>))</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> promise</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li><code>makeCallback</code> å‡½æ•°</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// promise å¯¹è±¡/ å›è°ƒå‡½æ•°(å…³è”ä»»åŠ¡)/ ç±»å‹</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">makeCallback</span> (<span class=\"params\">promise, callback, action</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">promiseCallback</span> (<span class=\"params\">value</span>) </span>&#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li><code>resolve</code> å‡½æ•°å’Œ <code>reject</code> å‡½æ•°<br>è¿™ä¸¤ä¸ªå‡½æ•°éƒ½éœ€è¦ä¸€ä¸ªå‚æ•°æ¥æ¥æ”¶ç»“æœ, ç”±äºçŠ¶æ€åªèƒ½è½¬æ¢ä¸€æ¬¡æ‰€ä»¥ä¸¤ä¸ªå‡½æ•°éƒ½éœ€è¦åˆ¤æ–­çŠ¶æ€.</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// æˆåŠŸ</span></span><br><span class=\"line\"><span class=\"comment\">// promise: å±äºå“ªä¸ª promise å¯¹è±¡</span></span><br><span class=\"line\"><span class=\"comment\">// data: å¼‚æ­¥æ“ä½œçš„ç»“æœ</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">resolve</span> (<span class=\"params\">promise, data</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// å·²ç»è¢« resolve è¿‡çš„è¯ç›´æ¥è¿”å›</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (promise._status !== <span class=\"string\">'pending'</span>) <span class=\"keyword\">return</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// ä¿®æ”¹ promise çŠ¶æ€</span></span><br><span class=\"line\">    promise._status = <span class=\"string\">'fulfilled'</span></span><br><span class=\"line\">    <span class=\"comment\">// ä¿å­˜å¼‚æ­¥æ“ä½œçš„å€¼</span></span><br><span class=\"line\">    promise._value = data</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// æ‰§è¡Œç›¸å…³å›è°ƒå‡½æ•°</span></span><br><span class=\"line\">    run(promise)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å¤±è´¥</span></span><br><span class=\"line\"><span class=\"comment\">// promise: å±äºå“ªä¸ª promise å¯¹è±¡</span></span><br><span class=\"line\"><span class=\"comment\">// reason: å¤±è´¥åŸå› </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">reject</span> (<span class=\"params\">promise, reason</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (promise._status !== <span class=\"string\">'pending'</span>) <span class=\"keyword\">return</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    promise._status = <span class=\"string\">'rejected'</span></span><br><span class=\"line\">    promise._value = reason</span><br><span class=\"line\">    </span><br><span class=\"line\">    run(promise)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li><code>run</code> å‡½æ•°<br>ç”¨æ¥æ‰§è¡Œå¼‚æ­¥ç›¸å…³çš„å›è°ƒå‡½æ•°.</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">run</span> (<span class=\"params\">promise</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// then æ–¹æ³•ä¸­ä¹Ÿä¼šè°ƒç”¨, æ­¤å¤„å†åšä¸€æ¬¡åˆ¤æ–­</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (promise._status === <span class=\"string\">'pending'</span>) <span class=\"keyword\">return</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">let</span> value = promise._value</span><br><span class=\"line\">    <span class=\"comment\">// æ˜¯å¦æˆåŠŸ</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> callbacks = promise._status === <span class=\"string\">'fulfilled'</span></span><br><span class=\"line\">        ? promise._doneCallbacks</span><br><span class=\"line\">        : promise._failCallbacks</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// è¿™é‡Œéœ€è¦å¼‚æ­¥</span></span><br><span class=\"line\">    setTimeout(<span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// æ‰§è¡Œå›è°ƒå‡½æ•°</span></span><br><span class=\"line\">        callbacks.map(<span class=\"function\"><span class=\"params\">cb</span> =&gt;</span> cb(value))</span><br><span class=\"line\">    &#125;, <span class=\"number\">0</span>)</span><br><span class=\"line\">    </span><br><span class=\"line\">    promise._doneCallbacks = []</span><br><span class=\"line\">    promise._failCallbacks = []</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong><code>run</code> å‡½æ•°ä¸­çš„ callbacks å°±æ˜¯ <code>makeCallback</code> æ‰€è¿”å›çš„å‡½æ•°</strong></p>\n<ul>\n<li>å®Œå–„ <code>makeCallback</code> å‡½æ•°</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">makeCallback</span> (<span class=\"params\">promise, callback, action</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">promiseCallback</span> (<span class=\"params\">value</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// å¦‚æœ callback æ˜¯ä¸ªå‡½æ•°, ä½¿ç”¨å‰ä¸€ä¸ª promise</span></span><br><span class=\"line\">        <span class=\"comment\">// ä¼ é€’çš„å€¼ä½œä¸º callback çš„å‚æ•°</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> callback === <span class=\"string\">'function'</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">let</span> x</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                x = callback(value)</span><br><span class=\"line\">            &#125;<span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// å¼‚å¸¸æ—¶, ç”¨å½“å‰ promise çš„ reject</span></span><br><span class=\"line\">                reject(promise, e)</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"comment\">// å¦‚æœ callback è¿”å›çš„æ˜¯å½“å‰çš„ promise</span></span><br><span class=\"line\">            <span class=\"comment\">// è¦æŠ›å‡ºå¼‚å¸¸</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (x === promise) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">let</span> reason = <span class=\"keyword\">new</span> <span class=\"built_in\">Error</span>(<span class=\"string\">'Error: return value could not be same with the promise'</span>)</span><br><span class=\"line\">                reject(promise, reason)</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"comment\">// å¦‚æœè¿”å›å€¼æ˜¯ä¸€ä¸ª promise å¯¹è±¡</span></span><br><span class=\"line\">            <span class=\"comment\">// åˆ™å½“è¿”å› promise å¯¹è±¡è¢« reoslve/ rejectå</span></span><br><span class=\"line\">            <span class=\"comment\">// å†æ‰§è¡Œå½“å‰çš„ promise çš„ resolve/ reject</span></span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (x <span class=\"keyword\">instanceof</span> <span class=\"built_in\">Promise</span>) &#123;</span><br><span class=\"line\">                x.then(</span><br><span class=\"line\">                    <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">data</span>) </span>&#123;</span><br><span class=\"line\">                        resolve(promise, data)</span><br><span class=\"line\">                    &#125;,</span><br><span class=\"line\">                    <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">reason</span>) </span>&#123;</span><br><span class=\"line\">                        reject(promise, reason)</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                )</span><br><span class=\"line\">            &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">let</span> then</span><br><span class=\"line\">                (<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">resolveThenable</span> (<span class=\"params\">x</span>) </span>&#123;</span><br><span class=\"line\">                    <span class=\"comment\">// å¦‚æœè¿”å›çš„æ˜¯ä¸€ä¸ª Thenable å¯¹è±¡</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (x &amp;&amp; (<span class=\"keyword\">typeof</span> x === <span class=\"string\">'object'</span> || <span class=\"keyword\">typeof</span> x === <span class=\"string\">'function'</span>)) &#123;</span><br><span class=\"line\">                        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                            then = x.then</span><br><span class=\"line\">                        &#125;<span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">                            reject(promise, e)</span><br><span class=\"line\">                            <span class=\"keyword\">return</span></span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                        </span><br><span class=\"line\">                        <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> then === <span class=\"string\">'function'</span>) &#123;</span><br><span class=\"line\">                            <span class=\"comment\">// è°ƒç”¨ Thenable å¯¹è±¡çš„ thenæ–¹æ³•</span></span><br><span class=\"line\">                            <span class=\"comment\">// ä¼ é€’è¿›å»çš„ resolvePromise å’Œ rejectPromise ä»¥åŠä¸‹é¢ä¸¤ä¸ªåŒ¿åå‡½æ•°</span></span><br><span class=\"line\">                            <span class=\"comment\">// å¯èƒ½ä¼šé‡å¤è°ƒç”¨, ä½†æ˜¯è§„èŒƒåªèƒ½æœ‰å…¶ä¸­ä¸€ä¸ªè¢«è°ƒç”¨ä¸€æ¬¡, å…¶ä»–è¦è¢«å¿½ç•¥</span></span><br><span class=\"line\">                            <span class=\"keyword\">let</span> invoked = <span class=\"literal\">false</span></span><br><span class=\"line\">                            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                                then.call(x,</span><br><span class=\"line\">                                    <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">y</span>) </span>&#123;</span><br><span class=\"line\">                                        <span class=\"keyword\">if</span> (invoked) <span class=\"keyword\">return</span></span><br><span class=\"line\">                                        invoked = <span class=\"literal\">true</span></span><br><span class=\"line\">                                        </span><br><span class=\"line\">                                        <span class=\"comment\">// é¿å…ä¸¤ä¸ª promise æ’ç­‰</span></span><br><span class=\"line\">                                        <span class=\"keyword\">if</span> (y === x) &#123;</span><br><span class=\"line\">                                            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Error</span>(<span class=\"string\">'Error: return value could not be same with the promise'</span>)</span><br><span class=\"line\">                                        &#125;</span><br><span class=\"line\">                                        </span><br><span class=\"line\">                                    <span class=\"comment\">// y æœ‰å¯èƒ½è¿˜æ˜¯ thenable å¯¹è±¡    </span></span><br><span class=\"line\">                                    resolveThenable(y)</span><br><span class=\"line\">                                    &#125;,</span><br><span class=\"line\">                                    <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">e</span>) </span>&#123;</span><br><span class=\"line\">                                        <span class=\"keyword\">if</span> (invoked) <span class=\"keyword\">return</span></span><br><span class=\"line\">                                        invoked = <span class=\"literal\">true</span></span><br><span class=\"line\">                                        </span><br><span class=\"line\">                                        reject(promise, e)</span><br><span class=\"line\">                                    &#125;</span><br><span class=\"line\">                                )</span><br><span class=\"line\">                            &#125;<span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">                                    <span class=\"comment\">// å¦‚æœ`resolvePromise`å’Œ`rejectPromise`æ–¹æ³•è¢«è°ƒç”¨åï¼Œå†æŠ›å‡ºå¼‚å¸¸ï¼Œåˆ™å¿½ç•¥å¼‚å¸¸</span></span><br><span class=\"line\">                                    <span class=\"comment\">// å¦åˆ™ç”¨å¼‚å¸¸å¯¹è±¡rejectæ­¤Promiseå¯¹è±¡</span></span><br><span class=\"line\">                                <span class=\"keyword\">if</span> (!invoked) &#123;</span><br><span class=\"line\">                                    reject(promise, e)</span><br><span class=\"line\">                                &#125;</span><br><span class=\"line\">                            &#125;</span><br><span class=\"line\">                        &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                            resolve(promise, x)</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                        resolve(promise, x)</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;(x))</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// å¦‚æœæ²¡æœ‰ä¼  callbackç›´æ¥ä½¿ç”¨å‰ä¸€ä¸ª promise</span></span><br><span class=\"line\">        <span class=\"comment\">// ä¼ è¿‡æ¥çš„å€¼ resolve/reject å½“å‰ promise å¯¹è±¡</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            action === <span class=\"string\">'resolve'</span></span><br><span class=\"line\">                ? resolve(promise, value)</span><br><span class=\"line\">                : reject(promise, value)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h4><p>æˆ‘ä¸€å¼€å§‹æ˜¯å…ˆçœ‹çš„<strong>å‰–æ Promise ä¹‹åŸºç¡€ç¯‡</strong>, å‰åŠéƒ¨åˆ†ç¡®å®å¾ˆäº²æ°‘, ä½†æ˜¯åˆ°åŠ å…¥ <code>hanlde</code> å’Œæ”¹é€  <code>resolve</code> å‡½æ•° å°±å¼€å§‹æ‡µäº†, ç„¶åæ‡µæ‡µæ‡‚æ‡‚çš„å»çœ‹<strong>JS Promise çš„åŸç†å®ç°</strong>, ä¸è¿‡åœ¨æœ€å¤æ‚çš„ <code>makeCallback</code> å‡½æ•°ä¸­è§£é‡Šæœ‰ç‚¹ä¸€ç¬”å¸¦è¿‡çš„æ„æ€. ä¸è¿‡çœ‹äº†è¿™ç¯‡å¸®åŠ©æˆ‘ç†è§£ä¹‹å‰çš„<strong>å‰–æ Promise ä¹‹åŸºç¡€ç¯‡</strong>, å°±è¿”å›å»çœ‹åŸºç¡€ç¯‡ç”»äº†ä¸€éæµç¨‹å›¾æ‰ç®—çœ‹æ‡‚, é‡Œé¢çš„é—­åŒ…ç”¨çš„å¤ªç²¾å¦™äº†.</p>\n<blockquote>\n<p>å‚è€ƒæ–‡ç« <br><a href=\"https://tech.meituan.com/promise-insight.html\" target=\"_blank\" rel=\"noopener\">å‰–æ Promise ä¹‹åŸºç¡€ç¯‡</a><br><a href=\"http://bruce-xu.github.io/blogs/js/promise\" target=\"_blank\" rel=\"noopener\">JS Promise çš„åŸç†å®ç°</a><br><a href=\"https://github.com/xieranmaya/blog/issues/3\" target=\"_blank\" rel=\"noopener\">å‰–æPromiseå†…éƒ¨ç»“æ„</a></p>\n</blockquote>\n<p>Created on 2017-12-26 by Cara</p>\n","site":{"data":{}},"excerpt":"","more":"<p>Promise æ˜¯ ES6ä¸­ä¸­æ”¶å½•çš„å¼‚æ­¥æ“ä½œå°è£…, é€šå¸¸åœ¨å›è°ƒ/ äº‹ä»¶/ æ¶ˆæ¯ç­‰å¼‚æ­¥æ“ä½œä¸­æœ‰æ˜¾è‘—çš„ä¼˜åŠ¿, è®©æˆ‘ä»¬åœ¨æ›´æ–¹ä¾¿çš„æ“ä½œå¼‚æ­¥ä¹Ÿè®©ä»£ç æ›´åŠ æ¸…æ™°.åŒ…æ‹¬ ES7ä¸­çš„ Async/Await ä¹Ÿæ˜¯å¯¹å¼‚æ­¥æ“ä½œçš„å°è£…, ä¸è¿‡ Async æ›´åƒæ˜¯ Generator çš„è¯­æ³•ç³–.</p>\n<h3 id=\"åŸºç¡€å®ç°\"><a href=\"#åŸºç¡€å®ç°\" class=\"headerlink\" title=\"åŸºç¡€å®ç°\"></a>åŸºç¡€å®ç°</h3><p>å­¦ä¹ <a href=\"https://tech.meituan.com/promise-insight.html\" target=\"_blank\" rel=\"noopener\">å‰–æ Promise ä¹‹åŸºç¡€ç¯‡</a>ç”¨ä¸€ä¸ªæœ€å¸¸è§çš„åº”ç”¨æ¥å‰–æ <code>Promise</code>, é€šè¿‡å¼‚æ­¥è·å–ç”¨æˆ· Id, ç„¶åä½œä¸€äº›å¤„ç†. å¹³å¸¸æˆ‘ä»¬æœ€å¸¸ç”¨çš„æ˜¯å›è°ƒçš„æ–¹å¼æ¥å¤„ç†, ä¸‹é¢ç”¨ <code>Promise</code> çš„æ–¹å¼æ¥å¤„ç†.<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> getUserId = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        axios.get(<span class=\"string\">'http://example.com/api'</span>, <span class=\"attr\">params</span>: param).then(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">            resolve(<span class=\"built_in\">JSON</span>.parse(res).id)</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">getUserId().then(<span class=\"function\"><span class=\"params\">id</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(id)</span><br><span class=\"line\">    <span class=\"comment\">// do something...</span></span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure></p>\n<p>getUserId å‡½æ•°è¿”å›ä¸€ä¸ª <code>Promise</code>, åœ¨ä»–çš„ <code>then</code> æ–¹æ³•ä¸­æ”¾å…¥å¼‚æ­¥æ“ä½œæˆåŠŸä¹‹åçš„å›è°ƒå‡½æ•°. è¿™ç§æ–¹å¼æ˜æ˜¾æ¯”æˆ‘ä»¬ä¹‹å‰å¸¸ç”¨çš„å›è°ƒå‡½æ•°æ›´åŠ æ–¹ä¾¿è€Œä¸”æ˜“è¯», ä¹Ÿæ›´åŠ å®¹æ˜“é¿å… callback hell.</p>\n<p>é‚£ä¹ˆæ»¡è¶³è¿™æ ·çš„åœºæ™¯çš„<code>Promise</code>æ˜¯æ€æ ·å®ç°çš„å‘¢, ä¸‹é¢æˆ‘ä»¬å¯ä»¥ç®€å•çš„å®ç°ä¸€ä¸‹æœ€åŸºç¡€çš„<code>Promise</code>:<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Promise</span> (<span class=\"params\">fn</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> value = <span class=\"literal\">null</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> deferreds = []</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// 4. å­˜å…¥å¼‚æ­¥æˆåŠŸéœ€è¦çš„å›è°ƒå‡½æ•°</span></span><br><span class=\"line\">    <span class=\"comment\">// æ­¤æ—¶æŒ‡å‘ä¸¤ä¸ªå›è°ƒå‡½æ•° id =&gt; &#123;&#125;</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.then = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">onFulfilled</span>) </span>&#123;</span><br><span class=\"line\">        deferreds.push(onFulfilled)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">this</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// 3. æ‰§è¡Œ deferreds é˜Ÿåˆ—ä¸­çš„å›è°ƒå‡½æ•°</span></span><br><span class=\"line\">    <span class=\"comment\">// æ­¤æ—¶ value ä¸º123</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">resolve</span> (<span class=\"params\">value</span>) </span>&#123;</span><br><span class=\"line\">        deferreds.map(<span class=\"function\"><span class=\"params\">deferred</span> =&gt;</span> &#123;</span><br><span class=\"line\">            deferred(value)</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// 1. æ‰§è¡Œåˆ›å»º Promise å®ä¾‹æ—¶ä¼ å…¥çš„å‡½æ•°</span></span><br><span class=\"line\">    <span class=\"comment\">// å¹¶ä¼ å…¥ resolve ä¾›åœ¨é€‚å½“æ—¶è§¦å‘å›è°ƒ</span></span><br><span class=\"line\">    fn(resolve)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> getUserId = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\"><span class=\"params\">resolve</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 2. æ‰§è¡Œ resolve</span></span><br><span class=\"line\">        resolve(<span class=\"number\">123</span>)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">getUserId().then( <span class=\"function\"><span class=\"params\">id</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'this is callback!'</span>)</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(id) <span class=\"comment\">// 123</span></span><br><span class=\"line\">&#125;).then(<span class=\"function\"><span class=\"params\">id</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'this is second callback!'</span>)</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(id) <span class=\"comment\">// 123</span></span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>è°ƒç”¨ <code>then</code> æ–¹æ³•å°†å›è°ƒå‡½æ•°å­˜å…¥ deferreds é˜Ÿåˆ—.</li>\n<li>åˆ›å»º <code>Promise</code> å®ä¾‹æ—¶ä¼ å…¥å‡½æ•°å’Œ <code>resolve</code>, <code>resolve</code> ç”¨äºåœ¨é€‚å½“çš„æ—¶é—´è§¦å‘å›è°ƒå‡½æ•°.</li>\n<li>çœŸæ­£æ‰§è¡Œå›è°ƒå‡½æ•°çš„æ˜¯ <code>deferreds</code> é˜Ÿåˆ—ä¸­çš„å…ƒç´ .</li>\n<li><code>resolve</code> å‡½æ•°æ¥å—ä¸€ä¸ªå‚æ•°, ç”¨äºå›è°ƒå‡½æ•°ä½¿ç”¨, å³å¼‚æ­¥æ“ä½œçš„è¿”å›ç»“æœ.</li>\n</ul>\n<p>å¯èƒ½å¤§å®¶å·²ç»å‘ç°, ä»¥ä¸Šä»£ç å¹¶ä¸èƒ½çœŸæ­£æ‰§è¡Œåˆ°å›è°ƒå‡½æ•°.æ ¹æ®ä¸Šé¢æ ‡æ³¨çš„åºå·å°±æ˜¯ä»£ç çš„æ‰§è¡Œé¡ºåº, è¿™æ˜¯å› ä¸ºç°åœ¨è¿˜æ˜¯åŒæ­¥å‡½æ•°, <code>Promise</code> å‡½æ•°ä¸­çš„ <code>resolve</code> å‡½æ•°ä¼šå…ˆäº <code>this.then</code> å‡½æ•°æ‰§è¡Œ,æ­¤æ—¶ <code>deferreds</code> é˜Ÿåˆ—ä¸­è¿˜æ˜¯ç©ºçš„, ä»¥è‡³äºåé¢çš„å›è°ƒå‡½æ•°ä¹Ÿæ— æ³•æ‰§è¡Œ. æ‰€ä»¥æˆ‘ä»¬è¦ä¿è¯å›è°ƒä»¥å¼‚æ­¥çš„æ–¹å¼æ‰§è¡Œ, ä»¥ä¿è¯æ‰§è¡Œé¡ºåº. å¯ä»¥é€šè¿‡ <code>setTimeout</code> å°† <code>resolve</code> ä¸­çš„å›è°ƒå‡½æ•°æ”¾åœ¨æ‰§è¡Œæ ˆçš„æœ«å°¾.<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">resolve</span> (<span class=\"params\">value</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// å°†æ‰§è¡Œçš„å›è°ƒçš„é€»è¾‘æ”¾å…¥æ‰§è¡Œæ ˆæœ«å°¾</span></span><br><span class=\"line\">    setTimeout(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        deferreds.map(<span class=\"function\"><span class=\"params\">deferred</span> =&gt;</span> &#123;</span><br><span class=\"line\">            deferred(value)</span><br><span class=\"line\">        &#125;)    </span><br><span class=\"line\">    &#125;, <span class=\"number\">0</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>ç°åœ¨å°±å¯ä»¥çœ‹åˆ°, then ä¸­çš„å›è°ƒå‡½æ•°èƒ½å¤Ÿæ­£å¸¸æ‰§è¡Œäº†.</p>\n<h4 id=\"å¼•å…¥çŠ¶æ€\"><a href=\"#å¼•å…¥çŠ¶æ€\" class=\"headerlink\" title=\"å¼•å…¥çŠ¶æ€\"></a>å¼•å…¥çŠ¶æ€</h4><p>ç°åœ¨æˆ‘ä»¬å¼•å…¥è§„èŒƒ <code>Promises/A+</code> ä¸­æ‰€è¯´çš„ States, å®ƒæœ‰ä¸‰ä¸ªäº’æ–¥çš„çŠ¶æ€: pending/ fulfilled/ rejected.</p>\n<p>ç°åœ¨æˆ‘ä»¬æ¥æ”¹è¿›ä¸‹ä»£ç :<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Promise</span> (<span class=\"params\">fn</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> value = <span class=\"literal\">null</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> deferreds = []</span><br><span class=\"line\">    <span class=\"keyword\">let</span> state = <span class=\"string\">'pending'</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">this</span>.then = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">onFulfilled</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (state === <span class=\"string\">'pending'</span>) &#123;</span><br><span class=\"line\">            deferreds.push(onFulfilled)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">this</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        onFulfilled(value)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">this</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">resolve</span> (<span class=\"params\">newValue</span>) </span>&#123;</span><br><span class=\"line\">        value = newValue</span><br><span class=\"line\">        state = <span class=\"string\">'fulfilled'</span></span><br><span class=\"line\">        setTimeout(<span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">            deferreds.map(<span class=\"function\"><span class=\"params\">deferred</span> =&gt;</span> &#123;</span><br><span class=\"line\">                deferred(value)</span><br><span class=\"line\">            &#125;)</span><br><span class=\"line\">        &#125;, <span class=\"number\">0</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    fn(resolve)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"ä¸²è¡Œ-Promise\"><a href=\"#ä¸²è¡Œ-Promise\" class=\"headerlink\" title=\"ä¸²è¡Œ Promise\"></a>ä¸²è¡Œ Promise</h3><p>ä¸²è¡Œ <code>Promise</code> æ˜¯æŒ‡å½“ promise è¾¾åˆ° fuifilled çŠ¶æ€ä¹‹å, å†è¿›è¡Œä¸‹ä¸€ä¸ª promise. æ¯”å¦‚ä¸Šä¾‹ä¸­çš„æˆ‘ä»¬æ‹¿åˆ° userId ä¹‹åè¿˜éœ€è¦ç”¨è¿™ä¸ª userId å»è·å–ç”¨æˆ·çš„åç§°/ ä½å€/ æ‰‹æœºå·ç­‰å…¶ä»–ä¿¡æ¯.</p>\n<p>ä½¿ç”¨çš„ä¼ªä»£ç ç±»ä¼¼è¿™æ ·:<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">getUserId()</span><br><span class=\"line\">    .then(getUserInfoById)</span><br><span class=\"line\">    .then(<span class=\"function\"><span class=\"params\">userInfo</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// do something</span></span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"keyword\">const</span> getUserInfoById = <span class=\"function\"><span class=\"params\">id</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\"><span class=\"params\">resolve</span> =&gt;</span> &#123;</span><br><span class=\"line\">        axios.get(<span class=\"string\">'http://example.com/api'</span>, <span class=\"attr\">params</span>: &#123;</span><br><span class=\"line\">            id: <span class=\"number\">123</span></span><br><span class=\"line\">        &#125;).then(<span class=\"function\"><span class=\"params\">response</span> =&gt;</span> &#123;</span><br><span class=\"line\">            resolve(<span class=\"built_in\">JSON</span>.parse(response).info)</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">const</span> getUserId = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\"><span class=\"params\">resolve</span> =&gt;</span> &#123;</span><br><span class=\"line\">        resolve(<span class=\"number\">123</span>)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>ä¸²è¡Œçš„å›°éš¾åœ¨äºå¦‚ä½•å°†å‰åçš„ <code>Promise</code> è¡”æ¥èµ·æ¥, é¦–å…ˆå¯¹ <code>then</code> æ–¹æ³•æ”¹é€ :<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">this</span>.then = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">onFulfilled</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// bridge promise</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\"><span class=\"params\">resolve</span> =&gt;</span> &#123;</span><br><span class=\"line\">        handle(&#123;</span><br><span class=\"line\">            onFulfilled: onFulfilled || <span class=\"literal\">null</span>,</span><br><span class=\"line\">            resolve: resolve</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> handle = <span class=\"function\"><span class=\"params\">deferred</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (state === <span class=\"string\">'pending'</span>) &#123;</span><br><span class=\"line\">        deferreds.push(deferred)</span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> ret = deferred.onFulfilled(value)</span><br><span class=\"line\">    deferred.resolve(ret)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li><code>then</code> æ–¹æ³•ä¸­è¿”å›ä¸€ä¸ªæ–°åˆ›å»ºçš„ Promise å®ä¾‹ä½œä¸ºè¿”å›å€¼, è¿™æ˜¯ä¸²è¡Œçš„åŸºç¡€, ç”±äºè¿”å›ç±»å‹ä¸€æ ·æ‰€ä»¥ä¾ç„¶æ”¯æŒé“¾å¼.</li>\n<li><code>then</code> æ–¹æ³•ä¸­çš„å½¢å‚ <code>onFulfilled</code> å’Œæ–°åˆ›å»ºçš„ Promise å®ä¾‹ä¸­çš„ <code>resolve</code> å‡æ”¾å…¥å½“å‰ promise çš„ deferreds é˜Ÿåˆ—ä¸­.</li>\n<li><code>handle</code> æ–¹æ³•ä½œä¸ºå½“å‰ promise çš„å†…éƒ¨æ–¹æ³•, è¾ƒä¹‹å‰çš„ <code>then</code> æ–¹æ³•åªå¢åŠ äº†ä¸€è¡Œ<code>deferred.resolve(ret)</code>.</li>\n</ul>\n<p>åœ¨å½“å‰ promise çš„å¼‚æ­¥æˆåŠŸä¹‹åæ‰§è¡Œ <code>handle</code> æ–¹æ³•æ—¶, å…ˆæ‰§è¡Œ <code>onFulfilled</code> æ–¹æ³•, ç„¶åå°†å…¶è¿”å›å€¼ä½œä¸º <code>resolve</code> æ–¹æ³•çš„å®å‚ä¼ å…¥.</p>\n<p>å†æ”¹é€  <code>resolve</code> æ–¹æ³•, æŠŠä»£ç æ•´ç†ä¸€ä¸‹:<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Promise</span> (<span class=\"params\">fn</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> value = <span class=\"literal\">null</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> deferreds = []</span><br><span class=\"line\">    <span class=\"keyword\">let</span> state = <span class=\"string\">'pending'</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">this</span>.then = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">onFulfilled</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// åˆ›å»ºä¸€ä¸ªæ–°çš„ Promiseä½œä¸ºè¿”å›å€¼</span></span><br><span class=\"line\">        <span class=\"comment\">// å°†å½“å‰ promise çš„å›è°ƒå‡½æ•°å’Œæ–°åˆ›å»ºçš„ resolve</span></span><br><span class=\"line\">        <span class=\"comment\">// æ”¾å…¥ deferreds é˜Ÿåˆ—</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span> (<span class=\"function\"><span class=\"params\">resolve</span> =&gt;</span> &#123;</span><br><span class=\"line\">            handle(&#123;</span><br><span class=\"line\">                onFulfilled: onFulfilled || <span class=\"literal\">null</span></span><br><span class=\"line\">                resolve: resolve</span><br><span class=\"line\">            &#125;)</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> handle = <span class=\"function\"><span class=\"params\">deferred</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// åˆå§‹åŒ–çŠ¶æ€æ—¶, å¾€ deferreds é˜Ÿåˆ—æ·»åŠ </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (state === <span class=\"string\">'pending'</span>) &#123;</span><br><span class=\"line\">            deferreds.push(deferred)</span><br><span class=\"line\">            <span class=\"keyword\">return</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// å½“å‰ promise è¾¾åˆ° 'fulfilled' çŠ¶æ€ä¹‹å</span></span><br><span class=\"line\">        <span class=\"comment\">// å…ˆæ‰§è¡Œå›è°ƒå‡½æ•°, å†å°†å›è°ƒå‡½æ•°çš„è¿”å›å€¼(ret)</span></span><br><span class=\"line\">        <span class=\"comment\">// ä¼ é€’ç»™ resolve å‡½æ•°</span></span><br><span class=\"line\">        <span class=\"keyword\">let</span> ret = deferred.onFulfilled(value)</span><br><span class=\"line\">        deferred.resolve(ret)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">const</span> resolve = <span class=\"function\"><span class=\"params\">newValue</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (newValue &amp;&amp; (<span class=\"keyword\">typeof</span> newValue === <span class=\"string\">'object'</span> || <span class=\"keyword\">typeof</span> newValue === <span class=\"string\">'function'</span>)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">let</span> then = newValue.then</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> then === <span class=\"string\">'function'</span>) &#123;</span><br><span class=\"line\">                then.call(newValue, resolve)</span><br><span class=\"line\">                <span class=\"keyword\">return</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        value = newValue</span><br><span class=\"line\">        state = <span class=\"string\">'fulfilled'</span></span><br><span class=\"line\">        setTimeout(<span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">            deferreds.map(<span class=\"function\"><span class=\"params\">deferred</span> =&gt;</span> &#123;</span><br><span class=\"line\">                handle(deferred)</span><br><span class=\"line\">            &#125;)</span><br><span class=\"line\">        &#125;, <span class=\"number\">0</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// æ‰§è¡Œ promise å®ä¾‹ä¸­çš„å›è°ƒå‡½æ•°</span></span><br><span class=\"line\">    fn(resolve)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">getUserId()</span><br><span class=\"line\">    .then(getUserInfoById)</span><br><span class=\"line\">    .then(<span class=\"function\"><span class=\"params\">userInfo</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// do something</span></span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(<span class=\"string\">'this is second callback'</span>)</span><br><span class=\"line\">    &#125;)</span><br></pre></td></tr></table></figure></p>\n<p>ç°åœ¨ <code>resolve</code> æ”¯æŒä¼ å…¥ä¸€ä¸ª promise å®ä¾‹çš„å‚æ•°äº†, æ‰§è¡Œé¡ºåºå¦‚ä¸‹:</p>\n<ol>\n<li><code>getUserId</code> ç”Ÿæˆçš„ promise1, è¿›å…¥ Promise å‡½æ•°æ‰§è¡Œ <code>fn(resolve)</code> ç”±äº<code>getUserId</code> çš„å†…éƒ¨æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œ, ä¸‹ä¸€æ­¥ä¼šç›´æ¥æ‰§è¡Œ <code>this.then(onFulfilled)</code>.</li>\n<li><code>this.then()</code> è¿”å›ä¸€ä¸ªæ–°çš„ promise2 å‡½æ•°( å³: bridge promise)ä½œä¸ºé“¾å¼è°ƒç”¨, promise2 é‡æ–°å®ä¾‹åŒ–å†æ‰§è¡Œ <code>fn(resolve)</code>, åˆ™è¿›å…¥<code>handle({...})</code> æ­¤æ—¶ handle çš„å‚æ•°ä¸º getUserInfoById å’Œ resolve2, æ¥ç€è¢« push åˆ° <code>deferreds1</code> é˜Ÿåˆ—ä¸­; å†æ¥ç€æ‰§è¡Œä¸‹ä¸€ä¸ª<code>this.then()</code> ç”Ÿæˆ promise3, <code>deferreds2</code> é˜Ÿåˆ—ä¸­ push è¿›ç¬¬äºŒä¸ª then çš„åŒ¿åå‡½æ•°(userInfo =&gt; {â€¦}) å’Œ resolve3.</li>\n<li>æ‰§è¡Œ<code>resolve(123)</code>, è¿›å…¥ <code>resolve(newValue)</code> æ‰§è¡Œ<code>handle(deferred)</code> æ­¤æ—¶ deferred ä¸º getUserInfoById å’Œ resolve2, æ‰§è¡Œ handle å†…éƒ¨çš„ <code>deferred.onFulfilled(value)</code> ä¹Ÿå°±æ˜¯ getUserInfoById æ–¹æ³•ä»è€Œç”Ÿæˆ promise4, å†åˆ° <code>deferred.resolve(ret)</code> è¿™ä¸ªæ—¶å€™ ret å°±ä¸º promise4, ä¼ å…¥ <code>resolve(newValue)</code> æ‰§è¡Œ <code>then.call(promise4, resolve2)</code>.</li>\n<li>æ¥ç€ä¸Šä¸€æ­¥è¿›å…¥ <code>this.then()</code> ç”Ÿæˆ promise5(bridge promise), deferred4 å‹å…¥ resolve2 å’Œ resolve5; åœ¨æ‰§è¡Œ getUserInfoById ä¸­çš„ <code>resolve({name: &#39;cara&#39;...})</code>, è¿›å…¥ setTimeout ä¸­çš„ <code>handle(deferred)</code>, åˆ° handle å‡½æ•°å†…éƒ¨ <code>deferred.onFulfilled(value)</code> å…¶å®æ‰§è¡Œçš„æ˜¯ <code>resolve2({...})</code> resolve2ä¸­çš„ <code>deferred</code> ä¿å­˜çš„æ˜¯çš„ <code>uerInfo =&gt; {}</code> åŒ¿åå‡½æ•°å’Œ <code>resolve3</code>; <code>deferred.resolve</code> å…¶å®æ‰§è¡Œçš„æ˜¯ <code>resolve5</code>, ç”±äº resolve3 å’Œ resolve5 ä¸­çš„ <code>deferred</code> éƒ½æ˜¯ç©ºçš„äºæ˜¯å®Œæˆæ•´ä¸ªæµç¨‹.</li>\n</ol>\n<p>æ¥ä¸‹æ¥å†åŠ å…¥é”™è¯¯å¤„ç†å’Œå¼‚å¸¸åˆ¤æ–­:<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Promise</span>(<span class=\"params\">fn</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> state = <span class=\"string\">'pending'</span>,</span><br><span class=\"line\">        value = <span class=\"literal\">null</span>,</span><br><span class=\"line\">        deferreds = [];</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.then = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">onFulfilled, onRejected</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">resolve, reject</span>) </span>&#123;</span><br><span class=\"line\">            handle(&#123;</span><br><span class=\"line\">                onFulfilled: onFulfilled || <span class=\"literal\">null</span>,</span><br><span class=\"line\">                onRejected: onRejected || <span class=\"literal\">null</span>,</span><br><span class=\"line\">                resolve: resolve,</span><br><span class=\"line\">                reject: reject</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">handle</span>(<span class=\"params\">deferred</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (state === <span class=\"string\">'pending'</span>) &#123;</span><br><span class=\"line\">            deferreds.push(deferred);</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">var</span> cb = state === <span class=\"string\">'fulfilled'</span> </span><br><span class=\"line\">            ? deferred.onFulfilled </span><br><span class=\"line\">            : deferred.onRejected,</span><br><span class=\"line\">                ret;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (cb === <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">            cb = state === <span class=\"string\">'fulfilled'</span> </span><br><span class=\"line\">                ? deferred.resolve </span><br><span class=\"line\">                : deferred.reject;</span><br><span class=\"line\">            cb(value);</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            ret = cb(value);</span><br><span class=\"line\">            deferred.resolve(ret);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">            deferred.reject(e);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">resolve</span>(<span class=\"params\">newValue</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (newValue &amp;&amp; (<span class=\"keyword\">typeof</span> newValue === <span class=\"string\">'object'</span> || <span class=\"keyword\">typeof</span> newValue === <span class=\"string\">'function'</span>)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> then = newValue.then;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> then === <span class=\"string\">'function'</span>) &#123;</span><br><span class=\"line\">                then.call(newValue, resolve, reject);</span><br><span class=\"line\">                <span class=\"keyword\">return</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        state = <span class=\"string\">'fulfilled'</span>;</span><br><span class=\"line\">        value = newValue;</span><br><span class=\"line\">        finale();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">reject</span>(<span class=\"params\">reason</span>) </span>&#123;</span><br><span class=\"line\">        state = <span class=\"string\">'rejected'</span>;</span><br><span class=\"line\">        value = reason;</span><br><span class=\"line\">        finale();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">finale</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        setTimeout(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">            deferreds.forEach(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">deferred</span>) </span>&#123;</span><br><span class=\"line\">                handle(deferred);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;, <span class=\"number\">0</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    fn(resolve, reject);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><strong>ä¹‹å‰çš„æ–‡å­—æè¿°ä¸å¥½ç†è§£, æ‰€ä»¥è¿˜æ˜¯ç”»äº†ä¸€ä¸ªæ‰§è¡Œæµç¨‹å›¾</strong><br><img src=\"/img/Promiseæ‰§è¡Œè¿‡ç¨‹.png\" alt=\"promiseæ‰§è¡Œè¿‡ç¨‹\"></p>\n<p>æ²¡æœ‰ç”» <code>reject</code> çš„æƒ…å†µ, å› ä¸º<code>reject</code> è·Ÿ <code>resolve</code> çš„æµç¨‹æ˜¯ä¸€æ ·çš„, ä¸¤ä¸ªä¸€èµ·ç”»æ˜¾å¾—æ›´ä¹±å°±å•ç‹¬æŠŠ <code>resolve</code> æ‹å‡ºæ¥. åœ¨åŠ å…¥ <code>handle</code> å’Œ <code>resolve</code> åœ¨ promise å‡½æ•°ä¸­ä½œä¸ºå†…éƒ¨æ–¹æ³•åå®åœ¨ä¸æ˜“ç†è§£. ä¸»è¦å°±æ˜¯é€šè¿‡é—­åŒ…æ¥ä¿å­˜ promise å¯¹è±¡çš„å˜é‡å¼•ç”¨, å°†å›è°ƒå‡½æ•°å’Œ resolve å‡½æ•°ä¿å­˜åœ¨ç¼“å­˜é˜Ÿåˆ—ä¸­, åœ¨é€šè¿‡ resolve å®Œæˆé“¾å¼è°ƒç”¨.</p>\n<h2 id=\"å…¶ä»–å®ç°\"><a href=\"#å…¶ä»–å®ç°\" class=\"headerlink\" title=\"å…¶ä»–å®ç°\"></a>å…¶ä»–å®ç°</h2><p>çœ‹å®Œä¹‹å‰çš„é‚£ç¯‡æ–‡ç« å®åœ¨è§‰å¾—æœ‰ç‚¹éš¾ç†è§£, äºæ˜¯åˆæ‰¾äº†å…¶ä»–çš„å®ç°æ–¹å¼<a href=\"http://bruce-xu.github.io/blogs/js/promise\" target=\"_blank\" rel=\"noopener\">JS Promiseçš„å®ç°åŸç†</a>æ¯”ä¹‹å‰é‚£ç¯‡æ›´å¥½ç†è§£ä¸€äº›, æ‰€ä»¥è¿˜æ˜¯è®°å½•ä¸€ä¸‹å¥½äº†.</p>\n<blockquote>\n<p>è¿™ç¯‡æ–‡ç« ä½œè€…è¯´åˆ°çš„ <code>Promise</code> é‡ç‚¹:</p>\n<ol>\n<li><code>Promise</code> æ˜¯ä¸€ä¸ªæ‰¿è¯º, æ‰€ä»¥ä¸ç®¡æˆåŠŸä¸å¦éƒ½è¦æœ‰ä¸€ä¸ªæ‰§è¡Œç»“æœ, å› æ­¤ Promise æ„é€ å‡½æ•°æœ‰ä¸€ä¸ªå‡½æ•°ç±»å‹çš„å‚æ•° <code>resolver</code> æ¥ä½œä¸ºä¸è¯¥ promise å¯¹è±¡å…³è”çš„ä»»åŠ¡.</li>\n<li>ä¸‰ç§çŠ¶æ€ä¸å¯é€†è½¬.</li>\n<li><code>resolver</code> å‡½æ•°å°è£…äº†éœ€è¦æ‰§è¡Œçš„å¼‚æ­¥æ“ä½œ, å†…éƒ¨: <code>resolve</code> å’Œ <code>reject</code> ä¸¤ä¸ªå‚æ•°; åˆ†åˆ«ä»£è¡¨æ‰§è¡ŒæˆåŠŸå’Œæ‰§è¡Œå¤±è´¥éœ€è¦æ‰§è¡Œçš„æ“ä½œ.</li>\n<li><code>then</code> æä¾›æˆåŠŸæˆ–å¤±è´¥çš„å“åº”å¤„ç†, äºæ˜¯æœ‰äº†<code>onResolve</code> å’Œ <code>onReject</code>.</li>\n<li><code>then</code> æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°çš„ promise(bridge promise), æä¾›é“¾å¼æ“ä½œåŠä¸²è¡Œ, å¦‚æœç›´æ¥è¿”å› this é‚£ä¹ˆå°±æ˜¯å¹¶è¡Œæ˜¾ç„¶ä¸ç¬¦åˆæˆ‘ä»¬çš„éœ€æ±‚. å‰ä¸€ä¸ª promise éœ€è¦çŸ¥é“ä¸‹ä¸€ä¸ª promise å¯¹è±¡æ˜¯è°åŠå…¶ä»»åŠ¡å¼•ç”¨, è€Œåä¸€ä¸ª promise è¦æä¾›ä¸€ä¸ªç»™å‰ä¸€ä¸ª promise æˆåŠŸæˆ–å¤±è´¥æ—¶éœ€è¦æ‰§è¡Œçš„ä»»åŠ¡, å› æ­¤æ·»åŠ ä¸€ä¸ªé—­åŒ…</li>\n<li><code>makeCallback</code> è°ƒç”¨å°† promise åŠå…¶å…³è”ä»»åŠ¡ä¼ é€’è¿›å», è¿”å›ä¸€ä¸ªæ–°å‡½æ•°, å‰ä¸€ä¸ª promise å¯¹è±¡å°±å°†æŒæœ‰è¿”å›å‡½æ•°çš„å¼•ç”¨, è°ƒç”¨è¿”å›å‡½æ•°æ—¶å°±èƒ½è®¿é—®åˆ° promise å¯¹è±¡å’Œå…³è”ä»»åŠ¡.</li>\n<li><code>resolve</code> å’Œ <code>reject</code> å‡½æ•°åœ¨å¼‚æ­¥æˆåŠŸæˆ–å¤±è´¥çš„æ—¶å€™è°ƒç”¨, å¹¶ä¼ é€’æˆåŠŸçš„æ•°æ®å’Œå¤±è´¥çš„åŸå› .</li>\n<li><code>run</code> å‡½æ•°æ‰§è¡Œå¼‚æ­¥ç›¸å…³çš„å›è°ƒå‡½æ•°.</li>\n</ol>\n</blockquote>\n<h3 id=\"ä»£ç ç»“æ„\"><a href=\"#ä»£ç ç»“æ„\" class=\"headerlink\" title=\"ä»£ç ç»“æ„\"></a>ä»£ç ç»“æ„</h3><ul>\n<li>æ„é€ å‡½æ•°</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Promise</span> (<span class=\"params\">resolver</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// çŠ¶æ€</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>._status = <span class=\"string\">'pending'</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// æˆåŠŸé˜Ÿåˆ—</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>._doneCallbacks = []</span><br><span class=\"line\">    <span class=\"comment\">// å¤±è´¥é˜Ÿåˆ—</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>._failCallbacks = []</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// ä¼ é€’å…³è”ä»»åŠ¡</span></span><br><span class=\"line\">    resolver(resolve, reject)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li><code>then</code> æ–¹æ³•</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">this</span>.prototype.then = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">onResolve, onReject</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// æ·»åŠ é—­åŒ…è°ƒç”¨</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> promise = <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;&#125;)</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// ä¿å­˜å¯¹ä¸Šä¸€ä¸ª promise çš„å¼•ç”¨</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>._doneCallbacks.push(makeCallback(promise, onResolve, <span class=\"string\">'reslove'</span>))</span><br><span class=\"line\">    <span class=\"keyword\">this</span>._failCallbacks.push(makeCallback(promise, onReject, <span class=\"string\">'reject'</span>))</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> promise</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li><code>makeCallback</code> å‡½æ•°</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// promise å¯¹è±¡/ å›è°ƒå‡½æ•°(å…³è”ä»»åŠ¡)/ ç±»å‹</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">makeCallback</span> (<span class=\"params\">promise, callback, action</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">promiseCallback</span> (<span class=\"params\">value</span>) </span>&#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li><code>resolve</code> å‡½æ•°å’Œ <code>reject</code> å‡½æ•°<br>è¿™ä¸¤ä¸ªå‡½æ•°éƒ½éœ€è¦ä¸€ä¸ªå‚æ•°æ¥æ¥æ”¶ç»“æœ, ç”±äºçŠ¶æ€åªèƒ½è½¬æ¢ä¸€æ¬¡æ‰€ä»¥ä¸¤ä¸ªå‡½æ•°éƒ½éœ€è¦åˆ¤æ–­çŠ¶æ€.</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// æˆåŠŸ</span></span><br><span class=\"line\"><span class=\"comment\">// promise: å±äºå“ªä¸ª promise å¯¹è±¡</span></span><br><span class=\"line\"><span class=\"comment\">// data: å¼‚æ­¥æ“ä½œçš„ç»“æœ</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">resolve</span> (<span class=\"params\">promise, data</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// å·²ç»è¢« resolve è¿‡çš„è¯ç›´æ¥è¿”å›</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (promise._status !== <span class=\"string\">'pending'</span>) <span class=\"keyword\">return</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// ä¿®æ”¹ promise çŠ¶æ€</span></span><br><span class=\"line\">    promise._status = <span class=\"string\">'fulfilled'</span></span><br><span class=\"line\">    <span class=\"comment\">// ä¿å­˜å¼‚æ­¥æ“ä½œçš„å€¼</span></span><br><span class=\"line\">    promise._value = data</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// æ‰§è¡Œç›¸å…³å›è°ƒå‡½æ•°</span></span><br><span class=\"line\">    run(promise)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å¤±è´¥</span></span><br><span class=\"line\"><span class=\"comment\">// promise: å±äºå“ªä¸ª promise å¯¹è±¡</span></span><br><span class=\"line\"><span class=\"comment\">// reason: å¤±è´¥åŸå› </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">reject</span> (<span class=\"params\">promise, reason</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (promise._status !== <span class=\"string\">'pending'</span>) <span class=\"keyword\">return</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    promise._status = <span class=\"string\">'rejected'</span></span><br><span class=\"line\">    promise._value = reason</span><br><span class=\"line\">    </span><br><span class=\"line\">    run(promise)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li><code>run</code> å‡½æ•°<br>ç”¨æ¥æ‰§è¡Œå¼‚æ­¥ç›¸å…³çš„å›è°ƒå‡½æ•°.</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">run</span> (<span class=\"params\">promise</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// then æ–¹æ³•ä¸­ä¹Ÿä¼šè°ƒç”¨, æ­¤å¤„å†åšä¸€æ¬¡åˆ¤æ–­</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (promise._status === <span class=\"string\">'pending'</span>) <span class=\"keyword\">return</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">let</span> value = promise._value</span><br><span class=\"line\">    <span class=\"comment\">// æ˜¯å¦æˆåŠŸ</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> callbacks = promise._status === <span class=\"string\">'fulfilled'</span></span><br><span class=\"line\">        ? promise._doneCallbacks</span><br><span class=\"line\">        : promise._failCallbacks</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// è¿™é‡Œéœ€è¦å¼‚æ­¥</span></span><br><span class=\"line\">    setTimeout(<span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// æ‰§è¡Œå›è°ƒå‡½æ•°</span></span><br><span class=\"line\">        callbacks.map(<span class=\"function\"><span class=\"params\">cb</span> =&gt;</span> cb(value))</span><br><span class=\"line\">    &#125;, <span class=\"number\">0</span>)</span><br><span class=\"line\">    </span><br><span class=\"line\">    promise._doneCallbacks = []</span><br><span class=\"line\">    promise._failCallbacks = []</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong><code>run</code> å‡½æ•°ä¸­çš„ callbacks å°±æ˜¯ <code>makeCallback</code> æ‰€è¿”å›çš„å‡½æ•°</strong></p>\n<ul>\n<li>å®Œå–„ <code>makeCallback</code> å‡½æ•°</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">makeCallback</span> (<span class=\"params\">promise, callback, action</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">promiseCallback</span> (<span class=\"params\">value</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// å¦‚æœ callback æ˜¯ä¸ªå‡½æ•°, ä½¿ç”¨å‰ä¸€ä¸ª promise</span></span><br><span class=\"line\">        <span class=\"comment\">// ä¼ é€’çš„å€¼ä½œä¸º callback çš„å‚æ•°</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> callback === <span class=\"string\">'function'</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">let</span> x</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                x = callback(value)</span><br><span class=\"line\">            &#125;<span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// å¼‚å¸¸æ—¶, ç”¨å½“å‰ promise çš„ reject</span></span><br><span class=\"line\">                reject(promise, e)</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"comment\">// å¦‚æœ callback è¿”å›çš„æ˜¯å½“å‰çš„ promise</span></span><br><span class=\"line\">            <span class=\"comment\">// è¦æŠ›å‡ºå¼‚å¸¸</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (x === promise) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">let</span> reason = <span class=\"keyword\">new</span> <span class=\"built_in\">Error</span>(<span class=\"string\">'Error: return value could not be same with the promise'</span>)</span><br><span class=\"line\">                reject(promise, reason)</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"comment\">// å¦‚æœè¿”å›å€¼æ˜¯ä¸€ä¸ª promise å¯¹è±¡</span></span><br><span class=\"line\">            <span class=\"comment\">// åˆ™å½“è¿”å› promise å¯¹è±¡è¢« reoslve/ rejectå</span></span><br><span class=\"line\">            <span class=\"comment\">// å†æ‰§è¡Œå½“å‰çš„ promise çš„ resolve/ reject</span></span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (x <span class=\"keyword\">instanceof</span> <span class=\"built_in\">Promise</span>) &#123;</span><br><span class=\"line\">                x.then(</span><br><span class=\"line\">                    <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">data</span>) </span>&#123;</span><br><span class=\"line\">                        resolve(promise, data)</span><br><span class=\"line\">                    &#125;,</span><br><span class=\"line\">                    <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">reason</span>) </span>&#123;</span><br><span class=\"line\">                        reject(promise, reason)</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                )</span><br><span class=\"line\">            &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">let</span> then</span><br><span class=\"line\">                (<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">resolveThenable</span> (<span class=\"params\">x</span>) </span>&#123;</span><br><span class=\"line\">                    <span class=\"comment\">// å¦‚æœè¿”å›çš„æ˜¯ä¸€ä¸ª Thenable å¯¹è±¡</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (x &amp;&amp; (<span class=\"keyword\">typeof</span> x === <span class=\"string\">'object'</span> || <span class=\"keyword\">typeof</span> x === <span class=\"string\">'function'</span>)) &#123;</span><br><span class=\"line\">                        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                            then = x.then</span><br><span class=\"line\">                        &#125;<span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">                            reject(promise, e)</span><br><span class=\"line\">                            <span class=\"keyword\">return</span></span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                        </span><br><span class=\"line\">                        <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> then === <span class=\"string\">'function'</span>) &#123;</span><br><span class=\"line\">                            <span class=\"comment\">// è°ƒç”¨ Thenable å¯¹è±¡çš„ thenæ–¹æ³•</span></span><br><span class=\"line\">                            <span class=\"comment\">// ä¼ é€’è¿›å»çš„ resolvePromise å’Œ rejectPromise ä»¥åŠä¸‹é¢ä¸¤ä¸ªåŒ¿åå‡½æ•°</span></span><br><span class=\"line\">                            <span class=\"comment\">// å¯èƒ½ä¼šé‡å¤è°ƒç”¨, ä½†æ˜¯è§„èŒƒåªèƒ½æœ‰å…¶ä¸­ä¸€ä¸ªè¢«è°ƒç”¨ä¸€æ¬¡, å…¶ä»–è¦è¢«å¿½ç•¥</span></span><br><span class=\"line\">                            <span class=\"keyword\">let</span> invoked = <span class=\"literal\">false</span></span><br><span class=\"line\">                            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                                then.call(x,</span><br><span class=\"line\">                                    <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">y</span>) </span>&#123;</span><br><span class=\"line\">                                        <span class=\"keyword\">if</span> (invoked) <span class=\"keyword\">return</span></span><br><span class=\"line\">                                        invoked = <span class=\"literal\">true</span></span><br><span class=\"line\">                                        </span><br><span class=\"line\">                                        <span class=\"comment\">// é¿å…ä¸¤ä¸ª promise æ’ç­‰</span></span><br><span class=\"line\">                                        <span class=\"keyword\">if</span> (y === x) &#123;</span><br><span class=\"line\">                                            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Error</span>(<span class=\"string\">'Error: return value could not be same with the promise'</span>)</span><br><span class=\"line\">                                        &#125;</span><br><span class=\"line\">                                        </span><br><span class=\"line\">                                    <span class=\"comment\">// y æœ‰å¯èƒ½è¿˜æ˜¯ thenable å¯¹è±¡    </span></span><br><span class=\"line\">                                    resolveThenable(y)</span><br><span class=\"line\">                                    &#125;,</span><br><span class=\"line\">                                    <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">e</span>) </span>&#123;</span><br><span class=\"line\">                                        <span class=\"keyword\">if</span> (invoked) <span class=\"keyword\">return</span></span><br><span class=\"line\">                                        invoked = <span class=\"literal\">true</span></span><br><span class=\"line\">                                        </span><br><span class=\"line\">                                        reject(promise, e)</span><br><span class=\"line\">                                    &#125;</span><br><span class=\"line\">                                )</span><br><span class=\"line\">                            &#125;<span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">                                    <span class=\"comment\">// å¦‚æœ`resolvePromise`å’Œ`rejectPromise`æ–¹æ³•è¢«è°ƒç”¨åï¼Œå†æŠ›å‡ºå¼‚å¸¸ï¼Œåˆ™å¿½ç•¥å¼‚å¸¸</span></span><br><span class=\"line\">                                    <span class=\"comment\">// å¦åˆ™ç”¨å¼‚å¸¸å¯¹è±¡rejectæ­¤Promiseå¯¹è±¡</span></span><br><span class=\"line\">                                <span class=\"keyword\">if</span> (!invoked) &#123;</span><br><span class=\"line\">                                    reject(promise, e)</span><br><span class=\"line\">                                &#125;</span><br><span class=\"line\">                            &#125;</span><br><span class=\"line\">                        &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                            resolve(promise, x)</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                        resolve(promise, x)</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;(x))</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// å¦‚æœæ²¡æœ‰ä¼  callbackç›´æ¥ä½¿ç”¨å‰ä¸€ä¸ª promise</span></span><br><span class=\"line\">        <span class=\"comment\">// ä¼ è¿‡æ¥çš„å€¼ resolve/reject å½“å‰ promise å¯¹è±¡</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            action === <span class=\"string\">'resolve'</span></span><br><span class=\"line\">                ? resolve(promise, value)</span><br><span class=\"line\">                : reject(promise, value)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h4><p>æˆ‘ä¸€å¼€å§‹æ˜¯å…ˆçœ‹çš„<strong>å‰–æ Promise ä¹‹åŸºç¡€ç¯‡</strong>, å‰åŠéƒ¨åˆ†ç¡®å®å¾ˆäº²æ°‘, ä½†æ˜¯åˆ°åŠ å…¥ <code>hanlde</code> å’Œæ”¹é€  <code>resolve</code> å‡½æ•° å°±å¼€å§‹æ‡µäº†, ç„¶åæ‡µæ‡µæ‡‚æ‡‚çš„å»çœ‹<strong>JS Promise çš„åŸç†å®ç°</strong>, ä¸è¿‡åœ¨æœ€å¤æ‚çš„ <code>makeCallback</code> å‡½æ•°ä¸­è§£é‡Šæœ‰ç‚¹ä¸€ç¬”å¸¦è¿‡çš„æ„æ€. ä¸è¿‡çœ‹äº†è¿™ç¯‡å¸®åŠ©æˆ‘ç†è§£ä¹‹å‰çš„<strong>å‰–æ Promise ä¹‹åŸºç¡€ç¯‡</strong>, å°±è¿”å›å»çœ‹åŸºç¡€ç¯‡ç”»äº†ä¸€éæµç¨‹å›¾æ‰ç®—çœ‹æ‡‚, é‡Œé¢çš„é—­åŒ…ç”¨çš„å¤ªç²¾å¦™äº†.</p>\n<blockquote>\n<p>å‚è€ƒæ–‡ç« <br><a href=\"https://tech.meituan.com/promise-insight.html\" target=\"_blank\" rel=\"noopener\">å‰–æ Promise ä¹‹åŸºç¡€ç¯‡</a><br><a href=\"http://bruce-xu.github.io/blogs/js/promise\" target=\"_blank\" rel=\"noopener\">JS Promise çš„åŸç†å®ç°</a><br><a href=\"https://github.com/xieranmaya/blog/issues/3\" target=\"_blank\" rel=\"noopener\">å‰–æPromiseå†…éƒ¨ç»“æ„</a></p>\n</blockquote>\n<p>Created on 2017-12-26 by Cara</p>\n"},{"title":"base64 è½¬ blob","date":"2017-10-22T13:44:12.000Z","categorles":["ç¬”è®°ğŸ“’"],"_content":"\n```javascript\nvar arr = base64.split(','), mime = arr[0].match(/:(.*?);/)[1],\n    bstr = atob(arr[1]), n = bstr.length, u8arr = new Uint8Array(n);\n    while (n--) {\n        // charCodeAt() æ–¹æ³•å¯è¿”å›æŒ‡å®šä½ç½®çš„å­—ç¬¦çš„ Unicode ç¼–ç \n        u8arr[n] = bstr.charCodeAt(n);\n    }\n// 'application/octet-binary' (é»˜è®¤å€¼)\nlet blob = new Blob([u8arr], { type: mime })\n```\n\n#### Base64 çš„ç¼–ç ç å’Œè§£ç \nä½¿ç”¨atob å’Œ btoa æ–¹æ³•.\n\n- atob() è§£ç \n\n```javascript\natob(\"amF2YXNjcmlwdA==\")\n// è§£ç ç»“æœ \"javascript\"\n```\n\n- btoa() ç¼–ç \n\n```javascript\nwindow.btoa(javascript)\n// è½¬ç ç»“æœ \"amF2YXNjcmlwdA==\"\n```\n\nä»¥ä¸Šä¸¤ç§æ–¹æ³•å¯¹äºä¸­æ–‡æ˜¯æœ‰å±€é™æ€§çš„, è§£å†³å¦‚ä¸‹:\n\n```javascript\nvar str = \"Chinaï¼Œä¸­å›½\";\n\n// å…ˆç”¨ encodeURI() ç¼–ç \nwindow.btoa(window.encodeURIComponent(str))\n// \"Q2hpbmElRUYlQkMlOEMlRTQlQjglQUQlRTUlOUIlQkQ=\"\n\n// atob è§£ç  Base64 å†ç”¨ decodeURI() è§£ç \nwindow.decodeURIComponent(window.atob('Q2hpbmElRUYlQkMlOEMlRTQlQjglQUQlRTUlOUIlQkQ='))\n// \"Chinaï¼Œä¸­å›½\"\n```\n\nCreated on 2017-9-4 by Cara*","source":"_posts/base64-è½¬-blob.md","raw":"---\ntitle: base64 è½¬ blob\ndate: 2017-10-22 21:44:12\ntags:\n- JavaScript\ncategorles:\n- ç¬”è®°ğŸ“’\n---\n\n```javascript\nvar arr = base64.split(','), mime = arr[0].match(/:(.*?);/)[1],\n    bstr = atob(arr[1]), n = bstr.length, u8arr = new Uint8Array(n);\n    while (n--) {\n        // charCodeAt() æ–¹æ³•å¯è¿”å›æŒ‡å®šä½ç½®çš„å­—ç¬¦çš„ Unicode ç¼–ç \n        u8arr[n] = bstr.charCodeAt(n);\n    }\n// 'application/octet-binary' (é»˜è®¤å€¼)\nlet blob = new Blob([u8arr], { type: mime })\n```\n\n#### Base64 çš„ç¼–ç ç å’Œè§£ç \nä½¿ç”¨atob å’Œ btoa æ–¹æ³•.\n\n- atob() è§£ç \n\n```javascript\natob(\"amF2YXNjcmlwdA==\")\n// è§£ç ç»“æœ \"javascript\"\n```\n\n- btoa() ç¼–ç \n\n```javascript\nwindow.btoa(javascript)\n// è½¬ç ç»“æœ \"amF2YXNjcmlwdA==\"\n```\n\nä»¥ä¸Šä¸¤ç§æ–¹æ³•å¯¹äºä¸­æ–‡æ˜¯æœ‰å±€é™æ€§çš„, è§£å†³å¦‚ä¸‹:\n\n```javascript\nvar str = \"Chinaï¼Œä¸­å›½\";\n\n// å…ˆç”¨ encodeURI() ç¼–ç \nwindow.btoa(window.encodeURIComponent(str))\n// \"Q2hpbmElRUYlQkMlOEMlRTQlQjglQUQlRTUlOUIlQkQ=\"\n\n// atob è§£ç  Base64 å†ç”¨ decodeURI() è§£ç \nwindow.decodeURIComponent(window.atob('Q2hpbmElRUYlQkMlOEMlRTQlQjglQUQlRTUlOUIlQkQ='))\n// \"Chinaï¼Œä¸­å›½\"\n```\n\nCreated on 2017-9-4 by Cara*","slug":"base64-è½¬-blob","published":1,"updated":"2018-05-05T09:23:03.665Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjgurolso000yklu0hc7a26bu","content":"<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> arr = base64.split(<span class=\"string\">','</span>), mime = arr[<span class=\"number\">0</span>].match(<span class=\"regexp\">/:(.*?);/</span>)[<span class=\"number\">1</span>],</span><br><span class=\"line\">    bstr = atob(arr[<span class=\"number\">1</span>]), n = bstr.length, u8arr = <span class=\"keyword\">new</span> <span class=\"built_in\">Uint8Array</span>(n);</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (n--) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// charCodeAt() æ–¹æ³•å¯è¿”å›æŒ‡å®šä½ç½®çš„å­—ç¬¦çš„ Unicode ç¼–ç </span></span><br><span class=\"line\">        u8arr[n] = bstr.charCodeAt(n);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"><span class=\"comment\">// 'application/octet-binary' (é»˜è®¤å€¼)</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> blob = <span class=\"keyword\">new</span> Blob([u8arr], &#123; <span class=\"attr\">type</span>: mime &#125;)</span><br></pre></td></tr></table></figure>\n<h4 id=\"Base64-çš„ç¼–ç ç å’Œè§£ç \"><a href=\"#Base64-çš„ç¼–ç ç å’Œè§£ç \" class=\"headerlink\" title=\"Base64 çš„ç¼–ç ç å’Œè§£ç \"></a>Base64 çš„ç¼–ç ç å’Œè§£ç </h4><p>ä½¿ç”¨atob å’Œ btoa æ–¹æ³•.</p>\n<ul>\n<li>atob() è§£ç </li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">atob(<span class=\"string\">\"amF2YXNjcmlwdA==\"</span>)</span><br><span class=\"line\"><span class=\"comment\">// è§£ç ç»“æœ \"javascript\"</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>btoa() ç¼–ç </li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">window</span>.btoa(javascript)</span><br><span class=\"line\"><span class=\"comment\">// è½¬ç ç»“æœ \"amF2YXNjcmlwdA==\"</span></span><br></pre></td></tr></table></figure>\n<p>ä»¥ä¸Šä¸¤ç§æ–¹æ³•å¯¹äºä¸­æ–‡æ˜¯æœ‰å±€é™æ€§çš„, è§£å†³å¦‚ä¸‹:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> str = <span class=\"string\">\"Chinaï¼Œä¸­å›½\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å…ˆç”¨ encodeURI() ç¼–ç </span></span><br><span class=\"line\"><span class=\"built_in\">window</span>.btoa(<span class=\"built_in\">window</span>.encodeURIComponent(str))</span><br><span class=\"line\"><span class=\"comment\">// \"Q2hpbmElRUYlQkMlOEMlRTQlQjglQUQlRTUlOUIlQkQ=\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// atob è§£ç  Base64 å†ç”¨ decodeURI() è§£ç </span></span><br><span class=\"line\"><span class=\"built_in\">window</span>.decodeURIComponent(<span class=\"built_in\">window</span>.atob(<span class=\"string\">'Q2hpbmElRUYlQkMlOEMlRTQlQjglQUQlRTUlOUIlQkQ='</span>))</span><br><span class=\"line\"><span class=\"comment\">// \"Chinaï¼Œä¸­å›½\"</span></span><br></pre></td></tr></table></figure>\n<p>Created on 2017-9-4 by Cara*</p>\n","site":{"data":{}},"excerpt":"","more":"<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> arr = base64.split(<span class=\"string\">','</span>), mime = arr[<span class=\"number\">0</span>].match(<span class=\"regexp\">/:(.*?);/</span>)[<span class=\"number\">1</span>],</span><br><span class=\"line\">    bstr = atob(arr[<span class=\"number\">1</span>]), n = bstr.length, u8arr = <span class=\"keyword\">new</span> <span class=\"built_in\">Uint8Array</span>(n);</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (n--) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// charCodeAt() æ–¹æ³•å¯è¿”å›æŒ‡å®šä½ç½®çš„å­—ç¬¦çš„ Unicode ç¼–ç </span></span><br><span class=\"line\">        u8arr[n] = bstr.charCodeAt(n);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"><span class=\"comment\">// 'application/octet-binary' (é»˜è®¤å€¼)</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> blob = <span class=\"keyword\">new</span> Blob([u8arr], &#123; <span class=\"attr\">type</span>: mime &#125;)</span><br></pre></td></tr></table></figure>\n<h4 id=\"Base64-çš„ç¼–ç ç å’Œè§£ç \"><a href=\"#Base64-çš„ç¼–ç ç å’Œè§£ç \" class=\"headerlink\" title=\"Base64 çš„ç¼–ç ç å’Œè§£ç \"></a>Base64 çš„ç¼–ç ç å’Œè§£ç </h4><p>ä½¿ç”¨atob å’Œ btoa æ–¹æ³•.</p>\n<ul>\n<li>atob() è§£ç </li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">atob(<span class=\"string\">\"amF2YXNjcmlwdA==\"</span>)</span><br><span class=\"line\"><span class=\"comment\">// è§£ç ç»“æœ \"javascript\"</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>btoa() ç¼–ç </li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">window</span>.btoa(javascript)</span><br><span class=\"line\"><span class=\"comment\">// è½¬ç ç»“æœ \"amF2YXNjcmlwdA==\"</span></span><br></pre></td></tr></table></figure>\n<p>ä»¥ä¸Šä¸¤ç§æ–¹æ³•å¯¹äºä¸­æ–‡æ˜¯æœ‰å±€é™æ€§çš„, è§£å†³å¦‚ä¸‹:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> str = <span class=\"string\">\"Chinaï¼Œä¸­å›½\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å…ˆç”¨ encodeURI() ç¼–ç </span></span><br><span class=\"line\"><span class=\"built_in\">window</span>.btoa(<span class=\"built_in\">window</span>.encodeURIComponent(str))</span><br><span class=\"line\"><span class=\"comment\">// \"Q2hpbmElRUYlQkMlOEMlRTQlQjglQUQlRTUlOUIlQkQ=\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// atob è§£ç  Base64 å†ç”¨ decodeURI() è§£ç </span></span><br><span class=\"line\"><span class=\"built_in\">window</span>.decodeURIComponent(<span class=\"built_in\">window</span>.atob(<span class=\"string\">'Q2hpbmElRUYlQkMlOEMlRTQlQjglQUQlRTUlOUIlQkQ='</span>))</span><br><span class=\"line\"><span class=\"comment\">// \"Chinaï¼Œä¸­å›½\"</span></span><br></pre></td></tr></table></figure>\n<p>Created on 2017-9-4 by Cara*</p>\n"},{"title":"cookie localStorage and sessionStorage","date":"2017-06-11T10:04:09.000Z","_content":"æµè§ˆå™¨çš„æ•°æ®ç¼“å­˜, å¸¸ç”¨çš„ä¸‰ç§æ–¹å¼cookie/localStorage/sessionStorage\n\n### 1. cookie\n\n> å…¨ç§°å«åš HTTP Cookie, é€šå¸¸æˆ‘ä»¬ç›´æ¥å«åšCookie, æœ€åˆæ˜¯åœ¨å®¢æˆ·ç«¯ç”¨äºå­˜å‚¨ä¼šè¯ä¿¡æ¯çš„. è¯¥æ ‡å‡†è¦æ±‚æœåŠ¡å™¨å¯¹ä»»æ„ HTTP è¯·æ±‚å‘é€ Set-Cookie Http å¤´ä½œä¸ºå“åº”çš„ä¸€éƒ¨åˆ†, å…¶ä¸­ä¼šåŒ…å«ä¼šè¯ä¿¡æ¯.è¿™ç§ HTTP çš„å“åº”ä»¥ key-valueç»„æˆçš„ä¸€ä¸ªcookie, ä¸”åœ¨ä¼ é€ä¸­éƒ½å¿…é¡»æ˜¯URLç¼–ç   ------**JavaScripté«˜çº§ç¨‹åºè®¾è®¡**                             \n\n- Cookie çš„æ•°æ®å¤§å°é™åˆ¶ä¸èƒ½è¶…è¿‡4k\n- æ¯æ¬¡ HTTP è¯·æ±‚éƒ½ä¼šæºå¸¦ Cookie,æ‰€ä»¥Cookieåªé€‚åˆä¿å­˜å¾ˆå°çš„æ•°æ®\n- é»˜è®¤ Cookie åœ¨æµè§ˆå™¨ä¼šè¯ç»“æŸæ—¶å°†æ‰€æœ‰ Cookieåˆ é™¤, ä¹Ÿå¯ä»¥è‡ªå·±è®¾ç½®åˆ é™¤æ—¶é—´\n\n#### JavaScript ä¸­çš„Cookie\n    \n* document.cookie å¯ä»¥è®¾ç½®ä¸€ä¸ªæ–°çš„ cookie å­—ç¬¦ä¸², key å’Œ valueæ˜¯å¿…é¡»çš„\n\n> `document.cookie = 'name=Cara';`\n    \nç”±äºæ¯æ¬¡å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€è¯·æ±‚çš„æ—¶å€™éƒ½ä¼šå‘é€è¿™ä¸ª cookie , æ‰€ä»¥æœ€å¥½æ¯æ¬¡è®¾ç½®çš„æ—¶å€™éƒ½ç”¨`encodeURI()`è¿›è¡Œç¼–ç , `decodeURI()`æ¥è§£ç \n\n### 2. localStorage\nåœ¨ HTML5 è§„èŒƒä¸­ä½œä¸ºæŒä¹…ä¿å­˜å®¢æˆ·ç«¯æ•°æ®çš„æ–¹æ¡ˆå–ä»£äº†globalStorage(ä»¥åŸŸä½œä¸ºè®¿é—®è§„åˆ™), è¦è®¿é—®åŒä¸€ä¸ª localStorage å¯¹è±¡, é¡µé¢å¿…é¡»æ¥è‡ªåŒä¸€ä¸ªåŸŸå(å­åŸŸåæ— æ•ˆ), ä½¿ç”¨åŒä¸€ç§åè®®, åœ¨åŒä¸€ä¸ªç«¯å£ä¸Š. å°±ç›¸å½“äº globalStorage[location.host].\n\n\n- ä½¿ç”¨æ–¹æ³•å‚¨å­˜æ•°æ®\n\n    > localStorage.setItem('name', 'Cara')\n    \n- ä½¿ç”¨å±æ€§å‚¨å­˜æ•°æ®\n\n    > localStorage.book = 'JavaScript'\n    \n- ä½¿ç”¨æ–¹æ³•è¯»å–æ•°æ®\n\n    > localStorage.getItem('name')\n    \n- ä½¿ç”¨å±æ€§è¯»å–æ•°æ®\n\n    > var book = localStorage.book\n\n- åˆ é™¤å‚¨å­˜æ•°æ®\n\n    > localStorage.removeItem('name')\n    \n> localStorage å’Œ sessionStorage è™½ç„¶ä¹Ÿæœ‰æ•°æ®å‚¨å­˜å¤§å°é™åˆ¶, ä½†æ¯” cookie è¦å¤§å¾ˆå¤š, å¯ä»¥è¾¾åˆ°5Mæˆ–æ›´å¤§. localStorageçš„æ•°æ®å§‹ç»ˆæœ‰æ•ˆ, å³ä½¿æµè§ˆå™¨å…³é—­ä¹Ÿä¼šä¸€ç›´ä¿å­˜, æ‰€ä»¥åªè¦ä¸ clear() æˆ–è€… removeItem() æ•°æ®å°±å¯ä»¥æ°¸ä¹…ä¿å­˜\n\n### 3. sessionStorage\nsessionStorageå¯¹è±¡å‚¨å­˜ç‰¹å®šäºæŸä¸ªä¼šè¯çš„æ•°æ®, ä¹Ÿå°±æ˜¯è¯´æ•°æ®åªä¿å­˜åˆ°æµè§ˆå™¨å…³é—­.\n\n* sessionStorageçš„ç”¨æ³•è·ŸlocalStorageçš„ç”¨æ³•ä¸€æ ·\n\n### Storageç±»å‹\nStorage ç±»å‹æä¾›æœ€å¤§çš„å‚¨å­˜ç©ºé—´ ( å› æµè§ˆå™¨è€Œå¼‚ ) æ¥å‚¨å­˜åå€¼å¯¹å„¿, æœ‰å¦‚ä¸‹æ–¹æ³•:\n\n- clear(): åˆ é™¤æ‰€æœ‰å€¼; ( Firefox æœªå®ç° )\n\n- getItem(name): æ ¹æ®æŒ‡å®šçš„åå­— name è·å–å¯¹åº”çš„ value\n\n- key(idnex): è·å– index ä½ç½®çš„å€¼å¯¹åº”çš„åå­—\n\n- removeItem(name): åˆ é™¤ç”±nameæŒ‡å®šçš„åå€¼å¯¹å„¿\n\n- setItem(name, value): è®¾ç½®æŒ‡å®šçš„nameåŠå¯¹åº”çš„value\n\n>  å¯ä»¥åªç”¨ length æ¥åˆ¤æ–­æœ‰å¤šå°‘åå€¼å¯¹å„¿å­˜æ”¾åœ¨ Storage å¯¹è±¡ä¸­\n\n\n\n\n\n\n","source":"_posts/cookie-localStorage-and-sessionStorage.md","raw":"---\ntitle: cookie localStorage and sessionStorage\ndate: 2017-06-11 18:04:09\ntags: \n- JavaScript\ncategories:\n- å¤ä¹ \n---\næµè§ˆå™¨çš„æ•°æ®ç¼“å­˜, å¸¸ç”¨çš„ä¸‰ç§æ–¹å¼cookie/localStorage/sessionStorage\n\n### 1. cookie\n\n> å…¨ç§°å«åš HTTP Cookie, é€šå¸¸æˆ‘ä»¬ç›´æ¥å«åšCookie, æœ€åˆæ˜¯åœ¨å®¢æˆ·ç«¯ç”¨äºå­˜å‚¨ä¼šè¯ä¿¡æ¯çš„. è¯¥æ ‡å‡†è¦æ±‚æœåŠ¡å™¨å¯¹ä»»æ„ HTTP è¯·æ±‚å‘é€ Set-Cookie Http å¤´ä½œä¸ºå“åº”çš„ä¸€éƒ¨åˆ†, å…¶ä¸­ä¼šåŒ…å«ä¼šè¯ä¿¡æ¯.è¿™ç§ HTTP çš„å“åº”ä»¥ key-valueç»„æˆçš„ä¸€ä¸ªcookie, ä¸”åœ¨ä¼ é€ä¸­éƒ½å¿…é¡»æ˜¯URLç¼–ç   ------**JavaScripté«˜çº§ç¨‹åºè®¾è®¡**                             \n\n- Cookie çš„æ•°æ®å¤§å°é™åˆ¶ä¸èƒ½è¶…è¿‡4k\n- æ¯æ¬¡ HTTP è¯·æ±‚éƒ½ä¼šæºå¸¦ Cookie,æ‰€ä»¥Cookieåªé€‚åˆä¿å­˜å¾ˆå°çš„æ•°æ®\n- é»˜è®¤ Cookie åœ¨æµè§ˆå™¨ä¼šè¯ç»“æŸæ—¶å°†æ‰€æœ‰ Cookieåˆ é™¤, ä¹Ÿå¯ä»¥è‡ªå·±è®¾ç½®åˆ é™¤æ—¶é—´\n\n#### JavaScript ä¸­çš„Cookie\n    \n* document.cookie å¯ä»¥è®¾ç½®ä¸€ä¸ªæ–°çš„ cookie å­—ç¬¦ä¸², key å’Œ valueæ˜¯å¿…é¡»çš„\n\n> `document.cookie = 'name=Cara';`\n    \nç”±äºæ¯æ¬¡å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€è¯·æ±‚çš„æ—¶å€™éƒ½ä¼šå‘é€è¿™ä¸ª cookie , æ‰€ä»¥æœ€å¥½æ¯æ¬¡è®¾ç½®çš„æ—¶å€™éƒ½ç”¨`encodeURI()`è¿›è¡Œç¼–ç , `decodeURI()`æ¥è§£ç \n\n### 2. localStorage\nåœ¨ HTML5 è§„èŒƒä¸­ä½œä¸ºæŒä¹…ä¿å­˜å®¢æˆ·ç«¯æ•°æ®çš„æ–¹æ¡ˆå–ä»£äº†globalStorage(ä»¥åŸŸä½œä¸ºè®¿é—®è§„åˆ™), è¦è®¿é—®åŒä¸€ä¸ª localStorage å¯¹è±¡, é¡µé¢å¿…é¡»æ¥è‡ªåŒä¸€ä¸ªåŸŸå(å­åŸŸåæ— æ•ˆ), ä½¿ç”¨åŒä¸€ç§åè®®, åœ¨åŒä¸€ä¸ªç«¯å£ä¸Š. å°±ç›¸å½“äº globalStorage[location.host].\n\n\n- ä½¿ç”¨æ–¹æ³•å‚¨å­˜æ•°æ®\n\n    > localStorage.setItem('name', 'Cara')\n    \n- ä½¿ç”¨å±æ€§å‚¨å­˜æ•°æ®\n\n    > localStorage.book = 'JavaScript'\n    \n- ä½¿ç”¨æ–¹æ³•è¯»å–æ•°æ®\n\n    > localStorage.getItem('name')\n    \n- ä½¿ç”¨å±æ€§è¯»å–æ•°æ®\n\n    > var book = localStorage.book\n\n- åˆ é™¤å‚¨å­˜æ•°æ®\n\n    > localStorage.removeItem('name')\n    \n> localStorage å’Œ sessionStorage è™½ç„¶ä¹Ÿæœ‰æ•°æ®å‚¨å­˜å¤§å°é™åˆ¶, ä½†æ¯” cookie è¦å¤§å¾ˆå¤š, å¯ä»¥è¾¾åˆ°5Mæˆ–æ›´å¤§. localStorageçš„æ•°æ®å§‹ç»ˆæœ‰æ•ˆ, å³ä½¿æµè§ˆå™¨å…³é—­ä¹Ÿä¼šä¸€ç›´ä¿å­˜, æ‰€ä»¥åªè¦ä¸ clear() æˆ–è€… removeItem() æ•°æ®å°±å¯ä»¥æ°¸ä¹…ä¿å­˜\n\n### 3. sessionStorage\nsessionStorageå¯¹è±¡å‚¨å­˜ç‰¹å®šäºæŸä¸ªä¼šè¯çš„æ•°æ®, ä¹Ÿå°±æ˜¯è¯´æ•°æ®åªä¿å­˜åˆ°æµè§ˆå™¨å…³é—­.\n\n* sessionStorageçš„ç”¨æ³•è·ŸlocalStorageçš„ç”¨æ³•ä¸€æ ·\n\n### Storageç±»å‹\nStorage ç±»å‹æä¾›æœ€å¤§çš„å‚¨å­˜ç©ºé—´ ( å› æµè§ˆå™¨è€Œå¼‚ ) æ¥å‚¨å­˜åå€¼å¯¹å„¿, æœ‰å¦‚ä¸‹æ–¹æ³•:\n\n- clear(): åˆ é™¤æ‰€æœ‰å€¼; ( Firefox æœªå®ç° )\n\n- getItem(name): æ ¹æ®æŒ‡å®šçš„åå­— name è·å–å¯¹åº”çš„ value\n\n- key(idnex): è·å– index ä½ç½®çš„å€¼å¯¹åº”çš„åå­—\n\n- removeItem(name): åˆ é™¤ç”±nameæŒ‡å®šçš„åå€¼å¯¹å„¿\n\n- setItem(name, value): è®¾ç½®æŒ‡å®šçš„nameåŠå¯¹åº”çš„value\n\n>  å¯ä»¥åªç”¨ length æ¥åˆ¤æ–­æœ‰å¤šå°‘åå€¼å¯¹å„¿å­˜æ”¾åœ¨ Storage å¯¹è±¡ä¸­\n\n\n\n\n\n\n","slug":"cookie-localStorage-and-sessionStorage","published":1,"updated":"2018-05-05T09:23:03.667Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjgurolsq0012klu08ssdd3n3","content":"<p>æµè§ˆå™¨çš„æ•°æ®ç¼“å­˜, å¸¸ç”¨çš„ä¸‰ç§æ–¹å¼cookie/localStorage/sessionStorage</p>\n<h3 id=\"1-cookie\"><a href=\"#1-cookie\" class=\"headerlink\" title=\"1. cookie\"></a>1. cookie</h3><blockquote>\n<p>å…¨ç§°å«åš HTTP Cookie, é€šå¸¸æˆ‘ä»¬ç›´æ¥å«åšCookie, æœ€åˆæ˜¯åœ¨å®¢æˆ·ç«¯ç”¨äºå­˜å‚¨ä¼šè¯ä¿¡æ¯çš„. è¯¥æ ‡å‡†è¦æ±‚æœåŠ¡å™¨å¯¹ä»»æ„ HTTP è¯·æ±‚å‘é€ Set-Cookie Http å¤´ä½œä¸ºå“åº”çš„ä¸€éƒ¨åˆ†, å…¶ä¸­ä¼šåŒ…å«ä¼šè¯ä¿¡æ¯.è¿™ç§ HTTP çš„å“åº”ä»¥ key-valueç»„æˆçš„ä¸€ä¸ªcookie, ä¸”åœ¨ä¼ é€ä¸­éƒ½å¿…é¡»æ˜¯URLç¼–ç   â€”â€”<strong>JavaScripté«˜çº§ç¨‹åºè®¾è®¡</strong>                             </p>\n</blockquote>\n<ul>\n<li>Cookie çš„æ•°æ®å¤§å°é™åˆ¶ä¸èƒ½è¶…è¿‡4k</li>\n<li>æ¯æ¬¡ HTTP è¯·æ±‚éƒ½ä¼šæºå¸¦ Cookie,æ‰€ä»¥Cookieåªé€‚åˆä¿å­˜å¾ˆå°çš„æ•°æ®</li>\n<li>é»˜è®¤ Cookie åœ¨æµè§ˆå™¨ä¼šè¯ç»“æŸæ—¶å°†æ‰€æœ‰ Cookieåˆ é™¤, ä¹Ÿå¯ä»¥è‡ªå·±è®¾ç½®åˆ é™¤æ—¶é—´</li>\n</ul>\n<h4 id=\"JavaScript-ä¸­çš„Cookie\"><a href=\"#JavaScript-ä¸­çš„Cookie\" class=\"headerlink\" title=\"JavaScript ä¸­çš„Cookie\"></a>JavaScript ä¸­çš„Cookie</h4><ul>\n<li>document.cookie å¯ä»¥è®¾ç½®ä¸€ä¸ªæ–°çš„ cookie å­—ç¬¦ä¸², key å’Œ valueæ˜¯å¿…é¡»çš„</li>\n</ul>\n<blockquote>\n<p><code>document.cookie = &#39;name=Cara&#39;;</code></p>\n</blockquote>\n<p>ç”±äºæ¯æ¬¡å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€è¯·æ±‚çš„æ—¶å€™éƒ½ä¼šå‘é€è¿™ä¸ª cookie , æ‰€ä»¥æœ€å¥½æ¯æ¬¡è®¾ç½®çš„æ—¶å€™éƒ½ç”¨<code>encodeURI()</code>è¿›è¡Œç¼–ç , <code>decodeURI()</code>æ¥è§£ç </p>\n<h3 id=\"2-localStorage\"><a href=\"#2-localStorage\" class=\"headerlink\" title=\"2. localStorage\"></a>2. localStorage</h3><p>åœ¨ HTML5 è§„èŒƒä¸­ä½œä¸ºæŒä¹…ä¿å­˜å®¢æˆ·ç«¯æ•°æ®çš„æ–¹æ¡ˆå–ä»£äº†globalStorage(ä»¥åŸŸä½œä¸ºè®¿é—®è§„åˆ™), è¦è®¿é—®åŒä¸€ä¸ª localStorage å¯¹è±¡, é¡µé¢å¿…é¡»æ¥è‡ªåŒä¸€ä¸ªåŸŸå(å­åŸŸåæ— æ•ˆ), ä½¿ç”¨åŒä¸€ç§åè®®, åœ¨åŒä¸€ä¸ªç«¯å£ä¸Š. å°±ç›¸å½“äº globalStorage[location.host].</p>\n<ul>\n<li><p>ä½¿ç”¨æ–¹æ³•å‚¨å­˜æ•°æ®</p>\n<blockquote>\n<p>localStorage.setItem(â€˜nameâ€™, â€˜Caraâ€™)</p>\n</blockquote>\n</li>\n<li><p>ä½¿ç”¨å±æ€§å‚¨å­˜æ•°æ®</p>\n<blockquote>\n<p>localStorage.book = â€˜JavaScriptâ€™</p>\n</blockquote>\n</li>\n<li><p>ä½¿ç”¨æ–¹æ³•è¯»å–æ•°æ®</p>\n<blockquote>\n<p>localStorage.getItem(â€˜nameâ€™)</p>\n</blockquote>\n</li>\n<li><p>ä½¿ç”¨å±æ€§è¯»å–æ•°æ®</p>\n<blockquote>\n<p>var book = localStorage.book</p>\n</blockquote>\n</li>\n<li><p>åˆ é™¤å‚¨å­˜æ•°æ®</p>\n<blockquote>\n<p>localStorage.removeItem(â€˜nameâ€™)</p>\n</blockquote>\n</li>\n</ul>\n<blockquote>\n<p>localStorage å’Œ sessionStorage è™½ç„¶ä¹Ÿæœ‰æ•°æ®å‚¨å­˜å¤§å°é™åˆ¶, ä½†æ¯” cookie è¦å¤§å¾ˆå¤š, å¯ä»¥è¾¾åˆ°5Mæˆ–æ›´å¤§. localStorageçš„æ•°æ®å§‹ç»ˆæœ‰æ•ˆ, å³ä½¿æµè§ˆå™¨å…³é—­ä¹Ÿä¼šä¸€ç›´ä¿å­˜, æ‰€ä»¥åªè¦ä¸ clear() æˆ–è€… removeItem() æ•°æ®å°±å¯ä»¥æ°¸ä¹…ä¿å­˜</p>\n</blockquote>\n<h3 id=\"3-sessionStorage\"><a href=\"#3-sessionStorage\" class=\"headerlink\" title=\"3. sessionStorage\"></a>3. sessionStorage</h3><p>sessionStorageå¯¹è±¡å‚¨å­˜ç‰¹å®šäºæŸä¸ªä¼šè¯çš„æ•°æ®, ä¹Ÿå°±æ˜¯è¯´æ•°æ®åªä¿å­˜åˆ°æµè§ˆå™¨å…³é—­.</p>\n<ul>\n<li>sessionStorageçš„ç”¨æ³•è·ŸlocalStorageçš„ç”¨æ³•ä¸€æ ·</li>\n</ul>\n<h3 id=\"Storageç±»å‹\"><a href=\"#Storageç±»å‹\" class=\"headerlink\" title=\"Storageç±»å‹\"></a>Storageç±»å‹</h3><p>Storage ç±»å‹æä¾›æœ€å¤§çš„å‚¨å­˜ç©ºé—´ ( å› æµè§ˆå™¨è€Œå¼‚ ) æ¥å‚¨å­˜åå€¼å¯¹å„¿, æœ‰å¦‚ä¸‹æ–¹æ³•:</p>\n<ul>\n<li><p>clear(): åˆ é™¤æ‰€æœ‰å€¼; ( Firefox æœªå®ç° )</p>\n</li>\n<li><p>getItem(name): æ ¹æ®æŒ‡å®šçš„åå­— name è·å–å¯¹åº”çš„ value</p>\n</li>\n<li><p>key(idnex): è·å– index ä½ç½®çš„å€¼å¯¹åº”çš„åå­—</p>\n</li>\n<li><p>removeItem(name): åˆ é™¤ç”±nameæŒ‡å®šçš„åå€¼å¯¹å„¿</p>\n</li>\n<li><p>setItem(name, value): è®¾ç½®æŒ‡å®šçš„nameåŠå¯¹åº”çš„value</p>\n</li>\n</ul>\n<blockquote>\n<p> å¯ä»¥åªç”¨ length æ¥åˆ¤æ–­æœ‰å¤šå°‘åå€¼å¯¹å„¿å­˜æ”¾åœ¨ Storage å¯¹è±¡ä¸­</p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<p>æµè§ˆå™¨çš„æ•°æ®ç¼“å­˜, å¸¸ç”¨çš„ä¸‰ç§æ–¹å¼cookie/localStorage/sessionStorage</p>\n<h3 id=\"1-cookie\"><a href=\"#1-cookie\" class=\"headerlink\" title=\"1. cookie\"></a>1. cookie</h3><blockquote>\n<p>å…¨ç§°å«åš HTTP Cookie, é€šå¸¸æˆ‘ä»¬ç›´æ¥å«åšCookie, æœ€åˆæ˜¯åœ¨å®¢æˆ·ç«¯ç”¨äºå­˜å‚¨ä¼šè¯ä¿¡æ¯çš„. è¯¥æ ‡å‡†è¦æ±‚æœåŠ¡å™¨å¯¹ä»»æ„ HTTP è¯·æ±‚å‘é€ Set-Cookie Http å¤´ä½œä¸ºå“åº”çš„ä¸€éƒ¨åˆ†, å…¶ä¸­ä¼šåŒ…å«ä¼šè¯ä¿¡æ¯.è¿™ç§ HTTP çš„å“åº”ä»¥ key-valueç»„æˆçš„ä¸€ä¸ªcookie, ä¸”åœ¨ä¼ é€ä¸­éƒ½å¿…é¡»æ˜¯URLç¼–ç   â€”â€”<strong>JavaScripté«˜çº§ç¨‹åºè®¾è®¡</strong>                             </p>\n</blockquote>\n<ul>\n<li>Cookie çš„æ•°æ®å¤§å°é™åˆ¶ä¸èƒ½è¶…è¿‡4k</li>\n<li>æ¯æ¬¡ HTTP è¯·æ±‚éƒ½ä¼šæºå¸¦ Cookie,æ‰€ä»¥Cookieåªé€‚åˆä¿å­˜å¾ˆå°çš„æ•°æ®</li>\n<li>é»˜è®¤ Cookie åœ¨æµè§ˆå™¨ä¼šè¯ç»“æŸæ—¶å°†æ‰€æœ‰ Cookieåˆ é™¤, ä¹Ÿå¯ä»¥è‡ªå·±è®¾ç½®åˆ é™¤æ—¶é—´</li>\n</ul>\n<h4 id=\"JavaScript-ä¸­çš„Cookie\"><a href=\"#JavaScript-ä¸­çš„Cookie\" class=\"headerlink\" title=\"JavaScript ä¸­çš„Cookie\"></a>JavaScript ä¸­çš„Cookie</h4><ul>\n<li>document.cookie å¯ä»¥è®¾ç½®ä¸€ä¸ªæ–°çš„ cookie å­—ç¬¦ä¸², key å’Œ valueæ˜¯å¿…é¡»çš„</li>\n</ul>\n<blockquote>\n<p><code>document.cookie = &#39;name=Cara&#39;;</code></p>\n</blockquote>\n<p>ç”±äºæ¯æ¬¡å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€è¯·æ±‚çš„æ—¶å€™éƒ½ä¼šå‘é€è¿™ä¸ª cookie , æ‰€ä»¥æœ€å¥½æ¯æ¬¡è®¾ç½®çš„æ—¶å€™éƒ½ç”¨<code>encodeURI()</code>è¿›è¡Œç¼–ç , <code>decodeURI()</code>æ¥è§£ç </p>\n<h3 id=\"2-localStorage\"><a href=\"#2-localStorage\" class=\"headerlink\" title=\"2. localStorage\"></a>2. localStorage</h3><p>åœ¨ HTML5 è§„èŒƒä¸­ä½œä¸ºæŒä¹…ä¿å­˜å®¢æˆ·ç«¯æ•°æ®çš„æ–¹æ¡ˆå–ä»£äº†globalStorage(ä»¥åŸŸä½œä¸ºè®¿é—®è§„åˆ™), è¦è®¿é—®åŒä¸€ä¸ª localStorage å¯¹è±¡, é¡µé¢å¿…é¡»æ¥è‡ªåŒä¸€ä¸ªåŸŸå(å­åŸŸåæ— æ•ˆ), ä½¿ç”¨åŒä¸€ç§åè®®, åœ¨åŒä¸€ä¸ªç«¯å£ä¸Š. å°±ç›¸å½“äº globalStorage[location.host].</p>\n<ul>\n<li><p>ä½¿ç”¨æ–¹æ³•å‚¨å­˜æ•°æ®</p>\n<blockquote>\n<p>localStorage.setItem(â€˜nameâ€™, â€˜Caraâ€™)</p>\n</blockquote>\n</li>\n<li><p>ä½¿ç”¨å±æ€§å‚¨å­˜æ•°æ®</p>\n<blockquote>\n<p>localStorage.book = â€˜JavaScriptâ€™</p>\n</blockquote>\n</li>\n<li><p>ä½¿ç”¨æ–¹æ³•è¯»å–æ•°æ®</p>\n<blockquote>\n<p>localStorage.getItem(â€˜nameâ€™)</p>\n</blockquote>\n</li>\n<li><p>ä½¿ç”¨å±æ€§è¯»å–æ•°æ®</p>\n<blockquote>\n<p>var book = localStorage.book</p>\n</blockquote>\n</li>\n<li><p>åˆ é™¤å‚¨å­˜æ•°æ®</p>\n<blockquote>\n<p>localStorage.removeItem(â€˜nameâ€™)</p>\n</blockquote>\n</li>\n</ul>\n<blockquote>\n<p>localStorage å’Œ sessionStorage è™½ç„¶ä¹Ÿæœ‰æ•°æ®å‚¨å­˜å¤§å°é™åˆ¶, ä½†æ¯” cookie è¦å¤§å¾ˆå¤š, å¯ä»¥è¾¾åˆ°5Mæˆ–æ›´å¤§. localStorageçš„æ•°æ®å§‹ç»ˆæœ‰æ•ˆ, å³ä½¿æµè§ˆå™¨å…³é—­ä¹Ÿä¼šä¸€ç›´ä¿å­˜, æ‰€ä»¥åªè¦ä¸ clear() æˆ–è€… removeItem() æ•°æ®å°±å¯ä»¥æ°¸ä¹…ä¿å­˜</p>\n</blockquote>\n<h3 id=\"3-sessionStorage\"><a href=\"#3-sessionStorage\" class=\"headerlink\" title=\"3. sessionStorage\"></a>3. sessionStorage</h3><p>sessionStorageå¯¹è±¡å‚¨å­˜ç‰¹å®šäºæŸä¸ªä¼šè¯çš„æ•°æ®, ä¹Ÿå°±æ˜¯è¯´æ•°æ®åªä¿å­˜åˆ°æµè§ˆå™¨å…³é—­.</p>\n<ul>\n<li>sessionStorageçš„ç”¨æ³•è·ŸlocalStorageçš„ç”¨æ³•ä¸€æ ·</li>\n</ul>\n<h3 id=\"Storageç±»å‹\"><a href=\"#Storageç±»å‹\" class=\"headerlink\" title=\"Storageç±»å‹\"></a>Storageç±»å‹</h3><p>Storage ç±»å‹æä¾›æœ€å¤§çš„å‚¨å­˜ç©ºé—´ ( å› æµè§ˆå™¨è€Œå¼‚ ) æ¥å‚¨å­˜åå€¼å¯¹å„¿, æœ‰å¦‚ä¸‹æ–¹æ³•:</p>\n<ul>\n<li><p>clear(): åˆ é™¤æ‰€æœ‰å€¼; ( Firefox æœªå®ç° )</p>\n</li>\n<li><p>getItem(name): æ ¹æ®æŒ‡å®šçš„åå­— name è·å–å¯¹åº”çš„ value</p>\n</li>\n<li><p>key(idnex): è·å– index ä½ç½®çš„å€¼å¯¹åº”çš„åå­—</p>\n</li>\n<li><p>removeItem(name): åˆ é™¤ç”±nameæŒ‡å®šçš„åå€¼å¯¹å„¿</p>\n</li>\n<li><p>setItem(name, value): è®¾ç½®æŒ‡å®šçš„nameåŠå¯¹åº”çš„value</p>\n</li>\n</ul>\n<blockquote>\n<p> å¯ä»¥åªç”¨ length æ¥åˆ¤æ–­æœ‰å¤šå°‘åå€¼å¯¹å„¿å­˜æ”¾åœ¨ Storage å¯¹è±¡ä¸­</p>\n</blockquote>\n"},{"title":"å…³äºå°†Node.jséƒ¨ç½²åœ¨IISæœåŠ¡å™¨","date":"2017-05-28T12:57:06.000Z","_content":"\n### èµ·å› \nåœ¨å·¥ä½œä¸´æ—¶é‡åˆ°åå°ç®¡ç†ç³»ç»Ÿéœ€è¦ç”¨åˆ°Node.jsåšä¸­è½¬æœåŠ¡, è¾¾åˆ°å³æ—¶é€šè®¯çš„ç›®çš„.\n\nç”±äºåˆšåˆšè½¬è¡ŒåŸºç¡€å®åœ¨å¤ªå·®, åœ¨æ­¤åšä¸‹è®°å½•.\n\n### ä¾èµ–é¡¹\n\n* Node.js\n\n* [URL rewrite](http://www.iis.net/download/URLRewrite)\n\n* [IISNode](http://go.microsoft.com/?linkid=9784334)\n\n### èµ„æº\n\n[GitHubèµ„æ–™](https://github.com/tjanczuk/iisnode)\n\n### ä½¿ç”¨\n\n* #### å®‰è£…`URL rewrite` æ—¶, å¯èƒ½ä¼šå‡ºç°å®‰è£…å¤±è´¥, éœ€è¦æ”¹ä¸‹æ³¨å†Œè¡¨.\n\t\n```\n\tæ‰“å¼€æ³¨å†Œè¡¨ç¼–è¾‘å™¨(win + r `regedit`)ï¼Œåœ¨HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\InetStpä½ç½®\n\næŠŠMajorVersionçš„å€¼æ”¹ä¸º9ä¹‹åï¼Œå°±å¯ä»¥å®‰è£…äº†ï¼Œå®‰è£…å®Œæˆä¹‹åï¼Œå†æŠŠMajorVersionçš„å€¼æ”¹å›10ï¼Œé‡å¯ä¸€ä¸‹iis\n\n```\n\n* #### å®‰è£…IISNode\n\tä¸€è·¯`ä¸‹ä¸€æ­¥`å°±è¡Œ\n\n* #### é…ç½®`web.config`æ–‡ä»¶\n```\n<configuration>\n\t<system.webServer>\n\t\t\n\t\t<!--indicates that the app.js file is a node.js application\n\t\t\tto be handled by the iisnode module -->\n\t\t<handlers>\n\t\t\t<add name=\"iisnode\" path=\"app.js\" verb=\"*\" modules=\"iisnode\" />\n\t\t</handlers>\n\n\t\t<rewrite>\n\t\t\t<rules>\n\t\t\t\t<rule name=\"SendToNode\" patternSyntax=\"ECMAScript\">\n\t\t\t\t\t<match url=\"/*\" />\n\t\t\t\t\t<action type=\"Rewrite\" url=\"app.js\" />\n\t\t\t\t</rule>\n\t\t\t</rules>\n\t\t</rewrite>\n\t\t<webSocket enabled=\"false\"/>\n\t</system.webServer>\n</configuration>\n```\n\n* #### éƒ¨ç½²\n\tåœ¨iiséƒ¨ç½²ä¹‹åä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªiisnodeæ–‡ä»¶å¤¹, é‡Œé¢å­˜å‚¨debugä¿¡æ¯,\n\nå› ä¸ºéƒ¨ç½²åœ¨iisä¹‹å, åŒæ—¶å¯åŠ¨Nodeä¼šæŠ¥é”™æˆ–è€…ä¸ä¼šæ‰“å°ä»»ä½•ä¸œè¥¿.\n\n\n\n\n","source":"_posts/iisNode.md","raw":"---\ntitle: å…³äºå°†Node.jséƒ¨ç½²åœ¨IISæœåŠ¡å™¨\ndate: 2017-05-28 20:57:06\ntags: \n- JavaScript \n- Node.js\ncategories:\n- ç¬”è®°ğŸ“’\n---\n\n### èµ·å› \nåœ¨å·¥ä½œä¸´æ—¶é‡åˆ°åå°ç®¡ç†ç³»ç»Ÿéœ€è¦ç”¨åˆ°Node.jsåšä¸­è½¬æœåŠ¡, è¾¾åˆ°å³æ—¶é€šè®¯çš„ç›®çš„.\n\nç”±äºåˆšåˆšè½¬è¡ŒåŸºç¡€å®åœ¨å¤ªå·®, åœ¨æ­¤åšä¸‹è®°å½•.\n\n### ä¾èµ–é¡¹\n\n* Node.js\n\n* [URL rewrite](http://www.iis.net/download/URLRewrite)\n\n* [IISNode](http://go.microsoft.com/?linkid=9784334)\n\n### èµ„æº\n\n[GitHubèµ„æ–™](https://github.com/tjanczuk/iisnode)\n\n### ä½¿ç”¨\n\n* #### å®‰è£…`URL rewrite` æ—¶, å¯èƒ½ä¼šå‡ºç°å®‰è£…å¤±è´¥, éœ€è¦æ”¹ä¸‹æ³¨å†Œè¡¨.\n\t\n```\n\tæ‰“å¼€æ³¨å†Œè¡¨ç¼–è¾‘å™¨(win + r `regedit`)ï¼Œåœ¨HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\InetStpä½ç½®\n\næŠŠMajorVersionçš„å€¼æ”¹ä¸º9ä¹‹åï¼Œå°±å¯ä»¥å®‰è£…äº†ï¼Œå®‰è£…å®Œæˆä¹‹åï¼Œå†æŠŠMajorVersionçš„å€¼æ”¹å›10ï¼Œé‡å¯ä¸€ä¸‹iis\n\n```\n\n* #### å®‰è£…IISNode\n\tä¸€è·¯`ä¸‹ä¸€æ­¥`å°±è¡Œ\n\n* #### é…ç½®`web.config`æ–‡ä»¶\n```\n<configuration>\n\t<system.webServer>\n\t\t\n\t\t<!--indicates that the app.js file is a node.js application\n\t\t\tto be handled by the iisnode module -->\n\t\t<handlers>\n\t\t\t<add name=\"iisnode\" path=\"app.js\" verb=\"*\" modules=\"iisnode\" />\n\t\t</handlers>\n\n\t\t<rewrite>\n\t\t\t<rules>\n\t\t\t\t<rule name=\"SendToNode\" patternSyntax=\"ECMAScript\">\n\t\t\t\t\t<match url=\"/*\" />\n\t\t\t\t\t<action type=\"Rewrite\" url=\"app.js\" />\n\t\t\t\t</rule>\n\t\t\t</rules>\n\t\t</rewrite>\n\t\t<webSocket enabled=\"false\"/>\n\t</system.webServer>\n</configuration>\n```\n\n* #### éƒ¨ç½²\n\tåœ¨iiséƒ¨ç½²ä¹‹åä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªiisnodeæ–‡ä»¶å¤¹, é‡Œé¢å­˜å‚¨debugä¿¡æ¯,\n\nå› ä¸ºéƒ¨ç½²åœ¨iisä¹‹å, åŒæ—¶å¯åŠ¨Nodeä¼šæŠ¥é”™æˆ–è€…ä¸ä¼šæ‰“å°ä»»ä½•ä¸œè¥¿.\n\n\n\n\n","slug":"iisNode","published":1,"updated":"2018-05-05T09:23:03.670Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjgurolsr0015klu00d8fgzcq","content":"<h3 id=\"èµ·å› \"><a href=\"#èµ·å› \" class=\"headerlink\" title=\"èµ·å› \"></a>èµ·å› </h3><p>åœ¨å·¥ä½œä¸´æ—¶é‡åˆ°åå°ç®¡ç†ç³»ç»Ÿéœ€è¦ç”¨åˆ°Node.jsåšä¸­è½¬æœåŠ¡, è¾¾åˆ°å³æ—¶é€šè®¯çš„ç›®çš„.</p>\n<p>ç”±äºåˆšåˆšè½¬è¡ŒåŸºç¡€å®åœ¨å¤ªå·®, åœ¨æ­¤åšä¸‹è®°å½•.</p>\n<h3 id=\"ä¾èµ–é¡¹\"><a href=\"#ä¾èµ–é¡¹\" class=\"headerlink\" title=\"ä¾èµ–é¡¹\"></a>ä¾èµ–é¡¹</h3><ul>\n<li><p>Node.js</p>\n</li>\n<li><p><a href=\"http://www.iis.net/download/URLRewrite\" target=\"_blank\" rel=\"noopener\">URL rewrite</a></p>\n</li>\n<li><p><a href=\"http://go.microsoft.com/?linkid=9784334\" target=\"_blank\" rel=\"noopener\">IISNode</a></p>\n</li>\n</ul>\n<h3 id=\"èµ„æº\"><a href=\"#èµ„æº\" class=\"headerlink\" title=\"èµ„æº\"></a>èµ„æº</h3><p><a href=\"https://github.com/tjanczuk/iisnode\" target=\"_blank\" rel=\"noopener\">GitHubèµ„æ–™</a></p>\n<h3 id=\"ä½¿ç”¨\"><a href=\"#ä½¿ç”¨\" class=\"headerlink\" title=\"ä½¿ç”¨\"></a>ä½¿ç”¨</h3><ul>\n<li><h4 id=\"å®‰è£…URL-rewrite-æ—¶-å¯èƒ½ä¼šå‡ºç°å®‰è£…å¤±è´¥-éœ€è¦æ”¹ä¸‹æ³¨å†Œè¡¨\"><a href=\"#å®‰è£…URL-rewrite-æ—¶-å¯èƒ½ä¼šå‡ºç°å®‰è£…å¤±è´¥-éœ€è¦æ”¹ä¸‹æ³¨å†Œè¡¨\" class=\"headerlink\" title=\"å®‰è£…URL rewrite æ—¶, å¯èƒ½ä¼šå‡ºç°å®‰è£…å¤±è´¥, éœ€è¦æ”¹ä¸‹æ³¨å†Œè¡¨.\"></a>å®‰è£…<code>URL rewrite</code> æ—¶, å¯èƒ½ä¼šå‡ºç°å®‰è£…å¤±è´¥, éœ€è¦æ”¹ä¸‹æ³¨å†Œè¡¨.</h4></li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">\tæ‰“å¼€æ³¨å†Œè¡¨ç¼–è¾‘å™¨(win + r `regedit`)ï¼Œåœ¨HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\InetStpä½ç½®</span><br><span class=\"line\"></span><br><span class=\"line\">æŠŠMajorVersionçš„å€¼æ”¹ä¸º9ä¹‹åï¼Œå°±å¯ä»¥å®‰è£…äº†ï¼Œå®‰è£…å®Œæˆä¹‹åï¼Œå†æŠŠMajorVersionçš„å€¼æ”¹å›10ï¼Œé‡å¯ä¸€ä¸‹iis</span><br></pre></td></tr></table></figure>\n<ul>\n<li><h4 id=\"å®‰è£…IISNode\"><a href=\"#å®‰è£…IISNode\" class=\"headerlink\" title=\"å®‰è£…IISNode\"></a>å®‰è£…IISNode</h4><p>  ä¸€è·¯<code>ä¸‹ä¸€æ­¥</code>å°±è¡Œ</p>\n</li>\n<li><h4 id=\"é…ç½®web-configæ–‡ä»¶\"><a href=\"#é…ç½®web-configæ–‡ä»¶\" class=\"headerlink\" title=\"é…ç½®web.configæ–‡ä»¶\"></a>é…ç½®<code>web.config</code>æ–‡ä»¶</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;configuration&gt;</span><br><span class=\"line\">\t&lt;system.webServer&gt;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t&lt;!--indicates that the app.js file is a node.js application</span><br><span class=\"line\">\t\t\tto be handled by the iisnode module --&gt;</span><br><span class=\"line\">\t\t&lt;handlers&gt;</span><br><span class=\"line\">\t\t\t&lt;add name=&quot;iisnode&quot; path=&quot;app.js&quot; verb=&quot;*&quot; modules=&quot;iisnode&quot; /&gt;</span><br><span class=\"line\">\t\t&lt;/handlers&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t&lt;rewrite&gt;</span><br><span class=\"line\">\t\t\t&lt;rules&gt;</span><br><span class=\"line\">\t\t\t\t&lt;rule name=&quot;SendToNode&quot; patternSyntax=&quot;ECMAScript&quot;&gt;</span><br><span class=\"line\">\t\t\t\t\t&lt;match url=&quot;/*&quot; /&gt;</span><br><span class=\"line\">\t\t\t\t\t&lt;action type=&quot;Rewrite&quot; url=&quot;app.js&quot; /&gt;</span><br><span class=\"line\">\t\t\t\t&lt;/rule&gt;</span><br><span class=\"line\">\t\t\t&lt;/rules&gt;</span><br><span class=\"line\">\t\t&lt;/rewrite&gt;</span><br><span class=\"line\">\t\t&lt;webSocket enabled=&quot;false&quot;/&gt;</span><br><span class=\"line\">\t&lt;/system.webServer&gt;</span><br><span class=\"line\">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>\n</li>\n<li><h4 id=\"éƒ¨ç½²\"><a href=\"#éƒ¨ç½²\" class=\"headerlink\" title=\"éƒ¨ç½²\"></a>éƒ¨ç½²</h4><p>  åœ¨iiséƒ¨ç½²ä¹‹åä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªiisnodeæ–‡ä»¶å¤¹, é‡Œé¢å­˜å‚¨debugä¿¡æ¯,</p>\n</li>\n</ul>\n<p>å› ä¸ºéƒ¨ç½²åœ¨iisä¹‹å, åŒæ—¶å¯åŠ¨Nodeä¼šæŠ¥é”™æˆ–è€…ä¸ä¼šæ‰“å°ä»»ä½•ä¸œè¥¿.</p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"èµ·å› \"><a href=\"#èµ·å› \" class=\"headerlink\" title=\"èµ·å› \"></a>èµ·å› </h3><p>åœ¨å·¥ä½œä¸´æ—¶é‡åˆ°åå°ç®¡ç†ç³»ç»Ÿéœ€è¦ç”¨åˆ°Node.jsåšä¸­è½¬æœåŠ¡, è¾¾åˆ°å³æ—¶é€šè®¯çš„ç›®çš„.</p>\n<p>ç”±äºåˆšåˆšè½¬è¡ŒåŸºç¡€å®åœ¨å¤ªå·®, åœ¨æ­¤åšä¸‹è®°å½•.</p>\n<h3 id=\"ä¾èµ–é¡¹\"><a href=\"#ä¾èµ–é¡¹\" class=\"headerlink\" title=\"ä¾èµ–é¡¹\"></a>ä¾èµ–é¡¹</h3><ul>\n<li><p>Node.js</p>\n</li>\n<li><p><a href=\"http://www.iis.net/download/URLRewrite\" target=\"_blank\" rel=\"noopener\">URL rewrite</a></p>\n</li>\n<li><p><a href=\"http://go.microsoft.com/?linkid=9784334\" target=\"_blank\" rel=\"noopener\">IISNode</a></p>\n</li>\n</ul>\n<h3 id=\"èµ„æº\"><a href=\"#èµ„æº\" class=\"headerlink\" title=\"èµ„æº\"></a>èµ„æº</h3><p><a href=\"https://github.com/tjanczuk/iisnode\" target=\"_blank\" rel=\"noopener\">GitHubèµ„æ–™</a></p>\n<h3 id=\"ä½¿ç”¨\"><a href=\"#ä½¿ç”¨\" class=\"headerlink\" title=\"ä½¿ç”¨\"></a>ä½¿ç”¨</h3><ul>\n<li><h4 id=\"å®‰è£…URL-rewrite-æ—¶-å¯èƒ½ä¼šå‡ºç°å®‰è£…å¤±è´¥-éœ€è¦æ”¹ä¸‹æ³¨å†Œè¡¨\"><a href=\"#å®‰è£…URL-rewrite-æ—¶-å¯èƒ½ä¼šå‡ºç°å®‰è£…å¤±è´¥-éœ€è¦æ”¹ä¸‹æ³¨å†Œè¡¨\" class=\"headerlink\" title=\"å®‰è£…URL rewrite æ—¶, å¯èƒ½ä¼šå‡ºç°å®‰è£…å¤±è´¥, éœ€è¦æ”¹ä¸‹æ³¨å†Œè¡¨.\"></a>å®‰è£…<code>URL rewrite</code> æ—¶, å¯èƒ½ä¼šå‡ºç°å®‰è£…å¤±è´¥, éœ€è¦æ”¹ä¸‹æ³¨å†Œè¡¨.</h4></li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">\tæ‰“å¼€æ³¨å†Œè¡¨ç¼–è¾‘å™¨(win + r `regedit`)ï¼Œåœ¨HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\InetStpä½ç½®</span><br><span class=\"line\"></span><br><span class=\"line\">æŠŠMajorVersionçš„å€¼æ”¹ä¸º9ä¹‹åï¼Œå°±å¯ä»¥å®‰è£…äº†ï¼Œå®‰è£…å®Œæˆä¹‹åï¼Œå†æŠŠMajorVersionçš„å€¼æ”¹å›10ï¼Œé‡å¯ä¸€ä¸‹iis</span><br></pre></td></tr></table></figure>\n<ul>\n<li><h4 id=\"å®‰è£…IISNode\"><a href=\"#å®‰è£…IISNode\" class=\"headerlink\" title=\"å®‰è£…IISNode\"></a>å®‰è£…IISNode</h4><p>  ä¸€è·¯<code>ä¸‹ä¸€æ­¥</code>å°±è¡Œ</p>\n</li>\n<li><h4 id=\"é…ç½®web-configæ–‡ä»¶\"><a href=\"#é…ç½®web-configæ–‡ä»¶\" class=\"headerlink\" title=\"é…ç½®web.configæ–‡ä»¶\"></a>é…ç½®<code>web.config</code>æ–‡ä»¶</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;configuration&gt;</span><br><span class=\"line\">\t&lt;system.webServer&gt;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t&lt;!--indicates that the app.js file is a node.js application</span><br><span class=\"line\">\t\t\tto be handled by the iisnode module --&gt;</span><br><span class=\"line\">\t\t&lt;handlers&gt;</span><br><span class=\"line\">\t\t\t&lt;add name=&quot;iisnode&quot; path=&quot;app.js&quot; verb=&quot;*&quot; modules=&quot;iisnode&quot; /&gt;</span><br><span class=\"line\">\t\t&lt;/handlers&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t&lt;rewrite&gt;</span><br><span class=\"line\">\t\t\t&lt;rules&gt;</span><br><span class=\"line\">\t\t\t\t&lt;rule name=&quot;SendToNode&quot; patternSyntax=&quot;ECMAScript&quot;&gt;</span><br><span class=\"line\">\t\t\t\t\t&lt;match url=&quot;/*&quot; /&gt;</span><br><span class=\"line\">\t\t\t\t\t&lt;action type=&quot;Rewrite&quot; url=&quot;app.js&quot; /&gt;</span><br><span class=\"line\">\t\t\t\t&lt;/rule&gt;</span><br><span class=\"line\">\t\t\t&lt;/rules&gt;</span><br><span class=\"line\">\t\t&lt;/rewrite&gt;</span><br><span class=\"line\">\t\t&lt;webSocket enabled=&quot;false&quot;/&gt;</span><br><span class=\"line\">\t&lt;/system.webServer&gt;</span><br><span class=\"line\">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>\n</li>\n<li><h4 id=\"éƒ¨ç½²\"><a href=\"#éƒ¨ç½²\" class=\"headerlink\" title=\"éƒ¨ç½²\"></a>éƒ¨ç½²</h4><p>  åœ¨iiséƒ¨ç½²ä¹‹åä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªiisnodeæ–‡ä»¶å¤¹, é‡Œé¢å­˜å‚¨debugä¿¡æ¯,</p>\n</li>\n</ul>\n<p>å› ä¸ºéƒ¨ç½²åœ¨iisä¹‹å, åŒæ—¶å¯åŠ¨Nodeä¼šæŠ¥é”™æˆ–è€…ä¸ä¼šæ‰“å°ä»»ä½•ä¸œè¥¿.</p>\n"},{"title":"this/ call and apply","date":"2017-10-17T15:01:38.000Z","_content":"åœ¨ JavaScript ä¸­, `this `å…³é”®å­—å¾ˆå®¹æ˜“ä½¿å¤§å®¶ç–‘æƒ‘, å†åŠ ä¸Š `Function.prototype.call`å’Œ`Function.prototype.apply`è¿™ä¸¤ä¸ªæ–¹æ³•çš„å¹¿æ³›è¿ç”¨, æ‰€ä»¥å¾ˆæœ‰å¿…è¦å¼„æ¸…`this`çš„ä½¿ç”¨.\n\n>  ### this\n> é¦–å…ˆå…ˆè¯´ä¸€ä¸‹`this`çš„æ¦‚å¿µ: `this`æ€»æ˜¯æŒ‡å‘ä¸€ä¸ªå¯¹è±¡, è€Œè¿™ä¸ªå¯¹è±¡å…·ä½“æ˜¯è°, æ˜¯æ ¹æ®è¿è¡Œæ—¶çš„å‡½æ•°æ‰§è¡Œçš„ç¯å¢ƒåŠ¨æ€ç»‘å®šçš„, è€Œéå‡½æ•°è¢«å£°æ˜æ—¶çš„ç¯å¢ƒ. å½“ç„¶åˆ°ç°åœ¨ç®­å¤´å‡½æ•°çš„å‡ºç°, `this`å¯¹ä¸äº†è§£çš„åŒå­¦ä»¬æ¥è¯´, æ— ç–‘æ˜¯æ·»äº†ä¸€æŠŠä¹±â€¦ æ¥ä¸‹æ¥æˆ‘ä»¬ä¸€ä¸ªä¸€ä¸ªçš„æ¥è¯´å§.\n\n#### 1. `this`çš„æŒ‡å‘\næˆ‘ä»¬é™¤å¼€ä¸å¸¸ç”¨çš„ with å’Œ eval çš„æƒ…å†µ, å…·ä½“åˆ°å®é™…åº”ç”¨ä¸­, `this`çš„æŒ‡å‘å¤§è‡´å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å››ç§æƒ…å†µ.\n\n- ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•è¢«è°ƒç”¨\n- ä½œä¸ºæ™®é€šå‡½æ•°è¢«è°ƒç”¨\n- æ„é€ å™¨è°ƒç”¨\n- è¢« call å’Œ apply æ–¹æ³•è°ƒç”¨\nä¸‹é¢æ¥ç”¨ < JavaScript è®¾è®¡æ¨¡å¼ > ä¸­çš„ä¾‹å­è¯´æ˜è¿™å››ç§æƒ…å†µ.\n\n    1. ä½œä¸ºå¯¹è±¡æ–¹æ³•è°ƒç”¨\n    å½“å‡½æ•°ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•è¢«è°ƒç”¨æ—¶, `this`æŒ‡å‘è¯¥å¯¹è±¡:\n```javascript\nlet name = 'window';\nlet obj = {\n    name: 'cara',\n    getName: function () {\n        console.log(this === obj)\n        console.log(this.name)\n    }\n}\nobj.getName() // true 'cara'\n```\n\n    2. ä½œä¸ºæ™®é€šå‡½æ•°è°ƒç”¨\n    å½“å‡½æ•°ä¸ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•è¢«è°ƒç”¨æ—¶, ä¹Ÿå°±æ˜¯æˆ‘ä»¬å¹³å¸¸è¯´çš„æ™®é€šå‡½æ•°çš„æ–¹å¼, æ­¤æ—¶çš„`this`æ€»æ˜¯æŒ‡å‘å…¨å±€å¯¹è±¡.\n```javascript\nwindow.name = 'window';\nlet getName = function () {\n    return this.name\n}\nconsole.log(getName()) // 'window'\n\n// æˆ–è€…\n\nwindow.name = 'window';\nlet obj = {\n    name: 'obj',\n    getName: function () {\n        return this.name\n    }\n}\n// è¿™é‡Œ obj çš„ getNameæ–¹æ³•èµ‹å€¼ç»™äº†ä¸€ä¸ªå˜é‡\n// è°ƒç”¨çš„æ—¶å€™å°±åªä¼šä½œä¸ºä¸€ä¸ªæ™®é€šå‡½æ•°è°ƒç”¨\nlet getName = obj.gatName;\nconsole.log(getName()) // 'window'\n```\n    ä¸Šé¢è¿™ä¸­ä½œä¸ºæ™®é€šå‡½æ•°è°ƒç”¨çš„æ–¹å¼å¸¸å¸¸ä¼šå¸¦æ¥ä¸€äº›å›°æ‰°, æ¯”å¦‚åœ¨æŸä¸ª div èŠ‚ç‚¹çš„äº‹ä»¶å‡½æ•°ä¸­, å®šä¹‰äº†ä¸€ä¸ªå±€éƒ¨çš„ callback æ–¹æ³•. è€Œè¿™ä¸ª callback æ–¹æ³•æˆ‘ä»¬å¾€å¾€æ˜¯æƒ³è®©å®ƒçš„ `this`æŒ‡å‘ div èŠ‚ç‚¹, ä½†å®ƒå†…éƒ¨å´æŒ‡å‘`window`. å¦‚:\n```html\n<div id='div1'>æˆ‘æ˜¯ä¸€ä¸ª div</div>\n```\n    ```javascript\n        window.id = 'window';\n        document.getElementById('div1').onclick = function () {\n            console.log(this.id); // 'div1'\n            let callback = function (){\n                console.log(this.id); // 'window'\t\n            }\n            callback() // ä½œä¸ºæ™®é€šå‡½æ•°è¢«è°ƒç”¨\n        }\n    ```\n    è¦è§£å†³ä»¥ä¸Šé—®é¢˜å…¶å®ä¹Ÿå¾ˆç®€å•, å¦‚ä¸‹:\n```javascript\nwindow.id = 'window';\ndocument.getElementById('div1').onclick = function () {\n    console.log(this.id);\n    let that = this; // ç”¨ä¸€ä¸ªå˜é‡æ¥å‚¨å­˜èŠ‚ç‚¹çš„å¼•ç”¨\n    let callback = function (){\n        console.log(that.id); // 'div1'\t\n    }\n    callback() // ä½œä¸ºæ™®é€šå‡½æ•°è¢«è°ƒç”¨\n}\n```\n    3. æ„é€ å™¨è°ƒç”¨\n    å…ˆè¯´è¯´æ„é€ å™¨å§, js ä¸­æ²¡æœ‰ç±»çš„æ¦‚å¿µ, ä½†æ˜¯å¯ä»¥ä»æ„é€ å™¨ä¸­åˆ›å»ºå¯¹è±¡, åŒæ—¶æä¾› `new` è¿ç®—ç¬¦, è®©æ„é€ å™¨çœ‹èµ·æ¥æ›´åƒä¸€ä¸ªç±». Js ä¸­å¤§éƒ¨åˆ†å‡½æ•°éƒ½å¯ä»¥å½“åšæ„é€ å™¨æ¥ä½¿ç”¨, æ‰€ä»¥å®ƒçš„å¤–è¡¨çœ‹èµ·æ¥è·Ÿæ™®é€šå‡½æ•°ä¸€æ ·, åŒºåˆ«åœ¨äºè¢«è°ƒç”¨çš„æ–¹å¼. å½“ç”¨ `new` è¿ç®—ç¬¦è°ƒç”¨æ—¶, è¯¥å‡½æ•°ä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡. é€šå¸¸æƒ…å†µä¸‹, æ„é€ å™¨é‡Œçš„ `this` å°±æŒ‡å‘è¿”å›çš„è¿™ä¸ªå¯¹è±¡, å¦‚ä¸‹:\n```javascript\nconst Myobj = function () {\n    this.name = 'cara';\n}\n\nlet obj = new Myobj();\nconsole.log(obj.name); // 'cara'\n```\n    ä½†æ˜¯ä½¿ç”¨ `new`è°ƒç”¨æ„é€ å™¨æ—¶, è¦æ³¨æ„ä¸€ä¸ªé—®é¢˜. å¦‚æœæ„é€ å™¨æ˜¾å¼åœ°è¿”å›äº†ä¸€ä¸ªå¯¹è±¡, é‚£ä¹ˆæœ€ç»ˆå°±ä¼šè¿”å›è¿™ä¸ªå¯¹è±¡, è€Œä¸æ˜¯æˆ‘ä»¬çš„æœŸæœ›çš„ `this`:\n```javascript\nconst Myobj = function () {\n    this.name = 'cara';\n    return {\n        name: 'somebody'\n    }\n}\n\nlet obj = new Myobj();\nconsole.log(obj.name); // 'somebody'\n```\n    å¦‚æœæ„é€ å™¨ä¸æ˜¾å¼åœ°è¿”å›ä»»ä½•æ•°æ®æˆ–æ˜¯è¿”å›ä¸€ä¸ªéå¯¹è±¡ç±»å‹çš„æ•°æ®, å°±ä¸ä¼šå‡ºç°ä¸Šè¿°æƒ…å†µ\n\n    4. call æˆ– apply æ–¹æ³•è°ƒç”¨\n    è·Ÿæ™®é€šçš„å‡½æ•°è°ƒç”¨ç›¸æ¯”, ç”¨ call æˆ–è€… apply æ–¹æ³•è°ƒç”¨å¯ä»¥åŠ¨æ€åœ°æ”¹å˜ä¼ å…¥å‡½æ•°çš„ `this`:\n```javascript\nlet obj1 = {\n    name: 'cara',\n    getName: function () {\n        return this.name\n    }\n};\n\nlet obj2 = {\n    name: 'ben'\n};\n\nconsole.log(obj1.name); // 'cara'\nconsole.log(obj1.name.call(obj2)); // 'ben'\n```\n    call å’Œ apply æ–¹æ³•èƒ½å¤Ÿå¾ˆå¥½çš„ä½“ç° js çš„å‡½æ•°å¼è¯­è¨€ç‰¹æ€§. åœ¨ js ä¸­å‡ ä¹æ¯ä¸€æ¬¡ç¼–å†™å‡½æ•°å¼è¯­è¨€é£æ ¼çš„ä»£ç éƒ½ç¦»ä¸å¼€ call å’Œ apply.\n\n#### 2. ä¸¢å¤±çš„ this\nè¿™æ˜¯ä¸€ä¸ªç»å¸¸é‡åˆ°çš„é—®é¢˜, åœ¨åˆšåˆšå¼€å§‹å­¦ä¹  js æ—¶,`this`çš„æŒ‡å‘å¸¸å¸¸ä»¤æˆ‘ç–‘æƒ‘, å°¤å…¶æ˜¯çœ‹åˆ°ç½‘ä¸Šå…³äº`this`æŒ‡å‘çš„é¢˜ç›®, ç®€ç›´äº‘é‡Œé›¾é‡Œ. ä¸‹é¢å°±æ¥çœ‹ä¸€äº›ä¾‹å­å§!\n\n```javascript\nconst obj = {\n    name: 'apple',\n    getName: function () {\n        return this.name;\n    }\n}\n\nconsole.log(obj.getName()); // 'apple'\nlet getMyName = obj.getName;\nconsole.log(getMyName()); // undefined\n```\nä¸Šé¢è¿™ä¸ªä¾‹å­å¥½ç†è§£, å°±æ˜¯é€šè¿‡ä¸€ä¸ªå˜é‡æ¥å¼•ç”¨`obj.getName`æ–¹æ³•, å¹¶ä¸”è°ƒç”¨ getMyName æ—¶, å°±æ˜¯ç”¨çš„æ™®é€šå‡½æ•°è°ƒç”¨æ–¹å¼, `this`æ˜¯æŒ‡å‘å…¨å±€ window çš„.\n\n    æ¥ä¸‹æ¥å†æ¥çœ‹ä¸€ä¸ªç¨å¾®å¤æ‚ä¸€ç‚¹çš„ä¾‹å­å§:\n```javascript\nlet name = 'window';\nconst person = {\n    name: 'person',\n    showName1: function () {\n        console.log(this.name)\n    },\n    showName2: _ => console.log(this.name),\n    showName3: function () {\n        return function () {\n            console.log(this.name)\n        }\n    },\n    showName4: function () {\n        return _ => console.log(this.name)\n    }\n};\nconst person2 = {name: 'person2'};\n\nperson.showName1();\nperson.showName1().call(person2);\n\nperson.showName2();\nperson.showName2().call(person2);\n\nperson.showName3()();\nperson.showName3().call(person2);\nperson.showName3.call(person2)();\n\nperson.showName4()();\nperson.showName4().call(person2);\nperson.showName4.call(person2)();\n```\nè¿™ä¸ªä¾‹å­å¯èƒ½å¤§å®¶å·²ç»å¾ˆçœ¼ç†Ÿäº†, ä¸è¿‡å½“æ—¶æˆ‘ç¬¬ä¸€æ¬¡åšçš„æ—¶å€™å‡ ä¹é”™äº†ä¸€å¤§åŠğŸ˜’â€¦. ç°åœ¨å†æ‹¿å‡ºæ¥çœ‹çœ‹å…¶å®è¿˜æ˜¯å¾ˆç»å…¸çš„: åœ¨ person å’Œ person2 ä¹‹é—´ç–¯ç‹‚ç© showName æ–¹æ³•. åœ¨ç»™å‡ºç­”æ¡ˆä¹‹å‰æˆ‘ä»¬å…ˆçœ‹çœ‹ç®­å¤´å‡½æ•°çš„ä¸€äº›ç‰¹ç‚¹:\n\n- ç®­å¤´å‡½æ•°ä¸å¯ç”¨ä½œæ„é€ å‡½æ•°.\n- ä¸å¯ä»¥ä½¿ç”¨ `arguments`å¯¹è±¡, å¦‚æœè¦ç”¨å¯ä»¥ä½¿ç”¨ rest å‚æ•°ä»£æ›¿.\n- ä¸èƒ½ä½¿ç”¨`yield`å‘½ä»¤, æ‰€ä»¥ç®­å¤´å‡½æ•°ä¹Ÿä¸èƒ½ä½œä¸º Generator å‡½æ•°.\n- ç®­å¤´å‡½æ•°çš„`this`æ˜¯å®šä¹‰æ—¶æ‰€åœ¨çš„å¯¹è±¡, è€Œä¸æ˜¯æ‰§è¡Œæ—¶æ‰€åœ¨çš„å¯¹è±¡.\n\n    åœ¨æœ€åä¸€ç‚¹çš„`this`æŒ‡å‘ä¸Š, æˆ‘ä¸ªäººè§‰å¾—æœ‰ç‚¹è¯¯å¯¼(ä¹Ÿå¯èƒ½æ˜¯æˆ‘æ²¡ç†è§£åˆ°ä½)â€¦ å› ä¸ºå¦‚æœåœ¨å¯¹è±¡å­—é¢é‡ä¸­çš„æ–¹æ³•æ˜¯é€šè¿‡ç®­å¤´å‡½æ•°å®šä¹‰çš„è¯, `this`çš„æŒ‡å‘å°±ä¼šå’Œä½ æœŸæœ›çš„ä¸ä¸€æ ·äº†. \n\n```javascript\nlet name = 'window'\nlet obj = {\n    name: 'obj',\n    getName: _ => console.log(this.name)\n}\nobj.getName(); // 'window'\n```\næ‰€ä»¥æˆ‘è§‰å¾—å…³äºç†è§£ç®­å¤´å‡½æ•°`this`åœ¨å®šä¹‰æ—¶æ‰€åœ¨çš„å¯¹è±¡æ˜¯è¿™æ ·: `this`ç»§æ‰¿è‡ªçˆ¶çº§çš„æ‰§è¡Œä¸Šä¸‹æ–‡(ç®€å•å¯¹è±¡å³éå‡½æ•°, æ˜¯æ²¡æœ‰æ‰§è¡Œä¸Šä¸‹æ–‡çš„), æ‰€ä»¥ä¸Šé¢ä¾‹å­å°±æ˜¯ getName æ–¹æ³•çš„çˆ¶çº§æ˜¯ obj, è€Œ obj çš„æ‰§è¡Œä¸Šä¸‹æ–‡æ˜¯`window`, å› æ­¤è¾“å‡ºå…¨å±€å¯¹è±¡çš„ name. ç†è§£äº†å…³äºç®­å¤´å‡½æ•°`this`çš„æŒ‡å‘, ç°åœ¨å†æ¥çœ‹çœ‹ç­”æ¡ˆå§:\n\n```javascript\nperson.showName1(); // 'person'\nperson.showName1().call(person2); //  'person2'\n\nperson.showName2(); // 'window'\nperson.showName2().call(person2); // 'window'\n\nperson.showName3()(); // 'window'\nperson.showName3().call(person2); // 'person2'\nperson.showName3.call(person2)(); // 'window'\n\nperson.showName4()(); // 'person'\nperson.showName4().call(person2); // 'person'\nperson.showName4.call(person2)(); // 'perons2'\n```\n\nç„¶åæ¥åˆ†æä¸€ä¸‹ç­”æ¡ˆå§:\n- è°ƒç”¨ showName1() \nè¿™ä¸¤ä¸ªæ–¹å¼å¥½ç†è§£, ç¬¬ä¸€ç§æ˜¯é€šè¿‡ person å¯¹è±¡æ¥è°ƒç”¨çš„ showName1 æ–¹æ³•, ä¹Ÿå°±æ˜¯ä¸Šé¢æˆ‘ä»¬è¯´è¿‡çš„**ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•è¢«è°ƒç”¨**, æ‰€ä»¥`this`è‡ªç„¶æŒ‡å‘çš„æ˜¯person å¯¹è±¡; ç¬¬äºŒç§æ˜¯**è¢« call å’Œ apply æ–¹æ³•è°ƒç”¨**, æ‰€ä»¥`this`æŒ‡å‘çš„æ˜¯è¢« call æ–¹æ³•çŸ«æ­£çš„ person2.\n\n- è°ƒç”¨ showName2()\nshowName2 æ–¹æ³•æ˜¯ä¸€ä¸ªç®­å¤´å‡½æ•°, æ ¹æ®æˆ‘ä»¬ä¹‹å‰è¯´è¿‡çš„ç®­å¤´å‡½æ•°æŒ‡å‘é—®é¢˜æ¥çœ‹. ç¬¬ä¸€ç§é€šè¿‡ person å¯¹è±¡æ¥è°ƒç”¨, ç”±äº person æ˜¯ä¸€ä¸ªç®€å•å¯¹è±¡æ‰€ä»¥è¿™é‡Œå®ƒçš„æ‰§è¡Œä¸Šä¸‹æ–‡å°±æ˜¯`window`, é‚£ä¹ˆå°±æ˜¯ä½œä¸ºæ™®é€šå‡½æ•°è°ƒç”¨, `this`æŒ‡å‘ `window`; ç¬¬äºŒç§è·Ÿç¬¬ä¸€ç§æ˜¯ç›¸åŒçš„è°ƒç”¨æ–¹å¼, åªæ˜¯æŠŠ person å¯¹è±¡æ¢ä¸º person2.\n\n- è°ƒç”¨ showName3()\nPerson.showName3 æ˜¯ä¸€ä¸ªé«˜é˜¶å‡½æ•°, è¿”å›äº†ä¸€ä¸ªåŒ¿åå‡½æ•°. ç¬¬ä¸€ç§æ–¹å¼ç›¸å½“äºç›´æ¥è°ƒç”¨é‚£ä¸ªåŒ¿åå‡½æ•°æ‰§è¡Œç¯å¢ƒå°±æ˜¯`window`, æ‰€ä»¥`this`æŒ‡å‘`window`; ç¬¬äºŒç§æ–¹å¼é€šè¿‡ person2 æ¥è°ƒç”¨ person çš„é«˜é˜¶å‡½æ•°, è¾“å‡º person2; ç¬¬ä¸‰ç§å…ˆé€šè¿‡ person2 è°ƒç”¨ person çš„é«˜é˜¶å‡½æ•°, ç„¶ååœ¨å…¨å±€ä½œç”¨åŸŸä¸‹æ‰§è¡Œ, å› æ­¤`this`æŒ‡å‘`window`.\n\n- è°ƒç”¨ showName4()\næœ€åè¿™ä¸‰ç»„è°ƒç”¨ä¹Ÿæ˜¯é«˜é˜¶å‡½æ•°, ä¸è¿‡è¿”å›çš„åŒ¿åå‡½æ•°ç”¨çš„ç®­å¤´å‡½æ•°. å‰ä¸¤ç§æ–¹å¼ä¹Ÿå°±å°è¯äº†æˆ‘ä»¬ä¹‹å‰æ‰€è¯´çš„**ç®­å¤´å‡½æ•°çš„ this ç»§æ‰¿è‡ªçˆ¶çº§æ‰§è¡Œä¸Šä¸‹æ–‡**, æ‰€ä»¥å‰ä¸¤ç§éƒ½è¾“å‡º person, å°±ç®—ç¬¬äºŒç§æ–¹å¼åé¢ç”¨ call æ–¹æ³•æ¥çŸ«æ­£ä¹Ÿæ˜¯ä¸è¡Œçš„; ç¬¬ä¸‰ç§ä¹Ÿå°±æ˜¯é€šè¿‡ person2 æ¥è°ƒç”¨æ‰§è¡Œçš„ showName4 æ–¹æ³•, è‡ªç„¶ä¹Ÿå°±è¾“å‡º person2 å•¦.\n \n> ### call å’Œ apply\nFunction.prototype.call() å’Œ Function.prototype.apply() éƒ½æ˜¯éå¸¸å¸¸ç”¨çš„æ–¹æ³•, åœ¨å®é™…å¼€å‘ä¸­å’Œ JavaScript çš„è®¾è®¡æ¨¡å¼ä¸­è¿™ä¸¤ä¸ªæ–¹æ³•åº”ç”¨å¹¿æ³›. å…¶å®å®ƒä»¬çš„ä½œç”¨æ˜¯ä¸€æ ·çš„, åªæ˜¯æœ‰ä¼ å…¥å‚æ•°å½¢å¼ä¸åŒçš„åŒºåˆ«.\n\n- apply\napply æ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‚æ•°: ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šå‡½æ•°ä½“ä¸­ `this`çš„æŒ‡å‘; ç¬¬äºŒä¸ªå‚æ•°ä¸ºä¸€ä¸ªå¸¦ä¸‹æ ‡çš„åˆé›†(å¯ä»¥æ˜¯æ•°ç»„æˆ–è€…ç±»æ•°ç»„), è¿™ä¸ªå‚æ•°å°†ä¼šä¼ é€’ç»™è¢«è°ƒç”¨çš„å‡½æ•°.\n```javascript\nlet fn = function (a, b, c) {\n\tconsole.log(a, b, c); // 1 2 3\n}\n// ç¬¬ä¸€ä¸ªå‚æ•°ä¸º null çš„è¯, è¡¨ç¤ºä¸æ”¹å˜ this çš„æŒ‡å‘\nfn.apply(null, [1, 2, 3]); \n```\n- call\ncall æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°å’Œ apply æ–¹æ³•ä¸€æ ·, æŒ‡å®š`this`çš„æŒ‡å‘; ç¬¬äºŒä¸ªå‚æ•°ä¸åŒ, call æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°çš„æ•°é‡ä¸å›ºå®š, ä»ç¬¬äºŒå‚æ•°å¼€å§‹ä¸€æ¬¡æŒ‰é¡ºåºä¼ é€’ç»™è¢«è°ƒç”¨çš„å‡½æ•°.\n```javascript\nlet fn = function (a, b, c) {\n\tconsole.log(a, b, c); // 1 2 3\n}\nfn.call(null, 1, 2, 3)\n```\n\nåœ¨æˆ‘ä»¬ä¸å…³å¿ƒå…·ä½“æœ‰å¤šå°‘å‚æ•°è¢«ä¼ å…¥å‡½æ•°æ—¶, å°±å¯ä»¥ä½¿ç”¨ apply æ–¹æ³•ä¸€è‚¡è„‘æ¨è¿‡å»å°±è¡Œäº†; å½“æˆ‘ä»¬æ˜ç¡®çš„çŸ¥é“æœ‰å¤šå°‘å‚æ•°, æƒ³ä¸€ç›®äº†ç„¶çš„è¡¨è¾¾å½¢å‚å’Œå®å‚çš„å¯¹åº”å…³ç³»æ—¶, é‚£ä¹ˆå°±å¯ä»¥ç”¨ call æ–¹æ³•.\n\n- å€Ÿç”¨å…¶ä»–å¯¹è±¡çš„æ–¹æ³•\ncall å’Œ apply ç»å¸¸è¢«ç”¨æ¥å€Ÿç”¨å…¶ä»–å¯¹è±¡çš„æ–¹æ³•, å¸¸ç”¨çš„å°±æœ‰å€Ÿç”¨`Array`çš„æ–¹æ³•æ¥æ“ä½œ`arguments`æˆ–è€…å€Ÿç”¨æ„é€ å‡½æ•°æ¥å®ç°ä¸€äº›ç±»ä¼¼ç»§æ‰¿çš„æ•ˆæœ.\n\t\n    1. å€Ÿç”¨æ„é€ å‡½æ•°\n```javascript\nlet A = function (name) {\n\tthis.name = name\n};\n// å€Ÿç”¨æ„é€ å‡½æ•° A\nlet B = function () {\n\tA.apply(this, arguments)\n};\nB.prototype.getName = function () {\n\treturn this.name\n}\n\nlet b = new B('cara');\nconsole.log(b.getName); // 'cara'\n```\n    2. å€Ÿç”¨ Array çš„æ–¹æ³•\n```javascript\n(function () {\n\tArray.prototype.push.call(arguments, 3);\n\tconsole.log(arguments); // {'0': 1, '1': 2, '2': 3}\n})(1, 2)\n```\nå€Ÿç”¨çš„æ—¶å€™è¦ä¿è¯ä¸¤ä¸ªå¿…è¦æ¡ä»¶: 1. å¯¹è±¡æœ¬èº«è¦å¯ä»¥å­˜å–å±æ€§; 2. å¯¹è±¡çš„ length å±æ€§å¯è¯»å†™.\n> ### Function.prototype.bind\nç»‘å®šå‡½æ•° bind ä¹Ÿæ˜¯å¯ä»¥ç”¨ä½œçŸ«æ­£ `this`çš„æŒ‡å‘, bind å‡½æ•°ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°(ç»‘å®šå‡½æ•°), æ–°å‡½æ•°å’Œç›®æ ‡å‡½æ•°å°†æ‹¥æœ‰ç›¸åŒçš„å‡½æ•°ä½“. ç¬¬ä¸€ä¸ªå‚æ•°ç»‘å®š`this`çš„æŒ‡å‘, ä»ç¬¬äºŒå‚æ•°èµ·åé¢çš„å‚æ•°å°†ä½œä¸ºå®å‚ç»‘å®šåˆ°ç›®æ ‡å‡½æ•°çš„å½¢å‚.\n\n```javascript\nlet sum = function (a, b) {\n\treturn a + b;\n};\nlet result = sum.bind(null, 1); // 1 å°†ä½œä¸ºå®å‚ä¼ å…¥ sum\nconsole.log(result(2)); // 3\n```\n\n> å¦å¤–å½“ bind è¿”å›çš„å‡½æ•°ä½œä¸ºæ„é€ å‡½æ•°ä½¿ç”¨çš„è¯, ç»‘å®šçš„`this`å°†è¢«å¿½ç•¥, å®å‚ä¼ å…¥ç›®æ ‡å‡½æ•°.\n\n```javascript\nlet original = function (x) {\n\tthis.a = 1;\n\tthis.b = function () {\n\t\treturn this.a + x\n\t}\n};\n\nlet obj = {\n\ta: 2\n};\n\nlet newObj = new (original.bind(obj, 2));\nconsole.log(newObj.a); // 1 => this çš„æŒ‡å‘è¢«å¿½ç•¥\nconsole.log(newObj.b()); // 3 => 2 è¢«ä¼ å…¥ original\n```\ncall å’Œ apply æ–¹æ³•éƒ½æ˜¯æ”¹å˜`this`æŒ‡å‘åç«‹å³æ‰§è¡Œè€Œ bind å¯ä»¥åœ¨ä½ æƒ³æ‰§è¡Œçš„\næ—¶å€™å†æ‰§è¡Œ.\n\nå·®ä¸å¤šå°±åˆ°è¿™å„¿å§, è¦æ˜¯æœ‰è¡¥å……å†æ¥ç€å†™â€¦\n\nCreated on 2017-10-17 by Cara\n\n","source":"_posts/this-call-and-apply.md","raw":"---\ntitle: this/ call and apply\ndate: 2017-10-17 23:01:38\ntags:\n- JavaScript\ncategories:\n- ç¬”è®°ğŸ“’\n- JavaScriptè®¾è®¡æ¨¡å¼\n---\nåœ¨ JavaScript ä¸­, `this `å…³é”®å­—å¾ˆå®¹æ˜“ä½¿å¤§å®¶ç–‘æƒ‘, å†åŠ ä¸Š `Function.prototype.call`å’Œ`Function.prototype.apply`è¿™ä¸¤ä¸ªæ–¹æ³•çš„å¹¿æ³›è¿ç”¨, æ‰€ä»¥å¾ˆæœ‰å¿…è¦å¼„æ¸…`this`çš„ä½¿ç”¨.\n\n>  ### this\n> é¦–å…ˆå…ˆè¯´ä¸€ä¸‹`this`çš„æ¦‚å¿µ: `this`æ€»æ˜¯æŒ‡å‘ä¸€ä¸ªå¯¹è±¡, è€Œè¿™ä¸ªå¯¹è±¡å…·ä½“æ˜¯è°, æ˜¯æ ¹æ®è¿è¡Œæ—¶çš„å‡½æ•°æ‰§è¡Œçš„ç¯å¢ƒåŠ¨æ€ç»‘å®šçš„, è€Œéå‡½æ•°è¢«å£°æ˜æ—¶çš„ç¯å¢ƒ. å½“ç„¶åˆ°ç°åœ¨ç®­å¤´å‡½æ•°çš„å‡ºç°, `this`å¯¹ä¸äº†è§£çš„åŒå­¦ä»¬æ¥è¯´, æ— ç–‘æ˜¯æ·»äº†ä¸€æŠŠä¹±â€¦ æ¥ä¸‹æ¥æˆ‘ä»¬ä¸€ä¸ªä¸€ä¸ªçš„æ¥è¯´å§.\n\n#### 1. `this`çš„æŒ‡å‘\næˆ‘ä»¬é™¤å¼€ä¸å¸¸ç”¨çš„ with å’Œ eval çš„æƒ…å†µ, å…·ä½“åˆ°å®é™…åº”ç”¨ä¸­, `this`çš„æŒ‡å‘å¤§è‡´å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å››ç§æƒ…å†µ.\n\n- ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•è¢«è°ƒç”¨\n- ä½œä¸ºæ™®é€šå‡½æ•°è¢«è°ƒç”¨\n- æ„é€ å™¨è°ƒç”¨\n- è¢« call å’Œ apply æ–¹æ³•è°ƒç”¨\nä¸‹é¢æ¥ç”¨ < JavaScript è®¾è®¡æ¨¡å¼ > ä¸­çš„ä¾‹å­è¯´æ˜è¿™å››ç§æƒ…å†µ.\n\n    1. ä½œä¸ºå¯¹è±¡æ–¹æ³•è°ƒç”¨\n    å½“å‡½æ•°ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•è¢«è°ƒç”¨æ—¶, `this`æŒ‡å‘è¯¥å¯¹è±¡:\n```javascript\nlet name = 'window';\nlet obj = {\n    name: 'cara',\n    getName: function () {\n        console.log(this === obj)\n        console.log(this.name)\n    }\n}\nobj.getName() // true 'cara'\n```\n\n    2. ä½œä¸ºæ™®é€šå‡½æ•°è°ƒç”¨\n    å½“å‡½æ•°ä¸ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•è¢«è°ƒç”¨æ—¶, ä¹Ÿå°±æ˜¯æˆ‘ä»¬å¹³å¸¸è¯´çš„æ™®é€šå‡½æ•°çš„æ–¹å¼, æ­¤æ—¶çš„`this`æ€»æ˜¯æŒ‡å‘å…¨å±€å¯¹è±¡.\n```javascript\nwindow.name = 'window';\nlet getName = function () {\n    return this.name\n}\nconsole.log(getName()) // 'window'\n\n// æˆ–è€…\n\nwindow.name = 'window';\nlet obj = {\n    name: 'obj',\n    getName: function () {\n        return this.name\n    }\n}\n// è¿™é‡Œ obj çš„ getNameæ–¹æ³•èµ‹å€¼ç»™äº†ä¸€ä¸ªå˜é‡\n// è°ƒç”¨çš„æ—¶å€™å°±åªä¼šä½œä¸ºä¸€ä¸ªæ™®é€šå‡½æ•°è°ƒç”¨\nlet getName = obj.gatName;\nconsole.log(getName()) // 'window'\n```\n    ä¸Šé¢è¿™ä¸­ä½œä¸ºæ™®é€šå‡½æ•°è°ƒç”¨çš„æ–¹å¼å¸¸å¸¸ä¼šå¸¦æ¥ä¸€äº›å›°æ‰°, æ¯”å¦‚åœ¨æŸä¸ª div èŠ‚ç‚¹çš„äº‹ä»¶å‡½æ•°ä¸­, å®šä¹‰äº†ä¸€ä¸ªå±€éƒ¨çš„ callback æ–¹æ³•. è€Œè¿™ä¸ª callback æ–¹æ³•æˆ‘ä»¬å¾€å¾€æ˜¯æƒ³è®©å®ƒçš„ `this`æŒ‡å‘ div èŠ‚ç‚¹, ä½†å®ƒå†…éƒ¨å´æŒ‡å‘`window`. å¦‚:\n```html\n<div id='div1'>æˆ‘æ˜¯ä¸€ä¸ª div</div>\n```\n    ```javascript\n        window.id = 'window';\n        document.getElementById('div1').onclick = function () {\n            console.log(this.id); // 'div1'\n            let callback = function (){\n                console.log(this.id); // 'window'\t\n            }\n            callback() // ä½œä¸ºæ™®é€šå‡½æ•°è¢«è°ƒç”¨\n        }\n    ```\n    è¦è§£å†³ä»¥ä¸Šé—®é¢˜å…¶å®ä¹Ÿå¾ˆç®€å•, å¦‚ä¸‹:\n```javascript\nwindow.id = 'window';\ndocument.getElementById('div1').onclick = function () {\n    console.log(this.id);\n    let that = this; // ç”¨ä¸€ä¸ªå˜é‡æ¥å‚¨å­˜èŠ‚ç‚¹çš„å¼•ç”¨\n    let callback = function (){\n        console.log(that.id); // 'div1'\t\n    }\n    callback() // ä½œä¸ºæ™®é€šå‡½æ•°è¢«è°ƒç”¨\n}\n```\n    3. æ„é€ å™¨è°ƒç”¨\n    å…ˆè¯´è¯´æ„é€ å™¨å§, js ä¸­æ²¡æœ‰ç±»çš„æ¦‚å¿µ, ä½†æ˜¯å¯ä»¥ä»æ„é€ å™¨ä¸­åˆ›å»ºå¯¹è±¡, åŒæ—¶æä¾› `new` è¿ç®—ç¬¦, è®©æ„é€ å™¨çœ‹èµ·æ¥æ›´åƒä¸€ä¸ªç±». Js ä¸­å¤§éƒ¨åˆ†å‡½æ•°éƒ½å¯ä»¥å½“åšæ„é€ å™¨æ¥ä½¿ç”¨, æ‰€ä»¥å®ƒçš„å¤–è¡¨çœ‹èµ·æ¥è·Ÿæ™®é€šå‡½æ•°ä¸€æ ·, åŒºåˆ«åœ¨äºè¢«è°ƒç”¨çš„æ–¹å¼. å½“ç”¨ `new` è¿ç®—ç¬¦è°ƒç”¨æ—¶, è¯¥å‡½æ•°ä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡. é€šå¸¸æƒ…å†µä¸‹, æ„é€ å™¨é‡Œçš„ `this` å°±æŒ‡å‘è¿”å›çš„è¿™ä¸ªå¯¹è±¡, å¦‚ä¸‹:\n```javascript\nconst Myobj = function () {\n    this.name = 'cara';\n}\n\nlet obj = new Myobj();\nconsole.log(obj.name); // 'cara'\n```\n    ä½†æ˜¯ä½¿ç”¨ `new`è°ƒç”¨æ„é€ å™¨æ—¶, è¦æ³¨æ„ä¸€ä¸ªé—®é¢˜. å¦‚æœæ„é€ å™¨æ˜¾å¼åœ°è¿”å›äº†ä¸€ä¸ªå¯¹è±¡, é‚£ä¹ˆæœ€ç»ˆå°±ä¼šè¿”å›è¿™ä¸ªå¯¹è±¡, è€Œä¸æ˜¯æˆ‘ä»¬çš„æœŸæœ›çš„ `this`:\n```javascript\nconst Myobj = function () {\n    this.name = 'cara';\n    return {\n        name: 'somebody'\n    }\n}\n\nlet obj = new Myobj();\nconsole.log(obj.name); // 'somebody'\n```\n    å¦‚æœæ„é€ å™¨ä¸æ˜¾å¼åœ°è¿”å›ä»»ä½•æ•°æ®æˆ–æ˜¯è¿”å›ä¸€ä¸ªéå¯¹è±¡ç±»å‹çš„æ•°æ®, å°±ä¸ä¼šå‡ºç°ä¸Šè¿°æƒ…å†µ\n\n    4. call æˆ– apply æ–¹æ³•è°ƒç”¨\n    è·Ÿæ™®é€šçš„å‡½æ•°è°ƒç”¨ç›¸æ¯”, ç”¨ call æˆ–è€… apply æ–¹æ³•è°ƒç”¨å¯ä»¥åŠ¨æ€åœ°æ”¹å˜ä¼ å…¥å‡½æ•°çš„ `this`:\n```javascript\nlet obj1 = {\n    name: 'cara',\n    getName: function () {\n        return this.name\n    }\n};\n\nlet obj2 = {\n    name: 'ben'\n};\n\nconsole.log(obj1.name); // 'cara'\nconsole.log(obj1.name.call(obj2)); // 'ben'\n```\n    call å’Œ apply æ–¹æ³•èƒ½å¤Ÿå¾ˆå¥½çš„ä½“ç° js çš„å‡½æ•°å¼è¯­è¨€ç‰¹æ€§. åœ¨ js ä¸­å‡ ä¹æ¯ä¸€æ¬¡ç¼–å†™å‡½æ•°å¼è¯­è¨€é£æ ¼çš„ä»£ç éƒ½ç¦»ä¸å¼€ call å’Œ apply.\n\n#### 2. ä¸¢å¤±çš„ this\nè¿™æ˜¯ä¸€ä¸ªç»å¸¸é‡åˆ°çš„é—®é¢˜, åœ¨åˆšåˆšå¼€å§‹å­¦ä¹  js æ—¶,`this`çš„æŒ‡å‘å¸¸å¸¸ä»¤æˆ‘ç–‘æƒ‘, å°¤å…¶æ˜¯çœ‹åˆ°ç½‘ä¸Šå…³äº`this`æŒ‡å‘çš„é¢˜ç›®, ç®€ç›´äº‘é‡Œé›¾é‡Œ. ä¸‹é¢å°±æ¥çœ‹ä¸€äº›ä¾‹å­å§!\n\n```javascript\nconst obj = {\n    name: 'apple',\n    getName: function () {\n        return this.name;\n    }\n}\n\nconsole.log(obj.getName()); // 'apple'\nlet getMyName = obj.getName;\nconsole.log(getMyName()); // undefined\n```\nä¸Šé¢è¿™ä¸ªä¾‹å­å¥½ç†è§£, å°±æ˜¯é€šè¿‡ä¸€ä¸ªå˜é‡æ¥å¼•ç”¨`obj.getName`æ–¹æ³•, å¹¶ä¸”è°ƒç”¨ getMyName æ—¶, å°±æ˜¯ç”¨çš„æ™®é€šå‡½æ•°è°ƒç”¨æ–¹å¼, `this`æ˜¯æŒ‡å‘å…¨å±€ window çš„.\n\n    æ¥ä¸‹æ¥å†æ¥çœ‹ä¸€ä¸ªç¨å¾®å¤æ‚ä¸€ç‚¹çš„ä¾‹å­å§:\n```javascript\nlet name = 'window';\nconst person = {\n    name: 'person',\n    showName1: function () {\n        console.log(this.name)\n    },\n    showName2: _ => console.log(this.name),\n    showName3: function () {\n        return function () {\n            console.log(this.name)\n        }\n    },\n    showName4: function () {\n        return _ => console.log(this.name)\n    }\n};\nconst person2 = {name: 'person2'};\n\nperson.showName1();\nperson.showName1().call(person2);\n\nperson.showName2();\nperson.showName2().call(person2);\n\nperson.showName3()();\nperson.showName3().call(person2);\nperson.showName3.call(person2)();\n\nperson.showName4()();\nperson.showName4().call(person2);\nperson.showName4.call(person2)();\n```\nè¿™ä¸ªä¾‹å­å¯èƒ½å¤§å®¶å·²ç»å¾ˆçœ¼ç†Ÿäº†, ä¸è¿‡å½“æ—¶æˆ‘ç¬¬ä¸€æ¬¡åšçš„æ—¶å€™å‡ ä¹é”™äº†ä¸€å¤§åŠğŸ˜’â€¦. ç°åœ¨å†æ‹¿å‡ºæ¥çœ‹çœ‹å…¶å®è¿˜æ˜¯å¾ˆç»å…¸çš„: åœ¨ person å’Œ person2 ä¹‹é—´ç–¯ç‹‚ç© showName æ–¹æ³•. åœ¨ç»™å‡ºç­”æ¡ˆä¹‹å‰æˆ‘ä»¬å…ˆçœ‹çœ‹ç®­å¤´å‡½æ•°çš„ä¸€äº›ç‰¹ç‚¹:\n\n- ç®­å¤´å‡½æ•°ä¸å¯ç”¨ä½œæ„é€ å‡½æ•°.\n- ä¸å¯ä»¥ä½¿ç”¨ `arguments`å¯¹è±¡, å¦‚æœè¦ç”¨å¯ä»¥ä½¿ç”¨ rest å‚æ•°ä»£æ›¿.\n- ä¸èƒ½ä½¿ç”¨`yield`å‘½ä»¤, æ‰€ä»¥ç®­å¤´å‡½æ•°ä¹Ÿä¸èƒ½ä½œä¸º Generator å‡½æ•°.\n- ç®­å¤´å‡½æ•°çš„`this`æ˜¯å®šä¹‰æ—¶æ‰€åœ¨çš„å¯¹è±¡, è€Œä¸æ˜¯æ‰§è¡Œæ—¶æ‰€åœ¨çš„å¯¹è±¡.\n\n    åœ¨æœ€åä¸€ç‚¹çš„`this`æŒ‡å‘ä¸Š, æˆ‘ä¸ªäººè§‰å¾—æœ‰ç‚¹è¯¯å¯¼(ä¹Ÿå¯èƒ½æ˜¯æˆ‘æ²¡ç†è§£åˆ°ä½)â€¦ å› ä¸ºå¦‚æœåœ¨å¯¹è±¡å­—é¢é‡ä¸­çš„æ–¹æ³•æ˜¯é€šè¿‡ç®­å¤´å‡½æ•°å®šä¹‰çš„è¯, `this`çš„æŒ‡å‘å°±ä¼šå’Œä½ æœŸæœ›çš„ä¸ä¸€æ ·äº†. \n\n```javascript\nlet name = 'window'\nlet obj = {\n    name: 'obj',\n    getName: _ => console.log(this.name)\n}\nobj.getName(); // 'window'\n```\næ‰€ä»¥æˆ‘è§‰å¾—å…³äºç†è§£ç®­å¤´å‡½æ•°`this`åœ¨å®šä¹‰æ—¶æ‰€åœ¨çš„å¯¹è±¡æ˜¯è¿™æ ·: `this`ç»§æ‰¿è‡ªçˆ¶çº§çš„æ‰§è¡Œä¸Šä¸‹æ–‡(ç®€å•å¯¹è±¡å³éå‡½æ•°, æ˜¯æ²¡æœ‰æ‰§è¡Œä¸Šä¸‹æ–‡çš„), æ‰€ä»¥ä¸Šé¢ä¾‹å­å°±æ˜¯ getName æ–¹æ³•çš„çˆ¶çº§æ˜¯ obj, è€Œ obj çš„æ‰§è¡Œä¸Šä¸‹æ–‡æ˜¯`window`, å› æ­¤è¾“å‡ºå…¨å±€å¯¹è±¡çš„ name. ç†è§£äº†å…³äºç®­å¤´å‡½æ•°`this`çš„æŒ‡å‘, ç°åœ¨å†æ¥çœ‹çœ‹ç­”æ¡ˆå§:\n\n```javascript\nperson.showName1(); // 'person'\nperson.showName1().call(person2); //  'person2'\n\nperson.showName2(); // 'window'\nperson.showName2().call(person2); // 'window'\n\nperson.showName3()(); // 'window'\nperson.showName3().call(person2); // 'person2'\nperson.showName3.call(person2)(); // 'window'\n\nperson.showName4()(); // 'person'\nperson.showName4().call(person2); // 'person'\nperson.showName4.call(person2)(); // 'perons2'\n```\n\nç„¶åæ¥åˆ†æä¸€ä¸‹ç­”æ¡ˆå§:\n- è°ƒç”¨ showName1() \nè¿™ä¸¤ä¸ªæ–¹å¼å¥½ç†è§£, ç¬¬ä¸€ç§æ˜¯é€šè¿‡ person å¯¹è±¡æ¥è°ƒç”¨çš„ showName1 æ–¹æ³•, ä¹Ÿå°±æ˜¯ä¸Šé¢æˆ‘ä»¬è¯´è¿‡çš„**ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•è¢«è°ƒç”¨**, æ‰€ä»¥`this`è‡ªç„¶æŒ‡å‘çš„æ˜¯person å¯¹è±¡; ç¬¬äºŒç§æ˜¯**è¢« call å’Œ apply æ–¹æ³•è°ƒç”¨**, æ‰€ä»¥`this`æŒ‡å‘çš„æ˜¯è¢« call æ–¹æ³•çŸ«æ­£çš„ person2.\n\n- è°ƒç”¨ showName2()\nshowName2 æ–¹æ³•æ˜¯ä¸€ä¸ªç®­å¤´å‡½æ•°, æ ¹æ®æˆ‘ä»¬ä¹‹å‰è¯´è¿‡çš„ç®­å¤´å‡½æ•°æŒ‡å‘é—®é¢˜æ¥çœ‹. ç¬¬ä¸€ç§é€šè¿‡ person å¯¹è±¡æ¥è°ƒç”¨, ç”±äº person æ˜¯ä¸€ä¸ªç®€å•å¯¹è±¡æ‰€ä»¥è¿™é‡Œå®ƒçš„æ‰§è¡Œä¸Šä¸‹æ–‡å°±æ˜¯`window`, é‚£ä¹ˆå°±æ˜¯ä½œä¸ºæ™®é€šå‡½æ•°è°ƒç”¨, `this`æŒ‡å‘ `window`; ç¬¬äºŒç§è·Ÿç¬¬ä¸€ç§æ˜¯ç›¸åŒçš„è°ƒç”¨æ–¹å¼, åªæ˜¯æŠŠ person å¯¹è±¡æ¢ä¸º person2.\n\n- è°ƒç”¨ showName3()\nPerson.showName3 æ˜¯ä¸€ä¸ªé«˜é˜¶å‡½æ•°, è¿”å›äº†ä¸€ä¸ªåŒ¿åå‡½æ•°. ç¬¬ä¸€ç§æ–¹å¼ç›¸å½“äºç›´æ¥è°ƒç”¨é‚£ä¸ªåŒ¿åå‡½æ•°æ‰§è¡Œç¯å¢ƒå°±æ˜¯`window`, æ‰€ä»¥`this`æŒ‡å‘`window`; ç¬¬äºŒç§æ–¹å¼é€šè¿‡ person2 æ¥è°ƒç”¨ person çš„é«˜é˜¶å‡½æ•°, è¾“å‡º person2; ç¬¬ä¸‰ç§å…ˆé€šè¿‡ person2 è°ƒç”¨ person çš„é«˜é˜¶å‡½æ•°, ç„¶ååœ¨å…¨å±€ä½œç”¨åŸŸä¸‹æ‰§è¡Œ, å› æ­¤`this`æŒ‡å‘`window`.\n\n- è°ƒç”¨ showName4()\næœ€åè¿™ä¸‰ç»„è°ƒç”¨ä¹Ÿæ˜¯é«˜é˜¶å‡½æ•°, ä¸è¿‡è¿”å›çš„åŒ¿åå‡½æ•°ç”¨çš„ç®­å¤´å‡½æ•°. å‰ä¸¤ç§æ–¹å¼ä¹Ÿå°±å°è¯äº†æˆ‘ä»¬ä¹‹å‰æ‰€è¯´çš„**ç®­å¤´å‡½æ•°çš„ this ç»§æ‰¿è‡ªçˆ¶çº§æ‰§è¡Œä¸Šä¸‹æ–‡**, æ‰€ä»¥å‰ä¸¤ç§éƒ½è¾“å‡º person, å°±ç®—ç¬¬äºŒç§æ–¹å¼åé¢ç”¨ call æ–¹æ³•æ¥çŸ«æ­£ä¹Ÿæ˜¯ä¸è¡Œçš„; ç¬¬ä¸‰ç§ä¹Ÿå°±æ˜¯é€šè¿‡ person2 æ¥è°ƒç”¨æ‰§è¡Œçš„ showName4 æ–¹æ³•, è‡ªç„¶ä¹Ÿå°±è¾“å‡º person2 å•¦.\n \n> ### call å’Œ apply\nFunction.prototype.call() å’Œ Function.prototype.apply() éƒ½æ˜¯éå¸¸å¸¸ç”¨çš„æ–¹æ³•, åœ¨å®é™…å¼€å‘ä¸­å’Œ JavaScript çš„è®¾è®¡æ¨¡å¼ä¸­è¿™ä¸¤ä¸ªæ–¹æ³•åº”ç”¨å¹¿æ³›. å…¶å®å®ƒä»¬çš„ä½œç”¨æ˜¯ä¸€æ ·çš„, åªæ˜¯æœ‰ä¼ å…¥å‚æ•°å½¢å¼ä¸åŒçš„åŒºåˆ«.\n\n- apply\napply æ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‚æ•°: ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šå‡½æ•°ä½“ä¸­ `this`çš„æŒ‡å‘; ç¬¬äºŒä¸ªå‚æ•°ä¸ºä¸€ä¸ªå¸¦ä¸‹æ ‡çš„åˆé›†(å¯ä»¥æ˜¯æ•°ç»„æˆ–è€…ç±»æ•°ç»„), è¿™ä¸ªå‚æ•°å°†ä¼šä¼ é€’ç»™è¢«è°ƒç”¨çš„å‡½æ•°.\n```javascript\nlet fn = function (a, b, c) {\n\tconsole.log(a, b, c); // 1 2 3\n}\n// ç¬¬ä¸€ä¸ªå‚æ•°ä¸º null çš„è¯, è¡¨ç¤ºä¸æ”¹å˜ this çš„æŒ‡å‘\nfn.apply(null, [1, 2, 3]); \n```\n- call\ncall æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°å’Œ apply æ–¹æ³•ä¸€æ ·, æŒ‡å®š`this`çš„æŒ‡å‘; ç¬¬äºŒä¸ªå‚æ•°ä¸åŒ, call æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°çš„æ•°é‡ä¸å›ºå®š, ä»ç¬¬äºŒå‚æ•°å¼€å§‹ä¸€æ¬¡æŒ‰é¡ºåºä¼ é€’ç»™è¢«è°ƒç”¨çš„å‡½æ•°.\n```javascript\nlet fn = function (a, b, c) {\n\tconsole.log(a, b, c); // 1 2 3\n}\nfn.call(null, 1, 2, 3)\n```\n\nåœ¨æˆ‘ä»¬ä¸å…³å¿ƒå…·ä½“æœ‰å¤šå°‘å‚æ•°è¢«ä¼ å…¥å‡½æ•°æ—¶, å°±å¯ä»¥ä½¿ç”¨ apply æ–¹æ³•ä¸€è‚¡è„‘æ¨è¿‡å»å°±è¡Œäº†; å½“æˆ‘ä»¬æ˜ç¡®çš„çŸ¥é“æœ‰å¤šå°‘å‚æ•°, æƒ³ä¸€ç›®äº†ç„¶çš„è¡¨è¾¾å½¢å‚å’Œå®å‚çš„å¯¹åº”å…³ç³»æ—¶, é‚£ä¹ˆå°±å¯ä»¥ç”¨ call æ–¹æ³•.\n\n- å€Ÿç”¨å…¶ä»–å¯¹è±¡çš„æ–¹æ³•\ncall å’Œ apply ç»å¸¸è¢«ç”¨æ¥å€Ÿç”¨å…¶ä»–å¯¹è±¡çš„æ–¹æ³•, å¸¸ç”¨çš„å°±æœ‰å€Ÿç”¨`Array`çš„æ–¹æ³•æ¥æ“ä½œ`arguments`æˆ–è€…å€Ÿç”¨æ„é€ å‡½æ•°æ¥å®ç°ä¸€äº›ç±»ä¼¼ç»§æ‰¿çš„æ•ˆæœ.\n\t\n    1. å€Ÿç”¨æ„é€ å‡½æ•°\n```javascript\nlet A = function (name) {\n\tthis.name = name\n};\n// å€Ÿç”¨æ„é€ å‡½æ•° A\nlet B = function () {\n\tA.apply(this, arguments)\n};\nB.prototype.getName = function () {\n\treturn this.name\n}\n\nlet b = new B('cara');\nconsole.log(b.getName); // 'cara'\n```\n    2. å€Ÿç”¨ Array çš„æ–¹æ³•\n```javascript\n(function () {\n\tArray.prototype.push.call(arguments, 3);\n\tconsole.log(arguments); // {'0': 1, '1': 2, '2': 3}\n})(1, 2)\n```\nå€Ÿç”¨çš„æ—¶å€™è¦ä¿è¯ä¸¤ä¸ªå¿…è¦æ¡ä»¶: 1. å¯¹è±¡æœ¬èº«è¦å¯ä»¥å­˜å–å±æ€§; 2. å¯¹è±¡çš„ length å±æ€§å¯è¯»å†™.\n> ### Function.prototype.bind\nç»‘å®šå‡½æ•° bind ä¹Ÿæ˜¯å¯ä»¥ç”¨ä½œçŸ«æ­£ `this`çš„æŒ‡å‘, bind å‡½æ•°ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°(ç»‘å®šå‡½æ•°), æ–°å‡½æ•°å’Œç›®æ ‡å‡½æ•°å°†æ‹¥æœ‰ç›¸åŒçš„å‡½æ•°ä½“. ç¬¬ä¸€ä¸ªå‚æ•°ç»‘å®š`this`çš„æŒ‡å‘, ä»ç¬¬äºŒå‚æ•°èµ·åé¢çš„å‚æ•°å°†ä½œä¸ºå®å‚ç»‘å®šåˆ°ç›®æ ‡å‡½æ•°çš„å½¢å‚.\n\n```javascript\nlet sum = function (a, b) {\n\treturn a + b;\n};\nlet result = sum.bind(null, 1); // 1 å°†ä½œä¸ºå®å‚ä¼ å…¥ sum\nconsole.log(result(2)); // 3\n```\n\n> å¦å¤–å½“ bind è¿”å›çš„å‡½æ•°ä½œä¸ºæ„é€ å‡½æ•°ä½¿ç”¨çš„è¯, ç»‘å®šçš„`this`å°†è¢«å¿½ç•¥, å®å‚ä¼ å…¥ç›®æ ‡å‡½æ•°.\n\n```javascript\nlet original = function (x) {\n\tthis.a = 1;\n\tthis.b = function () {\n\t\treturn this.a + x\n\t}\n};\n\nlet obj = {\n\ta: 2\n};\n\nlet newObj = new (original.bind(obj, 2));\nconsole.log(newObj.a); // 1 => this çš„æŒ‡å‘è¢«å¿½ç•¥\nconsole.log(newObj.b()); // 3 => 2 è¢«ä¼ å…¥ original\n```\ncall å’Œ apply æ–¹æ³•éƒ½æ˜¯æ”¹å˜`this`æŒ‡å‘åç«‹å³æ‰§è¡Œè€Œ bind å¯ä»¥åœ¨ä½ æƒ³æ‰§è¡Œçš„\næ—¶å€™å†æ‰§è¡Œ.\n\nå·®ä¸å¤šå°±åˆ°è¿™å„¿å§, è¦æ˜¯æœ‰è¡¥å……å†æ¥ç€å†™â€¦\n\nCreated on 2017-10-17 by Cara\n\n","slug":"this-call-and-apply","published":1,"updated":"2018-05-05T09:23:03.671Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjgurolss0019klu0mnha4373","content":"<p>åœ¨ JavaScript ä¸­, <code>this</code>å…³é”®å­—å¾ˆå®¹æ˜“ä½¿å¤§å®¶ç–‘æƒ‘, å†åŠ ä¸Š <code>Function.prototype.call</code>å’Œ<code>Function.prototype.apply</code>è¿™ä¸¤ä¸ªæ–¹æ³•çš„å¹¿æ³›è¿ç”¨, æ‰€ä»¥å¾ˆæœ‰å¿…è¦å¼„æ¸…<code>this</code>çš„ä½¿ç”¨.</p>\n<blockquote>\n<h3 id=\"this\"><a href=\"#this\" class=\"headerlink\" title=\"this\"></a>this</h3><p>é¦–å…ˆå…ˆè¯´ä¸€ä¸‹<code>this</code>çš„æ¦‚å¿µ: <code>this</code>æ€»æ˜¯æŒ‡å‘ä¸€ä¸ªå¯¹è±¡, è€Œè¿™ä¸ªå¯¹è±¡å…·ä½“æ˜¯è°, æ˜¯æ ¹æ®è¿è¡Œæ—¶çš„å‡½æ•°æ‰§è¡Œçš„ç¯å¢ƒåŠ¨æ€ç»‘å®šçš„, è€Œéå‡½æ•°è¢«å£°æ˜æ—¶çš„ç¯å¢ƒ. å½“ç„¶åˆ°ç°åœ¨ç®­å¤´å‡½æ•°çš„å‡ºç°, <code>this</code>å¯¹ä¸äº†è§£çš„åŒå­¦ä»¬æ¥è¯´, æ— ç–‘æ˜¯æ·»äº†ä¸€æŠŠä¹±â€¦ æ¥ä¸‹æ¥æˆ‘ä»¬ä¸€ä¸ªä¸€ä¸ªçš„æ¥è¯´å§.</p>\n</blockquote>\n<h4 id=\"1-thisçš„æŒ‡å‘\"><a href=\"#1-thisçš„æŒ‡å‘\" class=\"headerlink\" title=\"1. thisçš„æŒ‡å‘\"></a>1. <code>this</code>çš„æŒ‡å‘</h4><p>æˆ‘ä»¬é™¤å¼€ä¸å¸¸ç”¨çš„ with å’Œ eval çš„æƒ…å†µ, å…·ä½“åˆ°å®é™…åº”ç”¨ä¸­, <code>this</code>çš„æŒ‡å‘å¤§è‡´å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å››ç§æƒ…å†µ.</p>\n<ul>\n<li>ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•è¢«è°ƒç”¨</li>\n<li>ä½œä¸ºæ™®é€šå‡½æ•°è¢«è°ƒç”¨</li>\n<li>æ„é€ å™¨è°ƒç”¨</li>\n<li><p>è¢« call å’Œ apply æ–¹æ³•è°ƒç”¨<br>ä¸‹é¢æ¥ç”¨ &lt; JavaScript è®¾è®¡æ¨¡å¼ &gt; ä¸­çš„ä¾‹å­è¯´æ˜è¿™å››ç§æƒ…å†µ.</p>\n<ol>\n<li><p>ä½œä¸ºå¯¹è±¡æ–¹æ³•è°ƒç”¨<br>å½“å‡½æ•°ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•è¢«è°ƒç”¨æ—¶, <code>this</code>æŒ‡å‘è¯¥å¯¹è±¡:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> name = <span class=\"string\">'window'</span>;</span><br><span class=\"line\"><span class=\"keyword\">let</span> obj = &#123;</span><br><span class=\"line\">    name: <span class=\"string\">'cara'</span>,</span><br><span class=\"line\">    getName: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span> === obj)</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.name)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">obj.getName() <span class=\"comment\">// true 'cara'</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>ä½œä¸ºæ™®é€šå‡½æ•°è°ƒç”¨<br>å½“å‡½æ•°ä¸ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•è¢«è°ƒç”¨æ—¶, ä¹Ÿå°±æ˜¯æˆ‘ä»¬å¹³å¸¸è¯´çš„æ™®é€šå‡½æ•°çš„æ–¹å¼, æ­¤æ—¶çš„<code>this</code>æ€»æ˜¯æŒ‡å‘å…¨å±€å¯¹è±¡.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">window</span>.name = <span class=\"string\">'window'</span>;</span><br><span class=\"line\"><span class=\"keyword\">let</span> getName = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.name</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(getName()) <span class=\"comment\">// 'window'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æˆ–è€…</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">window</span>.name = <span class=\"string\">'window'</span>;</span><br><span class=\"line\"><span class=\"keyword\">let</span> obj = &#123;</span><br><span class=\"line\">    name: <span class=\"string\">'obj'</span>,</span><br><span class=\"line\">    getName: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.name</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// è¿™é‡Œ obj çš„ getNameæ–¹æ³•èµ‹å€¼ç»™äº†ä¸€ä¸ªå˜é‡</span></span><br><span class=\"line\"><span class=\"comment\">// è°ƒç”¨çš„æ—¶å€™å°±åªä¼šä½œä¸ºä¸€ä¸ªæ™®é€šå‡½æ•°è°ƒç”¨</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> getName = obj.gatName;</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(getName()) <span class=\"comment\">// 'window'</span></span><br></pre></td></tr></table></figure>\n<p>ä¸Šé¢è¿™ä¸­ä½œä¸ºæ™®é€šå‡½æ•°è°ƒç”¨çš„æ–¹å¼å¸¸å¸¸ä¼šå¸¦æ¥ä¸€äº›å›°æ‰°, æ¯”å¦‚åœ¨æŸä¸ª div èŠ‚ç‚¹çš„äº‹ä»¶å‡½æ•°ä¸­, å®šä¹‰äº†ä¸€ä¸ªå±€éƒ¨çš„ callback æ–¹æ³•. è€Œè¿™ä¸ª callback æ–¹æ³•æˆ‘ä»¬å¾€å¾€æ˜¯æƒ³è®©å®ƒçš„ <code>this</code>æŒ‡å‘ div èŠ‚ç‚¹, ä½†å®ƒå†…éƒ¨å´æŒ‡å‘<code>window</code>. å¦‚:</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">'div1'</span>&gt;</span>æˆ‘æ˜¯ä¸€ä¸ª div<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">window</span>.id = <span class=\"string\">'window'</span>;</span><br><span class=\"line\"><span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'div1'</span>).onclick = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.id); <span class=\"comment\">// 'div1'</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> callback = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.id); <span class=\"comment\">// 'window'\t</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    callback() <span class=\"comment\">// ä½œä¸ºæ™®é€šå‡½æ•°è¢«è°ƒç”¨</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>è¦è§£å†³ä»¥ä¸Šé—®é¢˜å…¶å®ä¹Ÿå¾ˆç®€å•, å¦‚ä¸‹:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">window</span>.id = <span class=\"string\">'window'</span>;</span><br><span class=\"line\"><span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'div1'</span>).onclick = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.id);</span><br><span class=\"line\">    <span class=\"keyword\">let</span> that = <span class=\"keyword\">this</span>; <span class=\"comment\">// ç”¨ä¸€ä¸ªå˜é‡æ¥å‚¨å­˜èŠ‚ç‚¹çš„å¼•ç”¨</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> callback = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(that.id); <span class=\"comment\">// 'div1'\t</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    callback() <span class=\"comment\">// ä½œä¸ºæ™®é€šå‡½æ•°è¢«è°ƒç”¨</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>æ„é€ å™¨è°ƒç”¨<br>å…ˆè¯´è¯´æ„é€ å™¨å§, js ä¸­æ²¡æœ‰ç±»çš„æ¦‚å¿µ, ä½†æ˜¯å¯ä»¥ä»æ„é€ å™¨ä¸­åˆ›å»ºå¯¹è±¡, åŒæ—¶æä¾› <code>new</code> è¿ç®—ç¬¦, è®©æ„é€ å™¨çœ‹èµ·æ¥æ›´åƒä¸€ä¸ªç±». Js ä¸­å¤§éƒ¨åˆ†å‡½æ•°éƒ½å¯ä»¥å½“åšæ„é€ å™¨æ¥ä½¿ç”¨, æ‰€ä»¥å®ƒçš„å¤–è¡¨çœ‹èµ·æ¥è·Ÿæ™®é€šå‡½æ•°ä¸€æ ·, åŒºåˆ«åœ¨äºè¢«è°ƒç”¨çš„æ–¹å¼. å½“ç”¨ <code>new</code> è¿ç®—ç¬¦è°ƒç”¨æ—¶, è¯¥å‡½æ•°ä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡. é€šå¸¸æƒ…å†µä¸‹, æ„é€ å™¨é‡Œçš„ <code>this</code> å°±æŒ‡å‘è¿”å›çš„è¿™ä¸ªå¯¹è±¡, å¦‚ä¸‹:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> Myobj = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.name = <span class=\"string\">'cara'</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> obj = <span class=\"keyword\">new</span> Myobj();</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(obj.name); <span class=\"comment\">// 'cara'</span></span><br></pre></td></tr></table></figure>\n<p>ä½†æ˜¯ä½¿ç”¨ <code>new</code>è°ƒç”¨æ„é€ å™¨æ—¶, è¦æ³¨æ„ä¸€ä¸ªé—®é¢˜. å¦‚æœæ„é€ å™¨æ˜¾å¼åœ°è¿”å›äº†ä¸€ä¸ªå¯¹è±¡, é‚£ä¹ˆæœ€ç»ˆå°±ä¼šè¿”å›è¿™ä¸ªå¯¹è±¡, è€Œä¸æ˜¯æˆ‘ä»¬çš„æœŸæœ›çš„ <code>this</code>:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> Myobj = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.name = <span class=\"string\">'cara'</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">        name: <span class=\"string\">'somebody'</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> obj = <span class=\"keyword\">new</span> Myobj();</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(obj.name); <span class=\"comment\">// 'somebody'</span></span><br></pre></td></tr></table></figure>\n<p>å¦‚æœæ„é€ å™¨ä¸æ˜¾å¼åœ°è¿”å›ä»»ä½•æ•°æ®æˆ–æ˜¯è¿”å›ä¸€ä¸ªéå¯¹è±¡ç±»å‹çš„æ•°æ®, å°±ä¸ä¼šå‡ºç°ä¸Šè¿°æƒ…å†µ</p>\n</li>\n<li><p>call æˆ– apply æ–¹æ³•è°ƒç”¨<br>è·Ÿæ™®é€šçš„å‡½æ•°è°ƒç”¨ç›¸æ¯”, ç”¨ call æˆ–è€… apply æ–¹æ³•è°ƒç”¨å¯ä»¥åŠ¨æ€åœ°æ”¹å˜ä¼ å…¥å‡½æ•°çš„ <code>this</code>:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> obj1 = &#123;</span><br><span class=\"line\">    name: <span class=\"string\">'cara'</span>,</span><br><span class=\"line\">    getName: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.name</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> obj2 = &#123;</span><br><span class=\"line\">    name: <span class=\"string\">'ben'</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(obj1.name); <span class=\"comment\">// 'cara'</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(obj1.name.call(obj2)); <span class=\"comment\">// 'ben'</span></span><br></pre></td></tr></table></figure>\n<p>call å’Œ apply æ–¹æ³•èƒ½å¤Ÿå¾ˆå¥½çš„ä½“ç° js çš„å‡½æ•°å¼è¯­è¨€ç‰¹æ€§. åœ¨ js ä¸­å‡ ä¹æ¯ä¸€æ¬¡ç¼–å†™å‡½æ•°å¼è¯­è¨€é£æ ¼çš„ä»£ç éƒ½ç¦»ä¸å¼€ call å’Œ apply.</p>\n</li>\n</ol>\n</li>\n</ul>\n<h4 id=\"2-ä¸¢å¤±çš„-this\"><a href=\"#2-ä¸¢å¤±çš„-this\" class=\"headerlink\" title=\"2. ä¸¢å¤±çš„ this\"></a>2. ä¸¢å¤±çš„ this</h4><p>è¿™æ˜¯ä¸€ä¸ªç»å¸¸é‡åˆ°çš„é—®é¢˜, åœ¨åˆšåˆšå¼€å§‹å­¦ä¹  js æ—¶,<code>this</code>çš„æŒ‡å‘å¸¸å¸¸ä»¤æˆ‘ç–‘æƒ‘, å°¤å…¶æ˜¯çœ‹åˆ°ç½‘ä¸Šå…³äº<code>this</code>æŒ‡å‘çš„é¢˜ç›®, ç®€ç›´äº‘é‡Œé›¾é‡Œ. ä¸‹é¢å°±æ¥çœ‹ä¸€äº›ä¾‹å­å§!</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> obj = &#123;</span><br><span class=\"line\">    name: <span class=\"string\">'apple'</span>,</span><br><span class=\"line\">    getName: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(obj.getName()); <span class=\"comment\">// 'apple'</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> getMyName = obj.getName;</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(getMyName()); <span class=\"comment\">// undefined</span></span><br></pre></td></tr></table></figure>\n<p>ä¸Šé¢è¿™ä¸ªä¾‹å­å¥½ç†è§£, å°±æ˜¯é€šè¿‡ä¸€ä¸ªå˜é‡æ¥å¼•ç”¨<code>obj.getName</code>æ–¹æ³•, å¹¶ä¸”è°ƒç”¨ getMyName æ—¶, å°±æ˜¯ç”¨çš„æ™®é€šå‡½æ•°è°ƒç”¨æ–¹å¼, <code>this</code>æ˜¯æŒ‡å‘å…¨å±€ window çš„.</p>\n<pre><code>æ¥ä¸‹æ¥å†æ¥çœ‹ä¸€ä¸ªç¨å¾®å¤æ‚ä¸€ç‚¹çš„ä¾‹å­å§:\n</code></pre><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> name = <span class=\"string\">'window'</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> person = &#123;</span><br><span class=\"line\">    name: <span class=\"string\">'person'</span>,</span><br><span class=\"line\">    showName1: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.name)</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    showName2: <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.name),</span><br><span class=\"line\">    showName3: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.name)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    showName4: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.name)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">const</span> person2 = &#123;<span class=\"attr\">name</span>: <span class=\"string\">'person2'</span>&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">person.showName1();</span><br><span class=\"line\">person.showName1().call(person2);</span><br><span class=\"line\"></span><br><span class=\"line\">person.showName2();</span><br><span class=\"line\">person.showName2().call(person2);</span><br><span class=\"line\"></span><br><span class=\"line\">person.showName3()();</span><br><span class=\"line\">person.showName3().call(person2);</span><br><span class=\"line\">person.showName3.call(person2)();</span><br><span class=\"line\"></span><br><span class=\"line\">person.showName4()();</span><br><span class=\"line\">person.showName4().call(person2);</span><br><span class=\"line\">person.showName4.call(person2)();</span><br></pre></td></tr></table></figure>\n<p>è¿™ä¸ªä¾‹å­å¯èƒ½å¤§å®¶å·²ç»å¾ˆçœ¼ç†Ÿäº†, ä¸è¿‡å½“æ—¶æˆ‘ç¬¬ä¸€æ¬¡åšçš„æ—¶å€™å‡ ä¹é”™äº†ä¸€å¤§åŠğŸ˜’â€¦. ç°åœ¨å†æ‹¿å‡ºæ¥çœ‹çœ‹å…¶å®è¿˜æ˜¯å¾ˆç»å…¸çš„: åœ¨ person å’Œ person2 ä¹‹é—´ç–¯ç‹‚ç© showName æ–¹æ³•. åœ¨ç»™å‡ºç­”æ¡ˆä¹‹å‰æˆ‘ä»¬å…ˆçœ‹çœ‹ç®­å¤´å‡½æ•°çš„ä¸€äº›ç‰¹ç‚¹:</p>\n<ul>\n<li>ç®­å¤´å‡½æ•°ä¸å¯ç”¨ä½œæ„é€ å‡½æ•°.</li>\n<li>ä¸å¯ä»¥ä½¿ç”¨ <code>arguments</code>å¯¹è±¡, å¦‚æœè¦ç”¨å¯ä»¥ä½¿ç”¨ rest å‚æ•°ä»£æ›¿.</li>\n<li>ä¸èƒ½ä½¿ç”¨<code>yield</code>å‘½ä»¤, æ‰€ä»¥ç®­å¤´å‡½æ•°ä¹Ÿä¸èƒ½ä½œä¸º Generator å‡½æ•°.</li>\n<li><p>ç®­å¤´å‡½æ•°çš„<code>this</code>æ˜¯å®šä¹‰æ—¶æ‰€åœ¨çš„å¯¹è±¡, è€Œä¸æ˜¯æ‰§è¡Œæ—¶æ‰€åœ¨çš„å¯¹è±¡.</p>\n<p>  åœ¨æœ€åä¸€ç‚¹çš„<code>this</code>æŒ‡å‘ä¸Š, æˆ‘ä¸ªäººè§‰å¾—æœ‰ç‚¹è¯¯å¯¼(ä¹Ÿå¯èƒ½æ˜¯æˆ‘æ²¡ç†è§£åˆ°ä½)â€¦ å› ä¸ºå¦‚æœåœ¨å¯¹è±¡å­—é¢é‡ä¸­çš„æ–¹æ³•æ˜¯é€šè¿‡ç®­å¤´å‡½æ•°å®šä¹‰çš„è¯, <code>this</code>çš„æŒ‡å‘å°±ä¼šå’Œä½ æœŸæœ›çš„ä¸ä¸€æ ·äº†. </p>\n</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> name = <span class=\"string\">'window'</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> obj = &#123;</span><br><span class=\"line\">    name: <span class=\"string\">'obj'</span>,</span><br><span class=\"line\">    getName: <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.name)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">obj.getName(); <span class=\"comment\">// 'window'</span></span><br></pre></td></tr></table></figure>\n<p>æ‰€ä»¥æˆ‘è§‰å¾—å…³äºç†è§£ç®­å¤´å‡½æ•°<code>this</code>åœ¨å®šä¹‰æ—¶æ‰€åœ¨çš„å¯¹è±¡æ˜¯è¿™æ ·: <code>this</code>ç»§æ‰¿è‡ªçˆ¶çº§çš„æ‰§è¡Œä¸Šä¸‹æ–‡(ç®€å•å¯¹è±¡å³éå‡½æ•°, æ˜¯æ²¡æœ‰æ‰§è¡Œä¸Šä¸‹æ–‡çš„), æ‰€ä»¥ä¸Šé¢ä¾‹å­å°±æ˜¯ getName æ–¹æ³•çš„çˆ¶çº§æ˜¯ obj, è€Œ obj çš„æ‰§è¡Œä¸Šä¸‹æ–‡æ˜¯<code>window</code>, å› æ­¤è¾“å‡ºå…¨å±€å¯¹è±¡çš„ name. ç†è§£äº†å…³äºç®­å¤´å‡½æ•°<code>this</code>çš„æŒ‡å‘, ç°åœ¨å†æ¥çœ‹çœ‹ç­”æ¡ˆå§:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">person.showName1(); <span class=\"comment\">// 'person'</span></span><br><span class=\"line\">person.showName1().call(person2); <span class=\"comment\">//  'person2'</span></span><br><span class=\"line\"></span><br><span class=\"line\">person.showName2(); <span class=\"comment\">// 'window'</span></span><br><span class=\"line\">person.showName2().call(person2); <span class=\"comment\">// 'window'</span></span><br><span class=\"line\"></span><br><span class=\"line\">person.showName3()(); <span class=\"comment\">// 'window'</span></span><br><span class=\"line\">person.showName3().call(person2); <span class=\"comment\">// 'person2'</span></span><br><span class=\"line\">person.showName3.call(person2)(); <span class=\"comment\">// 'window'</span></span><br><span class=\"line\"></span><br><span class=\"line\">person.showName4()(); <span class=\"comment\">// 'person'</span></span><br><span class=\"line\">person.showName4().call(person2); <span class=\"comment\">// 'person'</span></span><br><span class=\"line\">person.showName4.call(person2)(); <span class=\"comment\">// 'perons2'</span></span><br></pre></td></tr></table></figure>\n<p>ç„¶åæ¥åˆ†æä¸€ä¸‹ç­”æ¡ˆå§:</p>\n<ul>\n<li><p>è°ƒç”¨ showName1()<br>è¿™ä¸¤ä¸ªæ–¹å¼å¥½ç†è§£, ç¬¬ä¸€ç§æ˜¯é€šè¿‡ person å¯¹è±¡æ¥è°ƒç”¨çš„ showName1 æ–¹æ³•, ä¹Ÿå°±æ˜¯ä¸Šé¢æˆ‘ä»¬è¯´è¿‡çš„<strong>ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•è¢«è°ƒç”¨</strong>, æ‰€ä»¥<code>this</code>è‡ªç„¶æŒ‡å‘çš„æ˜¯person å¯¹è±¡; ç¬¬äºŒç§æ˜¯<strong>è¢« call å’Œ apply æ–¹æ³•è°ƒç”¨</strong>, æ‰€ä»¥<code>this</code>æŒ‡å‘çš„æ˜¯è¢« call æ–¹æ³•çŸ«æ­£çš„ person2.</p>\n</li>\n<li><p>è°ƒç”¨ showName2()<br>showName2 æ–¹æ³•æ˜¯ä¸€ä¸ªç®­å¤´å‡½æ•°, æ ¹æ®æˆ‘ä»¬ä¹‹å‰è¯´è¿‡çš„ç®­å¤´å‡½æ•°æŒ‡å‘é—®é¢˜æ¥çœ‹. ç¬¬ä¸€ç§é€šè¿‡ person å¯¹è±¡æ¥è°ƒç”¨, ç”±äº person æ˜¯ä¸€ä¸ªç®€å•å¯¹è±¡æ‰€ä»¥è¿™é‡Œå®ƒçš„æ‰§è¡Œä¸Šä¸‹æ–‡å°±æ˜¯<code>window</code>, é‚£ä¹ˆå°±æ˜¯ä½œä¸ºæ™®é€šå‡½æ•°è°ƒç”¨, <code>this</code>æŒ‡å‘ <code>window</code>; ç¬¬äºŒç§è·Ÿç¬¬ä¸€ç§æ˜¯ç›¸åŒçš„è°ƒç”¨æ–¹å¼, åªæ˜¯æŠŠ person å¯¹è±¡æ¢ä¸º person2.</p>\n</li>\n<li><p>è°ƒç”¨ showName3()<br>Person.showName3 æ˜¯ä¸€ä¸ªé«˜é˜¶å‡½æ•°, è¿”å›äº†ä¸€ä¸ªåŒ¿åå‡½æ•°. ç¬¬ä¸€ç§æ–¹å¼ç›¸å½“äºç›´æ¥è°ƒç”¨é‚£ä¸ªåŒ¿åå‡½æ•°æ‰§è¡Œç¯å¢ƒå°±æ˜¯<code>window</code>, æ‰€ä»¥<code>this</code>æŒ‡å‘<code>window</code>; ç¬¬äºŒç§æ–¹å¼é€šè¿‡ person2 æ¥è°ƒç”¨ person çš„é«˜é˜¶å‡½æ•°, è¾“å‡º person2; ç¬¬ä¸‰ç§å…ˆé€šè¿‡ person2 è°ƒç”¨ person çš„é«˜é˜¶å‡½æ•°, ç„¶ååœ¨å…¨å±€ä½œç”¨åŸŸä¸‹æ‰§è¡Œ, å› æ­¤<code>this</code>æŒ‡å‘<code>window</code>.</p>\n</li>\n<li><p>è°ƒç”¨ showName4()<br>æœ€åè¿™ä¸‰ç»„è°ƒç”¨ä¹Ÿæ˜¯é«˜é˜¶å‡½æ•°, ä¸è¿‡è¿”å›çš„åŒ¿åå‡½æ•°ç”¨çš„ç®­å¤´å‡½æ•°. å‰ä¸¤ç§æ–¹å¼ä¹Ÿå°±å°è¯äº†æˆ‘ä»¬ä¹‹å‰æ‰€è¯´çš„<strong>ç®­å¤´å‡½æ•°çš„ this ç»§æ‰¿è‡ªçˆ¶çº§æ‰§è¡Œä¸Šä¸‹æ–‡</strong>, æ‰€ä»¥å‰ä¸¤ç§éƒ½è¾“å‡º person, å°±ç®—ç¬¬äºŒç§æ–¹å¼åé¢ç”¨ call æ–¹æ³•æ¥çŸ«æ­£ä¹Ÿæ˜¯ä¸è¡Œçš„; ç¬¬ä¸‰ç§ä¹Ÿå°±æ˜¯é€šè¿‡ person2 æ¥è°ƒç”¨æ‰§è¡Œçš„ showName4 æ–¹æ³•, è‡ªç„¶ä¹Ÿå°±è¾“å‡º person2 å•¦.</p>\n</li>\n</ul>\n<blockquote>\n<h3 id=\"call-å’Œ-apply\"><a href=\"#call-å’Œ-apply\" class=\"headerlink\" title=\"call å’Œ apply\"></a>call å’Œ apply</h3><p>Function.prototype.call() å’Œ Function.prototype.apply() éƒ½æ˜¯éå¸¸å¸¸ç”¨çš„æ–¹æ³•, åœ¨å®é™…å¼€å‘ä¸­å’Œ JavaScript çš„è®¾è®¡æ¨¡å¼ä¸­è¿™ä¸¤ä¸ªæ–¹æ³•åº”ç”¨å¹¿æ³›. å…¶å®å®ƒä»¬çš„ä½œç”¨æ˜¯ä¸€æ ·çš„, åªæ˜¯æœ‰ä¼ å…¥å‚æ•°å½¢å¼ä¸åŒçš„åŒºåˆ«.</p>\n</blockquote>\n<ul>\n<li><p>apply<br>apply æ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‚æ•°: ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šå‡½æ•°ä½“ä¸­ <code>this</code>çš„æŒ‡å‘; ç¬¬äºŒä¸ªå‚æ•°ä¸ºä¸€ä¸ªå¸¦ä¸‹æ ‡çš„åˆé›†(å¯ä»¥æ˜¯æ•°ç»„æˆ–è€…ç±»æ•°ç»„), è¿™ä¸ªå‚æ•°å°†ä¼šä¼ é€’ç»™è¢«è°ƒç”¨çš„å‡½æ•°.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> fn = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">a, b, c</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">console</span>.log(a, b, c); <span class=\"comment\">// 1 2 3</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// ç¬¬ä¸€ä¸ªå‚æ•°ä¸º null çš„è¯, è¡¨ç¤ºä¸æ”¹å˜ this çš„æŒ‡å‘</span></span><br><span class=\"line\">fn.apply(<span class=\"literal\">null</span>, [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>]);</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>call<br>call æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°å’Œ apply æ–¹æ³•ä¸€æ ·, æŒ‡å®š<code>this</code>çš„æŒ‡å‘; ç¬¬äºŒä¸ªå‚æ•°ä¸åŒ, call æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°çš„æ•°é‡ä¸å›ºå®š, ä»ç¬¬äºŒå‚æ•°å¼€å§‹ä¸€æ¬¡æŒ‰é¡ºåºä¼ é€’ç»™è¢«è°ƒç”¨çš„å‡½æ•°.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> fn = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">a, b, c</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">console</span>.log(a, b, c); <span class=\"comment\">// 1 2 3</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">fn.call(<span class=\"literal\">null</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>)</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>åœ¨æˆ‘ä»¬ä¸å…³å¿ƒå…·ä½“æœ‰å¤šå°‘å‚æ•°è¢«ä¼ å…¥å‡½æ•°æ—¶, å°±å¯ä»¥ä½¿ç”¨ apply æ–¹æ³•ä¸€è‚¡è„‘æ¨è¿‡å»å°±è¡Œäº†; å½“æˆ‘ä»¬æ˜ç¡®çš„çŸ¥é“æœ‰å¤šå°‘å‚æ•°, æƒ³ä¸€ç›®äº†ç„¶çš„è¡¨è¾¾å½¢å‚å’Œå®å‚çš„å¯¹åº”å…³ç³»æ—¶, é‚£ä¹ˆå°±å¯ä»¥ç”¨ call æ–¹æ³•.</p>\n<ul>\n<li><p>å€Ÿç”¨å…¶ä»–å¯¹è±¡çš„æ–¹æ³•<br>call å’Œ apply ç»å¸¸è¢«ç”¨æ¥å€Ÿç”¨å…¶ä»–å¯¹è±¡çš„æ–¹æ³•, å¸¸ç”¨çš„å°±æœ‰å€Ÿç”¨<code>Array</code>çš„æ–¹æ³•æ¥æ“ä½œ<code>arguments</code>æˆ–è€…å€Ÿç”¨æ„é€ å‡½æ•°æ¥å®ç°ä¸€äº›ç±»ä¼¼ç»§æ‰¿çš„æ•ˆæœ.</p>\n<ol>\n<li><p>å€Ÿç”¨æ„é€ å‡½æ•°</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> A = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">name</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">this</span>.name = name</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"comment\">// å€Ÿç”¨æ„é€ å‡½æ•° A</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> B = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\tA.apply(<span class=\"keyword\">this</span>, <span class=\"built_in\">arguments</span>)</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">B.prototype.getName = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.name</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> b = <span class=\"keyword\">new</span> B(<span class=\"string\">'cara'</span>);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(b.getName); <span class=\"comment\">// 'cara'</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>å€Ÿç”¨ Array çš„æ–¹æ³•</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">Array</span>.prototype.push.call(<span class=\"built_in\">arguments</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">console</span>.log(<span class=\"built_in\">arguments</span>); <span class=\"comment\">// &#123;'0': 1, '1': 2, '2': 3&#125;</span></span><br><span class=\"line\">&#125;)(<span class=\"number\">1</span>, <span class=\"number\">2</span>)</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n</li>\n</ul>\n<p>å€Ÿç”¨çš„æ—¶å€™è¦ä¿è¯ä¸¤ä¸ªå¿…è¦æ¡ä»¶: 1. å¯¹è±¡æœ¬èº«è¦å¯ä»¥å­˜å–å±æ€§; 2. å¯¹è±¡çš„ length å±æ€§å¯è¯»å†™.</p>\n<blockquote>\n<h3 id=\"Function-prototype-bind\"><a href=\"#Function-prototype-bind\" class=\"headerlink\" title=\"Function.prototype.bind\"></a>Function.prototype.bind</h3><p>ç»‘å®šå‡½æ•° bind ä¹Ÿæ˜¯å¯ä»¥ç”¨ä½œçŸ«æ­£ <code>this</code>çš„æŒ‡å‘, bind å‡½æ•°ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°(ç»‘å®šå‡½æ•°), æ–°å‡½æ•°å’Œç›®æ ‡å‡½æ•°å°†æ‹¥æœ‰ç›¸åŒçš„å‡½æ•°ä½“. ç¬¬ä¸€ä¸ªå‚æ•°ç»‘å®š<code>this</code>çš„æŒ‡å‘, ä»ç¬¬äºŒå‚æ•°èµ·åé¢çš„å‚æ•°å°†ä½œä¸ºå®å‚ç»‘å®šåˆ°ç›®æ ‡å‡½æ•°çš„å½¢å‚.</p>\n</blockquote>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> sum = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">a, b</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> a + b;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">let</span> result = sum.bind(<span class=\"literal\">null</span>, <span class=\"number\">1</span>); <span class=\"comment\">// 1 å°†ä½œä¸ºå®å‚ä¼ å…¥ sum</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(result(<span class=\"number\">2</span>)); <span class=\"comment\">// 3</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>å¦å¤–å½“ bind è¿”å›çš„å‡½æ•°ä½œä¸ºæ„é€ å‡½æ•°ä½¿ç”¨çš„è¯, ç»‘å®šçš„<code>this</code>å°†è¢«å¿½ç•¥, å®å‚ä¼ å…¥ç›®æ ‡å‡½æ•°.</p>\n</blockquote>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> original = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">x</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">this</span>.a = <span class=\"number\">1</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">this</span>.b = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.a + x</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> obj = &#123;</span><br><span class=\"line\">\ta: <span class=\"number\">2</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> newObj = <span class=\"keyword\">new</span> (original.bind(obj, <span class=\"number\">2</span>));</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(newObj.a); <span class=\"comment\">// 1 =&gt; this çš„æŒ‡å‘è¢«å¿½ç•¥</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(newObj.b()); <span class=\"comment\">// 3 =&gt; 2 è¢«ä¼ å…¥ original</span></span><br></pre></td></tr></table></figure>\n<p>call å’Œ apply æ–¹æ³•éƒ½æ˜¯æ”¹å˜<code>this</code>æŒ‡å‘åç«‹å³æ‰§è¡Œè€Œ bind å¯ä»¥åœ¨ä½ æƒ³æ‰§è¡Œçš„<br>æ—¶å€™å†æ‰§è¡Œ.</p>\n<p>å·®ä¸å¤šå°±åˆ°è¿™å„¿å§, è¦æ˜¯æœ‰è¡¥å……å†æ¥ç€å†™â€¦</p>\n<p>Created on 2017-10-17 by Cara</p>\n","site":{"data":{}},"excerpt":"","more":"<p>åœ¨ JavaScript ä¸­, <code>this</code>å…³é”®å­—å¾ˆå®¹æ˜“ä½¿å¤§å®¶ç–‘æƒ‘, å†åŠ ä¸Š <code>Function.prototype.call</code>å’Œ<code>Function.prototype.apply</code>è¿™ä¸¤ä¸ªæ–¹æ³•çš„å¹¿æ³›è¿ç”¨, æ‰€ä»¥å¾ˆæœ‰å¿…è¦å¼„æ¸…<code>this</code>çš„ä½¿ç”¨.</p>\n<blockquote>\n<h3 id=\"this\"><a href=\"#this\" class=\"headerlink\" title=\"this\"></a>this</h3><p>é¦–å…ˆå…ˆè¯´ä¸€ä¸‹<code>this</code>çš„æ¦‚å¿µ: <code>this</code>æ€»æ˜¯æŒ‡å‘ä¸€ä¸ªå¯¹è±¡, è€Œè¿™ä¸ªå¯¹è±¡å…·ä½“æ˜¯è°, æ˜¯æ ¹æ®è¿è¡Œæ—¶çš„å‡½æ•°æ‰§è¡Œçš„ç¯å¢ƒåŠ¨æ€ç»‘å®šçš„, è€Œéå‡½æ•°è¢«å£°æ˜æ—¶çš„ç¯å¢ƒ. å½“ç„¶åˆ°ç°åœ¨ç®­å¤´å‡½æ•°çš„å‡ºç°, <code>this</code>å¯¹ä¸äº†è§£çš„åŒå­¦ä»¬æ¥è¯´, æ— ç–‘æ˜¯æ·»äº†ä¸€æŠŠä¹±â€¦ æ¥ä¸‹æ¥æˆ‘ä»¬ä¸€ä¸ªä¸€ä¸ªçš„æ¥è¯´å§.</p>\n</blockquote>\n<h4 id=\"1-thisçš„æŒ‡å‘\"><a href=\"#1-thisçš„æŒ‡å‘\" class=\"headerlink\" title=\"1. thisçš„æŒ‡å‘\"></a>1. <code>this</code>çš„æŒ‡å‘</h4><p>æˆ‘ä»¬é™¤å¼€ä¸å¸¸ç”¨çš„ with å’Œ eval çš„æƒ…å†µ, å…·ä½“åˆ°å®é™…åº”ç”¨ä¸­, <code>this</code>çš„æŒ‡å‘å¤§è‡´å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å››ç§æƒ…å†µ.</p>\n<ul>\n<li>ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•è¢«è°ƒç”¨</li>\n<li>ä½œä¸ºæ™®é€šå‡½æ•°è¢«è°ƒç”¨</li>\n<li>æ„é€ å™¨è°ƒç”¨</li>\n<li><p>è¢« call å’Œ apply æ–¹æ³•è°ƒç”¨<br>ä¸‹é¢æ¥ç”¨ &lt; JavaScript è®¾è®¡æ¨¡å¼ &gt; ä¸­çš„ä¾‹å­è¯´æ˜è¿™å››ç§æƒ…å†µ.</p>\n<ol>\n<li><p>ä½œä¸ºå¯¹è±¡æ–¹æ³•è°ƒç”¨<br>å½“å‡½æ•°ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•è¢«è°ƒç”¨æ—¶, <code>this</code>æŒ‡å‘è¯¥å¯¹è±¡:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> name = <span class=\"string\">'window'</span>;</span><br><span class=\"line\"><span class=\"keyword\">let</span> obj = &#123;</span><br><span class=\"line\">    name: <span class=\"string\">'cara'</span>,</span><br><span class=\"line\">    getName: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span> === obj)</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.name)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">obj.getName() <span class=\"comment\">// true 'cara'</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>ä½œä¸ºæ™®é€šå‡½æ•°è°ƒç”¨<br>å½“å‡½æ•°ä¸ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•è¢«è°ƒç”¨æ—¶, ä¹Ÿå°±æ˜¯æˆ‘ä»¬å¹³å¸¸è¯´çš„æ™®é€šå‡½æ•°çš„æ–¹å¼, æ­¤æ—¶çš„<code>this</code>æ€»æ˜¯æŒ‡å‘å…¨å±€å¯¹è±¡.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">window</span>.name = <span class=\"string\">'window'</span>;</span><br><span class=\"line\"><span class=\"keyword\">let</span> getName = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.name</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(getName()) <span class=\"comment\">// 'window'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æˆ–è€…</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">window</span>.name = <span class=\"string\">'window'</span>;</span><br><span class=\"line\"><span class=\"keyword\">let</span> obj = &#123;</span><br><span class=\"line\">    name: <span class=\"string\">'obj'</span>,</span><br><span class=\"line\">    getName: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.name</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// è¿™é‡Œ obj çš„ getNameæ–¹æ³•èµ‹å€¼ç»™äº†ä¸€ä¸ªå˜é‡</span></span><br><span class=\"line\"><span class=\"comment\">// è°ƒç”¨çš„æ—¶å€™å°±åªä¼šä½œä¸ºä¸€ä¸ªæ™®é€šå‡½æ•°è°ƒç”¨</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> getName = obj.gatName;</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(getName()) <span class=\"comment\">// 'window'</span></span><br></pre></td></tr></table></figure>\n<p>ä¸Šé¢è¿™ä¸­ä½œä¸ºæ™®é€šå‡½æ•°è°ƒç”¨çš„æ–¹å¼å¸¸å¸¸ä¼šå¸¦æ¥ä¸€äº›å›°æ‰°, æ¯”å¦‚åœ¨æŸä¸ª div èŠ‚ç‚¹çš„äº‹ä»¶å‡½æ•°ä¸­, å®šä¹‰äº†ä¸€ä¸ªå±€éƒ¨çš„ callback æ–¹æ³•. è€Œè¿™ä¸ª callback æ–¹æ³•æˆ‘ä»¬å¾€å¾€æ˜¯æƒ³è®©å®ƒçš„ <code>this</code>æŒ‡å‘ div èŠ‚ç‚¹, ä½†å®ƒå†…éƒ¨å´æŒ‡å‘<code>window</code>. å¦‚:</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">'div1'</span>&gt;</span>æˆ‘æ˜¯ä¸€ä¸ª div<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">window</span>.id = <span class=\"string\">'window'</span>;</span><br><span class=\"line\"><span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'div1'</span>).onclick = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.id); <span class=\"comment\">// 'div1'</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> callback = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.id); <span class=\"comment\">// 'window'\t</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    callback() <span class=\"comment\">// ä½œä¸ºæ™®é€šå‡½æ•°è¢«è°ƒç”¨</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>è¦è§£å†³ä»¥ä¸Šé—®é¢˜å…¶å®ä¹Ÿå¾ˆç®€å•, å¦‚ä¸‹:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">window</span>.id = <span class=\"string\">'window'</span>;</span><br><span class=\"line\"><span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'div1'</span>).onclick = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.id);</span><br><span class=\"line\">    <span class=\"keyword\">let</span> that = <span class=\"keyword\">this</span>; <span class=\"comment\">// ç”¨ä¸€ä¸ªå˜é‡æ¥å‚¨å­˜èŠ‚ç‚¹çš„å¼•ç”¨</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> callback = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(that.id); <span class=\"comment\">// 'div1'\t</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    callback() <span class=\"comment\">// ä½œä¸ºæ™®é€šå‡½æ•°è¢«è°ƒç”¨</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>æ„é€ å™¨è°ƒç”¨<br>å…ˆè¯´è¯´æ„é€ å™¨å§, js ä¸­æ²¡æœ‰ç±»çš„æ¦‚å¿µ, ä½†æ˜¯å¯ä»¥ä»æ„é€ å™¨ä¸­åˆ›å»ºå¯¹è±¡, åŒæ—¶æä¾› <code>new</code> è¿ç®—ç¬¦, è®©æ„é€ å™¨çœ‹èµ·æ¥æ›´åƒä¸€ä¸ªç±». Js ä¸­å¤§éƒ¨åˆ†å‡½æ•°éƒ½å¯ä»¥å½“åšæ„é€ å™¨æ¥ä½¿ç”¨, æ‰€ä»¥å®ƒçš„å¤–è¡¨çœ‹èµ·æ¥è·Ÿæ™®é€šå‡½æ•°ä¸€æ ·, åŒºåˆ«åœ¨äºè¢«è°ƒç”¨çš„æ–¹å¼. å½“ç”¨ <code>new</code> è¿ç®—ç¬¦è°ƒç”¨æ—¶, è¯¥å‡½æ•°ä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡. é€šå¸¸æƒ…å†µä¸‹, æ„é€ å™¨é‡Œçš„ <code>this</code> å°±æŒ‡å‘è¿”å›çš„è¿™ä¸ªå¯¹è±¡, å¦‚ä¸‹:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> Myobj = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.name = <span class=\"string\">'cara'</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> obj = <span class=\"keyword\">new</span> Myobj();</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(obj.name); <span class=\"comment\">// 'cara'</span></span><br></pre></td></tr></table></figure>\n<p>ä½†æ˜¯ä½¿ç”¨ <code>new</code>è°ƒç”¨æ„é€ å™¨æ—¶, è¦æ³¨æ„ä¸€ä¸ªé—®é¢˜. å¦‚æœæ„é€ å™¨æ˜¾å¼åœ°è¿”å›äº†ä¸€ä¸ªå¯¹è±¡, é‚£ä¹ˆæœ€ç»ˆå°±ä¼šè¿”å›è¿™ä¸ªå¯¹è±¡, è€Œä¸æ˜¯æˆ‘ä»¬çš„æœŸæœ›çš„ <code>this</code>:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> Myobj = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.name = <span class=\"string\">'cara'</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">        name: <span class=\"string\">'somebody'</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> obj = <span class=\"keyword\">new</span> Myobj();</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(obj.name); <span class=\"comment\">// 'somebody'</span></span><br></pre></td></tr></table></figure>\n<p>å¦‚æœæ„é€ å™¨ä¸æ˜¾å¼åœ°è¿”å›ä»»ä½•æ•°æ®æˆ–æ˜¯è¿”å›ä¸€ä¸ªéå¯¹è±¡ç±»å‹çš„æ•°æ®, å°±ä¸ä¼šå‡ºç°ä¸Šè¿°æƒ…å†µ</p>\n</li>\n<li><p>call æˆ– apply æ–¹æ³•è°ƒç”¨<br>è·Ÿæ™®é€šçš„å‡½æ•°è°ƒç”¨ç›¸æ¯”, ç”¨ call æˆ–è€… apply æ–¹æ³•è°ƒç”¨å¯ä»¥åŠ¨æ€åœ°æ”¹å˜ä¼ å…¥å‡½æ•°çš„ <code>this</code>:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> obj1 = &#123;</span><br><span class=\"line\">    name: <span class=\"string\">'cara'</span>,</span><br><span class=\"line\">    getName: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.name</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> obj2 = &#123;</span><br><span class=\"line\">    name: <span class=\"string\">'ben'</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(obj1.name); <span class=\"comment\">// 'cara'</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(obj1.name.call(obj2)); <span class=\"comment\">// 'ben'</span></span><br></pre></td></tr></table></figure>\n<p>call å’Œ apply æ–¹æ³•èƒ½å¤Ÿå¾ˆå¥½çš„ä½“ç° js çš„å‡½æ•°å¼è¯­è¨€ç‰¹æ€§. åœ¨ js ä¸­å‡ ä¹æ¯ä¸€æ¬¡ç¼–å†™å‡½æ•°å¼è¯­è¨€é£æ ¼çš„ä»£ç éƒ½ç¦»ä¸å¼€ call å’Œ apply.</p>\n</li>\n</ol>\n</li>\n</ul>\n<h4 id=\"2-ä¸¢å¤±çš„-this\"><a href=\"#2-ä¸¢å¤±çš„-this\" class=\"headerlink\" title=\"2. ä¸¢å¤±çš„ this\"></a>2. ä¸¢å¤±çš„ this</h4><p>è¿™æ˜¯ä¸€ä¸ªç»å¸¸é‡åˆ°çš„é—®é¢˜, åœ¨åˆšåˆšå¼€å§‹å­¦ä¹  js æ—¶,<code>this</code>çš„æŒ‡å‘å¸¸å¸¸ä»¤æˆ‘ç–‘æƒ‘, å°¤å…¶æ˜¯çœ‹åˆ°ç½‘ä¸Šå…³äº<code>this</code>æŒ‡å‘çš„é¢˜ç›®, ç®€ç›´äº‘é‡Œé›¾é‡Œ. ä¸‹é¢å°±æ¥çœ‹ä¸€äº›ä¾‹å­å§!</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> obj = &#123;</span><br><span class=\"line\">    name: <span class=\"string\">'apple'</span>,</span><br><span class=\"line\">    getName: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(obj.getName()); <span class=\"comment\">// 'apple'</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> getMyName = obj.getName;</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(getMyName()); <span class=\"comment\">// undefined</span></span><br></pre></td></tr></table></figure>\n<p>ä¸Šé¢è¿™ä¸ªä¾‹å­å¥½ç†è§£, å°±æ˜¯é€šè¿‡ä¸€ä¸ªå˜é‡æ¥å¼•ç”¨<code>obj.getName</code>æ–¹æ³•, å¹¶ä¸”è°ƒç”¨ getMyName æ—¶, å°±æ˜¯ç”¨çš„æ™®é€šå‡½æ•°è°ƒç”¨æ–¹å¼, <code>this</code>æ˜¯æŒ‡å‘å…¨å±€ window çš„.</p>\n<pre><code>æ¥ä¸‹æ¥å†æ¥çœ‹ä¸€ä¸ªç¨å¾®å¤æ‚ä¸€ç‚¹çš„ä¾‹å­å§:\n</code></pre><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> name = <span class=\"string\">'window'</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> person = &#123;</span><br><span class=\"line\">    name: <span class=\"string\">'person'</span>,</span><br><span class=\"line\">    showName1: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.name)</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    showName2: <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.name),</span><br><span class=\"line\">    showName3: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.name)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    showName4: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.name)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">const</span> person2 = &#123;<span class=\"attr\">name</span>: <span class=\"string\">'person2'</span>&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">person.showName1();</span><br><span class=\"line\">person.showName1().call(person2);</span><br><span class=\"line\"></span><br><span class=\"line\">person.showName2();</span><br><span class=\"line\">person.showName2().call(person2);</span><br><span class=\"line\"></span><br><span class=\"line\">person.showName3()();</span><br><span class=\"line\">person.showName3().call(person2);</span><br><span class=\"line\">person.showName3.call(person2)();</span><br><span class=\"line\"></span><br><span class=\"line\">person.showName4()();</span><br><span class=\"line\">person.showName4().call(person2);</span><br><span class=\"line\">person.showName4.call(person2)();</span><br></pre></td></tr></table></figure>\n<p>è¿™ä¸ªä¾‹å­å¯èƒ½å¤§å®¶å·²ç»å¾ˆçœ¼ç†Ÿäº†, ä¸è¿‡å½“æ—¶æˆ‘ç¬¬ä¸€æ¬¡åšçš„æ—¶å€™å‡ ä¹é”™äº†ä¸€å¤§åŠğŸ˜’â€¦. ç°åœ¨å†æ‹¿å‡ºæ¥çœ‹çœ‹å…¶å®è¿˜æ˜¯å¾ˆç»å…¸çš„: åœ¨ person å’Œ person2 ä¹‹é—´ç–¯ç‹‚ç© showName æ–¹æ³•. åœ¨ç»™å‡ºç­”æ¡ˆä¹‹å‰æˆ‘ä»¬å…ˆçœ‹çœ‹ç®­å¤´å‡½æ•°çš„ä¸€äº›ç‰¹ç‚¹:</p>\n<ul>\n<li>ç®­å¤´å‡½æ•°ä¸å¯ç”¨ä½œæ„é€ å‡½æ•°.</li>\n<li>ä¸å¯ä»¥ä½¿ç”¨ <code>arguments</code>å¯¹è±¡, å¦‚æœè¦ç”¨å¯ä»¥ä½¿ç”¨ rest å‚æ•°ä»£æ›¿.</li>\n<li>ä¸èƒ½ä½¿ç”¨<code>yield</code>å‘½ä»¤, æ‰€ä»¥ç®­å¤´å‡½æ•°ä¹Ÿä¸èƒ½ä½œä¸º Generator å‡½æ•°.</li>\n<li><p>ç®­å¤´å‡½æ•°çš„<code>this</code>æ˜¯å®šä¹‰æ—¶æ‰€åœ¨çš„å¯¹è±¡, è€Œä¸æ˜¯æ‰§è¡Œæ—¶æ‰€åœ¨çš„å¯¹è±¡.</p>\n<p>  åœ¨æœ€åä¸€ç‚¹çš„<code>this</code>æŒ‡å‘ä¸Š, æˆ‘ä¸ªäººè§‰å¾—æœ‰ç‚¹è¯¯å¯¼(ä¹Ÿå¯èƒ½æ˜¯æˆ‘æ²¡ç†è§£åˆ°ä½)â€¦ å› ä¸ºå¦‚æœåœ¨å¯¹è±¡å­—é¢é‡ä¸­çš„æ–¹æ³•æ˜¯é€šè¿‡ç®­å¤´å‡½æ•°å®šä¹‰çš„è¯, <code>this</code>çš„æŒ‡å‘å°±ä¼šå’Œä½ æœŸæœ›çš„ä¸ä¸€æ ·äº†. </p>\n</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> name = <span class=\"string\">'window'</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> obj = &#123;</span><br><span class=\"line\">    name: <span class=\"string\">'obj'</span>,</span><br><span class=\"line\">    getName: <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.name)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">obj.getName(); <span class=\"comment\">// 'window'</span></span><br></pre></td></tr></table></figure>\n<p>æ‰€ä»¥æˆ‘è§‰å¾—å…³äºç†è§£ç®­å¤´å‡½æ•°<code>this</code>åœ¨å®šä¹‰æ—¶æ‰€åœ¨çš„å¯¹è±¡æ˜¯è¿™æ ·: <code>this</code>ç»§æ‰¿è‡ªçˆ¶çº§çš„æ‰§è¡Œä¸Šä¸‹æ–‡(ç®€å•å¯¹è±¡å³éå‡½æ•°, æ˜¯æ²¡æœ‰æ‰§è¡Œä¸Šä¸‹æ–‡çš„), æ‰€ä»¥ä¸Šé¢ä¾‹å­å°±æ˜¯ getName æ–¹æ³•çš„çˆ¶çº§æ˜¯ obj, è€Œ obj çš„æ‰§è¡Œä¸Šä¸‹æ–‡æ˜¯<code>window</code>, å› æ­¤è¾“å‡ºå…¨å±€å¯¹è±¡çš„ name. ç†è§£äº†å…³äºç®­å¤´å‡½æ•°<code>this</code>çš„æŒ‡å‘, ç°åœ¨å†æ¥çœ‹çœ‹ç­”æ¡ˆå§:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">person.showName1(); <span class=\"comment\">// 'person'</span></span><br><span class=\"line\">person.showName1().call(person2); <span class=\"comment\">//  'person2'</span></span><br><span class=\"line\"></span><br><span class=\"line\">person.showName2(); <span class=\"comment\">// 'window'</span></span><br><span class=\"line\">person.showName2().call(person2); <span class=\"comment\">// 'window'</span></span><br><span class=\"line\"></span><br><span class=\"line\">person.showName3()(); <span class=\"comment\">// 'window'</span></span><br><span class=\"line\">person.showName3().call(person2); <span class=\"comment\">// 'person2'</span></span><br><span class=\"line\">person.showName3.call(person2)(); <span class=\"comment\">// 'window'</span></span><br><span class=\"line\"></span><br><span class=\"line\">person.showName4()(); <span class=\"comment\">// 'person'</span></span><br><span class=\"line\">person.showName4().call(person2); <span class=\"comment\">// 'person'</span></span><br><span class=\"line\">person.showName4.call(person2)(); <span class=\"comment\">// 'perons2'</span></span><br></pre></td></tr></table></figure>\n<p>ç„¶åæ¥åˆ†æä¸€ä¸‹ç­”æ¡ˆå§:</p>\n<ul>\n<li><p>è°ƒç”¨ showName1()<br>è¿™ä¸¤ä¸ªæ–¹å¼å¥½ç†è§£, ç¬¬ä¸€ç§æ˜¯é€šè¿‡ person å¯¹è±¡æ¥è°ƒç”¨çš„ showName1 æ–¹æ³•, ä¹Ÿå°±æ˜¯ä¸Šé¢æˆ‘ä»¬è¯´è¿‡çš„<strong>ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•è¢«è°ƒç”¨</strong>, æ‰€ä»¥<code>this</code>è‡ªç„¶æŒ‡å‘çš„æ˜¯person å¯¹è±¡; ç¬¬äºŒç§æ˜¯<strong>è¢« call å’Œ apply æ–¹æ³•è°ƒç”¨</strong>, æ‰€ä»¥<code>this</code>æŒ‡å‘çš„æ˜¯è¢« call æ–¹æ³•çŸ«æ­£çš„ person2.</p>\n</li>\n<li><p>è°ƒç”¨ showName2()<br>showName2 æ–¹æ³•æ˜¯ä¸€ä¸ªç®­å¤´å‡½æ•°, æ ¹æ®æˆ‘ä»¬ä¹‹å‰è¯´è¿‡çš„ç®­å¤´å‡½æ•°æŒ‡å‘é—®é¢˜æ¥çœ‹. ç¬¬ä¸€ç§é€šè¿‡ person å¯¹è±¡æ¥è°ƒç”¨, ç”±äº person æ˜¯ä¸€ä¸ªç®€å•å¯¹è±¡æ‰€ä»¥è¿™é‡Œå®ƒçš„æ‰§è¡Œä¸Šä¸‹æ–‡å°±æ˜¯<code>window</code>, é‚£ä¹ˆå°±æ˜¯ä½œä¸ºæ™®é€šå‡½æ•°è°ƒç”¨, <code>this</code>æŒ‡å‘ <code>window</code>; ç¬¬äºŒç§è·Ÿç¬¬ä¸€ç§æ˜¯ç›¸åŒçš„è°ƒç”¨æ–¹å¼, åªæ˜¯æŠŠ person å¯¹è±¡æ¢ä¸º person2.</p>\n</li>\n<li><p>è°ƒç”¨ showName3()<br>Person.showName3 æ˜¯ä¸€ä¸ªé«˜é˜¶å‡½æ•°, è¿”å›äº†ä¸€ä¸ªåŒ¿åå‡½æ•°. ç¬¬ä¸€ç§æ–¹å¼ç›¸å½“äºç›´æ¥è°ƒç”¨é‚£ä¸ªåŒ¿åå‡½æ•°æ‰§è¡Œç¯å¢ƒå°±æ˜¯<code>window</code>, æ‰€ä»¥<code>this</code>æŒ‡å‘<code>window</code>; ç¬¬äºŒç§æ–¹å¼é€šè¿‡ person2 æ¥è°ƒç”¨ person çš„é«˜é˜¶å‡½æ•°, è¾“å‡º person2; ç¬¬ä¸‰ç§å…ˆé€šè¿‡ person2 è°ƒç”¨ person çš„é«˜é˜¶å‡½æ•°, ç„¶ååœ¨å…¨å±€ä½œç”¨åŸŸä¸‹æ‰§è¡Œ, å› æ­¤<code>this</code>æŒ‡å‘<code>window</code>.</p>\n</li>\n<li><p>è°ƒç”¨ showName4()<br>æœ€åè¿™ä¸‰ç»„è°ƒç”¨ä¹Ÿæ˜¯é«˜é˜¶å‡½æ•°, ä¸è¿‡è¿”å›çš„åŒ¿åå‡½æ•°ç”¨çš„ç®­å¤´å‡½æ•°. å‰ä¸¤ç§æ–¹å¼ä¹Ÿå°±å°è¯äº†æˆ‘ä»¬ä¹‹å‰æ‰€è¯´çš„<strong>ç®­å¤´å‡½æ•°çš„ this ç»§æ‰¿è‡ªçˆ¶çº§æ‰§è¡Œä¸Šä¸‹æ–‡</strong>, æ‰€ä»¥å‰ä¸¤ç§éƒ½è¾“å‡º person, å°±ç®—ç¬¬äºŒç§æ–¹å¼åé¢ç”¨ call æ–¹æ³•æ¥çŸ«æ­£ä¹Ÿæ˜¯ä¸è¡Œçš„; ç¬¬ä¸‰ç§ä¹Ÿå°±æ˜¯é€šè¿‡ person2 æ¥è°ƒç”¨æ‰§è¡Œçš„ showName4 æ–¹æ³•, è‡ªç„¶ä¹Ÿå°±è¾“å‡º person2 å•¦.</p>\n</li>\n</ul>\n<blockquote>\n<h3 id=\"call-å’Œ-apply\"><a href=\"#call-å’Œ-apply\" class=\"headerlink\" title=\"call å’Œ apply\"></a>call å’Œ apply</h3><p>Function.prototype.call() å’Œ Function.prototype.apply() éƒ½æ˜¯éå¸¸å¸¸ç”¨çš„æ–¹æ³•, åœ¨å®é™…å¼€å‘ä¸­å’Œ JavaScript çš„è®¾è®¡æ¨¡å¼ä¸­è¿™ä¸¤ä¸ªæ–¹æ³•åº”ç”¨å¹¿æ³›. å…¶å®å®ƒä»¬çš„ä½œç”¨æ˜¯ä¸€æ ·çš„, åªæ˜¯æœ‰ä¼ å…¥å‚æ•°å½¢å¼ä¸åŒçš„åŒºåˆ«.</p>\n</blockquote>\n<ul>\n<li><p>apply<br>apply æ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‚æ•°: ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šå‡½æ•°ä½“ä¸­ <code>this</code>çš„æŒ‡å‘; ç¬¬äºŒä¸ªå‚æ•°ä¸ºä¸€ä¸ªå¸¦ä¸‹æ ‡çš„åˆé›†(å¯ä»¥æ˜¯æ•°ç»„æˆ–è€…ç±»æ•°ç»„), è¿™ä¸ªå‚æ•°å°†ä¼šä¼ é€’ç»™è¢«è°ƒç”¨çš„å‡½æ•°.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> fn = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">a, b, c</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">console</span>.log(a, b, c); <span class=\"comment\">// 1 2 3</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// ç¬¬ä¸€ä¸ªå‚æ•°ä¸º null çš„è¯, è¡¨ç¤ºä¸æ”¹å˜ this çš„æŒ‡å‘</span></span><br><span class=\"line\">fn.apply(<span class=\"literal\">null</span>, [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>]);</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>call<br>call æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°å’Œ apply æ–¹æ³•ä¸€æ ·, æŒ‡å®š<code>this</code>çš„æŒ‡å‘; ç¬¬äºŒä¸ªå‚æ•°ä¸åŒ, call æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°çš„æ•°é‡ä¸å›ºå®š, ä»ç¬¬äºŒå‚æ•°å¼€å§‹ä¸€æ¬¡æŒ‰é¡ºåºä¼ é€’ç»™è¢«è°ƒç”¨çš„å‡½æ•°.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> fn = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">a, b, c</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">console</span>.log(a, b, c); <span class=\"comment\">// 1 2 3</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">fn.call(<span class=\"literal\">null</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>)</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>åœ¨æˆ‘ä»¬ä¸å…³å¿ƒå…·ä½“æœ‰å¤šå°‘å‚æ•°è¢«ä¼ å…¥å‡½æ•°æ—¶, å°±å¯ä»¥ä½¿ç”¨ apply æ–¹æ³•ä¸€è‚¡è„‘æ¨è¿‡å»å°±è¡Œäº†; å½“æˆ‘ä»¬æ˜ç¡®çš„çŸ¥é“æœ‰å¤šå°‘å‚æ•°, æƒ³ä¸€ç›®äº†ç„¶çš„è¡¨è¾¾å½¢å‚å’Œå®å‚çš„å¯¹åº”å…³ç³»æ—¶, é‚£ä¹ˆå°±å¯ä»¥ç”¨ call æ–¹æ³•.</p>\n<ul>\n<li><p>å€Ÿç”¨å…¶ä»–å¯¹è±¡çš„æ–¹æ³•<br>call å’Œ apply ç»å¸¸è¢«ç”¨æ¥å€Ÿç”¨å…¶ä»–å¯¹è±¡çš„æ–¹æ³•, å¸¸ç”¨çš„å°±æœ‰å€Ÿç”¨<code>Array</code>çš„æ–¹æ³•æ¥æ“ä½œ<code>arguments</code>æˆ–è€…å€Ÿç”¨æ„é€ å‡½æ•°æ¥å®ç°ä¸€äº›ç±»ä¼¼ç»§æ‰¿çš„æ•ˆæœ.</p>\n<ol>\n<li><p>å€Ÿç”¨æ„é€ å‡½æ•°</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> A = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">name</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">this</span>.name = name</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"comment\">// å€Ÿç”¨æ„é€ å‡½æ•° A</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> B = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\tA.apply(<span class=\"keyword\">this</span>, <span class=\"built_in\">arguments</span>)</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">B.prototype.getName = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.name</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> b = <span class=\"keyword\">new</span> B(<span class=\"string\">'cara'</span>);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(b.getName); <span class=\"comment\">// 'cara'</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>å€Ÿç”¨ Array çš„æ–¹æ³•</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">Array</span>.prototype.push.call(<span class=\"built_in\">arguments</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">console</span>.log(<span class=\"built_in\">arguments</span>); <span class=\"comment\">// &#123;'0': 1, '1': 2, '2': 3&#125;</span></span><br><span class=\"line\">&#125;)(<span class=\"number\">1</span>, <span class=\"number\">2</span>)</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n</li>\n</ul>\n<p>å€Ÿç”¨çš„æ—¶å€™è¦ä¿è¯ä¸¤ä¸ªå¿…è¦æ¡ä»¶: 1. å¯¹è±¡æœ¬èº«è¦å¯ä»¥å­˜å–å±æ€§; 2. å¯¹è±¡çš„ length å±æ€§å¯è¯»å†™.</p>\n<blockquote>\n<h3 id=\"Function-prototype-bind\"><a href=\"#Function-prototype-bind\" class=\"headerlink\" title=\"Function.prototype.bind\"></a>Function.prototype.bind</h3><p>ç»‘å®šå‡½æ•° bind ä¹Ÿæ˜¯å¯ä»¥ç”¨ä½œçŸ«æ­£ <code>this</code>çš„æŒ‡å‘, bind å‡½æ•°ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°(ç»‘å®šå‡½æ•°), æ–°å‡½æ•°å’Œç›®æ ‡å‡½æ•°å°†æ‹¥æœ‰ç›¸åŒçš„å‡½æ•°ä½“. ç¬¬ä¸€ä¸ªå‚æ•°ç»‘å®š<code>this</code>çš„æŒ‡å‘, ä»ç¬¬äºŒå‚æ•°èµ·åé¢çš„å‚æ•°å°†ä½œä¸ºå®å‚ç»‘å®šåˆ°ç›®æ ‡å‡½æ•°çš„å½¢å‚.</p>\n</blockquote>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> sum = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">a, b</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> a + b;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">let</span> result = sum.bind(<span class=\"literal\">null</span>, <span class=\"number\">1</span>); <span class=\"comment\">// 1 å°†ä½œä¸ºå®å‚ä¼ å…¥ sum</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(result(<span class=\"number\">2</span>)); <span class=\"comment\">// 3</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>å¦å¤–å½“ bind è¿”å›çš„å‡½æ•°ä½œä¸ºæ„é€ å‡½æ•°ä½¿ç”¨çš„è¯, ç»‘å®šçš„<code>this</code>å°†è¢«å¿½ç•¥, å®å‚ä¼ å…¥ç›®æ ‡å‡½æ•°.</p>\n</blockquote>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> original = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">x</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">this</span>.a = <span class=\"number\">1</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">this</span>.b = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.a + x</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> obj = &#123;</span><br><span class=\"line\">\ta: <span class=\"number\">2</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> newObj = <span class=\"keyword\">new</span> (original.bind(obj, <span class=\"number\">2</span>));</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(newObj.a); <span class=\"comment\">// 1 =&gt; this çš„æŒ‡å‘è¢«å¿½ç•¥</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(newObj.b()); <span class=\"comment\">// 3 =&gt; 2 è¢«ä¼ å…¥ original</span></span><br></pre></td></tr></table></figure>\n<p>call å’Œ apply æ–¹æ³•éƒ½æ˜¯æ”¹å˜<code>this</code>æŒ‡å‘åç«‹å³æ‰§è¡Œè€Œ bind å¯ä»¥åœ¨ä½ æƒ³æ‰§è¡Œçš„<br>æ—¶å€™å†æ‰§è¡Œ.</p>\n<p>å·®ä¸å¤šå°±åˆ°è¿™å„¿å§, è¦æ˜¯æœ‰è¡¥å……å†æ¥ç€å†™â€¦</p>\n<p>Created on 2017-10-17 by Cara</p>\n"},{"title":"äº‹ä»¶","date":"2017-12-10T14:05:49.000Z","_content":"JavaScript å’Œ HTML äº¤äº’æ˜¯é€šè¿‡äº‹ä»¶å®ç°, è€Œäº‹ä»¶å¤„ç†ç¨‹åºè®¢é˜…äº‹ä»¶ä»è€Œæ‰§è¡Œç›¸åº”çš„æ“ä½œ.\n\n#### äº‹ä»¶æµ\näº‹ä»¶æµæè¿°çš„æ˜¯ ä»é¡µé¢æ¥æ”¶äº‹ä»¶çš„é¡ºåº. \näº‹ä»¶å†’æ³¡: ä»æœ€å…·ä½“çš„å…ƒç´ åˆ°æœ€ä¸å…·ä½“çš„å…ƒç´ (ä»å†…åˆ°å¤–); â€” IE  \näº‹ä»¶æ•è·: ä»æœ€ä¸å…·ä½“çš„å…ƒç´ åˆ°æœ€å…·ä½“çš„å…ƒç´ (ä»å¤–åˆ°å†…); â€” Netscape\nDOM äº‹ä»¶æµ: å…ˆæ•è·åå†’æ³¡çš„æ–¹å¼.\n\nDOMäº‹ä»¶æµåŒ…æ‹¬ä¸‰ä¸ªé˜¶æ®µ:\n1. æ•è·é˜¶æ®µ (IE ä½ç‰ˆæœ¬ä¸æ”¯æŒè¯¥é˜¶æ®µ)\n2. ç›®æ ‡é˜¶æ®µ (è§¦å‘äº‹ä»¶)\n3. å†’æ³¡é˜¶æ®µ (å›ä¼ æ–‡æ¡£)\n\n#### äº‹ä»¶å¤„ç†ç¨‹åº\näº‹ä»¶æ˜¯ç”¨æˆ·æˆ–æµè§ˆå™¨è‡ªèº«æ‰§è¡Œçš„åŠ¨ä½œ, äº‹ä»¶å¤„ç†ç¨‹åº(äº‹ä»¶ç›‘å¬å™¨)æ˜¯å“åº”äº‹ä»¶çš„åŠ¨ä½œ. æ¯”å¦‚ click äº‹ä»¶çš„äº‹ä»¶å¤„ç†ç¨‹åºå°±æ˜¯ onclick, ä¸ºäº‹ä»¶æŒ‡å®šå¤„ç†ç¨‹åºçš„æ–¹å¼ä¹Ÿæœ‰å‡ ç§.\n\n##### HTML äº‹ä»¶å¤„ç†ç¨‹åº\nåœ¨æ ‡ç­¾ä¸Šç»‘å®šäº‹ä»¶å¤„ç†ç¨‹åº, HTML å’Œ js ç´§å¯†è€¦åˆ\n```HTML\n<button onclick='alert('clicked')'>click me</button>\n```\n\n##### DOM 0çº§äº‹ä»¶å¤„ç†ç¨‹åº\nå°†ä¸€ä¸ªå‡½æ•°èµ‹å€¼ç»™ä¸€ä¸ªäº‹ä»¶å¤„ç†ç¨‹åºå±æ€§\n```javascript\nvar btn = document.querySelector('#btn');\nbtn.onclick = function () {\n\talert('clicked')\n}\n```\n\n##### DOM 2çº§äº‹ä»¶å¤„ç†ç¨‹åº\nå®šä¹‰äº†ä¸¤ä¸ªæ–¹æ³•, ç”¨äºç»‘å®šäº‹ä»¶å¤„ç†ç¨‹åºå’Œåˆ é™¤äº‹ä»¶å¤„ç†ç¨‹åº: `addEventListener()`å’Œ`removeEventListener()`. æ‰€æœ‰çš„ DOM èŠ‚ç‚¹éƒ½åŒ…å«è¿™ä¸¤ä¸ªæ–¹æ³•, æ–¹æ³•æœ‰ä¸‰ä¸ªå‚æ•°: éœ€è¦å¤„ç†çš„äº‹ä»¶å/ å¤„ç†å‡½æ•°/ å¸ƒå°”å€¼(true ä¸ºåœ¨æ•è·é˜¶æ®µè°ƒç”¨; false ä¸ºåœ¨å†’æ³¡é˜¶æ®µè°ƒç”¨)\n```javascript\nvar btn = document.querySelector('#btn');\n// ç»‘å®šå¤„ç†ç¨‹åº\nbtn.addEventListener('click', function () {\n\talert('clicked')\n}, false);\n// ç§»é™¤å¤„ç†ç¨‹åº(ç§»é™¤å¤„ç†ç¨‹åºæ—¶, ç¬¬äºŒä¸ªå‚æ•°å¿…é¡»å’Œç»‘å®šæ—¶ä¸€æ ·)\nbtn.removeEventListener('click', function () {\n\talert('remove')\n}, false)\n```\n\n#### IE å’Œ  DOM2çº§äº‹ä»¶å¤„ç†ç¨‹åºçš„åŒºåˆ«\n\n- IE äº‹ä»¶å¤„ç†ç¨‹åº\n```javascript\nvar btn = docuemnt.querySelector('#btn');\n// ç»‘å®šäº‹ä»¶\nbtn.attachEvent('onclick', function () {\n\t// this === window\n\talert('click on IE')\n})\n// ç§»é™¤äº‹ä»¶\nbtn.detachEvent('onclick', function () {\n\talert('remove on IE')\n})\n```\n\n**ä»¥ä¸Šä¸¤ç§äº‹ä»¶å¤„ç†ç¨‹åºéƒ½æ”¯æŒç»‘å®šå¤šä¸ªäº‹ä»¶, DOM2çº§æŒ‰ç…§é¡ºåº**\n\n- è·¨æµè§ˆå™¨äº‹ä»¶å¤„ç†\n```javascript\nconst EventUtil = {\n\t// ç»‘å®šäº‹ä»¶å¤„ç†ç¨‹åº\n\taddHanlder: function (element, type, handler) {\n\t\tif (element.addEventListener) {\n\t\t\telement.addEventListener(type, handler, false)\n\t\t}\n\t\telse if (element.attachEvent) {\n\t\t\telement.attachEvent('on' + type, handler)\n\t\t}\n\t\telse {\n\t\t\telement['on' + type] = handler;\n\t\t}\n\t},\n\t// ç§»é™¤äº‹ä»¶å¤„ç†ç¨‹åº\n\tremoveHandler: function (element, type, handler) {\n\t\tif (element.removeEventListener) {\n\t\t\telement.removeEventListener(type, handler, false)\n\t\t}\n\t\telse if (element.detachEvent) {\n\t\t\telement.detachEvent('on' + type, handler)\n\t\t}\n\t\telse {\n\t\t\telement['on' + type] = null;\n\t\t}\n\t}\n} \n```\n\n#### äº‹ä»¶ä»£ç†/ å§”æ‰˜\nç”±äºäº‹ä»¶å¤„ç†ç¨‹åºè¶Šå¤š, æ€§èƒ½è¶Šå·®, æ‰€ä»¥æœ‰äº†äº‹ä»¶å¤„ç†ç¨‹åº. äº‹ä»¶ä»£ç†çš„åŸç†æ˜¯åŸºäºäº‹ä»¶çš„å†’æ³¡æœºåˆ¶å®ç°çš„, ç”±ä¸Šçº§èŠ‚ç‚¹ä»£ç†å®Œæˆäº‹ä»¶ç»‘å®š, ä¼˜ç‚¹æ˜¯: \n\n> èŠ‚çœå†…å­˜å ç”¨, å‡å°‘äº‹ä»¶æ³¨å†Œ. æ¯”å¦‚åœ¨`ul`ä»£ç†æ‰€æœ‰`li`çš„ç‚¹å‡»äº‹ä»¶\n> åŠ¨æ€æ–°å¢å­çº§æ—¶, æ— éœ€å†æ¬¡ç»‘å®šäº‹ä»¶.\n\nå¯èƒ½ä¼šæåˆ°`currentTarget`å’Œ`target`çš„åŒºåˆ«: currentTarget æ˜¯æ³¨å†Œäº‹ä»¶æ—¶çš„ç›®æ ‡(åœ¨äº‹ä»¶å¤„ç†ç¨‹åºä¸­`this`å§‹ç»ˆæŒ‡å‘ currentTarget), target æ˜¯çœŸæ­£è§¦å‘äº‹ä»¶çš„ç›®æ ‡.\n\n```javascript\ndocument.body.onclick = function (event) {\n\t// äº‹ä»¶æ³¨å†Œæ—¶çš„å…ƒç´ \n\tconsole.log(document.body === event.currentTarget); // true\n\tconsole.log(this === document.body); // true\n\t// çœŸæ­£ç‚¹å‡»çš„å…ƒç´ \n\tconsole.log(event.target === document.querySelector('#btn')); // true\n}\n```\n\n#### äº‹ä»¶å¯¹è±¡\näº‹ä»¶å†…ç½®çš„ event å¯¹è±¡, ä¸‹é¢åˆ—ä¸¾å¸¸ç”¨çš„å‡ ä¸ªäº‹ä»¶å¯¹è±¡å±æ€§:\n- event || window.event\n- event.preventDefault() || window.event.cancelBubble(Boolean)\né˜»æ­¢æµè§ˆå™¨é»˜è®¤äº‹ä»¶\n- event.stopPropagation() || window.event.returnValue(Boolean)\né˜»æ­¢å†’æ³¡äº‹ä»¶\n- event.target || winow.event.srcElement\n\nCreated on 2017-12-10 by Cara","source":"_posts/äº‹ä»¶ä»£ç†-å§”æ‰˜.md","raw":"---\ntitle: äº‹ä»¶\ndate: 2017-12-10 22:05:49\ntags:\n- JavaScript\ncategories: \n- å¤ä¹ \n---\nJavaScript å’Œ HTML äº¤äº’æ˜¯é€šè¿‡äº‹ä»¶å®ç°, è€Œäº‹ä»¶å¤„ç†ç¨‹åºè®¢é˜…äº‹ä»¶ä»è€Œæ‰§è¡Œç›¸åº”çš„æ“ä½œ.\n\n#### äº‹ä»¶æµ\näº‹ä»¶æµæè¿°çš„æ˜¯ ä»é¡µé¢æ¥æ”¶äº‹ä»¶çš„é¡ºåº. \näº‹ä»¶å†’æ³¡: ä»æœ€å…·ä½“çš„å…ƒç´ åˆ°æœ€ä¸å…·ä½“çš„å…ƒç´ (ä»å†…åˆ°å¤–); â€” IE  \näº‹ä»¶æ•è·: ä»æœ€ä¸å…·ä½“çš„å…ƒç´ åˆ°æœ€å…·ä½“çš„å…ƒç´ (ä»å¤–åˆ°å†…); â€” Netscape\nDOM äº‹ä»¶æµ: å…ˆæ•è·åå†’æ³¡çš„æ–¹å¼.\n\nDOMäº‹ä»¶æµåŒ…æ‹¬ä¸‰ä¸ªé˜¶æ®µ:\n1. æ•è·é˜¶æ®µ (IE ä½ç‰ˆæœ¬ä¸æ”¯æŒè¯¥é˜¶æ®µ)\n2. ç›®æ ‡é˜¶æ®µ (è§¦å‘äº‹ä»¶)\n3. å†’æ³¡é˜¶æ®µ (å›ä¼ æ–‡æ¡£)\n\n#### äº‹ä»¶å¤„ç†ç¨‹åº\näº‹ä»¶æ˜¯ç”¨æˆ·æˆ–æµè§ˆå™¨è‡ªèº«æ‰§è¡Œçš„åŠ¨ä½œ, äº‹ä»¶å¤„ç†ç¨‹åº(äº‹ä»¶ç›‘å¬å™¨)æ˜¯å“åº”äº‹ä»¶çš„åŠ¨ä½œ. æ¯”å¦‚ click äº‹ä»¶çš„äº‹ä»¶å¤„ç†ç¨‹åºå°±æ˜¯ onclick, ä¸ºäº‹ä»¶æŒ‡å®šå¤„ç†ç¨‹åºçš„æ–¹å¼ä¹Ÿæœ‰å‡ ç§.\n\n##### HTML äº‹ä»¶å¤„ç†ç¨‹åº\nåœ¨æ ‡ç­¾ä¸Šç»‘å®šäº‹ä»¶å¤„ç†ç¨‹åº, HTML å’Œ js ç´§å¯†è€¦åˆ\n```HTML\n<button onclick='alert('clicked')'>click me</button>\n```\n\n##### DOM 0çº§äº‹ä»¶å¤„ç†ç¨‹åº\nå°†ä¸€ä¸ªå‡½æ•°èµ‹å€¼ç»™ä¸€ä¸ªäº‹ä»¶å¤„ç†ç¨‹åºå±æ€§\n```javascript\nvar btn = document.querySelector('#btn');\nbtn.onclick = function () {\n\talert('clicked')\n}\n```\n\n##### DOM 2çº§äº‹ä»¶å¤„ç†ç¨‹åº\nå®šä¹‰äº†ä¸¤ä¸ªæ–¹æ³•, ç”¨äºç»‘å®šäº‹ä»¶å¤„ç†ç¨‹åºå’Œåˆ é™¤äº‹ä»¶å¤„ç†ç¨‹åº: `addEventListener()`å’Œ`removeEventListener()`. æ‰€æœ‰çš„ DOM èŠ‚ç‚¹éƒ½åŒ…å«è¿™ä¸¤ä¸ªæ–¹æ³•, æ–¹æ³•æœ‰ä¸‰ä¸ªå‚æ•°: éœ€è¦å¤„ç†çš„äº‹ä»¶å/ å¤„ç†å‡½æ•°/ å¸ƒå°”å€¼(true ä¸ºåœ¨æ•è·é˜¶æ®µè°ƒç”¨; false ä¸ºåœ¨å†’æ³¡é˜¶æ®µè°ƒç”¨)\n```javascript\nvar btn = document.querySelector('#btn');\n// ç»‘å®šå¤„ç†ç¨‹åº\nbtn.addEventListener('click', function () {\n\talert('clicked')\n}, false);\n// ç§»é™¤å¤„ç†ç¨‹åº(ç§»é™¤å¤„ç†ç¨‹åºæ—¶, ç¬¬äºŒä¸ªå‚æ•°å¿…é¡»å’Œç»‘å®šæ—¶ä¸€æ ·)\nbtn.removeEventListener('click', function () {\n\talert('remove')\n}, false)\n```\n\n#### IE å’Œ  DOM2çº§äº‹ä»¶å¤„ç†ç¨‹åºçš„åŒºåˆ«\n\n- IE äº‹ä»¶å¤„ç†ç¨‹åº\n```javascript\nvar btn = docuemnt.querySelector('#btn');\n// ç»‘å®šäº‹ä»¶\nbtn.attachEvent('onclick', function () {\n\t// this === window\n\talert('click on IE')\n})\n// ç§»é™¤äº‹ä»¶\nbtn.detachEvent('onclick', function () {\n\talert('remove on IE')\n})\n```\n\n**ä»¥ä¸Šä¸¤ç§äº‹ä»¶å¤„ç†ç¨‹åºéƒ½æ”¯æŒç»‘å®šå¤šä¸ªäº‹ä»¶, DOM2çº§æŒ‰ç…§é¡ºåº**\n\n- è·¨æµè§ˆå™¨äº‹ä»¶å¤„ç†\n```javascript\nconst EventUtil = {\n\t// ç»‘å®šäº‹ä»¶å¤„ç†ç¨‹åº\n\taddHanlder: function (element, type, handler) {\n\t\tif (element.addEventListener) {\n\t\t\telement.addEventListener(type, handler, false)\n\t\t}\n\t\telse if (element.attachEvent) {\n\t\t\telement.attachEvent('on' + type, handler)\n\t\t}\n\t\telse {\n\t\t\telement['on' + type] = handler;\n\t\t}\n\t},\n\t// ç§»é™¤äº‹ä»¶å¤„ç†ç¨‹åº\n\tremoveHandler: function (element, type, handler) {\n\t\tif (element.removeEventListener) {\n\t\t\telement.removeEventListener(type, handler, false)\n\t\t}\n\t\telse if (element.detachEvent) {\n\t\t\telement.detachEvent('on' + type, handler)\n\t\t}\n\t\telse {\n\t\t\telement['on' + type] = null;\n\t\t}\n\t}\n} \n```\n\n#### äº‹ä»¶ä»£ç†/ å§”æ‰˜\nç”±äºäº‹ä»¶å¤„ç†ç¨‹åºè¶Šå¤š, æ€§èƒ½è¶Šå·®, æ‰€ä»¥æœ‰äº†äº‹ä»¶å¤„ç†ç¨‹åº. äº‹ä»¶ä»£ç†çš„åŸç†æ˜¯åŸºäºäº‹ä»¶çš„å†’æ³¡æœºåˆ¶å®ç°çš„, ç”±ä¸Šçº§èŠ‚ç‚¹ä»£ç†å®Œæˆäº‹ä»¶ç»‘å®š, ä¼˜ç‚¹æ˜¯: \n\n> èŠ‚çœå†…å­˜å ç”¨, å‡å°‘äº‹ä»¶æ³¨å†Œ. æ¯”å¦‚åœ¨`ul`ä»£ç†æ‰€æœ‰`li`çš„ç‚¹å‡»äº‹ä»¶\n> åŠ¨æ€æ–°å¢å­çº§æ—¶, æ— éœ€å†æ¬¡ç»‘å®šäº‹ä»¶.\n\nå¯èƒ½ä¼šæåˆ°`currentTarget`å’Œ`target`çš„åŒºåˆ«: currentTarget æ˜¯æ³¨å†Œäº‹ä»¶æ—¶çš„ç›®æ ‡(åœ¨äº‹ä»¶å¤„ç†ç¨‹åºä¸­`this`å§‹ç»ˆæŒ‡å‘ currentTarget), target æ˜¯çœŸæ­£è§¦å‘äº‹ä»¶çš„ç›®æ ‡.\n\n```javascript\ndocument.body.onclick = function (event) {\n\t// äº‹ä»¶æ³¨å†Œæ—¶çš„å…ƒç´ \n\tconsole.log(document.body === event.currentTarget); // true\n\tconsole.log(this === document.body); // true\n\t// çœŸæ­£ç‚¹å‡»çš„å…ƒç´ \n\tconsole.log(event.target === document.querySelector('#btn')); // true\n}\n```\n\n#### äº‹ä»¶å¯¹è±¡\näº‹ä»¶å†…ç½®çš„ event å¯¹è±¡, ä¸‹é¢åˆ—ä¸¾å¸¸ç”¨çš„å‡ ä¸ªäº‹ä»¶å¯¹è±¡å±æ€§:\n- event || window.event\n- event.preventDefault() || window.event.cancelBubble(Boolean)\né˜»æ­¢æµè§ˆå™¨é»˜è®¤äº‹ä»¶\n- event.stopPropagation() || window.event.returnValue(Boolean)\né˜»æ­¢å†’æ³¡äº‹ä»¶\n- event.target || winow.event.srcElement\n\nCreated on 2017-12-10 by Cara","slug":"äº‹ä»¶ä»£ç†-å§”æ‰˜","published":1,"updated":"2018-05-05T09:23:03.673Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjgurolst001dklu09raid2so","content":"<p>JavaScript å’Œ HTML äº¤äº’æ˜¯é€šè¿‡äº‹ä»¶å®ç°, è€Œäº‹ä»¶å¤„ç†ç¨‹åºè®¢é˜…äº‹ä»¶ä»è€Œæ‰§è¡Œç›¸åº”çš„æ“ä½œ.</p>\n<h4 id=\"äº‹ä»¶æµ\"><a href=\"#äº‹ä»¶æµ\" class=\"headerlink\" title=\"äº‹ä»¶æµ\"></a>äº‹ä»¶æµ</h4><p>äº‹ä»¶æµæè¿°çš„æ˜¯ ä»é¡µé¢æ¥æ”¶äº‹ä»¶çš„é¡ºåº.<br>äº‹ä»¶å†’æ³¡: ä»æœ€å…·ä½“çš„å…ƒç´ åˆ°æœ€ä¸å…·ä½“çš„å…ƒç´ (ä»å†…åˆ°å¤–); â€” IE<br>äº‹ä»¶æ•è·: ä»æœ€ä¸å…·ä½“çš„å…ƒç´ åˆ°æœ€å…·ä½“çš„å…ƒç´ (ä»å¤–åˆ°å†…); â€” Netscape<br>DOM äº‹ä»¶æµ: å…ˆæ•è·åå†’æ³¡çš„æ–¹å¼.</p>\n<p>DOMäº‹ä»¶æµåŒ…æ‹¬ä¸‰ä¸ªé˜¶æ®µ:</p>\n<ol>\n<li>æ•è·é˜¶æ®µ (IE ä½ç‰ˆæœ¬ä¸æ”¯æŒè¯¥é˜¶æ®µ)</li>\n<li>ç›®æ ‡é˜¶æ®µ (è§¦å‘äº‹ä»¶)</li>\n<li>å†’æ³¡é˜¶æ®µ (å›ä¼ æ–‡æ¡£)</li>\n</ol>\n<h4 id=\"äº‹ä»¶å¤„ç†ç¨‹åº\"><a href=\"#äº‹ä»¶å¤„ç†ç¨‹åº\" class=\"headerlink\" title=\"äº‹ä»¶å¤„ç†ç¨‹åº\"></a>äº‹ä»¶å¤„ç†ç¨‹åº</h4><p>äº‹ä»¶æ˜¯ç”¨æˆ·æˆ–æµè§ˆå™¨è‡ªèº«æ‰§è¡Œçš„åŠ¨ä½œ, äº‹ä»¶å¤„ç†ç¨‹åº(äº‹ä»¶ç›‘å¬å™¨)æ˜¯å“åº”äº‹ä»¶çš„åŠ¨ä½œ. æ¯”å¦‚ click äº‹ä»¶çš„äº‹ä»¶å¤„ç†ç¨‹åºå°±æ˜¯ onclick, ä¸ºäº‹ä»¶æŒ‡å®šå¤„ç†ç¨‹åºçš„æ–¹å¼ä¹Ÿæœ‰å‡ ç§.</p>\n<h5 id=\"HTML-äº‹ä»¶å¤„ç†ç¨‹åº\"><a href=\"#HTML-äº‹ä»¶å¤„ç†ç¨‹åº\" class=\"headerlink\" title=\"HTML äº‹ä»¶å¤„ç†ç¨‹åº\"></a>HTML äº‹ä»¶å¤„ç†ç¨‹åº</h5><p>åœ¨æ ‡ç­¾ä¸Šç»‘å®šäº‹ä»¶å¤„ç†ç¨‹åº, HTML å’Œ js ç´§å¯†è€¦åˆ<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">button</span> <span class=\"attr\">onclick</span>=<span class=\"string\">'alert('</span><span class=\"attr\">clicked</span>')'&gt;</span>click me<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br></pre></td></tr></table></figure></p>\n<h5 id=\"DOM-0çº§äº‹ä»¶å¤„ç†ç¨‹åº\"><a href=\"#DOM-0çº§äº‹ä»¶å¤„ç†ç¨‹åº\" class=\"headerlink\" title=\"DOM 0çº§äº‹ä»¶å¤„ç†ç¨‹åº\"></a>DOM 0çº§äº‹ä»¶å¤„ç†ç¨‹åº</h5><p>å°†ä¸€ä¸ªå‡½æ•°èµ‹å€¼ç»™ä¸€ä¸ªäº‹ä»¶å¤„ç†ç¨‹åºå±æ€§<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> btn = <span class=\"built_in\">document</span>.querySelector(<span class=\"string\">'#btn'</span>);</span><br><span class=\"line\">btn.onclick = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\talert(<span class=\"string\">'clicked'</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"DOM-2çº§äº‹ä»¶å¤„ç†ç¨‹åº\"><a href=\"#DOM-2çº§äº‹ä»¶å¤„ç†ç¨‹åº\" class=\"headerlink\" title=\"DOM 2çº§äº‹ä»¶å¤„ç†ç¨‹åº\"></a>DOM 2çº§äº‹ä»¶å¤„ç†ç¨‹åº</h5><p>å®šä¹‰äº†ä¸¤ä¸ªæ–¹æ³•, ç”¨äºç»‘å®šäº‹ä»¶å¤„ç†ç¨‹åºå’Œåˆ é™¤äº‹ä»¶å¤„ç†ç¨‹åº: <code>addEventListener()</code>å’Œ<code>removeEventListener()</code>. æ‰€æœ‰çš„ DOM èŠ‚ç‚¹éƒ½åŒ…å«è¿™ä¸¤ä¸ªæ–¹æ³•, æ–¹æ³•æœ‰ä¸‰ä¸ªå‚æ•°: éœ€è¦å¤„ç†çš„äº‹ä»¶å/ å¤„ç†å‡½æ•°/ å¸ƒå°”å€¼(true ä¸ºåœ¨æ•è·é˜¶æ®µè°ƒç”¨; false ä¸ºåœ¨å†’æ³¡é˜¶æ®µè°ƒç”¨)<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> btn = <span class=\"built_in\">document</span>.querySelector(<span class=\"string\">'#btn'</span>);</span><br><span class=\"line\"><span class=\"comment\">// ç»‘å®šå¤„ç†ç¨‹åº</span></span><br><span class=\"line\">btn.addEventListener(<span class=\"string\">'click'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\talert(<span class=\"string\">'clicked'</span>)</span><br><span class=\"line\">&#125;, <span class=\"literal\">false</span>);</span><br><span class=\"line\"><span class=\"comment\">// ç§»é™¤å¤„ç†ç¨‹åº(ç§»é™¤å¤„ç†ç¨‹åºæ—¶, ç¬¬äºŒä¸ªå‚æ•°å¿…é¡»å’Œç»‘å®šæ—¶ä¸€æ ·)</span></span><br><span class=\"line\">btn.removeEventListener(<span class=\"string\">'click'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\talert(<span class=\"string\">'remove'</span>)</span><br><span class=\"line\">&#125;, <span class=\"literal\">false</span>)</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"IE-å’Œ-DOM2çº§äº‹ä»¶å¤„ç†ç¨‹åºçš„åŒºåˆ«\"><a href=\"#IE-å’Œ-DOM2çº§äº‹ä»¶å¤„ç†ç¨‹åºçš„åŒºåˆ«\" class=\"headerlink\" title=\"IE å’Œ  DOM2çº§äº‹ä»¶å¤„ç†ç¨‹åºçš„åŒºåˆ«\"></a>IE å’Œ  DOM2çº§äº‹ä»¶å¤„ç†ç¨‹åºçš„åŒºåˆ«</h4><ul>\n<li>IE äº‹ä»¶å¤„ç†ç¨‹åº<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> btn = docuemnt.querySelector(<span class=\"string\">'#btn'</span>);</span><br><span class=\"line\"><span class=\"comment\">// ç»‘å®šäº‹ä»¶</span></span><br><span class=\"line\">btn.attachEvent(<span class=\"string\">'onclick'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">// this === window</span></span><br><span class=\"line\">\talert(<span class=\"string\">'click on IE'</span>)</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"comment\">// ç§»é™¤äº‹ä»¶</span></span><br><span class=\"line\">btn.detachEvent(<span class=\"string\">'onclick'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\talert(<span class=\"string\">'remove on IE'</span>)</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p><strong>ä»¥ä¸Šä¸¤ç§äº‹ä»¶å¤„ç†ç¨‹åºéƒ½æ”¯æŒç»‘å®šå¤šä¸ªäº‹ä»¶, DOM2çº§æŒ‰ç…§é¡ºåº</strong></p>\n<ul>\n<li>è·¨æµè§ˆå™¨äº‹ä»¶å¤„ç†<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> EventUtil = &#123;</span><br><span class=\"line\">\t<span class=\"comment\">// ç»‘å®šäº‹ä»¶å¤„ç†ç¨‹åº</span></span><br><span class=\"line\">\taddHanlder: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">element, type, handler</span>) </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (element.addEventListener) &#123;</span><br><span class=\"line\">\t\t\telement.addEventListener(type, handler, <span class=\"literal\">false</span>)</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (element.attachEvent) &#123;</span><br><span class=\"line\">\t\t\telement.attachEvent(<span class=\"string\">'on'</span> + type, handler)</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\telement[<span class=\"string\">'on'</span> + type] = handler;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\">\t<span class=\"comment\">// ç§»é™¤äº‹ä»¶å¤„ç†ç¨‹åº</span></span><br><span class=\"line\">\tremoveHandler: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">element, type, handler</span>) </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (element.removeEventListener) &#123;</span><br><span class=\"line\">\t\t\telement.removeEventListener(type, handler, <span class=\"literal\">false</span>)</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (element.detachEvent) &#123;</span><br><span class=\"line\">\t\t\telement.detachEvent(<span class=\"string\">'on'</span> + type, handler)</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\telement[<span class=\"string\">'on'</span> + type] = <span class=\"literal\">null</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h4 id=\"äº‹ä»¶ä»£ç†-å§”æ‰˜\"><a href=\"#äº‹ä»¶ä»£ç†-å§”æ‰˜\" class=\"headerlink\" title=\"äº‹ä»¶ä»£ç†/ å§”æ‰˜\"></a>äº‹ä»¶ä»£ç†/ å§”æ‰˜</h4><p>ç”±äºäº‹ä»¶å¤„ç†ç¨‹åºè¶Šå¤š, æ€§èƒ½è¶Šå·®, æ‰€ä»¥æœ‰äº†äº‹ä»¶å¤„ç†ç¨‹åº. äº‹ä»¶ä»£ç†çš„åŸç†æ˜¯åŸºäºäº‹ä»¶çš„å†’æ³¡æœºåˆ¶å®ç°çš„, ç”±ä¸Šçº§èŠ‚ç‚¹ä»£ç†å®Œæˆäº‹ä»¶ç»‘å®š, ä¼˜ç‚¹æ˜¯: </p>\n<blockquote>\n<p>èŠ‚çœå†…å­˜å ç”¨, å‡å°‘äº‹ä»¶æ³¨å†Œ. æ¯”å¦‚åœ¨<code>ul</code>ä»£ç†æ‰€æœ‰<code>li</code>çš„ç‚¹å‡»äº‹ä»¶<br>åŠ¨æ€æ–°å¢å­çº§æ—¶, æ— éœ€å†æ¬¡ç»‘å®šäº‹ä»¶.</p>\n</blockquote>\n<p>å¯èƒ½ä¼šæåˆ°<code>currentTarget</code>å’Œ<code>target</code>çš„åŒºåˆ«: currentTarget æ˜¯æ³¨å†Œäº‹ä»¶æ—¶çš„ç›®æ ‡(åœ¨äº‹ä»¶å¤„ç†ç¨‹åºä¸­<code>this</code>å§‹ç»ˆæŒ‡å‘ currentTarget), target æ˜¯çœŸæ­£è§¦å‘äº‹ä»¶çš„ç›®æ ‡.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">document</span>.body.onclick = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">event</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">// äº‹ä»¶æ³¨å†Œæ—¶çš„å…ƒç´ </span></span><br><span class=\"line\">\t<span class=\"built_in\">console</span>.log(<span class=\"built_in\">document</span>.body === event.currentTarget); <span class=\"comment\">// true</span></span><br><span class=\"line\">\t<span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span> === <span class=\"built_in\">document</span>.body); <span class=\"comment\">// true</span></span><br><span class=\"line\">\t<span class=\"comment\">// çœŸæ­£ç‚¹å‡»çš„å…ƒç´ </span></span><br><span class=\"line\">\t<span class=\"built_in\">console</span>.log(event.target === <span class=\"built_in\">document</span>.querySelector(<span class=\"string\">'#btn'</span>)); <span class=\"comment\">// true</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"äº‹ä»¶å¯¹è±¡\"><a href=\"#äº‹ä»¶å¯¹è±¡\" class=\"headerlink\" title=\"äº‹ä»¶å¯¹è±¡\"></a>äº‹ä»¶å¯¹è±¡</h4><p>äº‹ä»¶å†…ç½®çš„ event å¯¹è±¡, ä¸‹é¢åˆ—ä¸¾å¸¸ç”¨çš„å‡ ä¸ªäº‹ä»¶å¯¹è±¡å±æ€§:</p>\n<ul>\n<li>event || window.event</li>\n<li>event.preventDefault() || window.event.cancelBubble(Boolean)<br>é˜»æ­¢æµè§ˆå™¨é»˜è®¤äº‹ä»¶</li>\n<li>event.stopPropagation() || window.event.returnValue(Boolean)<br>é˜»æ­¢å†’æ³¡äº‹ä»¶</li>\n<li>event.target || winow.event.srcElement</li>\n</ul>\n<p>Created on 2017-12-10 by Cara</p>\n","site":{"data":{}},"excerpt":"","more":"<p>JavaScript å’Œ HTML äº¤äº’æ˜¯é€šè¿‡äº‹ä»¶å®ç°, è€Œäº‹ä»¶å¤„ç†ç¨‹åºè®¢é˜…äº‹ä»¶ä»è€Œæ‰§è¡Œç›¸åº”çš„æ“ä½œ.</p>\n<h4 id=\"äº‹ä»¶æµ\"><a href=\"#äº‹ä»¶æµ\" class=\"headerlink\" title=\"äº‹ä»¶æµ\"></a>äº‹ä»¶æµ</h4><p>äº‹ä»¶æµæè¿°çš„æ˜¯ ä»é¡µé¢æ¥æ”¶äº‹ä»¶çš„é¡ºåº.<br>äº‹ä»¶å†’æ³¡: ä»æœ€å…·ä½“çš„å…ƒç´ åˆ°æœ€ä¸å…·ä½“çš„å…ƒç´ (ä»å†…åˆ°å¤–); â€” IE<br>äº‹ä»¶æ•è·: ä»æœ€ä¸å…·ä½“çš„å…ƒç´ åˆ°æœ€å…·ä½“çš„å…ƒç´ (ä»å¤–åˆ°å†…); â€” Netscape<br>DOM äº‹ä»¶æµ: å…ˆæ•è·åå†’æ³¡çš„æ–¹å¼.</p>\n<p>DOMäº‹ä»¶æµåŒ…æ‹¬ä¸‰ä¸ªé˜¶æ®µ:</p>\n<ol>\n<li>æ•è·é˜¶æ®µ (IE ä½ç‰ˆæœ¬ä¸æ”¯æŒè¯¥é˜¶æ®µ)</li>\n<li>ç›®æ ‡é˜¶æ®µ (è§¦å‘äº‹ä»¶)</li>\n<li>å†’æ³¡é˜¶æ®µ (å›ä¼ æ–‡æ¡£)</li>\n</ol>\n<h4 id=\"äº‹ä»¶å¤„ç†ç¨‹åº\"><a href=\"#äº‹ä»¶å¤„ç†ç¨‹åº\" class=\"headerlink\" title=\"äº‹ä»¶å¤„ç†ç¨‹åº\"></a>äº‹ä»¶å¤„ç†ç¨‹åº</h4><p>äº‹ä»¶æ˜¯ç”¨æˆ·æˆ–æµè§ˆå™¨è‡ªèº«æ‰§è¡Œçš„åŠ¨ä½œ, äº‹ä»¶å¤„ç†ç¨‹åº(äº‹ä»¶ç›‘å¬å™¨)æ˜¯å“åº”äº‹ä»¶çš„åŠ¨ä½œ. æ¯”å¦‚ click äº‹ä»¶çš„äº‹ä»¶å¤„ç†ç¨‹åºå°±æ˜¯ onclick, ä¸ºäº‹ä»¶æŒ‡å®šå¤„ç†ç¨‹åºçš„æ–¹å¼ä¹Ÿæœ‰å‡ ç§.</p>\n<h5 id=\"HTML-äº‹ä»¶å¤„ç†ç¨‹åº\"><a href=\"#HTML-äº‹ä»¶å¤„ç†ç¨‹åº\" class=\"headerlink\" title=\"HTML äº‹ä»¶å¤„ç†ç¨‹åº\"></a>HTML äº‹ä»¶å¤„ç†ç¨‹åº</h5><p>åœ¨æ ‡ç­¾ä¸Šç»‘å®šäº‹ä»¶å¤„ç†ç¨‹åº, HTML å’Œ js ç´§å¯†è€¦åˆ<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">button</span> <span class=\"attr\">onclick</span>=<span class=\"string\">'alert('</span><span class=\"attr\">clicked</span>')'&gt;</span>click me<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br></pre></td></tr></table></figure></p>\n<h5 id=\"DOM-0çº§äº‹ä»¶å¤„ç†ç¨‹åº\"><a href=\"#DOM-0çº§äº‹ä»¶å¤„ç†ç¨‹åº\" class=\"headerlink\" title=\"DOM 0çº§äº‹ä»¶å¤„ç†ç¨‹åº\"></a>DOM 0çº§äº‹ä»¶å¤„ç†ç¨‹åº</h5><p>å°†ä¸€ä¸ªå‡½æ•°èµ‹å€¼ç»™ä¸€ä¸ªäº‹ä»¶å¤„ç†ç¨‹åºå±æ€§<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> btn = <span class=\"built_in\">document</span>.querySelector(<span class=\"string\">'#btn'</span>);</span><br><span class=\"line\">btn.onclick = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\talert(<span class=\"string\">'clicked'</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"DOM-2çº§äº‹ä»¶å¤„ç†ç¨‹åº\"><a href=\"#DOM-2çº§äº‹ä»¶å¤„ç†ç¨‹åº\" class=\"headerlink\" title=\"DOM 2çº§äº‹ä»¶å¤„ç†ç¨‹åº\"></a>DOM 2çº§äº‹ä»¶å¤„ç†ç¨‹åº</h5><p>å®šä¹‰äº†ä¸¤ä¸ªæ–¹æ³•, ç”¨äºç»‘å®šäº‹ä»¶å¤„ç†ç¨‹åºå’Œåˆ é™¤äº‹ä»¶å¤„ç†ç¨‹åº: <code>addEventListener()</code>å’Œ<code>removeEventListener()</code>. æ‰€æœ‰çš„ DOM èŠ‚ç‚¹éƒ½åŒ…å«è¿™ä¸¤ä¸ªæ–¹æ³•, æ–¹æ³•æœ‰ä¸‰ä¸ªå‚æ•°: éœ€è¦å¤„ç†çš„äº‹ä»¶å/ å¤„ç†å‡½æ•°/ å¸ƒå°”å€¼(true ä¸ºåœ¨æ•è·é˜¶æ®µè°ƒç”¨; false ä¸ºåœ¨å†’æ³¡é˜¶æ®µè°ƒç”¨)<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> btn = <span class=\"built_in\">document</span>.querySelector(<span class=\"string\">'#btn'</span>);</span><br><span class=\"line\"><span class=\"comment\">// ç»‘å®šå¤„ç†ç¨‹åº</span></span><br><span class=\"line\">btn.addEventListener(<span class=\"string\">'click'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\talert(<span class=\"string\">'clicked'</span>)</span><br><span class=\"line\">&#125;, <span class=\"literal\">false</span>);</span><br><span class=\"line\"><span class=\"comment\">// ç§»é™¤å¤„ç†ç¨‹åº(ç§»é™¤å¤„ç†ç¨‹åºæ—¶, ç¬¬äºŒä¸ªå‚æ•°å¿…é¡»å’Œç»‘å®šæ—¶ä¸€æ ·)</span></span><br><span class=\"line\">btn.removeEventListener(<span class=\"string\">'click'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\talert(<span class=\"string\">'remove'</span>)</span><br><span class=\"line\">&#125;, <span class=\"literal\">false</span>)</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"IE-å’Œ-DOM2çº§äº‹ä»¶å¤„ç†ç¨‹åºçš„åŒºåˆ«\"><a href=\"#IE-å’Œ-DOM2çº§äº‹ä»¶å¤„ç†ç¨‹åºçš„åŒºåˆ«\" class=\"headerlink\" title=\"IE å’Œ  DOM2çº§äº‹ä»¶å¤„ç†ç¨‹åºçš„åŒºåˆ«\"></a>IE å’Œ  DOM2çº§äº‹ä»¶å¤„ç†ç¨‹åºçš„åŒºåˆ«</h4><ul>\n<li>IE äº‹ä»¶å¤„ç†ç¨‹åº<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> btn = docuemnt.querySelector(<span class=\"string\">'#btn'</span>);</span><br><span class=\"line\"><span class=\"comment\">// ç»‘å®šäº‹ä»¶</span></span><br><span class=\"line\">btn.attachEvent(<span class=\"string\">'onclick'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">// this === window</span></span><br><span class=\"line\">\talert(<span class=\"string\">'click on IE'</span>)</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"comment\">// ç§»é™¤äº‹ä»¶</span></span><br><span class=\"line\">btn.detachEvent(<span class=\"string\">'onclick'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\talert(<span class=\"string\">'remove on IE'</span>)</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p><strong>ä»¥ä¸Šä¸¤ç§äº‹ä»¶å¤„ç†ç¨‹åºéƒ½æ”¯æŒç»‘å®šå¤šä¸ªäº‹ä»¶, DOM2çº§æŒ‰ç…§é¡ºåº</strong></p>\n<ul>\n<li>è·¨æµè§ˆå™¨äº‹ä»¶å¤„ç†<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> EventUtil = &#123;</span><br><span class=\"line\">\t<span class=\"comment\">// ç»‘å®šäº‹ä»¶å¤„ç†ç¨‹åº</span></span><br><span class=\"line\">\taddHanlder: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">element, type, handler</span>) </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (element.addEventListener) &#123;</span><br><span class=\"line\">\t\t\telement.addEventListener(type, handler, <span class=\"literal\">false</span>)</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (element.attachEvent) &#123;</span><br><span class=\"line\">\t\t\telement.attachEvent(<span class=\"string\">'on'</span> + type, handler)</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\telement[<span class=\"string\">'on'</span> + type] = handler;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\">\t<span class=\"comment\">// ç§»é™¤äº‹ä»¶å¤„ç†ç¨‹åº</span></span><br><span class=\"line\">\tremoveHandler: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">element, type, handler</span>) </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (element.removeEventListener) &#123;</span><br><span class=\"line\">\t\t\telement.removeEventListener(type, handler, <span class=\"literal\">false</span>)</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (element.detachEvent) &#123;</span><br><span class=\"line\">\t\t\telement.detachEvent(<span class=\"string\">'on'</span> + type, handler)</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\telement[<span class=\"string\">'on'</span> + type] = <span class=\"literal\">null</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h4 id=\"äº‹ä»¶ä»£ç†-å§”æ‰˜\"><a href=\"#äº‹ä»¶ä»£ç†-å§”æ‰˜\" class=\"headerlink\" title=\"äº‹ä»¶ä»£ç†/ å§”æ‰˜\"></a>äº‹ä»¶ä»£ç†/ å§”æ‰˜</h4><p>ç”±äºäº‹ä»¶å¤„ç†ç¨‹åºè¶Šå¤š, æ€§èƒ½è¶Šå·®, æ‰€ä»¥æœ‰äº†äº‹ä»¶å¤„ç†ç¨‹åº. äº‹ä»¶ä»£ç†çš„åŸç†æ˜¯åŸºäºäº‹ä»¶çš„å†’æ³¡æœºåˆ¶å®ç°çš„, ç”±ä¸Šçº§èŠ‚ç‚¹ä»£ç†å®Œæˆäº‹ä»¶ç»‘å®š, ä¼˜ç‚¹æ˜¯: </p>\n<blockquote>\n<p>èŠ‚çœå†…å­˜å ç”¨, å‡å°‘äº‹ä»¶æ³¨å†Œ. æ¯”å¦‚åœ¨<code>ul</code>ä»£ç†æ‰€æœ‰<code>li</code>çš„ç‚¹å‡»äº‹ä»¶<br>åŠ¨æ€æ–°å¢å­çº§æ—¶, æ— éœ€å†æ¬¡ç»‘å®šäº‹ä»¶.</p>\n</blockquote>\n<p>å¯èƒ½ä¼šæåˆ°<code>currentTarget</code>å’Œ<code>target</code>çš„åŒºåˆ«: currentTarget æ˜¯æ³¨å†Œäº‹ä»¶æ—¶çš„ç›®æ ‡(åœ¨äº‹ä»¶å¤„ç†ç¨‹åºä¸­<code>this</code>å§‹ç»ˆæŒ‡å‘ currentTarget), target æ˜¯çœŸæ­£è§¦å‘äº‹ä»¶çš„ç›®æ ‡.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">document</span>.body.onclick = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">event</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">// äº‹ä»¶æ³¨å†Œæ—¶çš„å…ƒç´ </span></span><br><span class=\"line\">\t<span class=\"built_in\">console</span>.log(<span class=\"built_in\">document</span>.body === event.currentTarget); <span class=\"comment\">// true</span></span><br><span class=\"line\">\t<span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span> === <span class=\"built_in\">document</span>.body); <span class=\"comment\">// true</span></span><br><span class=\"line\">\t<span class=\"comment\">// çœŸæ­£ç‚¹å‡»çš„å…ƒç´ </span></span><br><span class=\"line\">\t<span class=\"built_in\">console</span>.log(event.target === <span class=\"built_in\">document</span>.querySelector(<span class=\"string\">'#btn'</span>)); <span class=\"comment\">// true</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"äº‹ä»¶å¯¹è±¡\"><a href=\"#äº‹ä»¶å¯¹è±¡\" class=\"headerlink\" title=\"äº‹ä»¶å¯¹è±¡\"></a>äº‹ä»¶å¯¹è±¡</h4><p>äº‹ä»¶å†…ç½®çš„ event å¯¹è±¡, ä¸‹é¢åˆ—ä¸¾å¸¸ç”¨çš„å‡ ä¸ªäº‹ä»¶å¯¹è±¡å±æ€§:</p>\n<ul>\n<li>event || window.event</li>\n<li>event.preventDefault() || window.event.cancelBubble(Boolean)<br>é˜»æ­¢æµè§ˆå™¨é»˜è®¤äº‹ä»¶</li>\n<li>event.stopPropagation() || window.event.returnValue(Boolean)<br>é˜»æ­¢å†’æ³¡äº‹ä»¶</li>\n<li>event.target || winow.event.srcElement</li>\n</ul>\n<p>Created on 2017-12-10 by Cara</p>\n"},{"title":"ä½è¿ç®—ç¬¦","date":"2017-10-18T15:06:59.000Z","_content":"åœ¨Cæˆ–è€…å…¶ä»–è¯­è¨€æ•°å€¼çš„è¿ç®—å…¶å®éƒ½æ˜¯å…ˆå°†æ•°å€¼è½¬æ¢ä¸ºäºŒè¿›åˆ¶åœ¨åšè¿ç®—çš„,\nè€Œä½è¿ç®—ç¬¦å°±æ˜¯ç›´æ¥è¿›è¡ŒäºŒè¿›åˆ¶è¿ç®—, å› æ­¤é€Ÿåº¦ä¼šéå¸¸å¿«. ä½†æ˜¯å¯¹äºJavaScript\næ¥è¯´, æ‰§è¡Œç¯å¢ƒä¸€èˆ¬æ¥è§¦ä¸åˆ°ç¡¬ä»¶, æ‰€ä»¥æ€§èƒ½å®Œå…¨ä¸èƒ½å’Œå…¶ä»–è¯­è¨€ç›¸æ¯”. ä¸è¿‡ä½œä¸º\näº†è§£è¿˜æ˜¯éœ€è¦çš„, åªå¯¹è¾ƒä¸ºå¸¸è§çš„ä½è¿ç®—ç¬¦ä½œè®°å½•.\n\n### ä½è¿ç®— NOT\nä½è¿ç®— NOT ç”± ( ~ ) ç¬¦å·è¡¨ç¤º, å…¶å®å°±æ˜¯å¯¹æ•°å€¼æ±‚è´Ÿä¹‹åå†å‡ä¸€, å¦‚:\n\n```javascript\nlet num = 10;\nlet num2 = ~num;\n\n// ~num æ•ˆæœåŒä¸‹\nnum2 = -num - 1;\n\nconsole.log(num2); // -11\n```\n\n### å·¦ä½ç§»è¿ç®—\nå·¦ä½ç§»è¿ç®—ç”± ( << ) ç¬¦å·è¡¨ç¤º. å°†æ•°å€¼çš„æ‰€æœ‰ä½å‘å·¦ç§»åŠ¨æŒ‡å®šæ•°é‡.ä¾‹å¦‚: \nå·¦ç§»ä¸€ä½ä¹˜2, å·¦ç§»2ä½ä¹˜4, ä»¥æ­¤ç±»æ¨.\n\n```javascript\nlet num = 2;\nlet num2 = num << 2;\n\n// æ•ˆæœåŒä¸‹\n num2 = num * 4;\n\nconsole.log(num2); // 8\n```\n\n### æœ‰ç¬¦å·å³ç§»è¿ç®—\næœ‰ç¬¦å·å³ç§»è¿ç®—ç¬¦ç”± ( >> ) ç¬¦å·è¡¨ç¤º, å°†æ•°å€¼çš„æ‰€æœ‰ä¸ºå‘å³ç§»åŠ¨æŒ‡å®šä½æ•°, \nåŒæ—¶ä¿ç•™è¯¥æ•°çš„ç¬¦å· (æ­£å·æˆ–è€…è´Ÿå·) . æœ‰ç¬¦å·å³ç§»è¿ç®—ç¬¦è·Ÿå·¦ä½ç§»è¿ç®—ç¬¦æ­£å¥½\nç›¸å.\n\n```javascript\nlet num = 12;\nlet num2 = num >> 2;\n\n// æ•ˆæœåŒä¸‹\nnum2 = num / 4;\n\nconsole.log(num2) // 3\n```\n\n### æ— ç¬¦å·å³ä½ç§»è¿ç®—ç¬¦\næ— ç¬¦å·è¿ç®—ç¬¦ç”± ( >>> ) ç¬¦å·è¡¨ç¤º, å¯¹äºæ­£æ•°æ— ç¬¦å·å³ä½ç§»è¿ç®—ç¬¦è·Ÿæ— ç¬¦å·å³ä½ç§»\nè¿ç®—ç¬¦è§„åˆ™ç›¸åŒ; è´Ÿæ•°æ—¶ä¼šå‡ºç°æ— é™å¤§çš„æ•°å€¼, æ‰€ä»¥å†³å®šä½¿ç”¨æ— ç¬¦å·å³ä½ç§»è¿ç®—ç¬¦\næ—¶ä¸€å®šè¦å°å¿ƒ.\n","source":"_posts/ä½è¿ç®—ç¬¦.md","raw":"---\ntitle: ä½è¿ç®—ç¬¦\ndate: 2017-10-18 23:06:59\ntags:\n- JavaScript\ncategories:\n- ç¬”è®°ğŸ“’\n---\nåœ¨Cæˆ–è€…å…¶ä»–è¯­è¨€æ•°å€¼çš„è¿ç®—å…¶å®éƒ½æ˜¯å…ˆå°†æ•°å€¼è½¬æ¢ä¸ºäºŒè¿›åˆ¶åœ¨åšè¿ç®—çš„,\nè€Œä½è¿ç®—ç¬¦å°±æ˜¯ç›´æ¥è¿›è¡ŒäºŒè¿›åˆ¶è¿ç®—, å› æ­¤é€Ÿåº¦ä¼šéå¸¸å¿«. ä½†æ˜¯å¯¹äºJavaScript\næ¥è¯´, æ‰§è¡Œç¯å¢ƒä¸€èˆ¬æ¥è§¦ä¸åˆ°ç¡¬ä»¶, æ‰€ä»¥æ€§èƒ½å®Œå…¨ä¸èƒ½å’Œå…¶ä»–è¯­è¨€ç›¸æ¯”. ä¸è¿‡ä½œä¸º\näº†è§£è¿˜æ˜¯éœ€è¦çš„, åªå¯¹è¾ƒä¸ºå¸¸è§çš„ä½è¿ç®—ç¬¦ä½œè®°å½•.\n\n### ä½è¿ç®— NOT\nä½è¿ç®— NOT ç”± ( ~ ) ç¬¦å·è¡¨ç¤º, å…¶å®å°±æ˜¯å¯¹æ•°å€¼æ±‚è´Ÿä¹‹åå†å‡ä¸€, å¦‚:\n\n```javascript\nlet num = 10;\nlet num2 = ~num;\n\n// ~num æ•ˆæœåŒä¸‹\nnum2 = -num - 1;\n\nconsole.log(num2); // -11\n```\n\n### å·¦ä½ç§»è¿ç®—\nå·¦ä½ç§»è¿ç®—ç”± ( << ) ç¬¦å·è¡¨ç¤º. å°†æ•°å€¼çš„æ‰€æœ‰ä½å‘å·¦ç§»åŠ¨æŒ‡å®šæ•°é‡.ä¾‹å¦‚: \nå·¦ç§»ä¸€ä½ä¹˜2, å·¦ç§»2ä½ä¹˜4, ä»¥æ­¤ç±»æ¨.\n\n```javascript\nlet num = 2;\nlet num2 = num << 2;\n\n// æ•ˆæœåŒä¸‹\n num2 = num * 4;\n\nconsole.log(num2); // 8\n```\n\n### æœ‰ç¬¦å·å³ç§»è¿ç®—\næœ‰ç¬¦å·å³ç§»è¿ç®—ç¬¦ç”± ( >> ) ç¬¦å·è¡¨ç¤º, å°†æ•°å€¼çš„æ‰€æœ‰ä¸ºå‘å³ç§»åŠ¨æŒ‡å®šä½æ•°, \nåŒæ—¶ä¿ç•™è¯¥æ•°çš„ç¬¦å· (æ­£å·æˆ–è€…è´Ÿå·) . æœ‰ç¬¦å·å³ç§»è¿ç®—ç¬¦è·Ÿå·¦ä½ç§»è¿ç®—ç¬¦æ­£å¥½\nç›¸å.\n\n```javascript\nlet num = 12;\nlet num2 = num >> 2;\n\n// æ•ˆæœåŒä¸‹\nnum2 = num / 4;\n\nconsole.log(num2) // 3\n```\n\n### æ— ç¬¦å·å³ä½ç§»è¿ç®—ç¬¦\næ— ç¬¦å·è¿ç®—ç¬¦ç”± ( >>> ) ç¬¦å·è¡¨ç¤º, å¯¹äºæ­£æ•°æ— ç¬¦å·å³ä½ç§»è¿ç®—ç¬¦è·Ÿæ— ç¬¦å·å³ä½ç§»\nè¿ç®—ç¬¦è§„åˆ™ç›¸åŒ; è´Ÿæ•°æ—¶ä¼šå‡ºç°æ— é™å¤§çš„æ•°å€¼, æ‰€ä»¥å†³å®šä½¿ç”¨æ— ç¬¦å·å³ä½ç§»è¿ç®—ç¬¦\næ—¶ä¸€å®šè¦å°å¿ƒ.\n","slug":"ä½è¿ç®—ç¬¦","published":1,"updated":"2018-05-05T09:23:03.674Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjgurolsv001gklu0jygctjsd","content":"<p>åœ¨Cæˆ–è€…å…¶ä»–è¯­è¨€æ•°å€¼çš„è¿ç®—å…¶å®éƒ½æ˜¯å…ˆå°†æ•°å€¼è½¬æ¢ä¸ºäºŒè¿›åˆ¶åœ¨åšè¿ç®—çš„,<br>è€Œä½è¿ç®—ç¬¦å°±æ˜¯ç›´æ¥è¿›è¡ŒäºŒè¿›åˆ¶è¿ç®—, å› æ­¤é€Ÿåº¦ä¼šéå¸¸å¿«. ä½†æ˜¯å¯¹äºJavaScript<br>æ¥è¯´, æ‰§è¡Œç¯å¢ƒä¸€èˆ¬æ¥è§¦ä¸åˆ°ç¡¬ä»¶, æ‰€ä»¥æ€§èƒ½å®Œå…¨ä¸èƒ½å’Œå…¶ä»–è¯­è¨€ç›¸æ¯”. ä¸è¿‡ä½œä¸º<br>äº†è§£è¿˜æ˜¯éœ€è¦çš„, åªå¯¹è¾ƒä¸ºå¸¸è§çš„ä½è¿ç®—ç¬¦ä½œè®°å½•.</p>\n<h3 id=\"ä½è¿ç®—-NOT\"><a href=\"#ä½è¿ç®—-NOT\" class=\"headerlink\" title=\"ä½è¿ç®— NOT\"></a>ä½è¿ç®— NOT</h3><p>ä½è¿ç®— NOT ç”± ( ~ ) ç¬¦å·è¡¨ç¤º, å…¶å®å°±æ˜¯å¯¹æ•°å€¼æ±‚è´Ÿä¹‹åå†å‡ä¸€, å¦‚:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> num = <span class=\"number\">10</span>;</span><br><span class=\"line\"><span class=\"keyword\">let</span> num2 = ~num;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ~num æ•ˆæœåŒä¸‹</span></span><br><span class=\"line\">num2 = -num - <span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(num2); <span class=\"comment\">// -11</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"å·¦ä½ç§»è¿ç®—\"><a href=\"#å·¦ä½ç§»è¿ç®—\" class=\"headerlink\" title=\"å·¦ä½ç§»è¿ç®—\"></a>å·¦ä½ç§»è¿ç®—</h3><p>å·¦ä½ç§»è¿ç®—ç”± ( &lt;&lt; ) ç¬¦å·è¡¨ç¤º. å°†æ•°å€¼çš„æ‰€æœ‰ä½å‘å·¦ç§»åŠ¨æŒ‡å®šæ•°é‡.ä¾‹å¦‚:<br>å·¦ç§»ä¸€ä½ä¹˜2, å·¦ç§»2ä½ä¹˜4, ä»¥æ­¤ç±»æ¨.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> num = <span class=\"number\">2</span>;</span><br><span class=\"line\"><span class=\"keyword\">let</span> num2 = num &lt;&lt; <span class=\"number\">2</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æ•ˆæœåŒä¸‹</span></span><br><span class=\"line\"> num2 = num * <span class=\"number\">4</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(num2); <span class=\"comment\">// 8</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"æœ‰ç¬¦å·å³ç§»è¿ç®—\"><a href=\"#æœ‰ç¬¦å·å³ç§»è¿ç®—\" class=\"headerlink\" title=\"æœ‰ç¬¦å·å³ç§»è¿ç®—\"></a>æœ‰ç¬¦å·å³ç§»è¿ç®—</h3><p>æœ‰ç¬¦å·å³ç§»è¿ç®—ç¬¦ç”± ( &gt;&gt; ) ç¬¦å·è¡¨ç¤º, å°†æ•°å€¼çš„æ‰€æœ‰ä¸ºå‘å³ç§»åŠ¨æŒ‡å®šä½æ•°,<br>åŒæ—¶ä¿ç•™è¯¥æ•°çš„ç¬¦å· (æ­£å·æˆ–è€…è´Ÿå·) . æœ‰ç¬¦å·å³ç§»è¿ç®—ç¬¦è·Ÿå·¦ä½ç§»è¿ç®—ç¬¦æ­£å¥½<br>ç›¸å.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> num = <span class=\"number\">12</span>;</span><br><span class=\"line\"><span class=\"keyword\">let</span> num2 = num &gt;&gt; <span class=\"number\">2</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æ•ˆæœåŒä¸‹</span></span><br><span class=\"line\">num2 = num / <span class=\"number\">4</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(num2) <span class=\"comment\">// 3</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"æ— ç¬¦å·å³ä½ç§»è¿ç®—ç¬¦\"><a href=\"#æ— ç¬¦å·å³ä½ç§»è¿ç®—ç¬¦\" class=\"headerlink\" title=\"æ— ç¬¦å·å³ä½ç§»è¿ç®—ç¬¦\"></a>æ— ç¬¦å·å³ä½ç§»è¿ç®—ç¬¦</h3><p>æ— ç¬¦å·è¿ç®—ç¬¦ç”± ( &gt;&gt;&gt; ) ç¬¦å·è¡¨ç¤º, å¯¹äºæ­£æ•°æ— ç¬¦å·å³ä½ç§»è¿ç®—ç¬¦è·Ÿæ— ç¬¦å·å³ä½ç§»<br>è¿ç®—ç¬¦è§„åˆ™ç›¸åŒ; è´Ÿæ•°æ—¶ä¼šå‡ºç°æ— é™å¤§çš„æ•°å€¼, æ‰€ä»¥å†³å®šä½¿ç”¨æ— ç¬¦å·å³ä½ç§»è¿ç®—ç¬¦<br>æ—¶ä¸€å®šè¦å°å¿ƒ.</p>\n","site":{"data":{}},"excerpt":"","more":"<p>åœ¨Cæˆ–è€…å…¶ä»–è¯­è¨€æ•°å€¼çš„è¿ç®—å…¶å®éƒ½æ˜¯å…ˆå°†æ•°å€¼è½¬æ¢ä¸ºäºŒè¿›åˆ¶åœ¨åšè¿ç®—çš„,<br>è€Œä½è¿ç®—ç¬¦å°±æ˜¯ç›´æ¥è¿›è¡ŒäºŒè¿›åˆ¶è¿ç®—, å› æ­¤é€Ÿåº¦ä¼šéå¸¸å¿«. ä½†æ˜¯å¯¹äºJavaScript<br>æ¥è¯´, æ‰§è¡Œç¯å¢ƒä¸€èˆ¬æ¥è§¦ä¸åˆ°ç¡¬ä»¶, æ‰€ä»¥æ€§èƒ½å®Œå…¨ä¸èƒ½å’Œå…¶ä»–è¯­è¨€ç›¸æ¯”. ä¸è¿‡ä½œä¸º<br>äº†è§£è¿˜æ˜¯éœ€è¦çš„, åªå¯¹è¾ƒä¸ºå¸¸è§çš„ä½è¿ç®—ç¬¦ä½œè®°å½•.</p>\n<h3 id=\"ä½è¿ç®—-NOT\"><a href=\"#ä½è¿ç®—-NOT\" class=\"headerlink\" title=\"ä½è¿ç®— NOT\"></a>ä½è¿ç®— NOT</h3><p>ä½è¿ç®— NOT ç”± ( ~ ) ç¬¦å·è¡¨ç¤º, å…¶å®å°±æ˜¯å¯¹æ•°å€¼æ±‚è´Ÿä¹‹åå†å‡ä¸€, å¦‚:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> num = <span class=\"number\">10</span>;</span><br><span class=\"line\"><span class=\"keyword\">let</span> num2 = ~num;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ~num æ•ˆæœåŒä¸‹</span></span><br><span class=\"line\">num2 = -num - <span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(num2); <span class=\"comment\">// -11</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"å·¦ä½ç§»è¿ç®—\"><a href=\"#å·¦ä½ç§»è¿ç®—\" class=\"headerlink\" title=\"å·¦ä½ç§»è¿ç®—\"></a>å·¦ä½ç§»è¿ç®—</h3><p>å·¦ä½ç§»è¿ç®—ç”± ( &lt;&lt; ) ç¬¦å·è¡¨ç¤º. å°†æ•°å€¼çš„æ‰€æœ‰ä½å‘å·¦ç§»åŠ¨æŒ‡å®šæ•°é‡.ä¾‹å¦‚:<br>å·¦ç§»ä¸€ä½ä¹˜2, å·¦ç§»2ä½ä¹˜4, ä»¥æ­¤ç±»æ¨.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> num = <span class=\"number\">2</span>;</span><br><span class=\"line\"><span class=\"keyword\">let</span> num2 = num &lt;&lt; <span class=\"number\">2</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æ•ˆæœåŒä¸‹</span></span><br><span class=\"line\"> num2 = num * <span class=\"number\">4</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(num2); <span class=\"comment\">// 8</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"æœ‰ç¬¦å·å³ç§»è¿ç®—\"><a href=\"#æœ‰ç¬¦å·å³ç§»è¿ç®—\" class=\"headerlink\" title=\"æœ‰ç¬¦å·å³ç§»è¿ç®—\"></a>æœ‰ç¬¦å·å³ç§»è¿ç®—</h3><p>æœ‰ç¬¦å·å³ç§»è¿ç®—ç¬¦ç”± ( &gt;&gt; ) ç¬¦å·è¡¨ç¤º, å°†æ•°å€¼çš„æ‰€æœ‰ä¸ºå‘å³ç§»åŠ¨æŒ‡å®šä½æ•°,<br>åŒæ—¶ä¿ç•™è¯¥æ•°çš„ç¬¦å· (æ­£å·æˆ–è€…è´Ÿå·) . æœ‰ç¬¦å·å³ç§»è¿ç®—ç¬¦è·Ÿå·¦ä½ç§»è¿ç®—ç¬¦æ­£å¥½<br>ç›¸å.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> num = <span class=\"number\">12</span>;</span><br><span class=\"line\"><span class=\"keyword\">let</span> num2 = num &gt;&gt; <span class=\"number\">2</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æ•ˆæœåŒä¸‹</span></span><br><span class=\"line\">num2 = num / <span class=\"number\">4</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(num2) <span class=\"comment\">// 3</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"æ— ç¬¦å·å³ä½ç§»è¿ç®—ç¬¦\"><a href=\"#æ— ç¬¦å·å³ä½ç§»è¿ç®—ç¬¦\" class=\"headerlink\" title=\"æ— ç¬¦å·å³ä½ç§»è¿ç®—ç¬¦\"></a>æ— ç¬¦å·å³ä½ç§»è¿ç®—ç¬¦</h3><p>æ— ç¬¦å·è¿ç®—ç¬¦ç”± ( &gt;&gt;&gt; ) ç¬¦å·è¡¨ç¤º, å¯¹äºæ­£æ•°æ— ç¬¦å·å³ä½ç§»è¿ç®—ç¬¦è·Ÿæ— ç¬¦å·å³ä½ç§»<br>è¿ç®—ç¬¦è§„åˆ™ç›¸åŒ; è´Ÿæ•°æ—¶ä¼šå‡ºç°æ— é™å¤§çš„æ•°å€¼, æ‰€ä»¥å†³å®šä½¿ç”¨æ— ç¬¦å·å³ä½ç§»è¿ç®—ç¬¦<br>æ—¶ä¸€å®šè¦å°å¿ƒ.</p>\n"},{"title":"å…³äºç§»æ¤ HEXO","date":"2017-10-14T10:47:02.000Z","_content":"\nè¿«äºæ–°ä¹°äº†å°ç”µè„‘, æ‰€ä»¥è¦ç§»æ¤ä¸€ä¸‹å°å¼ä¸Šçš„åšå®¢. ç”±äºè€æ˜¯å¿˜è®° hexo çš„å®˜ç½‘æ‰€ä»¥åœ¨è¿™å„¿é™„ä¸€ä¸ª[hexo å®˜ç½‘](https://hexo.io/docs/)\n\n### å‡†å¤‡å·¥ä½œ\nå°†åŸç”µè„‘ä¸Šçš„åšå®¢æºæ–‡ä»¶ä¸Šä¼ è‡³ GitHub, åªè¦æºæ–‡ä»¶ç›¸åŒé‚£ä¹ˆåšå®¢ä¼šè®¤ä¸ºæ˜¯åŒä¸€ä¸ªé¡¹ç›®, åŒ…æ‹¬å¦‚ä¸‹æ–‡ä»¶:\n\n<img src='http://ordnc4i2b.bkt.clouddn.com/blog_source.jpg' alt='blog_source_files'>\n\nå…¶å®ä¸»è¦éœ€è¦çš„æ–‡ä»¶æ˜¯`_conifg.yml`/ `source`æ–‡ä»¶å¤¹å’Œ `themes`æ–‡ä»¶å¤¹, \næ¥ä¸‹æ¥æ–°å»ºä¸€ä¸ªä»“åº“, æŠŠè¿™äº›æ–‡ä»¶ä¸Šä¼ ä¸Šå».\n\n### ç§»æ¤\n\n1. åœ¨æ–°ç”µè„‘ä¸Šå…‹éš†åˆšåˆšåˆ›å»ºçš„è¿™ä¸ªé¡¹ç›®\n\n<img src='http://ordnc4i2b.bkt.clouddn.com/17_10_14_blog.png' alt='git_clone_files'> \n\n2. åˆå§‹åŒ–æ–°çš„åšå®¢\n    1. æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹\n    2. å‘½ä»¤è¡Œè¿›å…¥è¿™ä¸ªæ–‡ä»¶å¤¹ `cnpm install hexo-cli -g` å…¨å±€å®‰è£… hexo(é»˜è®¤å·²ç»è£…è¿‡ [æ·˜å®é•œåƒ](https://npm.taobao.org/))\n    3. ç„¶å`cnpm install` å®‰è£…ä¸€ä¸‹ä¾èµ–é¡¹\n    3. åˆå§‹åŒ–å®Œæˆä¹‹å, æŠŠæˆ‘ä»¬å…‹éš†ä¸‹æ¥çš„æ–‡ä»¶æ‹·è´åˆ°è¿™ä¸ªæ–‡ä»¶å¤¹, è¦†ç›–æ‰åˆå§‹åŒ–çš„æ–‡ä»¶.\n    4. å¦‚æœä¸æƒ³æ”¹ä¹‹å‰çš„ä¸»é¢˜ç›´æ¥`hexo s` å°±å¯ä»¥åœ¨æœ¬åœ°è·‘èµ·æ¥äº†.\n\n### æ›´æ¢ä¸»é¢˜\nå…¶å®æ›´æ¢ hexo ä¸»é¢˜å¾ˆç®€å•, é¦–å…ˆæˆ‘ä»¬å…ˆå»å®˜ç½‘é€‰æ‹©ä¸€ä¸ªè‡ªå·±å–œæ¬¢çš„ä¸»é¢˜. [ä¸»é¢˜å®˜ç½‘](https://hexo.io/themes/)\n\n1. ä¸»é¢˜\n\nè¿™é‡Œæˆ‘é€‰äº†ä¸ªå¾ˆç®€æ´çš„ä¸»é¢˜[Anatole](https://github.com/Ben02/hexo-theme-Anatole), è¿›å…¥è¿™ä¸ªä¸»é¢˜çš„ä»“åº“, ä¸€èˆ¬ä½œè€…éƒ½ä¼šå‘Šè¯‰æ€ä¹ˆæ ·å®‰è£…å’Œä¸€äº›å¿…è¦çš„æ’ä»¶.\n\n2. å®‰è£…ä¸»é¢˜\nè¿™é‡Œæˆ‘ç›´æ¥ä¸‹è½½ .zip å‹ç¼©åŒ…, è§£å‹åæŠŠæ–‡ä»¶åæ›´æ”¹ä¸º anatole, ç„¶åç§»åŠ¨åˆ°ä½ çš„åšå®¢è·¯å¾„ä¸‹çš„`/themes` æ–‡ä»¶å¤¹å†…, ç„¶åä¿®æ”¹åšå®¢æ ¹ç›®å½•ä¸‹`_config.yml`ä¸­çš„`theme:`å±æ€§æ”¹ä¸º anatole. (å¦‚æœä½ æ˜¯å…¶ä»–ä¸»é¢˜å°±æ”¹ä¸ºä½ æ‹·è´è¿›æ¥çš„ä¸»é¢˜æ–‡ä»¶å¤¹çš„åç§°å°±å¥½)\n\n3. å®‰è£…æ’ä»¶\n`npm install --save hexo-renderer-jade hexo-generator-archive`\n\n4. é¢„è§ˆåŠéƒ¨ç½²å‘½ä»¤\n\n```javascript\n// æ–°å»ºæ–‡ç« \nhexo new 'xxx'\n\n// æœ¬åœ°é¢„è§ˆ\nhexo s (hexo server)\n\n// ç”Ÿæˆé™æ€æ–‡ä»¶\nhexo g (hexo generate)\n\n// éƒ¨ç½²ç½‘ç«™ (éƒ¨ç½²ç½‘ç«™å‰éœ€è¦å…ˆç”Ÿæˆé™æ€æ–‡ä»¶)\nhexo d (hexo deploy)\n\n// æ¸…é™¤ç¼“å­˜\nhexo clean\n```\n\nå¦‚æœéƒ¨ç½²æ—¶æŠ¥é”™ Not Found git, æœ‰å¯èƒ½æ—¶ä¸¤ä¸ªåŸå› : \n1. åšå®¢æ ¹ç›®å½•ä¸‹ `_config.yml` ä¸­ `deploy.type` å¦‚æœæ˜¯ `github` é‚£å°±æ”¹ä¸º `git` (3.0ç‰ˆæœ¬æ›´æ–°çš„é—®é¢˜)\n2. æ²¡æœ‰å®‰è£…æ’ä»¶, æ‰§è¡Œå‘½ä»¤`npm install hexo-deployer-git --save`\n    \n\n\n\n\n","source":"_posts/å…³äºç§»æ¤-HEXO.md","raw":"---\ntitle: å…³äºç§»æ¤ HEXO\ndate: 2017-10-14 18:47:02\ntags: hexo\ncategories:\n- ç¬”è®°ğŸ“’\n---\n\nè¿«äºæ–°ä¹°äº†å°ç”µè„‘, æ‰€ä»¥è¦ç§»æ¤ä¸€ä¸‹å°å¼ä¸Šçš„åšå®¢. ç”±äºè€æ˜¯å¿˜è®° hexo çš„å®˜ç½‘æ‰€ä»¥åœ¨è¿™å„¿é™„ä¸€ä¸ª[hexo å®˜ç½‘](https://hexo.io/docs/)\n\n### å‡†å¤‡å·¥ä½œ\nå°†åŸç”µè„‘ä¸Šçš„åšå®¢æºæ–‡ä»¶ä¸Šä¼ è‡³ GitHub, åªè¦æºæ–‡ä»¶ç›¸åŒé‚£ä¹ˆåšå®¢ä¼šè®¤ä¸ºæ˜¯åŒä¸€ä¸ªé¡¹ç›®, åŒ…æ‹¬å¦‚ä¸‹æ–‡ä»¶:\n\n<img src='http://ordnc4i2b.bkt.clouddn.com/blog_source.jpg' alt='blog_source_files'>\n\nå…¶å®ä¸»è¦éœ€è¦çš„æ–‡ä»¶æ˜¯`_conifg.yml`/ `source`æ–‡ä»¶å¤¹å’Œ `themes`æ–‡ä»¶å¤¹, \næ¥ä¸‹æ¥æ–°å»ºä¸€ä¸ªä»“åº“, æŠŠè¿™äº›æ–‡ä»¶ä¸Šä¼ ä¸Šå».\n\n### ç§»æ¤\n\n1. åœ¨æ–°ç”µè„‘ä¸Šå…‹éš†åˆšåˆšåˆ›å»ºçš„è¿™ä¸ªé¡¹ç›®\n\n<img src='http://ordnc4i2b.bkt.clouddn.com/17_10_14_blog.png' alt='git_clone_files'> \n\n2. åˆå§‹åŒ–æ–°çš„åšå®¢\n    1. æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹\n    2. å‘½ä»¤è¡Œè¿›å…¥è¿™ä¸ªæ–‡ä»¶å¤¹ `cnpm install hexo-cli -g` å…¨å±€å®‰è£… hexo(é»˜è®¤å·²ç»è£…è¿‡ [æ·˜å®é•œåƒ](https://npm.taobao.org/))\n    3. ç„¶å`cnpm install` å®‰è£…ä¸€ä¸‹ä¾èµ–é¡¹\n    3. åˆå§‹åŒ–å®Œæˆä¹‹å, æŠŠæˆ‘ä»¬å…‹éš†ä¸‹æ¥çš„æ–‡ä»¶æ‹·è´åˆ°è¿™ä¸ªæ–‡ä»¶å¤¹, è¦†ç›–æ‰åˆå§‹åŒ–çš„æ–‡ä»¶.\n    4. å¦‚æœä¸æƒ³æ”¹ä¹‹å‰çš„ä¸»é¢˜ç›´æ¥`hexo s` å°±å¯ä»¥åœ¨æœ¬åœ°è·‘èµ·æ¥äº†.\n\n### æ›´æ¢ä¸»é¢˜\nå…¶å®æ›´æ¢ hexo ä¸»é¢˜å¾ˆç®€å•, é¦–å…ˆæˆ‘ä»¬å…ˆå»å®˜ç½‘é€‰æ‹©ä¸€ä¸ªè‡ªå·±å–œæ¬¢çš„ä¸»é¢˜. [ä¸»é¢˜å®˜ç½‘](https://hexo.io/themes/)\n\n1. ä¸»é¢˜\n\nè¿™é‡Œæˆ‘é€‰äº†ä¸ªå¾ˆç®€æ´çš„ä¸»é¢˜[Anatole](https://github.com/Ben02/hexo-theme-Anatole), è¿›å…¥è¿™ä¸ªä¸»é¢˜çš„ä»“åº“, ä¸€èˆ¬ä½œè€…éƒ½ä¼šå‘Šè¯‰æ€ä¹ˆæ ·å®‰è£…å’Œä¸€äº›å¿…è¦çš„æ’ä»¶.\n\n2. å®‰è£…ä¸»é¢˜\nè¿™é‡Œæˆ‘ç›´æ¥ä¸‹è½½ .zip å‹ç¼©åŒ…, è§£å‹åæŠŠæ–‡ä»¶åæ›´æ”¹ä¸º anatole, ç„¶åç§»åŠ¨åˆ°ä½ çš„åšå®¢è·¯å¾„ä¸‹çš„`/themes` æ–‡ä»¶å¤¹å†…, ç„¶åä¿®æ”¹åšå®¢æ ¹ç›®å½•ä¸‹`_config.yml`ä¸­çš„`theme:`å±æ€§æ”¹ä¸º anatole. (å¦‚æœä½ æ˜¯å…¶ä»–ä¸»é¢˜å°±æ”¹ä¸ºä½ æ‹·è´è¿›æ¥çš„ä¸»é¢˜æ–‡ä»¶å¤¹çš„åç§°å°±å¥½)\n\n3. å®‰è£…æ’ä»¶\n`npm install --save hexo-renderer-jade hexo-generator-archive`\n\n4. é¢„è§ˆåŠéƒ¨ç½²å‘½ä»¤\n\n```javascript\n// æ–°å»ºæ–‡ç« \nhexo new 'xxx'\n\n// æœ¬åœ°é¢„è§ˆ\nhexo s (hexo server)\n\n// ç”Ÿæˆé™æ€æ–‡ä»¶\nhexo g (hexo generate)\n\n// éƒ¨ç½²ç½‘ç«™ (éƒ¨ç½²ç½‘ç«™å‰éœ€è¦å…ˆç”Ÿæˆé™æ€æ–‡ä»¶)\nhexo d (hexo deploy)\n\n// æ¸…é™¤ç¼“å­˜\nhexo clean\n```\n\nå¦‚æœéƒ¨ç½²æ—¶æŠ¥é”™ Not Found git, æœ‰å¯èƒ½æ—¶ä¸¤ä¸ªåŸå› : \n1. åšå®¢æ ¹ç›®å½•ä¸‹ `_config.yml` ä¸­ `deploy.type` å¦‚æœæ˜¯ `github` é‚£å°±æ”¹ä¸º `git` (3.0ç‰ˆæœ¬æ›´æ–°çš„é—®é¢˜)\n2. æ²¡æœ‰å®‰è£…æ’ä»¶, æ‰§è¡Œå‘½ä»¤`npm install hexo-deployer-git --save`\n    \n\n\n\n\n","slug":"å…³äºç§»æ¤-HEXO","published":1,"updated":"2018-05-05T09:23:03.676Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjgurolsw001kklu0bqcj0dcd","content":"<p>è¿«äºæ–°ä¹°äº†å°ç”µè„‘, æ‰€ä»¥è¦ç§»æ¤ä¸€ä¸‹å°å¼ä¸Šçš„åšå®¢. ç”±äºè€æ˜¯å¿˜è®° hexo çš„å®˜ç½‘æ‰€ä»¥åœ¨è¿™å„¿é™„ä¸€ä¸ª<a href=\"https://hexo.io/docs/\" target=\"_blank\" rel=\"noopener\">hexo å®˜ç½‘</a></p>\n<h3 id=\"å‡†å¤‡å·¥ä½œ\"><a href=\"#å‡†å¤‡å·¥ä½œ\" class=\"headerlink\" title=\"å‡†å¤‡å·¥ä½œ\"></a>å‡†å¤‡å·¥ä½œ</h3><p>å°†åŸç”µè„‘ä¸Šçš„åšå®¢æºæ–‡ä»¶ä¸Šä¼ è‡³ GitHub, åªè¦æºæ–‡ä»¶ç›¸åŒé‚£ä¹ˆåšå®¢ä¼šè®¤ä¸ºæ˜¯åŒä¸€ä¸ªé¡¹ç›®, åŒ…æ‹¬å¦‚ä¸‹æ–‡ä»¶:</p>\n<p><img src=\"http://ordnc4i2b.bkt.clouddn.com/blog_source.jpg\" alt=\"blog_source_files\"></p>\n<p>å…¶å®ä¸»è¦éœ€è¦çš„æ–‡ä»¶æ˜¯<code>_conifg.yml</code>/ <code>source</code>æ–‡ä»¶å¤¹å’Œ <code>themes</code>æ–‡ä»¶å¤¹,<br>æ¥ä¸‹æ¥æ–°å»ºä¸€ä¸ªä»“åº“, æŠŠè¿™äº›æ–‡ä»¶ä¸Šä¼ ä¸Šå».</p>\n<h3 id=\"ç§»æ¤\"><a href=\"#ç§»æ¤\" class=\"headerlink\" title=\"ç§»æ¤\"></a>ç§»æ¤</h3><ol>\n<li>åœ¨æ–°ç”µè„‘ä¸Šå…‹éš†åˆšåˆšåˆ›å»ºçš„è¿™ä¸ªé¡¹ç›®</li>\n</ol>\n<p><img src=\"http://ordnc4i2b.bkt.clouddn.com/17_10_14_blog.png\" alt=\"git_clone_files\"> </p>\n<ol start=\"2\">\n<li>åˆå§‹åŒ–æ–°çš„åšå®¢<ol>\n<li>æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹</li>\n<li>å‘½ä»¤è¡Œè¿›å…¥è¿™ä¸ªæ–‡ä»¶å¤¹ <code>cnpm install hexo-cli -g</code> å…¨å±€å®‰è£… hexo(é»˜è®¤å·²ç»è£…è¿‡ <a href=\"https://npm.taobao.org/\" target=\"_blank\" rel=\"noopener\">æ·˜å®é•œåƒ</a>)</li>\n<li>ç„¶å<code>cnpm install</code> å®‰è£…ä¸€ä¸‹ä¾èµ–é¡¹</li>\n<li>åˆå§‹åŒ–å®Œæˆä¹‹å, æŠŠæˆ‘ä»¬å…‹éš†ä¸‹æ¥çš„æ–‡ä»¶æ‹·è´åˆ°è¿™ä¸ªæ–‡ä»¶å¤¹, è¦†ç›–æ‰åˆå§‹åŒ–çš„æ–‡ä»¶.</li>\n<li>å¦‚æœä¸æƒ³æ”¹ä¹‹å‰çš„ä¸»é¢˜ç›´æ¥<code>hexo s</code> å°±å¯ä»¥åœ¨æœ¬åœ°è·‘èµ·æ¥äº†.</li>\n</ol>\n</li>\n</ol>\n<h3 id=\"æ›´æ¢ä¸»é¢˜\"><a href=\"#æ›´æ¢ä¸»é¢˜\" class=\"headerlink\" title=\"æ›´æ¢ä¸»é¢˜\"></a>æ›´æ¢ä¸»é¢˜</h3><p>å…¶å®æ›´æ¢ hexo ä¸»é¢˜å¾ˆç®€å•, é¦–å…ˆæˆ‘ä»¬å…ˆå»å®˜ç½‘é€‰æ‹©ä¸€ä¸ªè‡ªå·±å–œæ¬¢çš„ä¸»é¢˜. <a href=\"https://hexo.io/themes/\" target=\"_blank\" rel=\"noopener\">ä¸»é¢˜å®˜ç½‘</a></p>\n<ol>\n<li>ä¸»é¢˜</li>\n</ol>\n<p>è¿™é‡Œæˆ‘é€‰äº†ä¸ªå¾ˆç®€æ´çš„ä¸»é¢˜<a href=\"https://github.com/Ben02/hexo-theme-Anatole\" target=\"_blank\" rel=\"noopener\">Anatole</a>, è¿›å…¥è¿™ä¸ªä¸»é¢˜çš„ä»“åº“, ä¸€èˆ¬ä½œè€…éƒ½ä¼šå‘Šè¯‰æ€ä¹ˆæ ·å®‰è£…å’Œä¸€äº›å¿…è¦çš„æ’ä»¶.</p>\n<ol start=\"2\">\n<li><p>å®‰è£…ä¸»é¢˜<br>è¿™é‡Œæˆ‘ç›´æ¥ä¸‹è½½ .zip å‹ç¼©åŒ…, è§£å‹åæŠŠæ–‡ä»¶åæ›´æ”¹ä¸º anatole, ç„¶åç§»åŠ¨åˆ°ä½ çš„åšå®¢è·¯å¾„ä¸‹çš„<code>/themes</code> æ–‡ä»¶å¤¹å†…, ç„¶åä¿®æ”¹åšå®¢æ ¹ç›®å½•ä¸‹<code>_config.yml</code>ä¸­çš„<code>theme:</code>å±æ€§æ”¹ä¸º anatole. (å¦‚æœä½ æ˜¯å…¶ä»–ä¸»é¢˜å°±æ”¹ä¸ºä½ æ‹·è´è¿›æ¥çš„ä¸»é¢˜æ–‡ä»¶å¤¹çš„åç§°å°±å¥½)</p>\n</li>\n<li><p>å®‰è£…æ’ä»¶<br><code>npm install --save hexo-renderer-jade hexo-generator-archive</code></p>\n</li>\n<li><p>é¢„è§ˆåŠéƒ¨ç½²å‘½ä»¤</p>\n</li>\n</ol>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// æ–°å»ºæ–‡ç« </span></span><br><span class=\"line\">hexo <span class=\"keyword\">new</span> <span class=\"string\">'xxx'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æœ¬åœ°é¢„è§ˆ</span></span><br><span class=\"line\">hexo s (hexo server)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ç”Ÿæˆé™æ€æ–‡ä»¶</span></span><br><span class=\"line\">hexo g (hexo generate)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// éƒ¨ç½²ç½‘ç«™ (éƒ¨ç½²ç½‘ç«™å‰éœ€è¦å…ˆç”Ÿæˆé™æ€æ–‡ä»¶)</span></span><br><span class=\"line\">hexo d (hexo deploy)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æ¸…é™¤ç¼“å­˜</span></span><br><span class=\"line\">hexo clean</span><br></pre></td></tr></table></figure>\n<p>å¦‚æœéƒ¨ç½²æ—¶æŠ¥é”™ Not Found git, æœ‰å¯èƒ½æ—¶ä¸¤ä¸ªåŸå› : </p>\n<ol>\n<li>åšå®¢æ ¹ç›®å½•ä¸‹ <code>_config.yml</code> ä¸­ <code>deploy.type</code> å¦‚æœæ˜¯ <code>github</code> é‚£å°±æ”¹ä¸º <code>git</code> (3.0ç‰ˆæœ¬æ›´æ–°çš„é—®é¢˜)</li>\n<li>æ²¡æœ‰å®‰è£…æ’ä»¶, æ‰§è¡Œå‘½ä»¤<code>npm install hexo-deployer-git --save</code></li>\n</ol>\n","site":{"data":{}},"excerpt":"","more":"<p>è¿«äºæ–°ä¹°äº†å°ç”µè„‘, æ‰€ä»¥è¦ç§»æ¤ä¸€ä¸‹å°å¼ä¸Šçš„åšå®¢. ç”±äºè€æ˜¯å¿˜è®° hexo çš„å®˜ç½‘æ‰€ä»¥åœ¨è¿™å„¿é™„ä¸€ä¸ª<a href=\"https://hexo.io/docs/\" target=\"_blank\" rel=\"noopener\">hexo å®˜ç½‘</a></p>\n<h3 id=\"å‡†å¤‡å·¥ä½œ\"><a href=\"#å‡†å¤‡å·¥ä½œ\" class=\"headerlink\" title=\"å‡†å¤‡å·¥ä½œ\"></a>å‡†å¤‡å·¥ä½œ</h3><p>å°†åŸç”µè„‘ä¸Šçš„åšå®¢æºæ–‡ä»¶ä¸Šä¼ è‡³ GitHub, åªè¦æºæ–‡ä»¶ç›¸åŒé‚£ä¹ˆåšå®¢ä¼šè®¤ä¸ºæ˜¯åŒä¸€ä¸ªé¡¹ç›®, åŒ…æ‹¬å¦‚ä¸‹æ–‡ä»¶:</p>\n<p><img src=\"http://ordnc4i2b.bkt.clouddn.com/blog_source.jpg\" alt=\"blog_source_files\"></p>\n<p>å…¶å®ä¸»è¦éœ€è¦çš„æ–‡ä»¶æ˜¯<code>_conifg.yml</code>/ <code>source</code>æ–‡ä»¶å¤¹å’Œ <code>themes</code>æ–‡ä»¶å¤¹,<br>æ¥ä¸‹æ¥æ–°å»ºä¸€ä¸ªä»“åº“, æŠŠè¿™äº›æ–‡ä»¶ä¸Šä¼ ä¸Šå».</p>\n<h3 id=\"ç§»æ¤\"><a href=\"#ç§»æ¤\" class=\"headerlink\" title=\"ç§»æ¤\"></a>ç§»æ¤</h3><ol>\n<li>åœ¨æ–°ç”µè„‘ä¸Šå…‹éš†åˆšåˆšåˆ›å»ºçš„è¿™ä¸ªé¡¹ç›®</li>\n</ol>\n<p><img src=\"http://ordnc4i2b.bkt.clouddn.com/17_10_14_blog.png\" alt=\"git_clone_files\"> </p>\n<ol start=\"2\">\n<li>åˆå§‹åŒ–æ–°çš„åšå®¢<ol>\n<li>æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹</li>\n<li>å‘½ä»¤è¡Œè¿›å…¥è¿™ä¸ªæ–‡ä»¶å¤¹ <code>cnpm install hexo-cli -g</code> å…¨å±€å®‰è£… hexo(é»˜è®¤å·²ç»è£…è¿‡ <a href=\"https://npm.taobao.org/\" target=\"_blank\" rel=\"noopener\">æ·˜å®é•œåƒ</a>)</li>\n<li>ç„¶å<code>cnpm install</code> å®‰è£…ä¸€ä¸‹ä¾èµ–é¡¹</li>\n<li>åˆå§‹åŒ–å®Œæˆä¹‹å, æŠŠæˆ‘ä»¬å…‹éš†ä¸‹æ¥çš„æ–‡ä»¶æ‹·è´åˆ°è¿™ä¸ªæ–‡ä»¶å¤¹, è¦†ç›–æ‰åˆå§‹åŒ–çš„æ–‡ä»¶.</li>\n<li>å¦‚æœä¸æƒ³æ”¹ä¹‹å‰çš„ä¸»é¢˜ç›´æ¥<code>hexo s</code> å°±å¯ä»¥åœ¨æœ¬åœ°è·‘èµ·æ¥äº†.</li>\n</ol>\n</li>\n</ol>\n<h3 id=\"æ›´æ¢ä¸»é¢˜\"><a href=\"#æ›´æ¢ä¸»é¢˜\" class=\"headerlink\" title=\"æ›´æ¢ä¸»é¢˜\"></a>æ›´æ¢ä¸»é¢˜</h3><p>å…¶å®æ›´æ¢ hexo ä¸»é¢˜å¾ˆç®€å•, é¦–å…ˆæˆ‘ä»¬å…ˆå»å®˜ç½‘é€‰æ‹©ä¸€ä¸ªè‡ªå·±å–œæ¬¢çš„ä¸»é¢˜. <a href=\"https://hexo.io/themes/\" target=\"_blank\" rel=\"noopener\">ä¸»é¢˜å®˜ç½‘</a></p>\n<ol>\n<li>ä¸»é¢˜</li>\n</ol>\n<p>è¿™é‡Œæˆ‘é€‰äº†ä¸ªå¾ˆç®€æ´çš„ä¸»é¢˜<a href=\"https://github.com/Ben02/hexo-theme-Anatole\" target=\"_blank\" rel=\"noopener\">Anatole</a>, è¿›å…¥è¿™ä¸ªä¸»é¢˜çš„ä»“åº“, ä¸€èˆ¬ä½œè€…éƒ½ä¼šå‘Šè¯‰æ€ä¹ˆæ ·å®‰è£…å’Œä¸€äº›å¿…è¦çš„æ’ä»¶.</p>\n<ol start=\"2\">\n<li><p>å®‰è£…ä¸»é¢˜<br>è¿™é‡Œæˆ‘ç›´æ¥ä¸‹è½½ .zip å‹ç¼©åŒ…, è§£å‹åæŠŠæ–‡ä»¶åæ›´æ”¹ä¸º anatole, ç„¶åç§»åŠ¨åˆ°ä½ çš„åšå®¢è·¯å¾„ä¸‹çš„<code>/themes</code> æ–‡ä»¶å¤¹å†…, ç„¶åä¿®æ”¹åšå®¢æ ¹ç›®å½•ä¸‹<code>_config.yml</code>ä¸­çš„<code>theme:</code>å±æ€§æ”¹ä¸º anatole. (å¦‚æœä½ æ˜¯å…¶ä»–ä¸»é¢˜å°±æ”¹ä¸ºä½ æ‹·è´è¿›æ¥çš„ä¸»é¢˜æ–‡ä»¶å¤¹çš„åç§°å°±å¥½)</p>\n</li>\n<li><p>å®‰è£…æ’ä»¶<br><code>npm install --save hexo-renderer-jade hexo-generator-archive</code></p>\n</li>\n<li><p>é¢„è§ˆåŠéƒ¨ç½²å‘½ä»¤</p>\n</li>\n</ol>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// æ–°å»ºæ–‡ç« </span></span><br><span class=\"line\">hexo <span class=\"keyword\">new</span> <span class=\"string\">'xxx'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æœ¬åœ°é¢„è§ˆ</span></span><br><span class=\"line\">hexo s (hexo server)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ç”Ÿæˆé™æ€æ–‡ä»¶</span></span><br><span class=\"line\">hexo g (hexo generate)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// éƒ¨ç½²ç½‘ç«™ (éƒ¨ç½²ç½‘ç«™å‰éœ€è¦å…ˆç”Ÿæˆé™æ€æ–‡ä»¶)</span></span><br><span class=\"line\">hexo d (hexo deploy)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æ¸…é™¤ç¼“å­˜</span></span><br><span class=\"line\">hexo clean</span><br></pre></td></tr></table></figure>\n<p>å¦‚æœéƒ¨ç½²æ—¶æŠ¥é”™ Not Found git, æœ‰å¯èƒ½æ—¶ä¸¤ä¸ªåŸå› : </p>\n<ol>\n<li>åšå®¢æ ¹ç›®å½•ä¸‹ <code>_config.yml</code> ä¸­ <code>deploy.type</code> å¦‚æœæ˜¯ <code>github</code> é‚£å°±æ”¹ä¸º <code>git</code> (3.0ç‰ˆæœ¬æ›´æ–°çš„é—®é¢˜)</li>\n<li>æ²¡æœ‰å®‰è£…æ’ä»¶, æ‰§è¡Œå‘½ä»¤<code>npm install hexo-deployer-git --save</code></li>\n</ol>\n"},{"title":"å£°æ˜æå‡","date":"2017-12-20T13:54:07.000Z","_content":"åœ¨è¯´å£°æ˜æå‡ä¹‹å‰, é¦–å…ˆåº”è¯¥äº†è§£ä¸‰ä¸ªæ¦‚å¿µæ€§çš„ä¸œè¥¿, æ‰§è¡Œä¸Šä¸‹æ–‡(Execution Context)/ å˜é‡å¯¹è±¡(Variable Object)å’Œæ´»åŠ¨å¯¹è±¡(Activation Object), è¿™ä¸‰ä¸ªæ¦‚å¿µæ˜¯åœ¨ ES3 ä¸­å‡ºç°çš„.\n\n- æ‰§è¡Œä¸Šä¸‹æ–‡(Execution Context)\næ‰§è¡Œä¸Šä¸‹æ–‡ä¹Ÿå¯ä»¥è¯´æ˜¯ js ä»£ç çš„è¿è¡Œç¯å¢ƒ, ä»£ç ä¸€æ—¦è¢«åŠ è½½ js çš„è§£é‡Šå™¨é¦–å…ˆè¿›å…¥çš„å°±æ˜¯è¿™ä¸ªç¯å¢ƒ. ä»–æœ‰å…¨å±€çš„æ‰§è¡Œä¸Šä¸‹æ–‡å’Œå‡½æ•°çš„æ‰§è¡Œä¸Šä¸‹æ–‡(eval ä¸è¯´, å®ƒå†…éƒ¨ä¹Ÿæœ‰), js çš„è§£é‡Šå™¨é»˜è®¤å…ˆè¿›å…¥çš„æ˜¯å…¨å±€ä¸Šä¸‹æ–‡æ‰€ä»¥æˆ‘ä»¬ä¸€å¼€å§‹å°±èƒ½ç›´æ¥ä½¿ç”¨ä¸€äº›çš„å†…ç½®æ–¹æ³•, æ¯”å¦‚: Array/ Numberâ€¦ æ¯å½“ä¸€ä¸ªå‡½æ•°è¢«è°ƒç”¨æ—¶, å°±ä¼šåˆ›å»ºä»–è‡ªå·±çš„æ‰§è¡Œä¸Šä¸‹æ–‡, æ¯ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡éƒ½æœ‰ä¸€ä¸ªä¸ä¹‹å…³è”çš„å˜é‡å¯¹è±¡.\n\n- ä½œç”¨åŸŸé“¾(ä¹Ÿç§°è°ƒç”¨æ ˆ)\nçŸ¥é“äº†æ¯å½“ä¸€ä¸ªå‡½æ•°è°ƒç”¨æ—¶ä¼šåˆ›å»ºè‡ªå·±çš„æ‰§è¡Œä¸Šä¸‹æ–‡, è¿™ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡å°±ä¼šè¢«æ·»åŠ åˆ°ä½œç”¨åŸŸé“¾çš„é¡¶ç«¯. è€Œè§£é‡Šå™¨æ€»æ˜¯å…ˆè¿è¡Œä½œç”¨åŸŸé“¾é¡¶ç«¯çš„æ‰§è¡Œä¸Šä¸‹æ–‡, ä¸€æ—¦å‡½æ•°è°ƒç”¨å®Œæ¯•, å®ƒçš„æ‰§è¡Œä¸Šä¸‹æ–‡å°±ä¼šä»ä½œç”¨åŸŸé“¾çš„é¡¶ç«¯ç§»é™¤å¹¶å°†æ§åˆ¶æƒäº¤ç”±ä¸Šä¸€ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡, ç›´åˆ°å›åˆ°å…¨å±€ä¸Šä¸‹æ–‡. å¦‚ä¸‹å›¾æ‰€ç¤º:\n![æ‰§è¡Œç¯å¢ƒ](/img/event-loop.gif)\n\n\n- å˜é‡å¯¹è±¡(Variable Object)\nå½“æ‰§è¡Œä¸Šä¸‹æ–‡åˆ›å»ºå, è¿›å…¥å»ºç«‹é˜¶æ®µ(å‡½æ•°è°ƒç”¨, å…·ä½“ä»£ç æ‰§è¡Œä¹‹å‰), åœ¨è¿™ä¸ªé˜¶æ®µå˜é‡å¯¹è±¡/ ä½œç”¨åŸŸé“¾/ `this`çš„æŒ‡å‘éƒ½ä¼šè¢«ç¡®å®š. å˜é‡å¯¹åƒä¼šæŒ‰é¡ºåºå¡«å……:\n1. å‡½æ•°å‚æ•°(æ²¡æœ‰å°±æ˜¯ undefined)\n2. å‡½æ•°å£°æ˜(å‘½åå†²çª, ä¼šè¦†ç›–ä¹‹å‰çš„)\n3. å˜é‡å£°æ˜(å€¼ä¸º undefined, å‘½åå†²çª, ä¼šè¢«å¿½ç•¥)\n\n- æ´»åŠ¨å¯¹è±¡(ä¹Ÿç§°æ¿€æ´»å¯¹è±¡)\nå‡½æ•°è°ƒç”¨æ´»åŠ¨å¯¹è±¡å°±ä½œä¸ºå˜é‡å¯¹è±¡, æ‰€ä»¥åœ¨å‡½æ•°è°ƒç”¨æ—¶`å˜é‡å¯¹è±¡ === æ´»åŠ¨å¯¹è±¡`, æ´»åŠ¨å¯¹è±¡ä¼šå…ˆåŒ…å«`arguments`å¯¹è±¡åŠæ–¹æ³•.\n\nè¿˜æ˜¯çœ‹ä¸ªä»£ç æ¥è¯´å§: \n```javascript\nfunction foo (i) {\n\tvar a = 'hello'\n\tvar b = function bar () {}\n\tfunction c () {}\n}\nfoo(11)\n// å»ºç«‹é˜¶æ®µ\nfooExecutionContext = {\n\tvariableObject: {\n\t\targuments: {\n\t\t\t0: 11,\n\t\t\tlength: 1\n\t\t},\n\t\ti: 11, // åªæœ‰å‚æ•°è¢«èµ‹å€¼\n\t\tc: pointer to function c()\n\t\ta: undefined,\n\t\tb: undefined,\n\t},\n\tscopeChain: {...},\n\tthis: {...}\n}\n// æ‰§è¡Œé˜¶æ®µ\nfooExecutionContext = {\n\tvariableObject: {\n\t\targuments: {\n\t\t\t0: 11,\n\t\t\tlength: 1\n\t\t},\n\t\ti: 11,\n\t\tc: pointer to function c(),\n\t\ta: 'hello', // å˜é‡åœ¨è¿™ä¸ªæ—¶å€™æ‰è¢«èµ‹å€¼\n\t\tb: pointer to function bar()\n\t},\n\tscopeChain: {...},\n\tthis: {...}\n}\n```\nä»¥ä¸Šä¸‰ä¸ªæ¦‚å¿µéƒ½æ— æ³•ç”¨è¿‡ä»£ç è®¿é—®, æ˜¯è§£é‡Šå™¨åœ¨åå°ä½¿ç”¨.","source":"_posts/å£°æ˜æå‡.md","raw":"---\ntitle: 'å£°æ˜æå‡'\ndate: 2017-12-20 21:54:07\ntags:\n- JavaScript\ncategories:\n- ç¬”è®°ğŸ“’\n---\nåœ¨è¯´å£°æ˜æå‡ä¹‹å‰, é¦–å…ˆåº”è¯¥äº†è§£ä¸‰ä¸ªæ¦‚å¿µæ€§çš„ä¸œè¥¿, æ‰§è¡Œä¸Šä¸‹æ–‡(Execution Context)/ å˜é‡å¯¹è±¡(Variable Object)å’Œæ´»åŠ¨å¯¹è±¡(Activation Object), è¿™ä¸‰ä¸ªæ¦‚å¿µæ˜¯åœ¨ ES3 ä¸­å‡ºç°çš„.\n\n- æ‰§è¡Œä¸Šä¸‹æ–‡(Execution Context)\næ‰§è¡Œä¸Šä¸‹æ–‡ä¹Ÿå¯ä»¥è¯´æ˜¯ js ä»£ç çš„è¿è¡Œç¯å¢ƒ, ä»£ç ä¸€æ—¦è¢«åŠ è½½ js çš„è§£é‡Šå™¨é¦–å…ˆè¿›å…¥çš„å°±æ˜¯è¿™ä¸ªç¯å¢ƒ. ä»–æœ‰å…¨å±€çš„æ‰§è¡Œä¸Šä¸‹æ–‡å’Œå‡½æ•°çš„æ‰§è¡Œä¸Šä¸‹æ–‡(eval ä¸è¯´, å®ƒå†…éƒ¨ä¹Ÿæœ‰), js çš„è§£é‡Šå™¨é»˜è®¤å…ˆè¿›å…¥çš„æ˜¯å…¨å±€ä¸Šä¸‹æ–‡æ‰€ä»¥æˆ‘ä»¬ä¸€å¼€å§‹å°±èƒ½ç›´æ¥ä½¿ç”¨ä¸€äº›çš„å†…ç½®æ–¹æ³•, æ¯”å¦‚: Array/ Numberâ€¦ æ¯å½“ä¸€ä¸ªå‡½æ•°è¢«è°ƒç”¨æ—¶, å°±ä¼šåˆ›å»ºä»–è‡ªå·±çš„æ‰§è¡Œä¸Šä¸‹æ–‡, æ¯ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡éƒ½æœ‰ä¸€ä¸ªä¸ä¹‹å…³è”çš„å˜é‡å¯¹è±¡.\n\n- ä½œç”¨åŸŸé“¾(ä¹Ÿç§°è°ƒç”¨æ ˆ)\nçŸ¥é“äº†æ¯å½“ä¸€ä¸ªå‡½æ•°è°ƒç”¨æ—¶ä¼šåˆ›å»ºè‡ªå·±çš„æ‰§è¡Œä¸Šä¸‹æ–‡, è¿™ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡å°±ä¼šè¢«æ·»åŠ åˆ°ä½œç”¨åŸŸé“¾çš„é¡¶ç«¯. è€Œè§£é‡Šå™¨æ€»æ˜¯å…ˆè¿è¡Œä½œç”¨åŸŸé“¾é¡¶ç«¯çš„æ‰§è¡Œä¸Šä¸‹æ–‡, ä¸€æ—¦å‡½æ•°è°ƒç”¨å®Œæ¯•, å®ƒçš„æ‰§è¡Œä¸Šä¸‹æ–‡å°±ä¼šä»ä½œç”¨åŸŸé“¾çš„é¡¶ç«¯ç§»é™¤å¹¶å°†æ§åˆ¶æƒäº¤ç”±ä¸Šä¸€ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡, ç›´åˆ°å›åˆ°å…¨å±€ä¸Šä¸‹æ–‡. å¦‚ä¸‹å›¾æ‰€ç¤º:\n![æ‰§è¡Œç¯å¢ƒ](/img/event-loop.gif)\n\n\n- å˜é‡å¯¹è±¡(Variable Object)\nå½“æ‰§è¡Œä¸Šä¸‹æ–‡åˆ›å»ºå, è¿›å…¥å»ºç«‹é˜¶æ®µ(å‡½æ•°è°ƒç”¨, å…·ä½“ä»£ç æ‰§è¡Œä¹‹å‰), åœ¨è¿™ä¸ªé˜¶æ®µå˜é‡å¯¹è±¡/ ä½œç”¨åŸŸé“¾/ `this`çš„æŒ‡å‘éƒ½ä¼šè¢«ç¡®å®š. å˜é‡å¯¹åƒä¼šæŒ‰é¡ºåºå¡«å……:\n1. å‡½æ•°å‚æ•°(æ²¡æœ‰å°±æ˜¯ undefined)\n2. å‡½æ•°å£°æ˜(å‘½åå†²çª, ä¼šè¦†ç›–ä¹‹å‰çš„)\n3. å˜é‡å£°æ˜(å€¼ä¸º undefined, å‘½åå†²çª, ä¼šè¢«å¿½ç•¥)\n\n- æ´»åŠ¨å¯¹è±¡(ä¹Ÿç§°æ¿€æ´»å¯¹è±¡)\nå‡½æ•°è°ƒç”¨æ´»åŠ¨å¯¹è±¡å°±ä½œä¸ºå˜é‡å¯¹è±¡, æ‰€ä»¥åœ¨å‡½æ•°è°ƒç”¨æ—¶`å˜é‡å¯¹è±¡ === æ´»åŠ¨å¯¹è±¡`, æ´»åŠ¨å¯¹è±¡ä¼šå…ˆåŒ…å«`arguments`å¯¹è±¡åŠæ–¹æ³•.\n\nè¿˜æ˜¯çœ‹ä¸ªä»£ç æ¥è¯´å§: \n```javascript\nfunction foo (i) {\n\tvar a = 'hello'\n\tvar b = function bar () {}\n\tfunction c () {}\n}\nfoo(11)\n// å»ºç«‹é˜¶æ®µ\nfooExecutionContext = {\n\tvariableObject: {\n\t\targuments: {\n\t\t\t0: 11,\n\t\t\tlength: 1\n\t\t},\n\t\ti: 11, // åªæœ‰å‚æ•°è¢«èµ‹å€¼\n\t\tc: pointer to function c()\n\t\ta: undefined,\n\t\tb: undefined,\n\t},\n\tscopeChain: {...},\n\tthis: {...}\n}\n// æ‰§è¡Œé˜¶æ®µ\nfooExecutionContext = {\n\tvariableObject: {\n\t\targuments: {\n\t\t\t0: 11,\n\t\t\tlength: 1\n\t\t},\n\t\ti: 11,\n\t\tc: pointer to function c(),\n\t\ta: 'hello', // å˜é‡åœ¨è¿™ä¸ªæ—¶å€™æ‰è¢«èµ‹å€¼\n\t\tb: pointer to function bar()\n\t},\n\tscopeChain: {...},\n\tthis: {...}\n}\n```\nä»¥ä¸Šä¸‰ä¸ªæ¦‚å¿µéƒ½æ— æ³•ç”¨è¿‡ä»£ç è®¿é—®, æ˜¯è§£é‡Šå™¨åœ¨åå°ä½¿ç”¨.","slug":"å£°æ˜æå‡","published":1,"updated":"2018-05-05T09:23:03.678Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjgurolsx001nklu0joal8sv0","content":"<p>åœ¨è¯´å£°æ˜æå‡ä¹‹å‰, é¦–å…ˆåº”è¯¥äº†è§£ä¸‰ä¸ªæ¦‚å¿µæ€§çš„ä¸œè¥¿, æ‰§è¡Œä¸Šä¸‹æ–‡(Execution Context)/ å˜é‡å¯¹è±¡(Variable Object)å’Œæ´»åŠ¨å¯¹è±¡(Activation Object), è¿™ä¸‰ä¸ªæ¦‚å¿µæ˜¯åœ¨ ES3 ä¸­å‡ºç°çš„.</p>\n<ul>\n<li><p>æ‰§è¡Œä¸Šä¸‹æ–‡(Execution Context)<br>æ‰§è¡Œä¸Šä¸‹æ–‡ä¹Ÿå¯ä»¥è¯´æ˜¯ js ä»£ç çš„è¿è¡Œç¯å¢ƒ, ä»£ç ä¸€æ—¦è¢«åŠ è½½ js çš„è§£é‡Šå™¨é¦–å…ˆè¿›å…¥çš„å°±æ˜¯è¿™ä¸ªç¯å¢ƒ. ä»–æœ‰å…¨å±€çš„æ‰§è¡Œä¸Šä¸‹æ–‡å’Œå‡½æ•°çš„æ‰§è¡Œä¸Šä¸‹æ–‡(eval ä¸è¯´, å®ƒå†…éƒ¨ä¹Ÿæœ‰), js çš„è§£é‡Šå™¨é»˜è®¤å…ˆè¿›å…¥çš„æ˜¯å…¨å±€ä¸Šä¸‹æ–‡æ‰€ä»¥æˆ‘ä»¬ä¸€å¼€å§‹å°±èƒ½ç›´æ¥ä½¿ç”¨ä¸€äº›çš„å†…ç½®æ–¹æ³•, æ¯”å¦‚: Array/ Numberâ€¦ æ¯å½“ä¸€ä¸ªå‡½æ•°è¢«è°ƒç”¨æ—¶, å°±ä¼šåˆ›å»ºä»–è‡ªå·±çš„æ‰§è¡Œä¸Šä¸‹æ–‡, æ¯ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡éƒ½æœ‰ä¸€ä¸ªä¸ä¹‹å…³è”çš„å˜é‡å¯¹è±¡.</p>\n</li>\n<li><p>ä½œç”¨åŸŸé“¾(ä¹Ÿç§°è°ƒç”¨æ ˆ)<br>çŸ¥é“äº†æ¯å½“ä¸€ä¸ªå‡½æ•°è°ƒç”¨æ—¶ä¼šåˆ›å»ºè‡ªå·±çš„æ‰§è¡Œä¸Šä¸‹æ–‡, è¿™ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡å°±ä¼šè¢«æ·»åŠ åˆ°ä½œç”¨åŸŸé“¾çš„é¡¶ç«¯. è€Œè§£é‡Šå™¨æ€»æ˜¯å…ˆè¿è¡Œä½œç”¨åŸŸé“¾é¡¶ç«¯çš„æ‰§è¡Œä¸Šä¸‹æ–‡, ä¸€æ—¦å‡½æ•°è°ƒç”¨å®Œæ¯•, å®ƒçš„æ‰§è¡Œä¸Šä¸‹æ–‡å°±ä¼šä»ä½œç”¨åŸŸé“¾çš„é¡¶ç«¯ç§»é™¤å¹¶å°†æ§åˆ¶æƒäº¤ç”±ä¸Šä¸€ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡, ç›´åˆ°å›åˆ°å…¨å±€ä¸Šä¸‹æ–‡. å¦‚ä¸‹å›¾æ‰€ç¤º:<br><img src=\"/img/event-loop.gif\" alt=\"æ‰§è¡Œç¯å¢ƒ\"></p>\n</li>\n</ul>\n<ul>\n<li>å˜é‡å¯¹è±¡(Variable Object)<br>å½“æ‰§è¡Œä¸Šä¸‹æ–‡åˆ›å»ºå, è¿›å…¥å»ºç«‹é˜¶æ®µ(å‡½æ•°è°ƒç”¨, å…·ä½“ä»£ç æ‰§è¡Œä¹‹å‰), åœ¨è¿™ä¸ªé˜¶æ®µå˜é‡å¯¹è±¡/ ä½œç”¨åŸŸé“¾/ <code>this</code>çš„æŒ‡å‘éƒ½ä¼šè¢«ç¡®å®š. å˜é‡å¯¹åƒä¼šæŒ‰é¡ºåºå¡«å……:</li>\n</ul>\n<ol>\n<li>å‡½æ•°å‚æ•°(æ²¡æœ‰å°±æ˜¯ undefined)</li>\n<li>å‡½æ•°å£°æ˜(å‘½åå†²çª, ä¼šè¦†ç›–ä¹‹å‰çš„)</li>\n<li>å˜é‡å£°æ˜(å€¼ä¸º undefined, å‘½åå†²çª, ä¼šè¢«å¿½ç•¥)</li>\n</ol>\n<ul>\n<li>æ´»åŠ¨å¯¹è±¡(ä¹Ÿç§°æ¿€æ´»å¯¹è±¡)<br>å‡½æ•°è°ƒç”¨æ´»åŠ¨å¯¹è±¡å°±ä½œä¸ºå˜é‡å¯¹è±¡, æ‰€ä»¥åœ¨å‡½æ•°è°ƒç”¨æ—¶<code>å˜é‡å¯¹è±¡ === æ´»åŠ¨å¯¹è±¡</code>, æ´»åŠ¨å¯¹è±¡ä¼šå…ˆåŒ…å«<code>arguments</code>å¯¹è±¡åŠæ–¹æ³•.</li>\n</ul>\n<p>è¿˜æ˜¯çœ‹ä¸ªä»£ç æ¥è¯´å§:<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">foo</span> (<span class=\"params\">i</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">var</span> a = <span class=\"string\">'hello'</span></span><br><span class=\"line\">\t<span class=\"keyword\">var</span> b = <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">bar</span> (<span class=\"params\"></span>) </span>&#123;&#125;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">c</span> (<span class=\"params\"></span>) </span>&#123;&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">foo(<span class=\"number\">11</span>)</span><br><span class=\"line\"><span class=\"comment\">// å»ºç«‹é˜¶æ®µ</span></span><br><span class=\"line\">fooExecutionContext = &#123;</span><br><span class=\"line\">\tvariableObject: &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">arguments</span>: &#123;</span><br><span class=\"line\">\t\t\t<span class=\"number\">0</span>: <span class=\"number\">11</span>,</span><br><span class=\"line\">\t\t\tlength: <span class=\"number\">1</span></span><br><span class=\"line\">\t\t&#125;,</span><br><span class=\"line\">\t\ti: <span class=\"number\">11</span>, <span class=\"comment\">// åªæœ‰å‚æ•°è¢«èµ‹å€¼</span></span><br><span class=\"line\">\t\tc: pointer to <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">c</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">\t\t<span class=\"title\">a</span>: <span class=\"title\">undefined</span>,</span></span><br><span class=\"line\"><span class=\"function\">\t\t<span class=\"title\">b</span>: <span class=\"title\">undefined</span>,</span></span><br><span class=\"line\"><span class=\"function\">\t&#125;,</span></span><br><span class=\"line\"><span class=\"function\">\t<span class=\"title\">scopeChain</span>: </span>&#123;...&#125;,</span><br><span class=\"line\">\t<span class=\"keyword\">this</span>: &#123;...&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// æ‰§è¡Œé˜¶æ®µ</span></span><br><span class=\"line\">fooExecutionContext = &#123;</span><br><span class=\"line\">\tvariableObject: &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">arguments</span>: &#123;</span><br><span class=\"line\">\t\t\t<span class=\"number\">0</span>: <span class=\"number\">11</span>,</span><br><span class=\"line\">\t\t\tlength: <span class=\"number\">1</span></span><br><span class=\"line\">\t\t&#125;,</span><br><span class=\"line\">\t\ti: <span class=\"number\">11</span>,</span><br><span class=\"line\">\t\tc: pointer to <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">c</span>(<span class=\"params\"></span>),</span></span><br><span class=\"line\"><span class=\"function\">\t\t<span class=\"title\">a</span>: '<span class=\"title\">hello</span>', // å˜é‡åœ¨è¿™ä¸ªæ—¶å€™æ‰è¢«èµ‹å€¼</span></span><br><span class=\"line\"><span class=\"function\">\t\t<span class=\"title\">b</span>: <span class=\"title\">pointer</span> <span class=\"title\">to</span> <span class=\"title\">function</span> <span class=\"title\">bar</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">\t&#125;,</span></span><br><span class=\"line\"><span class=\"function\">\t<span class=\"title\">scopeChain</span>: </span>&#123;...&#125;,</span><br><span class=\"line\">\t<span class=\"keyword\">this</span>: &#123;...&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>ä»¥ä¸Šä¸‰ä¸ªæ¦‚å¿µéƒ½æ— æ³•ç”¨è¿‡ä»£ç è®¿é—®, æ˜¯è§£é‡Šå™¨åœ¨åå°ä½¿ç”¨.</p>\n","site":{"data":{}},"excerpt":"","more":"<p>åœ¨è¯´å£°æ˜æå‡ä¹‹å‰, é¦–å…ˆåº”è¯¥äº†è§£ä¸‰ä¸ªæ¦‚å¿µæ€§çš„ä¸œè¥¿, æ‰§è¡Œä¸Šä¸‹æ–‡(Execution Context)/ å˜é‡å¯¹è±¡(Variable Object)å’Œæ´»åŠ¨å¯¹è±¡(Activation Object), è¿™ä¸‰ä¸ªæ¦‚å¿µæ˜¯åœ¨ ES3 ä¸­å‡ºç°çš„.</p>\n<ul>\n<li><p>æ‰§è¡Œä¸Šä¸‹æ–‡(Execution Context)<br>æ‰§è¡Œä¸Šä¸‹æ–‡ä¹Ÿå¯ä»¥è¯´æ˜¯ js ä»£ç çš„è¿è¡Œç¯å¢ƒ, ä»£ç ä¸€æ—¦è¢«åŠ è½½ js çš„è§£é‡Šå™¨é¦–å…ˆè¿›å…¥çš„å°±æ˜¯è¿™ä¸ªç¯å¢ƒ. ä»–æœ‰å…¨å±€çš„æ‰§è¡Œä¸Šä¸‹æ–‡å’Œå‡½æ•°çš„æ‰§è¡Œä¸Šä¸‹æ–‡(eval ä¸è¯´, å®ƒå†…éƒ¨ä¹Ÿæœ‰), js çš„è§£é‡Šå™¨é»˜è®¤å…ˆè¿›å…¥çš„æ˜¯å…¨å±€ä¸Šä¸‹æ–‡æ‰€ä»¥æˆ‘ä»¬ä¸€å¼€å§‹å°±èƒ½ç›´æ¥ä½¿ç”¨ä¸€äº›çš„å†…ç½®æ–¹æ³•, æ¯”å¦‚: Array/ Numberâ€¦ æ¯å½“ä¸€ä¸ªå‡½æ•°è¢«è°ƒç”¨æ—¶, å°±ä¼šåˆ›å»ºä»–è‡ªå·±çš„æ‰§è¡Œä¸Šä¸‹æ–‡, æ¯ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡éƒ½æœ‰ä¸€ä¸ªä¸ä¹‹å…³è”çš„å˜é‡å¯¹è±¡.</p>\n</li>\n<li><p>ä½œç”¨åŸŸé“¾(ä¹Ÿç§°è°ƒç”¨æ ˆ)<br>çŸ¥é“äº†æ¯å½“ä¸€ä¸ªå‡½æ•°è°ƒç”¨æ—¶ä¼šåˆ›å»ºè‡ªå·±çš„æ‰§è¡Œä¸Šä¸‹æ–‡, è¿™ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡å°±ä¼šè¢«æ·»åŠ åˆ°ä½œç”¨åŸŸé“¾çš„é¡¶ç«¯. è€Œè§£é‡Šå™¨æ€»æ˜¯å…ˆè¿è¡Œä½œç”¨åŸŸé“¾é¡¶ç«¯çš„æ‰§è¡Œä¸Šä¸‹æ–‡, ä¸€æ—¦å‡½æ•°è°ƒç”¨å®Œæ¯•, å®ƒçš„æ‰§è¡Œä¸Šä¸‹æ–‡å°±ä¼šä»ä½œç”¨åŸŸé“¾çš„é¡¶ç«¯ç§»é™¤å¹¶å°†æ§åˆ¶æƒäº¤ç”±ä¸Šä¸€ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡, ç›´åˆ°å›åˆ°å…¨å±€ä¸Šä¸‹æ–‡. å¦‚ä¸‹å›¾æ‰€ç¤º:<br><img src=\"/img/event-loop.gif\" alt=\"æ‰§è¡Œç¯å¢ƒ\"></p>\n</li>\n</ul>\n<ul>\n<li>å˜é‡å¯¹è±¡(Variable Object)<br>å½“æ‰§è¡Œä¸Šä¸‹æ–‡åˆ›å»ºå, è¿›å…¥å»ºç«‹é˜¶æ®µ(å‡½æ•°è°ƒç”¨, å…·ä½“ä»£ç æ‰§è¡Œä¹‹å‰), åœ¨è¿™ä¸ªé˜¶æ®µå˜é‡å¯¹è±¡/ ä½œç”¨åŸŸé“¾/ <code>this</code>çš„æŒ‡å‘éƒ½ä¼šè¢«ç¡®å®š. å˜é‡å¯¹åƒä¼šæŒ‰é¡ºåºå¡«å……:</li>\n</ul>\n<ol>\n<li>å‡½æ•°å‚æ•°(æ²¡æœ‰å°±æ˜¯ undefined)</li>\n<li>å‡½æ•°å£°æ˜(å‘½åå†²çª, ä¼šè¦†ç›–ä¹‹å‰çš„)</li>\n<li>å˜é‡å£°æ˜(å€¼ä¸º undefined, å‘½åå†²çª, ä¼šè¢«å¿½ç•¥)</li>\n</ol>\n<ul>\n<li>æ´»åŠ¨å¯¹è±¡(ä¹Ÿç§°æ¿€æ´»å¯¹è±¡)<br>å‡½æ•°è°ƒç”¨æ´»åŠ¨å¯¹è±¡å°±ä½œä¸ºå˜é‡å¯¹è±¡, æ‰€ä»¥åœ¨å‡½æ•°è°ƒç”¨æ—¶<code>å˜é‡å¯¹è±¡ === æ´»åŠ¨å¯¹è±¡</code>, æ´»åŠ¨å¯¹è±¡ä¼šå…ˆåŒ…å«<code>arguments</code>å¯¹è±¡åŠæ–¹æ³•.</li>\n</ul>\n<p>è¿˜æ˜¯çœ‹ä¸ªä»£ç æ¥è¯´å§:<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">foo</span> (<span class=\"params\">i</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">var</span> a = <span class=\"string\">'hello'</span></span><br><span class=\"line\">\t<span class=\"keyword\">var</span> b = <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">bar</span> (<span class=\"params\"></span>) </span>&#123;&#125;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">c</span> (<span class=\"params\"></span>) </span>&#123;&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">foo(<span class=\"number\">11</span>)</span><br><span class=\"line\"><span class=\"comment\">// å»ºç«‹é˜¶æ®µ</span></span><br><span class=\"line\">fooExecutionContext = &#123;</span><br><span class=\"line\">\tvariableObject: &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">arguments</span>: &#123;</span><br><span class=\"line\">\t\t\t<span class=\"number\">0</span>: <span class=\"number\">11</span>,</span><br><span class=\"line\">\t\t\tlength: <span class=\"number\">1</span></span><br><span class=\"line\">\t\t&#125;,</span><br><span class=\"line\">\t\ti: <span class=\"number\">11</span>, <span class=\"comment\">// åªæœ‰å‚æ•°è¢«èµ‹å€¼</span></span><br><span class=\"line\">\t\tc: pointer to <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">c</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">\t\t<span class=\"title\">a</span>: <span class=\"title\">undefined</span>,</span></span><br><span class=\"line\"><span class=\"function\">\t\t<span class=\"title\">b</span>: <span class=\"title\">undefined</span>,</span></span><br><span class=\"line\"><span class=\"function\">\t&#125;,</span></span><br><span class=\"line\"><span class=\"function\">\t<span class=\"title\">scopeChain</span>: </span>&#123;...&#125;,</span><br><span class=\"line\">\t<span class=\"keyword\">this</span>: &#123;...&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// æ‰§è¡Œé˜¶æ®µ</span></span><br><span class=\"line\">fooExecutionContext = &#123;</span><br><span class=\"line\">\tvariableObject: &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">arguments</span>: &#123;</span><br><span class=\"line\">\t\t\t<span class=\"number\">0</span>: <span class=\"number\">11</span>,</span><br><span class=\"line\">\t\t\tlength: <span class=\"number\">1</span></span><br><span class=\"line\">\t\t&#125;,</span><br><span class=\"line\">\t\ti: <span class=\"number\">11</span>,</span><br><span class=\"line\">\t\tc: pointer to <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">c</span>(<span class=\"params\"></span>),</span></span><br><span class=\"line\"><span class=\"function\">\t\t<span class=\"title\">a</span>: '<span class=\"title\">hello</span>', // å˜é‡åœ¨è¿™ä¸ªæ—¶å€™æ‰è¢«èµ‹å€¼</span></span><br><span class=\"line\"><span class=\"function\">\t\t<span class=\"title\">b</span>: <span class=\"title\">pointer</span> <span class=\"title\">to</span> <span class=\"title\">function</span> <span class=\"title\">bar</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">\t&#125;,</span></span><br><span class=\"line\"><span class=\"function\">\t<span class=\"title\">scopeChain</span>: </span>&#123;...&#125;,</span><br><span class=\"line\">\t<span class=\"keyword\">this</span>: &#123;...&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>ä»¥ä¸Šä¸‰ä¸ªæ¦‚å¿µéƒ½æ— æ³•ç”¨è¿‡ä»£ç è®¿é—®, æ˜¯è§£é‡Šå™¨åœ¨åå°ä½¿ç”¨.</p>\n"},{"title":"ç›’æ¨¡å‹","date":"2017-10-21T15:58:06.000Z","_content":"`CSS` ç›’æ¨¡å‹ (Box Model), åŒ…å«çš„è¦ç´ åˆ†åˆ«ä¸º: content/padding/border/margin.\n\n### æ ‡å‡†ç›’æ¨¡å‹ & æ€ªå¼‚ç›’æ¨¡å‹\nç›’æ¨¡å‹åˆ†ä¸ºW3Cçš„æ ‡å‡†ç›’æ¨¡å‹å’ŒIEçš„æ ‡å‡†ç›’æ¨¡å‹.\n\n- æ ‡å‡†ç›’æ¨¡å‹\n`content + padding+ border + margin`  æ ‡å‡†ç›’æ¨¡å‹çš„ content æ˜¯ä¸åŒ…å«å…¶ä»–éƒ¨åˆ†çš„, å¦‚ä¸‹å›¾:\n![W3C-BOX](http://orf90agxq.bkt.clouddn.com/GitHub/boxW3C_BOX.jpeg)\n\n- IEæ ‡å‡†ç›’æ¨¡å‹\n`content(padding + border) + margin` è€ŒIEæ ‡å‡†ç›’æ¨¡å‹çš„ content å·²ç»åŒ…å«paddingå’Œborderçš„å€¼, å¦‚ä¸‹å›¾: \n![IE-BOX](http://orf90agxq.bkt.clouddn.com/GitHub/boxIE_BOX.jpeg)\n\nåœ¨æ–‡æ¡£é¡¶éƒ¨å£°æ˜ `DOCTYPE` å°±æ˜¯ä¸ºäº†è®©æµè§ˆå™¨ä½¿ç”¨ W3Cæ ‡å‡†ç›’æ¨¡å‹, ä½†æ˜¯åœ¨ IE5/ IE6 ä¸‹ä¾ç„¶æ˜¯ IE æ ‡å‡†ç›’æ¨¡å‹. å½“ç„¶é€šè¿‡`box-sizing`å±æ€§å¯ä»¥åœ¨ä¸¤è€…ä¹‹é—´è½¬æ¢.\n\n#### å¸¸è§é—®é¢˜\n\n1. ä¸¤ä¸ªå‚ç›´æ–¹å‘ç›¸é‚»çš„å—çº§å…ƒç´ ç›¸é‡æ—¶, å¤–è¾¹è·ä¼šåˆå¹¶ä¸”å–å€¼ä¸¤è€…è¾ƒå¤§å€¼çš„ `margin` ä½œä¸ºå¤–è¾¹è·.\n```css\nè§£å†³æ–¹æ¡ˆ:\n *{\n    margin: 0; \n    padding: 0\n}\n```\n\n2. margin å‡ºè½¨... \nå½“çˆ¶å…ƒç´ æ²¡æœ‰ `border` è¾¹æ¡†æ—¶, ç¬¬ä¸€ä¸ªå­å…ƒç´ æ·»åŠ  `margin-top` ä¼šè¶…å‡ºçˆ¶å…ƒç´ , ç›¸åŒæœ€åä¸€ä¸ªå­å…ƒç´ æ·»åŠ  `margin-bottom` ä¹ŸåŒæ ·ä¼šè¶…å‡ºçˆ¶å…ƒç´ , å¦‚ä¸‹å›¾: \n\n- ç¬¬ä¸€ä¸ªå­å…ƒç´ æ·»åŠ  margin-top\n![marginTop](http://orf90agxq.bkt.clouddn.com/box_modelmargin.png)\n\n- æœ€åä¸€ä¸ªå­å…ƒç´ æ·»åŠ  margin-bottom\n![marginBottom](http://orf90agxq.bkt.clouddn.com/box_modelmarginBottom.png)\n\n- å‰ä¸¤è€…åŒæ—¶å­˜åœ¨æ—¶, çˆ¶å…ƒç´ æ·»åŠ  border\n![marginBottom](http://orf90agxq.bkt.clouddn.com/box_modelborder.png)\n\nè§£å†³æ–¹æ¡ˆæœ‰å››ç§: \n> 1. ç»™çˆ¶å…ƒç´ æ·»åŠ  border.\n\n> 2. ç»™çˆ¶å…ƒç´ æ·»åŠ  padding.\n\n> 3. ç»™çˆ¶å…ƒç´ æ·»åŠ  overflow: hidden.\n\n> 4. ç»™çˆ¶å…ƒç´ æ·»åŠ ä¼ªç±». (æœ€ä½³)\n```css\n.parent {\n    content: '';\n    display: table;\n}\n```\n\nCreated on 2017-8-15 by Cara\n","source":"_posts/ç›’æ¨¡å‹.md","raw":"---\ntitle: ç›’æ¨¡å‹\ndate: 2017-10-21 23:58:06\ntags:\n- CSS\ncategories:\n- å¤ä¹ \n---\n`CSS` ç›’æ¨¡å‹ (Box Model), åŒ…å«çš„è¦ç´ åˆ†åˆ«ä¸º: content/padding/border/margin.\n\n### æ ‡å‡†ç›’æ¨¡å‹ & æ€ªå¼‚ç›’æ¨¡å‹\nç›’æ¨¡å‹åˆ†ä¸ºW3Cçš„æ ‡å‡†ç›’æ¨¡å‹å’ŒIEçš„æ ‡å‡†ç›’æ¨¡å‹.\n\n- æ ‡å‡†ç›’æ¨¡å‹\n`content + padding+ border + margin`  æ ‡å‡†ç›’æ¨¡å‹çš„ content æ˜¯ä¸åŒ…å«å…¶ä»–éƒ¨åˆ†çš„, å¦‚ä¸‹å›¾:\n![W3C-BOX](http://orf90agxq.bkt.clouddn.com/GitHub/boxW3C_BOX.jpeg)\n\n- IEæ ‡å‡†ç›’æ¨¡å‹\n`content(padding + border) + margin` è€ŒIEæ ‡å‡†ç›’æ¨¡å‹çš„ content å·²ç»åŒ…å«paddingå’Œborderçš„å€¼, å¦‚ä¸‹å›¾: \n![IE-BOX](http://orf90agxq.bkt.clouddn.com/GitHub/boxIE_BOX.jpeg)\n\nåœ¨æ–‡æ¡£é¡¶éƒ¨å£°æ˜ `DOCTYPE` å°±æ˜¯ä¸ºäº†è®©æµè§ˆå™¨ä½¿ç”¨ W3Cæ ‡å‡†ç›’æ¨¡å‹, ä½†æ˜¯åœ¨ IE5/ IE6 ä¸‹ä¾ç„¶æ˜¯ IE æ ‡å‡†ç›’æ¨¡å‹. å½“ç„¶é€šè¿‡`box-sizing`å±æ€§å¯ä»¥åœ¨ä¸¤è€…ä¹‹é—´è½¬æ¢.\n\n#### å¸¸è§é—®é¢˜\n\n1. ä¸¤ä¸ªå‚ç›´æ–¹å‘ç›¸é‚»çš„å—çº§å…ƒç´ ç›¸é‡æ—¶, å¤–è¾¹è·ä¼šåˆå¹¶ä¸”å–å€¼ä¸¤è€…è¾ƒå¤§å€¼çš„ `margin` ä½œä¸ºå¤–è¾¹è·.\n```css\nè§£å†³æ–¹æ¡ˆ:\n *{\n    margin: 0; \n    padding: 0\n}\n```\n\n2. margin å‡ºè½¨... \nå½“çˆ¶å…ƒç´ æ²¡æœ‰ `border` è¾¹æ¡†æ—¶, ç¬¬ä¸€ä¸ªå­å…ƒç´ æ·»åŠ  `margin-top` ä¼šè¶…å‡ºçˆ¶å…ƒç´ , ç›¸åŒæœ€åä¸€ä¸ªå­å…ƒç´ æ·»åŠ  `margin-bottom` ä¹ŸåŒæ ·ä¼šè¶…å‡ºçˆ¶å…ƒç´ , å¦‚ä¸‹å›¾: \n\n- ç¬¬ä¸€ä¸ªå­å…ƒç´ æ·»åŠ  margin-top\n![marginTop](http://orf90agxq.bkt.clouddn.com/box_modelmargin.png)\n\n- æœ€åä¸€ä¸ªå­å…ƒç´ æ·»åŠ  margin-bottom\n![marginBottom](http://orf90agxq.bkt.clouddn.com/box_modelmarginBottom.png)\n\n- å‰ä¸¤è€…åŒæ—¶å­˜åœ¨æ—¶, çˆ¶å…ƒç´ æ·»åŠ  border\n![marginBottom](http://orf90agxq.bkt.clouddn.com/box_modelborder.png)\n\nè§£å†³æ–¹æ¡ˆæœ‰å››ç§: \n> 1. ç»™çˆ¶å…ƒç´ æ·»åŠ  border.\n\n> 2. ç»™çˆ¶å…ƒç´ æ·»åŠ  padding.\n\n> 3. ç»™çˆ¶å…ƒç´ æ·»åŠ  overflow: hidden.\n\n> 4. ç»™çˆ¶å…ƒç´ æ·»åŠ ä¼ªç±». (æœ€ä½³)\n```css\n.parent {\n    content: '';\n    display: table;\n}\n```\n\nCreated on 2017-8-15 by Cara\n","slug":"ç›’æ¨¡å‹","published":1,"updated":"2018-05-05T09:23:03.679Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjgurolsz001rklu0ub6gw88t","content":"<p><code>CSS</code> ç›’æ¨¡å‹ (Box Model), åŒ…å«çš„è¦ç´ åˆ†åˆ«ä¸º: content/padding/border/margin.</p>\n<h3 id=\"æ ‡å‡†ç›’æ¨¡å‹-amp-æ€ªå¼‚ç›’æ¨¡å‹\"><a href=\"#æ ‡å‡†ç›’æ¨¡å‹-amp-æ€ªå¼‚ç›’æ¨¡å‹\" class=\"headerlink\" title=\"æ ‡å‡†ç›’æ¨¡å‹ &amp; æ€ªå¼‚ç›’æ¨¡å‹\"></a>æ ‡å‡†ç›’æ¨¡å‹ &amp; æ€ªå¼‚ç›’æ¨¡å‹</h3><p>ç›’æ¨¡å‹åˆ†ä¸ºW3Cçš„æ ‡å‡†ç›’æ¨¡å‹å’ŒIEçš„æ ‡å‡†ç›’æ¨¡å‹.</p>\n<ul>\n<li><p>æ ‡å‡†ç›’æ¨¡å‹<br><code>content + padding+ border + margin</code>  æ ‡å‡†ç›’æ¨¡å‹çš„ content æ˜¯ä¸åŒ…å«å…¶ä»–éƒ¨åˆ†çš„, å¦‚ä¸‹å›¾:<br><img src=\"http://orf90agxq.bkt.clouddn.com/GitHub/boxW3C_BOX.jpeg\" alt=\"W3C-BOX\"></p>\n</li>\n<li><p>IEæ ‡å‡†ç›’æ¨¡å‹<br><code>content(padding + border) + margin</code> è€ŒIEæ ‡å‡†ç›’æ¨¡å‹çš„ content å·²ç»åŒ…å«paddingå’Œborderçš„å€¼, å¦‚ä¸‹å›¾:<br><img src=\"http://orf90agxq.bkt.clouddn.com/GitHub/boxIE_BOX.jpeg\" alt=\"IE-BOX\"></p>\n</li>\n</ul>\n<p>åœ¨æ–‡æ¡£é¡¶éƒ¨å£°æ˜ <code>DOCTYPE</code> å°±æ˜¯ä¸ºäº†è®©æµè§ˆå™¨ä½¿ç”¨ W3Cæ ‡å‡†ç›’æ¨¡å‹, ä½†æ˜¯åœ¨ IE5/ IE6 ä¸‹ä¾ç„¶æ˜¯ IE æ ‡å‡†ç›’æ¨¡å‹. å½“ç„¶é€šè¿‡<code>box-sizing</code>å±æ€§å¯ä»¥åœ¨ä¸¤è€…ä¹‹é—´è½¬æ¢.</p>\n<h4 id=\"å¸¸è§é—®é¢˜\"><a href=\"#å¸¸è§é—®é¢˜\" class=\"headerlink\" title=\"å¸¸è§é—®é¢˜\"></a>å¸¸è§é—®é¢˜</h4><ol>\n<li><p>ä¸¤ä¸ªå‚ç›´æ–¹å‘ç›¸é‚»çš„å—çº§å…ƒç´ ç›¸é‡æ—¶, å¤–è¾¹è·ä¼šåˆå¹¶ä¸”å–å€¼ä¸¤è€…è¾ƒå¤§å€¼çš„ <code>margin</code> ä½œä¸ºå¤–è¾¹è·.</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">è§£å†³æ–¹æ¡ˆ:</span><br><span class=\"line\"> *&#123;</span><br><span class=\"line\">    <span class=\"attribute\">margin</span>: <span class=\"number\">0</span>; </span><br><span class=\"line\">    <span class=\"attribute\">padding</span>: <span class=\"number\">0</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>margin å‡ºè½¨â€¦<br>å½“çˆ¶å…ƒç´ æ²¡æœ‰ <code>border</code> è¾¹æ¡†æ—¶, ç¬¬ä¸€ä¸ªå­å…ƒç´ æ·»åŠ  <code>margin-top</code> ä¼šè¶…å‡ºçˆ¶å…ƒç´ , ç›¸åŒæœ€åä¸€ä¸ªå­å…ƒç´ æ·»åŠ  <code>margin-bottom</code> ä¹ŸåŒæ ·ä¼šè¶…å‡ºçˆ¶å…ƒç´ , å¦‚ä¸‹å›¾: </p>\n</li>\n</ol>\n<ul>\n<li><p>ç¬¬ä¸€ä¸ªå­å…ƒç´ æ·»åŠ  margin-top<br><img src=\"http://orf90agxq.bkt.clouddn.com/box_modelmargin.png\" alt=\"marginTop\"></p>\n</li>\n<li><p>æœ€åä¸€ä¸ªå­å…ƒç´ æ·»åŠ  margin-bottom<br><img src=\"http://orf90agxq.bkt.clouddn.com/box_modelmarginBottom.png\" alt=\"marginBottom\"></p>\n</li>\n<li><p>å‰ä¸¤è€…åŒæ—¶å­˜åœ¨æ—¶, çˆ¶å…ƒç´ æ·»åŠ  border<br><img src=\"http://orf90agxq.bkt.clouddn.com/box_modelborder.png\" alt=\"marginBottom\"></p>\n</li>\n</ul>\n<p>è§£å†³æ–¹æ¡ˆæœ‰å››ç§: </p>\n<blockquote>\n<ol>\n<li>ç»™çˆ¶å…ƒç´ æ·»åŠ  border.</li>\n</ol>\n</blockquote>\n<blockquote>\n<ol start=\"2\">\n<li>ç»™çˆ¶å…ƒç´ æ·»åŠ  padding.</li>\n</ol>\n</blockquote>\n<blockquote>\n<ol start=\"3\">\n<li>ç»™çˆ¶å…ƒç´ æ·»åŠ  overflow: hidden.</li>\n</ol>\n</blockquote>\n<blockquote>\n<ol start=\"4\">\n<li>ç»™çˆ¶å…ƒç´ æ·»åŠ ä¼ªç±». (æœ€ä½³)<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.parent</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">content</span>: <span class=\"string\">''</span>;</span><br><span class=\"line\">    <span class=\"attribute\">display</span>: table;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n</blockquote>\n<p>Created on 2017-8-15 by Cara</p>\n","site":{"data":{}},"excerpt":"","more":"<p><code>CSS</code> ç›’æ¨¡å‹ (Box Model), åŒ…å«çš„è¦ç´ åˆ†åˆ«ä¸º: content/padding/border/margin.</p>\n<h3 id=\"æ ‡å‡†ç›’æ¨¡å‹-amp-æ€ªå¼‚ç›’æ¨¡å‹\"><a href=\"#æ ‡å‡†ç›’æ¨¡å‹-amp-æ€ªå¼‚ç›’æ¨¡å‹\" class=\"headerlink\" title=\"æ ‡å‡†ç›’æ¨¡å‹ &amp; æ€ªå¼‚ç›’æ¨¡å‹\"></a>æ ‡å‡†ç›’æ¨¡å‹ &amp; æ€ªå¼‚ç›’æ¨¡å‹</h3><p>ç›’æ¨¡å‹åˆ†ä¸ºW3Cçš„æ ‡å‡†ç›’æ¨¡å‹å’ŒIEçš„æ ‡å‡†ç›’æ¨¡å‹.</p>\n<ul>\n<li><p>æ ‡å‡†ç›’æ¨¡å‹<br><code>content + padding+ border + margin</code>  æ ‡å‡†ç›’æ¨¡å‹çš„ content æ˜¯ä¸åŒ…å«å…¶ä»–éƒ¨åˆ†çš„, å¦‚ä¸‹å›¾:<br><img src=\"http://orf90agxq.bkt.clouddn.com/GitHub/boxW3C_BOX.jpeg\" alt=\"W3C-BOX\"></p>\n</li>\n<li><p>IEæ ‡å‡†ç›’æ¨¡å‹<br><code>content(padding + border) + margin</code> è€ŒIEæ ‡å‡†ç›’æ¨¡å‹çš„ content å·²ç»åŒ…å«paddingå’Œborderçš„å€¼, å¦‚ä¸‹å›¾:<br><img src=\"http://orf90agxq.bkt.clouddn.com/GitHub/boxIE_BOX.jpeg\" alt=\"IE-BOX\"></p>\n</li>\n</ul>\n<p>åœ¨æ–‡æ¡£é¡¶éƒ¨å£°æ˜ <code>DOCTYPE</code> å°±æ˜¯ä¸ºäº†è®©æµè§ˆå™¨ä½¿ç”¨ W3Cæ ‡å‡†ç›’æ¨¡å‹, ä½†æ˜¯åœ¨ IE5/ IE6 ä¸‹ä¾ç„¶æ˜¯ IE æ ‡å‡†ç›’æ¨¡å‹. å½“ç„¶é€šè¿‡<code>box-sizing</code>å±æ€§å¯ä»¥åœ¨ä¸¤è€…ä¹‹é—´è½¬æ¢.</p>\n<h4 id=\"å¸¸è§é—®é¢˜\"><a href=\"#å¸¸è§é—®é¢˜\" class=\"headerlink\" title=\"å¸¸è§é—®é¢˜\"></a>å¸¸è§é—®é¢˜</h4><ol>\n<li><p>ä¸¤ä¸ªå‚ç›´æ–¹å‘ç›¸é‚»çš„å—çº§å…ƒç´ ç›¸é‡æ—¶, å¤–è¾¹è·ä¼šåˆå¹¶ä¸”å–å€¼ä¸¤è€…è¾ƒå¤§å€¼çš„ <code>margin</code> ä½œä¸ºå¤–è¾¹è·.</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">è§£å†³æ–¹æ¡ˆ:</span><br><span class=\"line\"> *&#123;</span><br><span class=\"line\">    <span class=\"attribute\">margin</span>: <span class=\"number\">0</span>; </span><br><span class=\"line\">    <span class=\"attribute\">padding</span>: <span class=\"number\">0</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>margin å‡ºè½¨â€¦<br>å½“çˆ¶å…ƒç´ æ²¡æœ‰ <code>border</code> è¾¹æ¡†æ—¶, ç¬¬ä¸€ä¸ªå­å…ƒç´ æ·»åŠ  <code>margin-top</code> ä¼šè¶…å‡ºçˆ¶å…ƒç´ , ç›¸åŒæœ€åä¸€ä¸ªå­å…ƒç´ æ·»åŠ  <code>margin-bottom</code> ä¹ŸåŒæ ·ä¼šè¶…å‡ºçˆ¶å…ƒç´ , å¦‚ä¸‹å›¾: </p>\n</li>\n</ol>\n<ul>\n<li><p>ç¬¬ä¸€ä¸ªå­å…ƒç´ æ·»åŠ  margin-top<br><img src=\"http://orf90agxq.bkt.clouddn.com/box_modelmargin.png\" alt=\"marginTop\"></p>\n</li>\n<li><p>æœ€åä¸€ä¸ªå­å…ƒç´ æ·»åŠ  margin-bottom<br><img src=\"http://orf90agxq.bkt.clouddn.com/box_modelmarginBottom.png\" alt=\"marginBottom\"></p>\n</li>\n<li><p>å‰ä¸¤è€…åŒæ—¶å­˜åœ¨æ—¶, çˆ¶å…ƒç´ æ·»åŠ  border<br><img src=\"http://orf90agxq.bkt.clouddn.com/box_modelborder.png\" alt=\"marginBottom\"></p>\n</li>\n</ul>\n<p>è§£å†³æ–¹æ¡ˆæœ‰å››ç§: </p>\n<blockquote>\n<ol>\n<li>ç»™çˆ¶å…ƒç´ æ·»åŠ  border.</li>\n</ol>\n</blockquote>\n<blockquote>\n<ol start=\"2\">\n<li>ç»™çˆ¶å…ƒç´ æ·»åŠ  padding.</li>\n</ol>\n</blockquote>\n<blockquote>\n<ol start=\"3\">\n<li>ç»™çˆ¶å…ƒç´ æ·»åŠ  overflow: hidden.</li>\n</ol>\n</blockquote>\n<blockquote>\n<ol start=\"4\">\n<li>ç»™çˆ¶å…ƒç´ æ·»åŠ ä¼ªç±». (æœ€ä½³)<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.parent</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">content</span>: <span class=\"string\">''</span>;</span><br><span class=\"line\">    <span class=\"attribute\">display</span>: table;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n</blockquote>\n<p>Created on 2017-8-15 by Cara</p>\n"},{"title":"è·¨åŸŸ","date":"2018-04-02T09:01:24.000Z","_content":"è·¨åŸŸè¿™å—æ˜¯å‰åç«¯åˆ†ç¦»å¿…ç»çš„ä¸€æ¡è·¯, è¿™æ¬¡å¥½å¥½æ•´ç†ä¸€ä¸‹å…³äºè·¨åŸŸæ–¹é¢çŸ¥è¯†.\n\n### ä»€ä¹ˆæ˜¯è·¨åŸŸ?\nè·¨åŸŸæ˜¯å—åŒæºç­–ç•¥çš„å½±å“è€Œå¯¼è‡´çš„, æŒ‡ä¸€ä¸ªæºä¸‹çš„èµ„æºè¯•å›¾æ“ä½œå¦ä¸€ä¸ªæºä¸‹çš„èµ„æº.\n\n> é‚£ä¹ˆ, ä»€ä¹ˆåˆæ˜¯åŒæºç­–ç•¥å‘¢?\n> å°±æ˜¯é™åˆ¶ä»ä¸€ä¸ªæºçš„èµ„æºå¦‚ä½•ä¸å¦ä¸€ä¸ªæºçš„èµ„æºäº¤äº’, ç”¨äºéš”ç¦»æ½œåœ¨çš„æ¶æ„æ–‡ä»¶, ä¿è¯æ–‡ä»¶çš„å®‰å…¨æ€§. æ‰€è°“çš„åŒæºæ˜¯æŒ‡: åè®®/åŸŸå/ç«¯å£ ä¸‰è€…ç›¸åŒ, å³ä½¿ä¸¤ä¸ªä¸åŒçš„åŸŸåæŒ‡å‘åŒä¸€ä¸ª IP åœ°å€, ä¹ŸéåŒæº. å¦‚æœæ²¡æœ‰åŒæºç­–ç•¥, æµè§ˆå™¨å¾ˆå®¹æ˜“å—åˆ° XSS/CSRF ç­‰çš„æ”»å‡»(XSS: è·¨ç«™è„šæœ¬æ”»å‡»;CSRF: è·¨ç«™è¯·æ±‚ä¼ªé€ ).\n\nåŒæºç­–ç•¥å°†é™åˆ¶ä»¥ä¸‹è¡Œä¸º:\n- Cookie/LocalStorage/IndexDB\n- DOM æ— æ³•è·å¾—\n- Ajax è¯·æ±‚æ— æ³•å‘é€\n\n### è·¨åŸŸè§£å†³æ–¹æ¡ˆ\n\n#### 1. JSONP\nå®ƒçš„ç‰¹æ€§æ˜¯ç®€å•/ å…¼å®¹æ€§å¥½/ æ”¹é€ å°, ä½†æ˜¯ä¸æ”¯æŒ POST è¯·æ±‚. åŸç†æ˜¯é€šè¿‡ `script` æ ‡ç­¾æ”¾å…¥å›è°ƒå‡½æ•°, æœåŠ¡ç«¯å°†è¿”å›æ•°æ®å¡å…¥å›è°ƒå‡½æ•°å³å¯.\n\n```js\nconst createScript = url => {\n    let script = document.createElement('script')\n    script.type = 'text/javascript'\n    script.src = url\n    document.body.appendChild(script)\n}\n\n// ä¼ å…¥è¯·æ±‚åœ°å€\ncreateScript('http://www.example.com/api?callback=foo')\n\n// å›è°ƒå‡½æ•°\nfunction foo (data) {\n    // æœåŠ¡ç«¯è¿”å›æ•°æ®\n    console.log(data)\n}\n```\n\n#### 2. document.domain\né€šè¿‡è®¾ç½®åŸŸåæ¥è®¿é—® `Cookie` å’Œ æ“ä½œ `iframe` çª—å£, æ­¤æ–¹æ¡ˆåªé€‚ç”¨äºä¸»åŸŸç›¸åŒ, å­åŸŸä¸åŒçš„åœºæ™¯.\n\n```html\n// çˆ¶çª—å£ (http://www.main.com/a.html)\n<iframe id='iframe' src='http://www.child.main.com/b.html'></iframe>\n<script>\n    document.domain = 'main.com'\n    document.cookie = 'test=hi'\n    var user = 'admin'\n</script>\n\n\n// å­çª—å£ (http://www.child.main.com/b.html)\n<script>\n    document.domain = 'example.com'\n    let parentMessage = document.cookie\n    console.log(window.parent.user)\n</script>\n```\n\n#### 3. window.location.hash\né€šè¿‡ä¿®æ”¹ hash å€¼æ¥ä¼ é€’å‚æ•°, ä¿®æ”¹ hash å€¼å¹¶ä¸ä¼šåˆ·æ–°é¡µé¢ä½†å­—èŠ‚æ•°æœ‰é™åˆ¶.\n\n```js\n// çˆ¶çª—å£å‘å­çª—å£å†™å…¥ hash\nlet src = `${childUrl}#test=hi`\ndocument.querySelector('#iframe').src = src\n\n// å­çª—å£\n// æ¥æ”¶æ¶ˆæ¯\nwindow.onhashchange = () => {\n    let meg = window.location.hash\n}\n// å­çª—å£å‘çˆ¶çª—å£å†™å…¥ hash\nwindow.parent.href = `${window.parent.href}#world`\n```\n\n#### 4. window.name\nwindow.name åªè¦åœ¨åŒä¸€ä¸ªçª—å£, æ— è®ºæ˜¯å¦åŒæºå‰ä¸€ä¸ªé¡µé¢è®¾ç½®äº†è¿™ä¸ªå±æ€§, åä¸€ä¸ªé¡µé¢å°±èƒ½è¯»å–. å®ƒå¯ä»¥æ”¯æŒ2M å¤§å°çš„å€¼ä½†æ˜¯å˜åŒ–éœ€è¦è‡ªå·±ç›‘å¬.\n\n```js\n// çˆ¶çª—å£ (http://www.main.com/a.html)\nconst proxy = (url, callback) => {\n    const iframe = document.createElement('iframe')\n    let state = 0\n\n    // è·³è½¬åˆ°è·¨åŸŸé¡µé¢\n    iframe.src = url\n\n    iframe.onload = () => {\n        if (state === 1) {\n            // ç¬¬äºŒæ¬¡ä»£ç†ä¹ŸåŠ è½½æˆåŠŸä¹‹å, è¯»å– name å±æ€§\n            callback(window.name)\n            document.body.removeChild(iframe);\n        } else if (state === 0) {\n            //  ç¬¬ä¸€æ¬¡è·³è½¬åˆ°ä»£ç†é¡µé¢\n            iframe.src = 'http://www.main.com/proxy.html'\n            state = 1\n        }\n    }\n    document.body.appendChild(iframe)\n}\n\n// ä¼ å…¥è·¨åŸŸé¡µé¢ URL\nproxy('http://www.child.com/b.html', (name) => {\n    console.log(name) // 'This message from b.html'\n})\n\n// è·¨åŸŸå­çª—å£ (http://www.child.com/b.html) \n// è®¾ç½® name å±æ€§\nwindow.name = 'This message from b.html'\n```\n\n#### 5. postMessage\npostMessage(è·¨æ–‡æ¡£é€šä¿¡) æ˜¯ HTML5 ä¸­ä¸ºäº†è§£å†³è·¨åŸŸå‡ºçš„ API, å¯ä»¥è§£å†³ä»¥ä¸‹å‡ ç§é—®é¢˜:\n\n1. é¡µé¢å’Œå…¶æ‰“å¼€çš„æ–°çª—å£çš„æ•°æ®ä¼ é€’\n2. å¤šçª—å£ä¹‹é—´æ¶ˆæ¯ä¼ é€’\n3. é¡µé¢ä¸åµŒå¥—çš„iframeæ¶ˆæ¯ä¼ é€’\n4. ä¸Šé¢ä¸‰ä¸ªåœºæ™¯çš„è·¨åŸŸæ•°æ®ä¼ é€’\n\nå‘é€æ¶ˆæ¯é€šè¿‡ `postMessage(data, origin)` æ–¹æ³•, è¯¥æ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‚æ•°: \n- data: éœ€è¦ä¼ é€’çš„å‚æ•°, ç”±äºéƒ¨åˆ†æµè§ˆå™¨åªæ”¯æŒå­—ç¬¦ä¸², æ‰€ä»¥ä¼ é€’ä¹‹å‰æœ€å¥½å…ˆ `JSON.stringify()` åºåˆ—åŒ–\n- origin: æ˜¯æ¥æ”¶æ–¹çš„ åè®® + ä¸»æœº + ç«¯å£, å¯ä»¥æ˜¯è®¾ç½®ä¸º `*`, æŒ‡å®šä¸å½“å‰çª—å£åŒæºçš„è¯è®¾ç½®ä¸º `/`.\n\næ¥æ”¶æ¶ˆæ¯é€šè¿‡ `message` äº‹ä»¶ç›‘å¬, è¯¥äº‹ä»¶æœ‰ä¸€ä¸ª `event` å‚æ•°æä¾›ä¸‰ä¸ªå±æ€§:\n- event.origin: æ¶ˆæ¯æ¥æ”¶æ–¹\n- event.source: æ¶ˆæ¯æ¥æº\n- event.data: æ¶ˆæ¯ä½“\n\n```html\n// çˆ¶çª—å£ (http://www.main.com/a.html)\n<firame id='iframe' src='http://www.child.com/b.html'></iframe>\n<script>\n    let iframe = document.querySelector('#iframe')\n    let url = iframe.src\n    iframe.onload = () => {\n        let data = {\n            name: 'parent',\n            message: 'This message from parent'\n        }\n        // è·¨åŸŸå‘å­çª—å£å‘é€æ¶ˆæ¯\n        iframe.contentWindow.postMessage(JSON.stringify(data), url)\n    }\n\n    // çˆ¶çª—å£ç›‘å¬å­çª—å£å‘é€çš„æ¶ˆæ¯\n    window.onmessage = (event) => {\n        // è¿‡æ»¤ä¸å±äºè‡ªå·±çš„æ¶ˆæ¯\n        if (data.origin !== 'http://www.main.com/a.html') return\n        console.log('data from child: ' + event.data)\n    }\n</script>\n\n// å­çª—å£ (http://www.child.com/b.html)\n<script>\n    window.onmessage = (event) => {\n        console.log('data from main: ' + event.data)\n        let data = JSON.parse(event.data)\n        data.name = 'child'\n\n        // æ”¶åˆ°æ¶ˆæ¯åå¤„ç†å†å‘é€ç»™çˆ¶çª—å£\n        window.parent.postMessage(JSON.stringify(data), 'http://www.main.com/a.html')\n    }\n</script>\n```\n\n#### 5. CORS\nè·¨åŸŸèµ„æºå…±äº«(Cross-origin-resource-sharing), å®ƒå…è®¸æµè§ˆå™¨å‘è·¨æºæœåŠ¡å™¨å‘å‡º `XMLHttpRequest` è¯·æ±‚. CORS ç°åœ¨ä¹Ÿæ˜¯ä¸»æµçš„è·¨åŸŸè§£å†³æ–¹æ¡ˆ, è¿™ç§æ–¹å¼åªéœ€è¦åç«¯åšå¤„ç†, å¦‚æœè¦å¸¦ä¸Š cookie é‚£ä¹ˆå‰åç«¯éƒ½è¦è®¾ç½®.\n\nå¸¦ cookie ä¼ è¾“:\n```js\nxhr.withCredentials = true\n```\n\nè¯·æ±‚å®ä¾‹:\n```js\nconst XMLRequest = (method = 'GET', url = '', data = null) => {\n    let xhr = null\n    if (window.XMLHttpRequest) {\n        xhr = new XMLHttpRequest()\n    } else {\n        xhr = new ActiveXObject('Microsoft.XMLHTTP')\n    }\n\n    xhr.open(method, url, true)\n    xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded')\n    xhr.send(data)\n\n    xhr.onreadystatechange = () => {\n        if (xhr.readyState === 4 && xhr.status === 200) {\n            console.log(xhr.responseText)\n        }\n    }\n}\n\nXMLRequest('POST', 'http://www.example.com/api', {\n    name: 'cara'\n})\n```\n\nå…¶ä¸­ `readyState` æœ‰äº”ç§çŠ¶æ€:\n0: ä¸ºåˆå§‹åŒ–\n1: æœåŠ¡å™¨è¿æ¥å»ºç«‹\n2: è¯·æ±‚å·²æ¥æ”¶\n3: è¯·æ±‚å¤„ç†ä¸­\n4: è¯·æ±‚å·²å®Œæˆ\n\n#### 6. ä»£ç†æœåŠ¡å™¨\nå…¶å®å°±æ˜¯é€šè¿‡é…ç½® nginx å®ç°ä¸€ä¸ªä¸­é—´æœåŠ¡å™¨ä½œè·³æ¿, ä»£ç†åˆ°ç›®æ ‡æœåŠ¡å™¨.\n\né™æ€èµ„æºä»£ç†\n```config\nlocation / {\n    add_header Access-Control-Allow-Origin *;\n}\n```\n\nå…·ä½“ä»£ç†é…ç½®\n```config\nserver {\n    listen 81;\n    server_name www.example.com;\n\n    lication / {\n        # åå‘ä»£ç†\n        proxy_pass http://www.example2.com:8080;\n        # ä¿®æ”¹ cookie åŸŸå\n        proxy_cookie_domain www.example2.com www.example.com;\n        index index.html index.htm;\n\n        # ä¸å¸¦ cookie æ—¶æ‰èƒ½è®¾ç½®ä¸º *\n        add_header Access-Control-Allow-Origin http://www.example.com;\n        add_header Access-Control-Allow-Credentials true;\n    }\n}\n```\n\nè°ƒç”¨ç¤ºä¾‹\n```js\nlet xhr = new XMLHttpRequest()\n\nxhr.withCredentials = true\nxhr.open('GET', 'htt://www.example.com:81/?user=admin', true)\nxhr.send(null)\n```\n\nä»¥ä¸Š, å°±æ˜¯è·¨åŸŸå¯¼è‡´çš„åŸå› ä»¥åŠè§£å†³æ–¹æ¡ˆçš„å¤§è‡´æ€»ç»“.\n\nCreated on 2018-4-2 by Cara","source":"_posts/è·¨åŸŸ.md","raw":"---\ntitle: è·¨åŸŸ\ndate: 2018-04-02 17:01:24\ntags:\n- JavaScript\ncategories: \n- å¤ä¹ \n---\nè·¨åŸŸè¿™å—æ˜¯å‰åç«¯åˆ†ç¦»å¿…ç»çš„ä¸€æ¡è·¯, è¿™æ¬¡å¥½å¥½æ•´ç†ä¸€ä¸‹å…³äºè·¨åŸŸæ–¹é¢çŸ¥è¯†.\n\n### ä»€ä¹ˆæ˜¯è·¨åŸŸ?\nè·¨åŸŸæ˜¯å—åŒæºç­–ç•¥çš„å½±å“è€Œå¯¼è‡´çš„, æŒ‡ä¸€ä¸ªæºä¸‹çš„èµ„æºè¯•å›¾æ“ä½œå¦ä¸€ä¸ªæºä¸‹çš„èµ„æº.\n\n> é‚£ä¹ˆ, ä»€ä¹ˆåˆæ˜¯åŒæºç­–ç•¥å‘¢?\n> å°±æ˜¯é™åˆ¶ä»ä¸€ä¸ªæºçš„èµ„æºå¦‚ä½•ä¸å¦ä¸€ä¸ªæºçš„èµ„æºäº¤äº’, ç”¨äºéš”ç¦»æ½œåœ¨çš„æ¶æ„æ–‡ä»¶, ä¿è¯æ–‡ä»¶çš„å®‰å…¨æ€§. æ‰€è°“çš„åŒæºæ˜¯æŒ‡: åè®®/åŸŸå/ç«¯å£ ä¸‰è€…ç›¸åŒ, å³ä½¿ä¸¤ä¸ªä¸åŒçš„åŸŸåæŒ‡å‘åŒä¸€ä¸ª IP åœ°å€, ä¹ŸéåŒæº. å¦‚æœæ²¡æœ‰åŒæºç­–ç•¥, æµè§ˆå™¨å¾ˆå®¹æ˜“å—åˆ° XSS/CSRF ç­‰çš„æ”»å‡»(XSS: è·¨ç«™è„šæœ¬æ”»å‡»;CSRF: è·¨ç«™è¯·æ±‚ä¼ªé€ ).\n\nåŒæºç­–ç•¥å°†é™åˆ¶ä»¥ä¸‹è¡Œä¸º:\n- Cookie/LocalStorage/IndexDB\n- DOM æ— æ³•è·å¾—\n- Ajax è¯·æ±‚æ— æ³•å‘é€\n\n### è·¨åŸŸè§£å†³æ–¹æ¡ˆ\n\n#### 1. JSONP\nå®ƒçš„ç‰¹æ€§æ˜¯ç®€å•/ å…¼å®¹æ€§å¥½/ æ”¹é€ å°, ä½†æ˜¯ä¸æ”¯æŒ POST è¯·æ±‚. åŸç†æ˜¯é€šè¿‡ `script` æ ‡ç­¾æ”¾å…¥å›è°ƒå‡½æ•°, æœåŠ¡ç«¯å°†è¿”å›æ•°æ®å¡å…¥å›è°ƒå‡½æ•°å³å¯.\n\n```js\nconst createScript = url => {\n    let script = document.createElement('script')\n    script.type = 'text/javascript'\n    script.src = url\n    document.body.appendChild(script)\n}\n\n// ä¼ å…¥è¯·æ±‚åœ°å€\ncreateScript('http://www.example.com/api?callback=foo')\n\n// å›è°ƒå‡½æ•°\nfunction foo (data) {\n    // æœåŠ¡ç«¯è¿”å›æ•°æ®\n    console.log(data)\n}\n```\n\n#### 2. document.domain\né€šè¿‡è®¾ç½®åŸŸåæ¥è®¿é—® `Cookie` å’Œ æ“ä½œ `iframe` çª—å£, æ­¤æ–¹æ¡ˆåªé€‚ç”¨äºä¸»åŸŸç›¸åŒ, å­åŸŸä¸åŒçš„åœºæ™¯.\n\n```html\n// çˆ¶çª—å£ (http://www.main.com/a.html)\n<iframe id='iframe' src='http://www.child.main.com/b.html'></iframe>\n<script>\n    document.domain = 'main.com'\n    document.cookie = 'test=hi'\n    var user = 'admin'\n</script>\n\n\n// å­çª—å£ (http://www.child.main.com/b.html)\n<script>\n    document.domain = 'example.com'\n    let parentMessage = document.cookie\n    console.log(window.parent.user)\n</script>\n```\n\n#### 3. window.location.hash\né€šè¿‡ä¿®æ”¹ hash å€¼æ¥ä¼ é€’å‚æ•°, ä¿®æ”¹ hash å€¼å¹¶ä¸ä¼šåˆ·æ–°é¡µé¢ä½†å­—èŠ‚æ•°æœ‰é™åˆ¶.\n\n```js\n// çˆ¶çª—å£å‘å­çª—å£å†™å…¥ hash\nlet src = `${childUrl}#test=hi`\ndocument.querySelector('#iframe').src = src\n\n// å­çª—å£\n// æ¥æ”¶æ¶ˆæ¯\nwindow.onhashchange = () => {\n    let meg = window.location.hash\n}\n// å­çª—å£å‘çˆ¶çª—å£å†™å…¥ hash\nwindow.parent.href = `${window.parent.href}#world`\n```\n\n#### 4. window.name\nwindow.name åªè¦åœ¨åŒä¸€ä¸ªçª—å£, æ— è®ºæ˜¯å¦åŒæºå‰ä¸€ä¸ªé¡µé¢è®¾ç½®äº†è¿™ä¸ªå±æ€§, åä¸€ä¸ªé¡µé¢å°±èƒ½è¯»å–. å®ƒå¯ä»¥æ”¯æŒ2M å¤§å°çš„å€¼ä½†æ˜¯å˜åŒ–éœ€è¦è‡ªå·±ç›‘å¬.\n\n```js\n// çˆ¶çª—å£ (http://www.main.com/a.html)\nconst proxy = (url, callback) => {\n    const iframe = document.createElement('iframe')\n    let state = 0\n\n    // è·³è½¬åˆ°è·¨åŸŸé¡µé¢\n    iframe.src = url\n\n    iframe.onload = () => {\n        if (state === 1) {\n            // ç¬¬äºŒæ¬¡ä»£ç†ä¹ŸåŠ è½½æˆåŠŸä¹‹å, è¯»å– name å±æ€§\n            callback(window.name)\n            document.body.removeChild(iframe);\n        } else if (state === 0) {\n            //  ç¬¬ä¸€æ¬¡è·³è½¬åˆ°ä»£ç†é¡µé¢\n            iframe.src = 'http://www.main.com/proxy.html'\n            state = 1\n        }\n    }\n    document.body.appendChild(iframe)\n}\n\n// ä¼ å…¥è·¨åŸŸé¡µé¢ URL\nproxy('http://www.child.com/b.html', (name) => {\n    console.log(name) // 'This message from b.html'\n})\n\n// è·¨åŸŸå­çª—å£ (http://www.child.com/b.html) \n// è®¾ç½® name å±æ€§\nwindow.name = 'This message from b.html'\n```\n\n#### 5. postMessage\npostMessage(è·¨æ–‡æ¡£é€šä¿¡) æ˜¯ HTML5 ä¸­ä¸ºäº†è§£å†³è·¨åŸŸå‡ºçš„ API, å¯ä»¥è§£å†³ä»¥ä¸‹å‡ ç§é—®é¢˜:\n\n1. é¡µé¢å’Œå…¶æ‰“å¼€çš„æ–°çª—å£çš„æ•°æ®ä¼ é€’\n2. å¤šçª—å£ä¹‹é—´æ¶ˆæ¯ä¼ é€’\n3. é¡µé¢ä¸åµŒå¥—çš„iframeæ¶ˆæ¯ä¼ é€’\n4. ä¸Šé¢ä¸‰ä¸ªåœºæ™¯çš„è·¨åŸŸæ•°æ®ä¼ é€’\n\nå‘é€æ¶ˆæ¯é€šè¿‡ `postMessage(data, origin)` æ–¹æ³•, è¯¥æ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‚æ•°: \n- data: éœ€è¦ä¼ é€’çš„å‚æ•°, ç”±äºéƒ¨åˆ†æµè§ˆå™¨åªæ”¯æŒå­—ç¬¦ä¸², æ‰€ä»¥ä¼ é€’ä¹‹å‰æœ€å¥½å…ˆ `JSON.stringify()` åºåˆ—åŒ–\n- origin: æ˜¯æ¥æ”¶æ–¹çš„ åè®® + ä¸»æœº + ç«¯å£, å¯ä»¥æ˜¯è®¾ç½®ä¸º `*`, æŒ‡å®šä¸å½“å‰çª—å£åŒæºçš„è¯è®¾ç½®ä¸º `/`.\n\næ¥æ”¶æ¶ˆæ¯é€šè¿‡ `message` äº‹ä»¶ç›‘å¬, è¯¥äº‹ä»¶æœ‰ä¸€ä¸ª `event` å‚æ•°æä¾›ä¸‰ä¸ªå±æ€§:\n- event.origin: æ¶ˆæ¯æ¥æ”¶æ–¹\n- event.source: æ¶ˆæ¯æ¥æº\n- event.data: æ¶ˆæ¯ä½“\n\n```html\n// çˆ¶çª—å£ (http://www.main.com/a.html)\n<firame id='iframe' src='http://www.child.com/b.html'></iframe>\n<script>\n    let iframe = document.querySelector('#iframe')\n    let url = iframe.src\n    iframe.onload = () => {\n        let data = {\n            name: 'parent',\n            message: 'This message from parent'\n        }\n        // è·¨åŸŸå‘å­çª—å£å‘é€æ¶ˆæ¯\n        iframe.contentWindow.postMessage(JSON.stringify(data), url)\n    }\n\n    // çˆ¶çª—å£ç›‘å¬å­çª—å£å‘é€çš„æ¶ˆæ¯\n    window.onmessage = (event) => {\n        // è¿‡æ»¤ä¸å±äºè‡ªå·±çš„æ¶ˆæ¯\n        if (data.origin !== 'http://www.main.com/a.html') return\n        console.log('data from child: ' + event.data)\n    }\n</script>\n\n// å­çª—å£ (http://www.child.com/b.html)\n<script>\n    window.onmessage = (event) => {\n        console.log('data from main: ' + event.data)\n        let data = JSON.parse(event.data)\n        data.name = 'child'\n\n        // æ”¶åˆ°æ¶ˆæ¯åå¤„ç†å†å‘é€ç»™çˆ¶çª—å£\n        window.parent.postMessage(JSON.stringify(data), 'http://www.main.com/a.html')\n    }\n</script>\n```\n\n#### 5. CORS\nè·¨åŸŸèµ„æºå…±äº«(Cross-origin-resource-sharing), å®ƒå…è®¸æµè§ˆå™¨å‘è·¨æºæœåŠ¡å™¨å‘å‡º `XMLHttpRequest` è¯·æ±‚. CORS ç°åœ¨ä¹Ÿæ˜¯ä¸»æµçš„è·¨åŸŸè§£å†³æ–¹æ¡ˆ, è¿™ç§æ–¹å¼åªéœ€è¦åç«¯åšå¤„ç†, å¦‚æœè¦å¸¦ä¸Š cookie é‚£ä¹ˆå‰åç«¯éƒ½è¦è®¾ç½®.\n\nå¸¦ cookie ä¼ è¾“:\n```js\nxhr.withCredentials = true\n```\n\nè¯·æ±‚å®ä¾‹:\n```js\nconst XMLRequest = (method = 'GET', url = '', data = null) => {\n    let xhr = null\n    if (window.XMLHttpRequest) {\n        xhr = new XMLHttpRequest()\n    } else {\n        xhr = new ActiveXObject('Microsoft.XMLHTTP')\n    }\n\n    xhr.open(method, url, true)\n    xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded')\n    xhr.send(data)\n\n    xhr.onreadystatechange = () => {\n        if (xhr.readyState === 4 && xhr.status === 200) {\n            console.log(xhr.responseText)\n        }\n    }\n}\n\nXMLRequest('POST', 'http://www.example.com/api', {\n    name: 'cara'\n})\n```\n\nå…¶ä¸­ `readyState` æœ‰äº”ç§çŠ¶æ€:\n0: ä¸ºåˆå§‹åŒ–\n1: æœåŠ¡å™¨è¿æ¥å»ºç«‹\n2: è¯·æ±‚å·²æ¥æ”¶\n3: è¯·æ±‚å¤„ç†ä¸­\n4: è¯·æ±‚å·²å®Œæˆ\n\n#### 6. ä»£ç†æœåŠ¡å™¨\nå…¶å®å°±æ˜¯é€šè¿‡é…ç½® nginx å®ç°ä¸€ä¸ªä¸­é—´æœåŠ¡å™¨ä½œè·³æ¿, ä»£ç†åˆ°ç›®æ ‡æœåŠ¡å™¨.\n\né™æ€èµ„æºä»£ç†\n```config\nlocation / {\n    add_header Access-Control-Allow-Origin *;\n}\n```\n\nå…·ä½“ä»£ç†é…ç½®\n```config\nserver {\n    listen 81;\n    server_name www.example.com;\n\n    lication / {\n        # åå‘ä»£ç†\n        proxy_pass http://www.example2.com:8080;\n        # ä¿®æ”¹ cookie åŸŸå\n        proxy_cookie_domain www.example2.com www.example.com;\n        index index.html index.htm;\n\n        # ä¸å¸¦ cookie æ—¶æ‰èƒ½è®¾ç½®ä¸º *\n        add_header Access-Control-Allow-Origin http://www.example.com;\n        add_header Access-Control-Allow-Credentials true;\n    }\n}\n```\n\nè°ƒç”¨ç¤ºä¾‹\n```js\nlet xhr = new XMLHttpRequest()\n\nxhr.withCredentials = true\nxhr.open('GET', 'htt://www.example.com:81/?user=admin', true)\nxhr.send(null)\n```\n\nä»¥ä¸Š, å°±æ˜¯è·¨åŸŸå¯¼è‡´çš„åŸå› ä»¥åŠè§£å†³æ–¹æ¡ˆçš„å¤§è‡´æ€»ç»“.\n\nCreated on 2018-4-2 by Cara","slug":"è·¨åŸŸ","published":1,"updated":"2018-05-05T09:23:03.681Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjgurolt0001uklu0ol9onrig","content":"<p>è·¨åŸŸè¿™å—æ˜¯å‰åç«¯åˆ†ç¦»å¿…ç»çš„ä¸€æ¡è·¯, è¿™æ¬¡å¥½å¥½æ•´ç†ä¸€ä¸‹å…³äºè·¨åŸŸæ–¹é¢çŸ¥è¯†.</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯è·¨åŸŸ\"><a href=\"#ä»€ä¹ˆæ˜¯è·¨åŸŸ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯è·¨åŸŸ?\"></a>ä»€ä¹ˆæ˜¯è·¨åŸŸ?</h3><p>è·¨åŸŸæ˜¯å—åŒæºç­–ç•¥çš„å½±å“è€Œå¯¼è‡´çš„, æŒ‡ä¸€ä¸ªæºä¸‹çš„èµ„æºè¯•å›¾æ“ä½œå¦ä¸€ä¸ªæºä¸‹çš„èµ„æº.</p>\n<blockquote>\n<p>é‚£ä¹ˆ, ä»€ä¹ˆåˆæ˜¯åŒæºç­–ç•¥å‘¢?<br>å°±æ˜¯é™åˆ¶ä»ä¸€ä¸ªæºçš„èµ„æºå¦‚ä½•ä¸å¦ä¸€ä¸ªæºçš„èµ„æºäº¤äº’, ç”¨äºéš”ç¦»æ½œåœ¨çš„æ¶æ„æ–‡ä»¶, ä¿è¯æ–‡ä»¶çš„å®‰å…¨æ€§. æ‰€è°“çš„åŒæºæ˜¯æŒ‡: åè®®/åŸŸå/ç«¯å£ ä¸‰è€…ç›¸åŒ, å³ä½¿ä¸¤ä¸ªä¸åŒçš„åŸŸåæŒ‡å‘åŒä¸€ä¸ª IP åœ°å€, ä¹ŸéåŒæº. å¦‚æœæ²¡æœ‰åŒæºç­–ç•¥, æµè§ˆå™¨å¾ˆå®¹æ˜“å—åˆ° XSS/CSRF ç­‰çš„æ”»å‡»(XSS: è·¨ç«™è„šæœ¬æ”»å‡»;CSRF: è·¨ç«™è¯·æ±‚ä¼ªé€ ).</p>\n</blockquote>\n<p>åŒæºç­–ç•¥å°†é™åˆ¶ä»¥ä¸‹è¡Œä¸º:</p>\n<ul>\n<li>Cookie/LocalStorage/IndexDB</li>\n<li>DOM æ— æ³•è·å¾—</li>\n<li>Ajax è¯·æ±‚æ— æ³•å‘é€</li>\n</ul>\n<h3 id=\"è·¨åŸŸè§£å†³æ–¹æ¡ˆ\"><a href=\"#è·¨åŸŸè§£å†³æ–¹æ¡ˆ\" class=\"headerlink\" title=\"è·¨åŸŸè§£å†³æ–¹æ¡ˆ\"></a>è·¨åŸŸè§£å†³æ–¹æ¡ˆ</h3><h4 id=\"1-JSONP\"><a href=\"#1-JSONP\" class=\"headerlink\" title=\"1. JSONP\"></a>1. JSONP</h4><p>å®ƒçš„ç‰¹æ€§æ˜¯ç®€å•/ å…¼å®¹æ€§å¥½/ æ”¹é€ å°, ä½†æ˜¯ä¸æ”¯æŒ POST è¯·æ±‚. åŸç†æ˜¯é€šè¿‡ <code>script</code> æ ‡ç­¾æ”¾å…¥å›è°ƒå‡½æ•°, æœåŠ¡ç«¯å°†è¿”å›æ•°æ®å¡å…¥å›è°ƒå‡½æ•°å³å¯.</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> createScript = <span class=\"function\"><span class=\"params\">url</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> script = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">'script'</span>)</span><br><span class=\"line\">    script.type = <span class=\"string\">'text/javascript'</span></span><br><span class=\"line\">    script.src = url</span><br><span class=\"line\">    <span class=\"built_in\">document</span>.body.appendChild(script)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ä¼ å…¥è¯·æ±‚åœ°å€</span></span><br><span class=\"line\">createScript(<span class=\"string\">'http://www.example.com/api?callback=foo'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å›è°ƒå‡½æ•°</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">foo</span> (<span class=\"params\">data</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// æœåŠ¡ç«¯è¿”å›æ•°æ®</span></span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(data)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"2-document-domain\"><a href=\"#2-document-domain\" class=\"headerlink\" title=\"2. document.domain\"></a>2. document.domain</h4><p>é€šè¿‡è®¾ç½®åŸŸåæ¥è®¿é—® <code>Cookie</code> å’Œ æ“ä½œ <code>iframe</code> çª—å£, æ­¤æ–¹æ¡ˆåªé€‚ç”¨äºä¸»åŸŸç›¸åŒ, å­åŸŸä¸åŒçš„åœºæ™¯.</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// çˆ¶çª—å£ (http://www.main.com/a.html)</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">iframe</span> <span class=\"attr\">id</span>=<span class=\"string\">'iframe'</span> <span class=\"attr\">src</span>=<span class=\"string\">'http://www.child.main.com/b.html'</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">iframe</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"built_in\">document</span>.domain = <span class=\"string\">'main.com'</span></span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"built_in\">document</span>.cookie = <span class=\"string\">'test=hi'</span></span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"keyword\">var</span> user = <span class=\"string\">'admin'</span></span></span><br><span class=\"line\"><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">// å­çª—å£ (http://www.child.main.com/b.html)</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"built_in\">document</span>.domain = <span class=\"string\">'example.com'</span></span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"keyword\">let</span> parentMessage = <span class=\"built_in\">document</span>.cookie</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"built_in\">console</span>.log(<span class=\"built_in\">window</span>.parent.user)</span></span><br><span class=\"line\"><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"3-window-location-hash\"><a href=\"#3-window-location-hash\" class=\"headerlink\" title=\"3. window.location.hash\"></a>3. window.location.hash</h4><p>é€šè¿‡ä¿®æ”¹ hash å€¼æ¥ä¼ é€’å‚æ•°, ä¿®æ”¹ hash å€¼å¹¶ä¸ä¼šåˆ·æ–°é¡µé¢ä½†å­—èŠ‚æ•°æœ‰é™åˆ¶.</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// çˆ¶çª—å£å‘å­çª—å£å†™å…¥ hash</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> src = <span class=\"string\">`<span class=\"subst\">$&#123;childUrl&#125;</span>#test=hi`</span></span><br><span class=\"line\"><span class=\"built_in\">document</span>.querySelector(<span class=\"string\">'#iframe'</span>).src = src</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å­çª—å£</span></span><br><span class=\"line\"><span class=\"comment\">// æ¥æ”¶æ¶ˆæ¯</span></span><br><span class=\"line\"><span class=\"built_in\">window</span>.onhashchange = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> meg = <span class=\"built_in\">window</span>.location.hash</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// å­çª—å£å‘çˆ¶çª—å£å†™å…¥ hash</span></span><br><span class=\"line\"><span class=\"built_in\">window</span>.parent.href = <span class=\"string\">`<span class=\"subst\">$&#123;<span class=\"built_in\">window</span>.parent.href&#125;</span>#world`</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"4-window-name\"><a href=\"#4-window-name\" class=\"headerlink\" title=\"4. window.name\"></a>4. window.name</h4><p>window.name åªè¦åœ¨åŒä¸€ä¸ªçª—å£, æ— è®ºæ˜¯å¦åŒæºå‰ä¸€ä¸ªé¡µé¢è®¾ç½®äº†è¿™ä¸ªå±æ€§, åä¸€ä¸ªé¡µé¢å°±èƒ½è¯»å–. å®ƒå¯ä»¥æ”¯æŒ2M å¤§å°çš„å€¼ä½†æ˜¯å˜åŒ–éœ€è¦è‡ªå·±ç›‘å¬.</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// çˆ¶çª—å£ (http://www.main.com/a.html)</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> proxy = <span class=\"function\">(<span class=\"params\">url, callback</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> iframe = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">'iframe'</span>)</span><br><span class=\"line\">    <span class=\"keyword\">let</span> state = <span class=\"number\">0</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// è·³è½¬åˆ°è·¨åŸŸé¡µé¢</span></span><br><span class=\"line\">    iframe.src = url</span><br><span class=\"line\"></span><br><span class=\"line\">    iframe.onload = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (state === <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// ç¬¬äºŒæ¬¡ä»£ç†ä¹ŸåŠ è½½æˆåŠŸä¹‹å, è¯»å– name å±æ€§</span></span><br><span class=\"line\">            callback(<span class=\"built_in\">window</span>.name)</span><br><span class=\"line\">            <span class=\"built_in\">document</span>.body.removeChild(iframe);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (state === <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">//  ç¬¬ä¸€æ¬¡è·³è½¬åˆ°ä»£ç†é¡µé¢</span></span><br><span class=\"line\">            iframe.src = <span class=\"string\">'http://www.main.com/proxy.html'</span></span><br><span class=\"line\">            state = <span class=\"number\">1</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">document</span>.body.appendChild(iframe)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ä¼ å…¥è·¨åŸŸé¡µé¢ URL</span></span><br><span class=\"line\">proxy(<span class=\"string\">'http://www.child.com/b.html'</span>, (name) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(name) <span class=\"comment\">// 'This message from b.html'</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// è·¨åŸŸå­çª—å£ (http://www.child.com/b.html) </span></span><br><span class=\"line\"><span class=\"comment\">// è®¾ç½® name å±æ€§</span></span><br><span class=\"line\"><span class=\"built_in\">window</span>.name = <span class=\"string\">'This message from b.html'</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"5-postMessage\"><a href=\"#5-postMessage\" class=\"headerlink\" title=\"5. postMessage\"></a>5. postMessage</h4><p>postMessage(è·¨æ–‡æ¡£é€šä¿¡) æ˜¯ HTML5 ä¸­ä¸ºäº†è§£å†³è·¨åŸŸå‡ºçš„ API, å¯ä»¥è§£å†³ä»¥ä¸‹å‡ ç§é—®é¢˜:</p>\n<ol>\n<li>é¡µé¢å’Œå…¶æ‰“å¼€çš„æ–°çª—å£çš„æ•°æ®ä¼ é€’</li>\n<li>å¤šçª—å£ä¹‹é—´æ¶ˆæ¯ä¼ é€’</li>\n<li>é¡µé¢ä¸åµŒå¥—çš„iframeæ¶ˆæ¯ä¼ é€’</li>\n<li>ä¸Šé¢ä¸‰ä¸ªåœºæ™¯çš„è·¨åŸŸæ•°æ®ä¼ é€’</li>\n</ol>\n<p>å‘é€æ¶ˆæ¯é€šè¿‡ <code>postMessage(data, origin)</code> æ–¹æ³•, è¯¥æ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‚æ•°: </p>\n<ul>\n<li>data: éœ€è¦ä¼ é€’çš„å‚æ•°, ç”±äºéƒ¨åˆ†æµè§ˆå™¨åªæ”¯æŒå­—ç¬¦ä¸², æ‰€ä»¥ä¼ é€’ä¹‹å‰æœ€å¥½å…ˆ <code>JSON.stringify()</code> åºåˆ—åŒ–</li>\n<li>origin: æ˜¯æ¥æ”¶æ–¹çš„ åè®® + ä¸»æœº + ç«¯å£, å¯ä»¥æ˜¯è®¾ç½®ä¸º <code>*</code>, æŒ‡å®šä¸å½“å‰çª—å£åŒæºçš„è¯è®¾ç½®ä¸º <code>/</code>.</li>\n</ul>\n<p>æ¥æ”¶æ¶ˆæ¯é€šè¿‡ <code>message</code> äº‹ä»¶ç›‘å¬, è¯¥äº‹ä»¶æœ‰ä¸€ä¸ª <code>event</code> å‚æ•°æä¾›ä¸‰ä¸ªå±æ€§:</p>\n<ul>\n<li>event.origin: æ¶ˆæ¯æ¥æ”¶æ–¹</li>\n<li>event.source: æ¶ˆæ¯æ¥æº</li>\n<li>event.data: æ¶ˆæ¯ä½“</li>\n</ul>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// çˆ¶çª—å£ (http://www.main.com/a.html)</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">firame</span> <span class=\"attr\">id</span>=<span class=\"string\">'iframe'</span> <span class=\"attr\">src</span>=<span class=\"string\">'http://www.child.com/b.html'</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">iframe</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"keyword\">let</span> iframe = <span class=\"built_in\">document</span>.querySelector(<span class=\"string\">'#iframe'</span>)</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"keyword\">let</span> url = iframe.src</span></span><br><span class=\"line\"><span class=\"javascript\">    iframe.onload = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"keyword\">let</span> data = &#123;</span></span><br><span class=\"line\"><span class=\"javascript\">            name: <span class=\"string\">'parent'</span>,</span></span><br><span class=\"line\"><span class=\"javascript\">            message: <span class=\"string\">'This message from parent'</span></span></span><br><span class=\"line\"><span class=\"undefined\">        &#125;</span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">// è·¨åŸŸå‘å­çª—å£å‘é€æ¶ˆæ¯</span></span></span><br><span class=\"line\"><span class=\"javascript\">        iframe.contentWindow.postMessage(<span class=\"built_in\">JSON</span>.stringify(data), url)</span></span><br><span class=\"line\"><span class=\"undefined\">    &#125;</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"comment\">// çˆ¶çª—å£ç›‘å¬å­çª—å£å‘é€çš„æ¶ˆæ¯</span></span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"built_in\">window</span>.onmessage = <span class=\"function\">(<span class=\"params\">event</span>) =&gt;</span> &#123;</span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">// è¿‡æ»¤ä¸å±äºè‡ªå·±çš„æ¶ˆæ¯</span></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"keyword\">if</span> (data.origin !== <span class=\"string\">'http://www.main.com/a.html'</span>) <span class=\"keyword\">return</span></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"built_in\">console</span>.log(<span class=\"string\">'data from child: '</span> + event.data)</span></span><br><span class=\"line\"><span class=\"undefined\">    &#125;</span></span><br><span class=\"line\"><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">// å­çª—å£ (http://www.child.com/b.html)</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"built_in\">window</span>.onmessage = <span class=\"function\">(<span class=\"params\">event</span>) =&gt;</span> &#123;</span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"built_in\">console</span>.log(<span class=\"string\">'data from main: '</span> + event.data)</span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"keyword\">let</span> data = <span class=\"built_in\">JSON</span>.parse(event.data)</span></span><br><span class=\"line\"><span class=\"javascript\">        data.name = <span class=\"string\">'child'</span></span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">// æ”¶åˆ°æ¶ˆæ¯åå¤„ç†å†å‘é€ç»™çˆ¶çª—å£</span></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"built_in\">window</span>.parent.postMessage(<span class=\"built_in\">JSON</span>.stringify(data), <span class=\"string\">'http://www.main.com/a.html'</span>)</span></span><br><span class=\"line\"><span class=\"undefined\">    &#125;</span></span><br><span class=\"line\"><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"5-CORS\"><a href=\"#5-CORS\" class=\"headerlink\" title=\"5. CORS\"></a>5. CORS</h4><p>è·¨åŸŸèµ„æºå…±äº«(Cross-origin-resource-sharing), å®ƒå…è®¸æµè§ˆå™¨å‘è·¨æºæœåŠ¡å™¨å‘å‡º <code>XMLHttpRequest</code> è¯·æ±‚. CORS ç°åœ¨ä¹Ÿæ˜¯ä¸»æµçš„è·¨åŸŸè§£å†³æ–¹æ¡ˆ, è¿™ç§æ–¹å¼åªéœ€è¦åç«¯åšå¤„ç†, å¦‚æœè¦å¸¦ä¸Š cookie é‚£ä¹ˆå‰åç«¯éƒ½è¦è®¾ç½®.</p>\n<p>å¸¦ cookie ä¼ è¾“:<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">xhr.withCredentials = <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure></p>\n<p>è¯·æ±‚å®ä¾‹:<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> XMLRequest = <span class=\"function\">(<span class=\"params\">method = <span class=\"string\">'GET'</span>, url = <span class=\"string\">''</span>, data = <span class=\"literal\">null</span></span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> xhr = <span class=\"literal\">null</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">window</span>.XMLHttpRequest) &#123;</span><br><span class=\"line\">        xhr = <span class=\"keyword\">new</span> XMLHttpRequest()</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        xhr = <span class=\"keyword\">new</span> ActiveXObject(<span class=\"string\">'Microsoft.XMLHTTP'</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    xhr.open(method, url, <span class=\"literal\">true</span>)</span><br><span class=\"line\">    xhr.setRequestHeader(<span class=\"string\">'Content-Type'</span>, <span class=\"string\">'application/x-www-form-urlencoded'</span>)</span><br><span class=\"line\">    xhr.send(data)</span><br><span class=\"line\"></span><br><span class=\"line\">    xhr.onreadystatechange = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (xhr.readyState === <span class=\"number\">4</span> &amp;&amp; xhr.status === <span class=\"number\">200</span>) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">console</span>.log(xhr.responseText)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">XMLRequest(<span class=\"string\">'POST'</span>, <span class=\"string\">'http://www.example.com/api'</span>, &#123;</span><br><span class=\"line\">    name: <span class=\"string\">'cara'</span></span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure></p>\n<p>å…¶ä¸­ <code>readyState</code> æœ‰äº”ç§çŠ¶æ€:<br>0: ä¸ºåˆå§‹åŒ–<br>1: æœåŠ¡å™¨è¿æ¥å»ºç«‹<br>2: è¯·æ±‚å·²æ¥æ”¶<br>3: è¯·æ±‚å¤„ç†ä¸­<br>4: è¯·æ±‚å·²å®Œæˆ</p>\n<h4 id=\"6-ä»£ç†æœåŠ¡å™¨\"><a href=\"#6-ä»£ç†æœåŠ¡å™¨\" class=\"headerlink\" title=\"6. ä»£ç†æœåŠ¡å™¨\"></a>6. ä»£ç†æœåŠ¡å™¨</h4><p>å…¶å®å°±æ˜¯é€šè¿‡é…ç½® nginx å®ç°ä¸€ä¸ªä¸­é—´æœåŠ¡å™¨ä½œè·³æ¿, ä»£ç†åˆ°ç›®æ ‡æœåŠ¡å™¨.</p>\n<p>é™æ€èµ„æºä»£ç†<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">location / &#123;</span><br><span class=\"line\">    add_header Access-Control-Allow-Origin *;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>å…·ä½“ä»£ç†é…ç½®<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server &#123;</span><br><span class=\"line\">    listen 81;</span><br><span class=\"line\">    server_name www.example.com;</span><br><span class=\"line\"></span><br><span class=\"line\">    lication / &#123;</span><br><span class=\"line\">        # åå‘ä»£ç†</span><br><span class=\"line\">        proxy_pass http://www.example2.com:8080;</span><br><span class=\"line\">        # ä¿®æ”¹ cookie åŸŸå</span><br><span class=\"line\">        proxy_cookie_domain www.example2.com www.example.com;</span><br><span class=\"line\">        index index.html index.htm;</span><br><span class=\"line\"></span><br><span class=\"line\">        # ä¸å¸¦ cookie æ—¶æ‰èƒ½è®¾ç½®ä¸º *</span><br><span class=\"line\">        add_header Access-Control-Allow-Origin http://www.example.com;</span><br><span class=\"line\">        add_header Access-Control-Allow-Credentials true;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>è°ƒç”¨ç¤ºä¾‹<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> xhr = <span class=\"keyword\">new</span> XMLHttpRequest()</span><br><span class=\"line\"></span><br><span class=\"line\">xhr.withCredentials = <span class=\"literal\">true</span></span><br><span class=\"line\">xhr.open(<span class=\"string\">'GET'</span>, <span class=\"string\">'htt://www.example.com:81/?user=admin'</span>, <span class=\"literal\">true</span>)</span><br><span class=\"line\">xhr.send(<span class=\"literal\">null</span>)</span><br></pre></td></tr></table></figure></p>\n<p>ä»¥ä¸Š, å°±æ˜¯è·¨åŸŸå¯¼è‡´çš„åŸå› ä»¥åŠè§£å†³æ–¹æ¡ˆçš„å¤§è‡´æ€»ç»“.</p>\n<p>Created on 2018-4-2 by Cara</p>\n","site":{"data":{}},"excerpt":"","more":"<p>è·¨åŸŸè¿™å—æ˜¯å‰åç«¯åˆ†ç¦»å¿…ç»çš„ä¸€æ¡è·¯, è¿™æ¬¡å¥½å¥½æ•´ç†ä¸€ä¸‹å…³äºè·¨åŸŸæ–¹é¢çŸ¥è¯†.</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯è·¨åŸŸ\"><a href=\"#ä»€ä¹ˆæ˜¯è·¨åŸŸ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯è·¨åŸŸ?\"></a>ä»€ä¹ˆæ˜¯è·¨åŸŸ?</h3><p>è·¨åŸŸæ˜¯å—åŒæºç­–ç•¥çš„å½±å“è€Œå¯¼è‡´çš„, æŒ‡ä¸€ä¸ªæºä¸‹çš„èµ„æºè¯•å›¾æ“ä½œå¦ä¸€ä¸ªæºä¸‹çš„èµ„æº.</p>\n<blockquote>\n<p>é‚£ä¹ˆ, ä»€ä¹ˆåˆæ˜¯åŒæºç­–ç•¥å‘¢?<br>å°±æ˜¯é™åˆ¶ä»ä¸€ä¸ªæºçš„èµ„æºå¦‚ä½•ä¸å¦ä¸€ä¸ªæºçš„èµ„æºäº¤äº’, ç”¨äºéš”ç¦»æ½œåœ¨çš„æ¶æ„æ–‡ä»¶, ä¿è¯æ–‡ä»¶çš„å®‰å…¨æ€§. æ‰€è°“çš„åŒæºæ˜¯æŒ‡: åè®®/åŸŸå/ç«¯å£ ä¸‰è€…ç›¸åŒ, å³ä½¿ä¸¤ä¸ªä¸åŒçš„åŸŸåæŒ‡å‘åŒä¸€ä¸ª IP åœ°å€, ä¹ŸéåŒæº. å¦‚æœæ²¡æœ‰åŒæºç­–ç•¥, æµè§ˆå™¨å¾ˆå®¹æ˜“å—åˆ° XSS/CSRF ç­‰çš„æ”»å‡»(XSS: è·¨ç«™è„šæœ¬æ”»å‡»;CSRF: è·¨ç«™è¯·æ±‚ä¼ªé€ ).</p>\n</blockquote>\n<p>åŒæºç­–ç•¥å°†é™åˆ¶ä»¥ä¸‹è¡Œä¸º:</p>\n<ul>\n<li>Cookie/LocalStorage/IndexDB</li>\n<li>DOM æ— æ³•è·å¾—</li>\n<li>Ajax è¯·æ±‚æ— æ³•å‘é€</li>\n</ul>\n<h3 id=\"è·¨åŸŸè§£å†³æ–¹æ¡ˆ\"><a href=\"#è·¨åŸŸè§£å†³æ–¹æ¡ˆ\" class=\"headerlink\" title=\"è·¨åŸŸè§£å†³æ–¹æ¡ˆ\"></a>è·¨åŸŸè§£å†³æ–¹æ¡ˆ</h3><h4 id=\"1-JSONP\"><a href=\"#1-JSONP\" class=\"headerlink\" title=\"1. JSONP\"></a>1. JSONP</h4><p>å®ƒçš„ç‰¹æ€§æ˜¯ç®€å•/ å…¼å®¹æ€§å¥½/ æ”¹é€ å°, ä½†æ˜¯ä¸æ”¯æŒ POST è¯·æ±‚. åŸç†æ˜¯é€šè¿‡ <code>script</code> æ ‡ç­¾æ”¾å…¥å›è°ƒå‡½æ•°, æœåŠ¡ç«¯å°†è¿”å›æ•°æ®å¡å…¥å›è°ƒå‡½æ•°å³å¯.</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> createScript = <span class=\"function\"><span class=\"params\">url</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> script = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">'script'</span>)</span><br><span class=\"line\">    script.type = <span class=\"string\">'text/javascript'</span></span><br><span class=\"line\">    script.src = url</span><br><span class=\"line\">    <span class=\"built_in\">document</span>.body.appendChild(script)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ä¼ å…¥è¯·æ±‚åœ°å€</span></span><br><span class=\"line\">createScript(<span class=\"string\">'http://www.example.com/api?callback=foo'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å›è°ƒå‡½æ•°</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">foo</span> (<span class=\"params\">data</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// æœåŠ¡ç«¯è¿”å›æ•°æ®</span></span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(data)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"2-document-domain\"><a href=\"#2-document-domain\" class=\"headerlink\" title=\"2. document.domain\"></a>2. document.domain</h4><p>é€šè¿‡è®¾ç½®åŸŸåæ¥è®¿é—® <code>Cookie</code> å’Œ æ“ä½œ <code>iframe</code> çª—å£, æ­¤æ–¹æ¡ˆåªé€‚ç”¨äºä¸»åŸŸç›¸åŒ, å­åŸŸä¸åŒçš„åœºæ™¯.</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// çˆ¶çª—å£ (http://www.main.com/a.html)</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">iframe</span> <span class=\"attr\">id</span>=<span class=\"string\">'iframe'</span> <span class=\"attr\">src</span>=<span class=\"string\">'http://www.child.main.com/b.html'</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">iframe</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"built_in\">document</span>.domain = <span class=\"string\">'main.com'</span></span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"built_in\">document</span>.cookie = <span class=\"string\">'test=hi'</span></span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"keyword\">var</span> user = <span class=\"string\">'admin'</span></span></span><br><span class=\"line\"><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">// å­çª—å£ (http://www.child.main.com/b.html)</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"built_in\">document</span>.domain = <span class=\"string\">'example.com'</span></span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"keyword\">let</span> parentMessage = <span class=\"built_in\">document</span>.cookie</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"built_in\">console</span>.log(<span class=\"built_in\">window</span>.parent.user)</span></span><br><span class=\"line\"><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"3-window-location-hash\"><a href=\"#3-window-location-hash\" class=\"headerlink\" title=\"3. window.location.hash\"></a>3. window.location.hash</h4><p>é€šè¿‡ä¿®æ”¹ hash å€¼æ¥ä¼ é€’å‚æ•°, ä¿®æ”¹ hash å€¼å¹¶ä¸ä¼šåˆ·æ–°é¡µé¢ä½†å­—èŠ‚æ•°æœ‰é™åˆ¶.</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// çˆ¶çª—å£å‘å­çª—å£å†™å…¥ hash</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> src = <span class=\"string\">`<span class=\"subst\">$&#123;childUrl&#125;</span>#test=hi`</span></span><br><span class=\"line\"><span class=\"built_in\">document</span>.querySelector(<span class=\"string\">'#iframe'</span>).src = src</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å­çª—å£</span></span><br><span class=\"line\"><span class=\"comment\">// æ¥æ”¶æ¶ˆæ¯</span></span><br><span class=\"line\"><span class=\"built_in\">window</span>.onhashchange = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> meg = <span class=\"built_in\">window</span>.location.hash</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// å­çª—å£å‘çˆ¶çª—å£å†™å…¥ hash</span></span><br><span class=\"line\"><span class=\"built_in\">window</span>.parent.href = <span class=\"string\">`<span class=\"subst\">$&#123;<span class=\"built_in\">window</span>.parent.href&#125;</span>#world`</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"4-window-name\"><a href=\"#4-window-name\" class=\"headerlink\" title=\"4. window.name\"></a>4. window.name</h4><p>window.name åªè¦åœ¨åŒä¸€ä¸ªçª—å£, æ— è®ºæ˜¯å¦åŒæºå‰ä¸€ä¸ªé¡µé¢è®¾ç½®äº†è¿™ä¸ªå±æ€§, åä¸€ä¸ªé¡µé¢å°±èƒ½è¯»å–. å®ƒå¯ä»¥æ”¯æŒ2M å¤§å°çš„å€¼ä½†æ˜¯å˜åŒ–éœ€è¦è‡ªå·±ç›‘å¬.</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// çˆ¶çª—å£ (http://www.main.com/a.html)</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> proxy = <span class=\"function\">(<span class=\"params\">url, callback</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> iframe = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">'iframe'</span>)</span><br><span class=\"line\">    <span class=\"keyword\">let</span> state = <span class=\"number\">0</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// è·³è½¬åˆ°è·¨åŸŸé¡µé¢</span></span><br><span class=\"line\">    iframe.src = url</span><br><span class=\"line\"></span><br><span class=\"line\">    iframe.onload = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (state === <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// ç¬¬äºŒæ¬¡ä»£ç†ä¹ŸåŠ è½½æˆåŠŸä¹‹å, è¯»å– name å±æ€§</span></span><br><span class=\"line\">            callback(<span class=\"built_in\">window</span>.name)</span><br><span class=\"line\">            <span class=\"built_in\">document</span>.body.removeChild(iframe);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (state === <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">//  ç¬¬ä¸€æ¬¡è·³è½¬åˆ°ä»£ç†é¡µé¢</span></span><br><span class=\"line\">            iframe.src = <span class=\"string\">'http://www.main.com/proxy.html'</span></span><br><span class=\"line\">            state = <span class=\"number\">1</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">document</span>.body.appendChild(iframe)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ä¼ å…¥è·¨åŸŸé¡µé¢ URL</span></span><br><span class=\"line\">proxy(<span class=\"string\">'http://www.child.com/b.html'</span>, (name) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(name) <span class=\"comment\">// 'This message from b.html'</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// è·¨åŸŸå­çª—å£ (http://www.child.com/b.html) </span></span><br><span class=\"line\"><span class=\"comment\">// è®¾ç½® name å±æ€§</span></span><br><span class=\"line\"><span class=\"built_in\">window</span>.name = <span class=\"string\">'This message from b.html'</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"5-postMessage\"><a href=\"#5-postMessage\" class=\"headerlink\" title=\"5. postMessage\"></a>5. postMessage</h4><p>postMessage(è·¨æ–‡æ¡£é€šä¿¡) æ˜¯ HTML5 ä¸­ä¸ºäº†è§£å†³è·¨åŸŸå‡ºçš„ API, å¯ä»¥è§£å†³ä»¥ä¸‹å‡ ç§é—®é¢˜:</p>\n<ol>\n<li>é¡µé¢å’Œå…¶æ‰“å¼€çš„æ–°çª—å£çš„æ•°æ®ä¼ é€’</li>\n<li>å¤šçª—å£ä¹‹é—´æ¶ˆæ¯ä¼ é€’</li>\n<li>é¡µé¢ä¸åµŒå¥—çš„iframeæ¶ˆæ¯ä¼ é€’</li>\n<li>ä¸Šé¢ä¸‰ä¸ªåœºæ™¯çš„è·¨åŸŸæ•°æ®ä¼ é€’</li>\n</ol>\n<p>å‘é€æ¶ˆæ¯é€šè¿‡ <code>postMessage(data, origin)</code> æ–¹æ³•, è¯¥æ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‚æ•°: </p>\n<ul>\n<li>data: éœ€è¦ä¼ é€’çš„å‚æ•°, ç”±äºéƒ¨åˆ†æµè§ˆå™¨åªæ”¯æŒå­—ç¬¦ä¸², æ‰€ä»¥ä¼ é€’ä¹‹å‰æœ€å¥½å…ˆ <code>JSON.stringify()</code> åºåˆ—åŒ–</li>\n<li>origin: æ˜¯æ¥æ”¶æ–¹çš„ åè®® + ä¸»æœº + ç«¯å£, å¯ä»¥æ˜¯è®¾ç½®ä¸º <code>*</code>, æŒ‡å®šä¸å½“å‰çª—å£åŒæºçš„è¯è®¾ç½®ä¸º <code>/</code>.</li>\n</ul>\n<p>æ¥æ”¶æ¶ˆæ¯é€šè¿‡ <code>message</code> äº‹ä»¶ç›‘å¬, è¯¥äº‹ä»¶æœ‰ä¸€ä¸ª <code>event</code> å‚æ•°æä¾›ä¸‰ä¸ªå±æ€§:</p>\n<ul>\n<li>event.origin: æ¶ˆæ¯æ¥æ”¶æ–¹</li>\n<li>event.source: æ¶ˆæ¯æ¥æº</li>\n<li>event.data: æ¶ˆæ¯ä½“</li>\n</ul>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// çˆ¶çª—å£ (http://www.main.com/a.html)</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">firame</span> <span class=\"attr\">id</span>=<span class=\"string\">'iframe'</span> <span class=\"attr\">src</span>=<span class=\"string\">'http://www.child.com/b.html'</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">iframe</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"keyword\">let</span> iframe = <span class=\"built_in\">document</span>.querySelector(<span class=\"string\">'#iframe'</span>)</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"keyword\">let</span> url = iframe.src</span></span><br><span class=\"line\"><span class=\"javascript\">    iframe.onload = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"keyword\">let</span> data = &#123;</span></span><br><span class=\"line\"><span class=\"javascript\">            name: <span class=\"string\">'parent'</span>,</span></span><br><span class=\"line\"><span class=\"javascript\">            message: <span class=\"string\">'This message from parent'</span></span></span><br><span class=\"line\"><span class=\"undefined\">        &#125;</span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">// è·¨åŸŸå‘å­çª—å£å‘é€æ¶ˆæ¯</span></span></span><br><span class=\"line\"><span class=\"javascript\">        iframe.contentWindow.postMessage(<span class=\"built_in\">JSON</span>.stringify(data), url)</span></span><br><span class=\"line\"><span class=\"undefined\">    &#125;</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"comment\">// çˆ¶çª—å£ç›‘å¬å­çª—å£å‘é€çš„æ¶ˆæ¯</span></span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"built_in\">window</span>.onmessage = <span class=\"function\">(<span class=\"params\">event</span>) =&gt;</span> &#123;</span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">// è¿‡æ»¤ä¸å±äºè‡ªå·±çš„æ¶ˆæ¯</span></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"keyword\">if</span> (data.origin !== <span class=\"string\">'http://www.main.com/a.html'</span>) <span class=\"keyword\">return</span></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"built_in\">console</span>.log(<span class=\"string\">'data from child: '</span> + event.data)</span></span><br><span class=\"line\"><span class=\"undefined\">    &#125;</span></span><br><span class=\"line\"><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">// å­çª—å£ (http://www.child.com/b.html)</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"built_in\">window</span>.onmessage = <span class=\"function\">(<span class=\"params\">event</span>) =&gt;</span> &#123;</span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"built_in\">console</span>.log(<span class=\"string\">'data from main: '</span> + event.data)</span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"keyword\">let</span> data = <span class=\"built_in\">JSON</span>.parse(event.data)</span></span><br><span class=\"line\"><span class=\"javascript\">        data.name = <span class=\"string\">'child'</span></span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">// æ”¶åˆ°æ¶ˆæ¯åå¤„ç†å†å‘é€ç»™çˆ¶çª—å£</span></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"built_in\">window</span>.parent.postMessage(<span class=\"built_in\">JSON</span>.stringify(data), <span class=\"string\">'http://www.main.com/a.html'</span>)</span></span><br><span class=\"line\"><span class=\"undefined\">    &#125;</span></span><br><span class=\"line\"><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"5-CORS\"><a href=\"#5-CORS\" class=\"headerlink\" title=\"5. CORS\"></a>5. CORS</h4><p>è·¨åŸŸèµ„æºå…±äº«(Cross-origin-resource-sharing), å®ƒå…è®¸æµè§ˆå™¨å‘è·¨æºæœåŠ¡å™¨å‘å‡º <code>XMLHttpRequest</code> è¯·æ±‚. CORS ç°åœ¨ä¹Ÿæ˜¯ä¸»æµçš„è·¨åŸŸè§£å†³æ–¹æ¡ˆ, è¿™ç§æ–¹å¼åªéœ€è¦åç«¯åšå¤„ç†, å¦‚æœè¦å¸¦ä¸Š cookie é‚£ä¹ˆå‰åç«¯éƒ½è¦è®¾ç½®.</p>\n<p>å¸¦ cookie ä¼ è¾“:<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">xhr.withCredentials = <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure></p>\n<p>è¯·æ±‚å®ä¾‹:<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> XMLRequest = <span class=\"function\">(<span class=\"params\">method = <span class=\"string\">'GET'</span>, url = <span class=\"string\">''</span>, data = <span class=\"literal\">null</span></span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> xhr = <span class=\"literal\">null</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">window</span>.XMLHttpRequest) &#123;</span><br><span class=\"line\">        xhr = <span class=\"keyword\">new</span> XMLHttpRequest()</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        xhr = <span class=\"keyword\">new</span> ActiveXObject(<span class=\"string\">'Microsoft.XMLHTTP'</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    xhr.open(method, url, <span class=\"literal\">true</span>)</span><br><span class=\"line\">    xhr.setRequestHeader(<span class=\"string\">'Content-Type'</span>, <span class=\"string\">'application/x-www-form-urlencoded'</span>)</span><br><span class=\"line\">    xhr.send(data)</span><br><span class=\"line\"></span><br><span class=\"line\">    xhr.onreadystatechange = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (xhr.readyState === <span class=\"number\">4</span> &amp;&amp; xhr.status === <span class=\"number\">200</span>) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">console</span>.log(xhr.responseText)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">XMLRequest(<span class=\"string\">'POST'</span>, <span class=\"string\">'http://www.example.com/api'</span>, &#123;</span><br><span class=\"line\">    name: <span class=\"string\">'cara'</span></span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure></p>\n<p>å…¶ä¸­ <code>readyState</code> æœ‰äº”ç§çŠ¶æ€:<br>0: ä¸ºåˆå§‹åŒ–<br>1: æœåŠ¡å™¨è¿æ¥å»ºç«‹<br>2: è¯·æ±‚å·²æ¥æ”¶<br>3: è¯·æ±‚å¤„ç†ä¸­<br>4: è¯·æ±‚å·²å®Œæˆ</p>\n<h4 id=\"6-ä»£ç†æœåŠ¡å™¨\"><a href=\"#6-ä»£ç†æœåŠ¡å™¨\" class=\"headerlink\" title=\"6. ä»£ç†æœåŠ¡å™¨\"></a>6. ä»£ç†æœåŠ¡å™¨</h4><p>å…¶å®å°±æ˜¯é€šè¿‡é…ç½® nginx å®ç°ä¸€ä¸ªä¸­é—´æœåŠ¡å™¨ä½œè·³æ¿, ä»£ç†åˆ°ç›®æ ‡æœåŠ¡å™¨.</p>\n<p>é™æ€èµ„æºä»£ç†<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">location / &#123;</span><br><span class=\"line\">    add_header Access-Control-Allow-Origin *;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>å…·ä½“ä»£ç†é…ç½®<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server &#123;</span><br><span class=\"line\">    listen 81;</span><br><span class=\"line\">    server_name www.example.com;</span><br><span class=\"line\"></span><br><span class=\"line\">    lication / &#123;</span><br><span class=\"line\">        # åå‘ä»£ç†</span><br><span class=\"line\">        proxy_pass http://www.example2.com:8080;</span><br><span class=\"line\">        # ä¿®æ”¹ cookie åŸŸå</span><br><span class=\"line\">        proxy_cookie_domain www.example2.com www.example.com;</span><br><span class=\"line\">        index index.html index.htm;</span><br><span class=\"line\"></span><br><span class=\"line\">        # ä¸å¸¦ cookie æ—¶æ‰èƒ½è®¾ç½®ä¸º *</span><br><span class=\"line\">        add_header Access-Control-Allow-Origin http://www.example.com;</span><br><span class=\"line\">        add_header Access-Control-Allow-Credentials true;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>è°ƒç”¨ç¤ºä¾‹<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> xhr = <span class=\"keyword\">new</span> XMLHttpRequest()</span><br><span class=\"line\"></span><br><span class=\"line\">xhr.withCredentials = <span class=\"literal\">true</span></span><br><span class=\"line\">xhr.open(<span class=\"string\">'GET'</span>, <span class=\"string\">'htt://www.example.com:81/?user=admin'</span>, <span class=\"literal\">true</span>)</span><br><span class=\"line\">xhr.send(<span class=\"literal\">null</span>)</span><br></pre></td></tr></table></figure></p>\n<p>ä»¥ä¸Š, å°±æ˜¯è·¨åŸŸå¯¼è‡´çš„åŸå› ä»¥åŠè§£å†³æ–¹æ¡ˆçš„å¤§è‡´æ€»ç»“.</p>\n<p>Created on 2018-4-2 by Cara</p>\n"},{"title":"ç½‘ç»œæ‘„åƒæœºç›´æ’­","date":"2018-05-06T06:49:04.000Z","_content":"å¯¹äºç½‘ç»œæ‘„åƒæœºåšè§†é¢‘é¢„è§ˆè¿™å—, æœ¬èº«å…¶å®æ˜¯éå¸¸é™Œç”Ÿçš„, å½“æ—¶æ¥åˆ°è¿™ä¸ªéœ€æ±‚ä¹Ÿæ˜¯ç›¸å½“çš„å¤´ç–¼(å¯¹äºå½“æ—¶ä¸€å¹´ç»éªŒä¸åˆ°çš„æˆ‘æ¥è¯´).å½“æ—¶æˆ‘ä»¬çš„åº”ç”¨åœºæ™¯æ˜¯: å¤šè·¯ç½‘ç»œæ‘„åƒæœºé€šè¿‡å±€åŸŸç½‘è¿æ¥, PC ç«¯èƒ½å¤Ÿå®æ—¶é¢„è§ˆç›‘æ§ç”»é¢å¹¶ä¸”ç”»è´¨è¾¾åˆ°720p, å»¶è¿Ÿä¸èƒ½è¶…è¿‡10ç§’, å¤šä¸ªæ‘„åƒæœºèƒ½å¤Ÿåˆ‡æ¢æŸ¥çœ‹. ç”±äºåç«¯åªæä¾›ä¸€ä¸ª RTSP çš„ç›´æ’­åè®®, æ‰€ä»¥æ‰€æœ‰çš„æ–¹æ¡ˆéƒ½æ˜¯å›´ç»•ç€ RTSP è¿™ä¸ªå…³é”®è¯. å½“æ—¶æ—¶é—´å¾ˆèµ¶æ‰€ä»¥è¦è‡ªå·±æ…¢æ…¢ç ”ç©¶æ˜¯ä¸å¯èƒ½äº†, åªèƒ½å»æ‰¾ç°æˆçš„åº“.\n\n> ç°ç›®å‰ç”¨è¿‡ä¸‰ç§æ–¹æ¡ˆ, éƒ½ä¸å®Œç¾.\n\n### æ•´ä½“æ€è·¯\nç»è¿‡ä¸€æ³¢è°ƒç ”(google)ä¹‹å, çŸ¥é“æµè§ˆå™¨å¯¹ RTSP åè®®å¹¶ä¸å‹å¥½, ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¿…é¡»è¦è‡ªå·±è½¬ç å†æä¾›ç»™æµè§ˆå™¨ä½¿ç”¨, æ‰¾åˆ°çš„è§£å†³æ€è·¯å¤§æ¦‚æ˜¯:\n\n1. è½¬ç : [FFmpeg](https://www.ffmpeg.org/) æ˜¯ä¸€ä¸ªè€ç‰Œçš„è½¬ç å·¥å…·, éå¸¸å¼ºå¤§\n2. Node.js ç”¨ä½œä¸­è½¬ç«™æ¥æ”¶å®¢æˆ·ç«¯å‘æ¥çš„æ‘„åƒæœºä¿¡æ¯åŠæ§åˆ¶ FFmpeg æ¨æµ\n3. æœ€ç»ˆå®¢æˆ·ç«¯æ¥æ”¶è§†é¢‘æµ\n\nä¸‹é¢æˆ‘è¯•è¿‡çš„ä¸‰ç§æ–¹æ¡ˆ, åŸºæœ¬ç»“æ„éƒ½å¦‚æ­¤åªæ˜¯æ¨æµçš„æ–¹å¼å’Œå®¢æˆ·ç«¯çš„æ¥æ”¶æ–¹å¼æœ‰æ‰€ä¸åŒ.\n\n### å‡†å¤‡\n\n**å®‰è£… FFmpeg è½¬ç å·¥å…·**\n\n- window å¹³å°\n\n1. [ä¸‹è½½ FFmpeg](http://ffmpeg.zeranoe.com/builds/) è§£å‹ååº”è¯¥æ˜¯å·²ç»ç¼–è¯‘å¥½çš„æ–‡ä»¶\n2. å°†è§£å‹å¥½çš„æ–‡ä»¶æ”¾å…¥ C ç›˜æ ¹ç›®å½•(ä¹Ÿå¯ä»¥è‡ªè¡Œæ”¾å…¥å…¶ä»–ç›˜ç¬¦)ä¸‹é‡å‘½åä¸º ffmpeg(æ–¹ä¾¿ä»¥åæ‰¾)\n3. è®¾ç½®ç¯å¢ƒå˜é‡, æˆ‘çš„ç”µè„‘ -> å±æ€§ -> é«˜çº§ç³»ç»Ÿè®¾ç½® -> ç¯å¢ƒå˜é‡ -> ç³»ç»Ÿå˜é‡ -> æ–°å¢, è·¯å¾„é€‰æ‹©åˆšåˆš C ç›˜ä¸‹çš„ ffmpegæ–‡ä»¶å¤¹ä¸­çš„ bin æ–‡ä»¶å¤¹\n4. æ³¨é”€æˆ–é‡å¯ç”µè„‘è®©ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ\n5. æµ‹è¯•, åœ¨ cmd ä¸­è¾“å…¥ `ffmpeg -version`,  å¦‚æœå‡ºç°ç‰ˆæœ¬å·ä¹‹ç±»çš„ä¸œè¥¿åˆ™æˆåŠŸ.\n\n- Mac å¹³å°\nMac ä¸‹å¯ä»¥ç›´æ¥é€šè¿‡ `Homebrew` å®‰è£…æœ€ä¸ºç®€å•.\n\n1. å®‰è£… `Homebrew`, åœ¨ç»ˆç«¯ä¸­è¾“å…¥ `ruby -e \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)\"`\n2. å®‰è£… FFmpeg, ç›´æ¥åœ¨ç»ˆç«¯ä¸­è¾“å…¥ `brew install ffmpeg` å³å¯\n3. æµ‹è¯•, åŒæ ·åœ¨ç»ˆç«¯ä¸­è¾“å…¥ `ffmpeg -version` æŸ¥çœ‹ç‰ˆæœ¬å·\n\n**å®‰è£… Node.js**\nè¿™ä¸ªå°±ä¸å±•å¼€è¯¦ç»†è¯´äº†, æ¯ä¸ªå‰ç«¯éƒ½æœ‰å§...\n\n### æ–¹æ¡ˆä¸€: img æ ‡ç­¾\nå½“æ—¶æƒ³åˆ°çš„ç¬¬ä¸€ç§æ–¹æ¡ˆä¹Ÿæ˜¯æœ€ç®€å•çš„æ–¹æ¡ˆ, æ˜¯å°†è§†é¢‘æµçš„æ¯ä¸€å¸§è½¬åŒ–ä¸º base64 å†é€šè¿‡åŠ¨æ€æ›¿æ¢ `<img>` çš„ src å±æ€§æ¥è¾¾åˆ°é¢„è§ˆçš„æ•ˆæœ.ä¸­é—´ç”¨åˆ°äº†[rtsp-ffmpeg](https://github.com/agsh/rtsp-ffmpeg), è¿™ä¸ªåº“çš„æ€è·¯æ˜¯é€šè¿‡ websocket å‘é€æ¯ä¸€å¸§è§†é¢‘çš„ bytes åˆ°å®¢æˆ·ç«¯, å®¢æˆ·ç«¯å¯ä»¥é€šè¿‡ `<img>` æ ‡ç­¾æ¥å±•ç¤º.\n\nç¤ºä¾‹: \n\nnode ç«¯\n```js\nconst app = require('express')()\nconst server = require('http').Server(app)\nconst io = require('socket.io')(server)\nconst rtsp = require('rtsp-ffmpeg')\n\nserver.listen(8081, () => {\n    console.log('server listening on 8081')\n})\n\n// uri ä»¥æµ·åº·æ‘„åƒæœºçš„ rtsp åè®®ä¸ºä¾‹\nlet uri = 'rtps://admin:password@ip:port/h264/ch1/sub/av_stream'\nlet stream = new rtsp.FFMpeg({\n    input: uri,\n    resolution: '1080x720',\n    quality: 3\n})\n\nstream.on('start', function () {\n    console.log('stream')\n})\n\nstream.on('stop', function () {\n    console.log('stream stopped')\n})\n\nio.on('connection', socket => {\n    const pipeStream = data => {\n        socket.emit('data', data)\n    }\n    stream.on('data', pipeStream)\n\n    // åˆ‡æ¢æ‘„åƒæœº\n    socket.on('URI', data => {\n        console.log(data)\n        uri = `rtsp://${data.userName}:${data.passWord}@${data.ip}:${data.port}/h264/ch1/sub/av_stream`\n        stream.input = uri\n\n        // é‡å¯\n        stream.restart()\n    })\n\n    socket.on('disconnect' () => {\n        stream.removeListener('data', pipeStream)\n    })\n})\n```\n\nå®¢æˆ·ç«¯\n```html\n<body>\n    <img id='img'>\n<script src='/socket.io/socket.io.js'></script>\n<script>\n\tvar io = io();\n    let img = document.querySelector('#img')\n\tio.on('data', function(data) {\n        let bytes = new Unit8Array(data)\n        img.src = 'data:image/jpeg;base64,' + base64ArrayBuffer(bytes)\n\t\t\t\n\t})\n    // byte æ•°ç»„è½¬ base64 (è¿™æ®µæ˜¯åœ¨å…¶ä»–åœ°æ–¹æŠ„çš„)\n\tfunction base64ArrayBuffer(arrayBuffer) {\n\t\tvar base64    = '';\n\t\tvar encodings = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n\t\tvar bytes         = new Uint8Array(arrayBuffer);\n\t\tvar byteLength    = bytes.byteLength;\n\t\tvar byteRemainder = byteLength % 3;\n\t\tvar mainLength    = byteLength - byteRemainder;\n\t\tvar a, b, c, d;\n\t\tvar chunk;\n\t\t// Main loop deals with bytes in chunks of 3\n\t\tfor (var i = 0; i < mainLength; i = i + 3) {\n\t\t\t// Combine the three bytes into a single integer\n\t\t\tchunk = (bytes[i] << 16) | (bytes[i + 1] << 8) | bytes[i + 2];\n\t\t\t// Use bitmasks to extract 6-bit segments from the triplet\n\t\t\ta = (chunk & 16515072) >> 18; // 16515072 = (2^6 - 1) << 18\n\t\t\tb = (chunk & 258048)   >> 12; // 258048   = (2^6 - 1) << 12\n\t\t\tc = (chunk & 4032)     >>  6; // 4032     = (2^6 - 1) << 6\n\t\t\td = chunk & 63;               // 63       = 2^6 - 1\n\t\t\t// Convert the raw binary segments to the appropriate ASCII encoding\n\t\t\tbase64 += encodings[a] + encodings[b] + encodings[c] + encodings[d];\n\t\t}\n\t\t// Deal with the remaining bytes and padding\n\t\tif (byteRemainder == 1) {\n\t\t\tchunk = bytes[mainLength];\n\t\t\ta = (chunk & 252) >> 2; // 252 = (2^6 - 1) << 2\n\t\t\t// Set the 4 least significant bits to zero\n\t\t\tb = (chunk & 3)   << 4; // 3   = 2^2 - 1\n\t\t\tbase64 += encodings[a] + encodings[b] + '==';\n\t\t} else if (byteRemainder == 2) {\n\t\t\tchunk = (bytes[mainLength] << 8) | bytes[mainLength + 1];\n\t\t\ta = (chunk & 64512) >> 10; // 64512 = (2^6 - 1) << 10\n\t\t\tb = (chunk & 1008)  >>  4; // 1008  = (2^6 - 1) << 4\n\t\t\t// Set the 2 least significant bits to zero\n\t\t\tc = (chunk & 15)    <<  2; // 15    = 2^4 - 1\n\t\t\tbase64 += encodings[a] + encodings[b] + encodings[c] + '=';\n\t\t}\n\t\treturn base64;\n\t}\n</script>\n</body>\n```\n\nè¿™ç§é€šè¿‡ img çš„æ–¹å¼æš´éœ²å‡ºçš„é—®é¢˜æ˜¯éœ€è¦åœ¨å‰ç«¯è§£ç , å¯¼è‡´ä¸‹ä¸€å¸§åˆ°æ¥æ—¶ä¸Šä¸€å¸§çš„ç”»é¢è¿˜æ²¡è§£ç å®Œæˆ. å°±ä¼šæœ‰èŠ±å±ç”šè‡³ç”»é¢åªæ˜¾ç¤ºä¸€åŠçš„é—®é¢˜å’Œå»¶è¿Ÿè¾ƒå¤§ä¸”å»¶è¿Ÿä¼šç´¯ç§¯, åœ¨æ§åˆ¶å°ä¸­ä½ ä¼šçœ‹åˆ°ç–¯ç‹‚åˆ·ä»å†…å­˜æ¥çš„è¯·æ±‚, å¦‚æœä½ æƒ³çœ‹çœ‹ http è¯·æ±‚å¯èƒ½ä¼šç–¯. æ‰€ä»¥è¿™ç§æ–¹å¼è‚¯å®šä¸è¡Œ\n\nè¿™ä¸ª `rtsp-ffmpeg` è¿˜æä¾›ä¸€ç§ canvas çš„æ–¹å¼, åªæ˜¯åœ¨å®¢æˆ·ç«¯åšä¸€äº›ä¿®æ”¹:\n```js\nvar io = io();\n// æŠŠä¹‹å‰çš„ img æ ‡ç­¾æ¢æˆ canvas\nlet canvas = document.querySelector('#canvas')\nio.on('data', data => {\n    var bytes = new Uint8Array(data)\n\t\t\t\t\t\n    var blob = new Blob([bytes], {type: 'application/octet-binary'})\n                    \n    var url = URL.createObjectURL(blob)\n                    \n    var img = new Image\n                    \n    var ctx = canvas.getContext(\"2d\")\n        img.width = img.width * 0.5\n        img.height = img.height * 0.5\n        img.onload = function() {\n            URL.revokeObjectURL(url)\n            ctx.drawImage(img, 0, 0, 1080, 720)\n        };    \n    img.src = url\n})\n```\n\nç”¨ canvas çš„æ–¹æ³•è™½ç„¶æ¯” img çš„æ•ˆæœå¥½ä¸€ç‚¹, ä½†æ˜¯æœ€ç»ˆæ•ˆæœä»ç„¶æ˜¯ä¸å°½äººæ„. å›¾åƒå¾ˆä¸ç¨³å®š, è¡¨ç°ä¸ºä¸€åŠç”»é¢ä¸€åŠç»¿å±, å¦‚æœè§†é¢‘ä¸­å›¾åƒå˜æ¢å‰§çƒˆçš„è¯è¡¨ç°ä¼šæ›´å·®, æ‰€ä»¥è¿™ç§æ–¹æ³•ä¹Ÿä¸å¤ªè¡Œ. å…¶å®åœ¨è¿™ä¸­é—´æˆ‘å¹¶æ²¡æœ‰åšä»€ä¹ˆæ“ä½œåªæ˜¯å°†è¿™ä¸ª demo é›†æˆåœ¨äº† vue ä¸­, å†åŠ ä¸Šå¤šæ‘„åƒæœºçš„åˆ‡æ¢å’Œä¸»æµæ‘„åƒæœºå‚å•†çš„æ”¯æŒ(å› ä¸ºæ¯ä¸ªæ‘„åƒæœºå‚å•†çš„ rtsp åè®®çš„ç»“æ„ä¸ä¸€æ ·)è€Œå·², æ‰€ä»¥ç¬¬ä¸€æƒ³æ³•æ˜¯èƒ½ä¸èƒ½åœ¨è§£ç è¿™å—æ‰¾åˆ°æ›´å¥½è§£å†³åŠæ³•, äºæ˜¯åˆæ‰¾åˆ°äº†å¦ä¸€ä¸ªåº“ [jsmpeg](https://github.com/phoboslab/jsmpeg) æ–¹æ¡ˆäºŒå°±æ¥äº†.\n\n\n### æ–¹æ¡ˆäºŒ: jsmpeg\nè¿™ä¸ªåº“è¿˜ç®—æ¯”è¾ƒä¸é”™çš„äº†, ä¹Ÿæ˜¯é€šè¿‡ websocket æ¥è½¬å‘, çœ‹å®˜æ–¹çš„ä¾‹å­æ˜¯åœ¨ç»ˆç«¯ä¸­å¯åŠ¨ ffmpeg -> websocket -> å®¢æˆ·ç«¯é€šè¿‡ `jsmpeg.min.js` è§£ç åœ¨ canvas ä¸­æ’­æ”¾. å› ä¸ºè¿™é‡Œåªæ˜¯å®ç°äº†æ’­æ”¾, åœ¨è¿™ä¸ªåŸºç¡€ä¸Šæˆ‘ä»¬è¿˜éœ€è¦åœ¨è„šæœ¬ä¸­è‡ªå¯ ffmpeg / åˆ‡æ¢/ é‡å¯, ç„¶ååˆå»æ‰¾äº†ä¸€ä¸ªåŸºäº `jsmpeg` çš„åº“ [node-rtsp-stream](https://github.com/kyriesent/node-rtsp-stream). è¿™ä¸ªåº“åªæ˜¯åšäº†ä¸€äº›å°è£…è®©æˆ‘ä»¬ä¸ç”¨è‡ªå·±åœ¨ç»ˆç«¯ä¸­æ‰‹åŠ¨å¯ç”¨ ffmpeg, åœ¨æ­¤ä¹‹ä¸Šæˆ‘å†åŠ ä¸Šé‡å¯å°±èƒ½æ»¡è¶³ç°åœ¨çš„éœ€æ±‚.\n\nç¤ºä¾‹:\n\n1. æ”¹é€  `node-rtsp-stream`\n\nnode-rtsp-stream/videoStream.js\n```js\n(function() {\n    var Mpeg1Muxer, STREAM_MAGIC_BYTES, VideoStream, events, util, ws;\n\n    ws = require('ws');\n\n    util = require('util');\n\n    events = require('events');\n\n    Mpeg1Muxer = require('./mpeg1muxer');\n\n    STREAM_MAGIC_BYTES = \"jsmp\";\n\n    var child_process = require('child_process');\n\n    VideoStream = function(options) {\n        this.name = options.name;\n        this.streamUrl = options.streamUrl;\n        this.width = options.width;\n        this.height = options.height;\n        this.wsPort = options.wsPort;\n        this.inputStreamStarted = false;\n        this.stream = void 0;\n        this.startMpeg1Stream();\n        this.pipeStreamToSocketServer();\n        return this;\n    };\n\n    util.inherits(VideoStream, events.EventEmitter);\n    // åœæ­¢è§†é¢‘æµ\n    VideoStream.prototype.stop = function () {\n        if (this.mpeg1Muxer) {\n            this.mpeg1Muxer.stream.stop()\n        }\n    }\n    // é‡å¯è§†é¢‘æµ\n    VideoStream.prototype.restart = function() {\n        if (this.mpeg1Muxer) {\n            this.mpeg1Muxer.stream.stop()\n            console.log('ffmpeg is restart')\n            this.inputStreamStarted = false;\n            this.stream = void 0;\n            this.startMpeg1Stream();\n            // ç›‘å¬ ffmpeg è¿›ç¨‹æ˜¯å¦å…³é—­\n            this.mpeg1Muxer.on('ffmpegClose', function(code) {\n                console.log('ffmpeg closed on ' + code)\n            })\n        }\n    }\n\n    VideoStream.prototype.startMpeg1Stream = function() {\n        // çœç•¥æ‰“å¼€æµçš„æ–¹æ³•, è¿™éƒ¨åˆ†æ²¡æœ‰åšæ”¹åŠ¨\n    };\n\n    VideoStream.prototype.pipeStreamToSocketServer = function() {\n        // å°†æµå¡ç»™ socket, åŒæ ·ä¹Ÿæ²¡æ”¹\n    };\n\n    VideoStream.prototype.onSocketConnect = function(socket) {\n        var self, streamHeader;\n        self = this;\n        streamHeader = new Buffer(8);\n        streamHeader.write(STREAM_MAGIC_BYTES);\n        streamHeader.writeUInt16BE(this.width, 4);\n        streamHeader.writeUInt16BE(this.height, 6);\n        socket.send(streamHeader, {\n            binary: true\n        });\n        console.log((\"\" + this.name + \": New WebSocket Connection (\") + this.wsServer.clients.length + \" total)\");\n        return socket.on(\"close\", function(code, message) {\n            return console.log((\"\" + this.name + \": Disconnected WebSocket (\") + self.wsServer.clients.length + \" total)\");\n        });\n    };\n\n    module.exports = VideoStream;\n\n}).call(this);\n```\n\nnode-rtsp-stream/videoStream.js\n```js\n(function() {\n    var Mpeg1Muxer, child_process, events, util;\n\n    child_process = require('child_process');\n\n    util = require('util');\n\n    events = require('events');\n\n    Mpeg1Muxer = function(options) {\n        var self;\n        self = this;\n        this.url = options.url;\n        this.stream = child_process.spawn(\"ffmpeg\", \n            [\n                \"-rtsp_transport\",\n                \"tcp\",\n                \"-i\",\n                this.url,\n                '-s', \n                // å›¾åƒå®½é«˜\n                `${options.width}x${options.height}`, \n                '-f', \n                'mpeg1video', \n                '-b:v', \n                '800k', \n                '-r', \n                '30', \n                '-'\n            ], \n            {\n                detached: false\n            }\n        );\n        this.inputStreamStarted = true;\n        this.stream.stdout.on('data', function(data) {\n            return self.emit('mpeg1data', data);\n        });\n        this.stream.stderr.on('data', function(data) {\n            return self.emit('ffmpegError', data);\n        });\n        // kill ffmpeg\n        this.stream.stop = function() {\n            // console.log(self.stream.pid)\n            self.stream.stdin.pause();\n            self.stream.kill()\n            console.log('ffmpeg is be kill')\n        };\n        // ç›‘å¬ ffmpeg é€€å‡º\n        this.stream.on('exit', function(code) {\n            return self.emit('ffmpegClose', code)\n        })\n        return this;\n    };\n\n    util.inherits(Mpeg1Muxer, events.EventEmitter);\n\n    module.exports = Mpeg1Muxer;\n\n}).call(this);\n```\n\n2. node ç«¯ä½¿ç”¨\n\n```js\nconst app = require('express')()\nconst server = require('http').Server(app)\nconst io = require('socket.io')(server)\n// å¼•å…¥æ”¹é€ åçš„ node-rtsp-stream\nconst Rtsp = require('./node-rtsp-stream')\n\nserver.listen(8081, () => {\n    console.log('server listening on 8081')\n})\n\n// uri ä»¥æµ·åº·æ‘„åƒæœºçš„ rtsp åè®®ä¸ºä¾‹\nlet uri = 'rtps://admin:password@ip:port/h264/ch1/sub/av_stream'\nlet stream = new Rtsp({\n    name: 'rtsp_stream',\n    streamUrl: uri,\n    wsPort: 11111,\n    width: 720,\n    height: 405\n})\n\nstream.on('start', function () {\n    console.log('stream')\n})\n\nstream.on('stop', function () {\n    console.log('stream stopped')\n})\n\nio.on('connection', socket => {\n    const pipeStream = data => {\n        socket.emit('data', data)\n    }\n    stream.on('data', pipeStream)\n\n    // åˆ‡æ¢æ‘„åƒæœº\n    socket.on('URI', data => {\n        console.log(data)\n        uri = `rtsp://${data.userName}:${data.passWord}@${data.ip}:${data.port}/h264/ch1/sub/av_stream`\n        stream.streamUrl = uri;\n        // é‡å¯\n        stream.restart()\n    })\n\n    socket.on('disconnect' () => {\n        stream.removeListener('data', pipeStream)\n    })\n})\n```\n\n3. å®¢æˆ·ç«¯\n\n```html\n<canvas id='can'></canvas>\n<script src='jsmpeg.min.js'></script>\n<script>\n    let canvas = document.querySelector('#can')\n    let ws = new WebSocket('ws://127.0.0.1:11111')\n    let player = new jsmpeg(ws, {\n        canvas: canvas,\n        autoplay: true\n    })\n</script>\n```\n\nè¿™ä¸ªæ–¹æ¡ˆå…¶å®ä½¿ç”¨äº†å¾ˆä¹…ä¸€ç›´éƒ½æ²¡å‘ç°é—®é¢˜, æ˜¯åœ¨ä¸€è·¯æ‘„åƒæœºå®‰ç½®åœ¨å¤©æ¡¥é™„è¿‘äººæµé‡å‰§å¢, ä¸è¿™ä¸ªè§†é¢‘é¢„è§ˆåŒä¸€é¡µé¢è¿˜æœ‰ä¸€ä¸ªäººè„¸å®æ—¶æŠ“æ‹çš„å³æ—¶æ¶ˆæ¯æ¨é€çš„åŠŸèƒ½, å¯¼è‡´åœ¨20 - 30åˆ†é’Ÿæµè§ˆå™¨ç›´æ¥å‡æ­»æˆ–è€…å´©æºƒ.(ç„¶åè¿™ä¸ªæ–¹æ¡ˆåˆå‡‰äº†ğŸ˜‚)\n\n### æ–¹æ¡ˆä¸‰: FFmpeg + Nginx + video.js\næ–¹æ¡ˆä¸‰ä¸‹æ¬¡å†™~\n\n\n\nCreated on 2017/7/26 by Cara\n","source":"_posts/ç½‘ç»œæ‘„åƒæœºç›´æ’­.md","raw":"---\ntitle: 'ç½‘ç»œæ‘„åƒæœºç›´æ’­'\ndate: 2018-05-06 14:49:04\ntags:\n- JavaScript\n- Node.js\n- FFmpeg\ncategories:\n- ç¬”è®°ğŸ“’\n---\nå¯¹äºç½‘ç»œæ‘„åƒæœºåšè§†é¢‘é¢„è§ˆè¿™å—, æœ¬èº«å…¶å®æ˜¯éå¸¸é™Œç”Ÿçš„, å½“æ—¶æ¥åˆ°è¿™ä¸ªéœ€æ±‚ä¹Ÿæ˜¯ç›¸å½“çš„å¤´ç–¼(å¯¹äºå½“æ—¶ä¸€å¹´ç»éªŒä¸åˆ°çš„æˆ‘æ¥è¯´).å½“æ—¶æˆ‘ä»¬çš„åº”ç”¨åœºæ™¯æ˜¯: å¤šè·¯ç½‘ç»œæ‘„åƒæœºé€šè¿‡å±€åŸŸç½‘è¿æ¥, PC ç«¯èƒ½å¤Ÿå®æ—¶é¢„è§ˆç›‘æ§ç”»é¢å¹¶ä¸”ç”»è´¨è¾¾åˆ°720p, å»¶è¿Ÿä¸èƒ½è¶…è¿‡10ç§’, å¤šä¸ªæ‘„åƒæœºèƒ½å¤Ÿåˆ‡æ¢æŸ¥çœ‹. ç”±äºåç«¯åªæä¾›ä¸€ä¸ª RTSP çš„ç›´æ’­åè®®, æ‰€ä»¥æ‰€æœ‰çš„æ–¹æ¡ˆéƒ½æ˜¯å›´ç»•ç€ RTSP è¿™ä¸ªå…³é”®è¯. å½“æ—¶æ—¶é—´å¾ˆèµ¶æ‰€ä»¥è¦è‡ªå·±æ…¢æ…¢ç ”ç©¶æ˜¯ä¸å¯èƒ½äº†, åªèƒ½å»æ‰¾ç°æˆçš„åº“.\n\n> ç°ç›®å‰ç”¨è¿‡ä¸‰ç§æ–¹æ¡ˆ, éƒ½ä¸å®Œç¾.\n\n### æ•´ä½“æ€è·¯\nç»è¿‡ä¸€æ³¢è°ƒç ”(google)ä¹‹å, çŸ¥é“æµè§ˆå™¨å¯¹ RTSP åè®®å¹¶ä¸å‹å¥½, ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¿…é¡»è¦è‡ªå·±è½¬ç å†æä¾›ç»™æµè§ˆå™¨ä½¿ç”¨, æ‰¾åˆ°çš„è§£å†³æ€è·¯å¤§æ¦‚æ˜¯:\n\n1. è½¬ç : [FFmpeg](https://www.ffmpeg.org/) æ˜¯ä¸€ä¸ªè€ç‰Œçš„è½¬ç å·¥å…·, éå¸¸å¼ºå¤§\n2. Node.js ç”¨ä½œä¸­è½¬ç«™æ¥æ”¶å®¢æˆ·ç«¯å‘æ¥çš„æ‘„åƒæœºä¿¡æ¯åŠæ§åˆ¶ FFmpeg æ¨æµ\n3. æœ€ç»ˆå®¢æˆ·ç«¯æ¥æ”¶è§†é¢‘æµ\n\nä¸‹é¢æˆ‘è¯•è¿‡çš„ä¸‰ç§æ–¹æ¡ˆ, åŸºæœ¬ç»“æ„éƒ½å¦‚æ­¤åªæ˜¯æ¨æµçš„æ–¹å¼å’Œå®¢æˆ·ç«¯çš„æ¥æ”¶æ–¹å¼æœ‰æ‰€ä¸åŒ.\n\n### å‡†å¤‡\n\n**å®‰è£… FFmpeg è½¬ç å·¥å…·**\n\n- window å¹³å°\n\n1. [ä¸‹è½½ FFmpeg](http://ffmpeg.zeranoe.com/builds/) è§£å‹ååº”è¯¥æ˜¯å·²ç»ç¼–è¯‘å¥½çš„æ–‡ä»¶\n2. å°†è§£å‹å¥½çš„æ–‡ä»¶æ”¾å…¥ C ç›˜æ ¹ç›®å½•(ä¹Ÿå¯ä»¥è‡ªè¡Œæ”¾å…¥å…¶ä»–ç›˜ç¬¦)ä¸‹é‡å‘½åä¸º ffmpeg(æ–¹ä¾¿ä»¥åæ‰¾)\n3. è®¾ç½®ç¯å¢ƒå˜é‡, æˆ‘çš„ç”µè„‘ -> å±æ€§ -> é«˜çº§ç³»ç»Ÿè®¾ç½® -> ç¯å¢ƒå˜é‡ -> ç³»ç»Ÿå˜é‡ -> æ–°å¢, è·¯å¾„é€‰æ‹©åˆšåˆš C ç›˜ä¸‹çš„ ffmpegæ–‡ä»¶å¤¹ä¸­çš„ bin æ–‡ä»¶å¤¹\n4. æ³¨é”€æˆ–é‡å¯ç”µè„‘è®©ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ\n5. æµ‹è¯•, åœ¨ cmd ä¸­è¾“å…¥ `ffmpeg -version`,  å¦‚æœå‡ºç°ç‰ˆæœ¬å·ä¹‹ç±»çš„ä¸œè¥¿åˆ™æˆåŠŸ.\n\n- Mac å¹³å°\nMac ä¸‹å¯ä»¥ç›´æ¥é€šè¿‡ `Homebrew` å®‰è£…æœ€ä¸ºç®€å•.\n\n1. å®‰è£… `Homebrew`, åœ¨ç»ˆç«¯ä¸­è¾“å…¥ `ruby -e \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)\"`\n2. å®‰è£… FFmpeg, ç›´æ¥åœ¨ç»ˆç«¯ä¸­è¾“å…¥ `brew install ffmpeg` å³å¯\n3. æµ‹è¯•, åŒæ ·åœ¨ç»ˆç«¯ä¸­è¾“å…¥ `ffmpeg -version` æŸ¥çœ‹ç‰ˆæœ¬å·\n\n**å®‰è£… Node.js**\nè¿™ä¸ªå°±ä¸å±•å¼€è¯¦ç»†è¯´äº†, æ¯ä¸ªå‰ç«¯éƒ½æœ‰å§...\n\n### æ–¹æ¡ˆä¸€: img æ ‡ç­¾\nå½“æ—¶æƒ³åˆ°çš„ç¬¬ä¸€ç§æ–¹æ¡ˆä¹Ÿæ˜¯æœ€ç®€å•çš„æ–¹æ¡ˆ, æ˜¯å°†è§†é¢‘æµçš„æ¯ä¸€å¸§è½¬åŒ–ä¸º base64 å†é€šè¿‡åŠ¨æ€æ›¿æ¢ `<img>` çš„ src å±æ€§æ¥è¾¾åˆ°é¢„è§ˆçš„æ•ˆæœ.ä¸­é—´ç”¨åˆ°äº†[rtsp-ffmpeg](https://github.com/agsh/rtsp-ffmpeg), è¿™ä¸ªåº“çš„æ€è·¯æ˜¯é€šè¿‡ websocket å‘é€æ¯ä¸€å¸§è§†é¢‘çš„ bytes åˆ°å®¢æˆ·ç«¯, å®¢æˆ·ç«¯å¯ä»¥é€šè¿‡ `<img>` æ ‡ç­¾æ¥å±•ç¤º.\n\nç¤ºä¾‹: \n\nnode ç«¯\n```js\nconst app = require('express')()\nconst server = require('http').Server(app)\nconst io = require('socket.io')(server)\nconst rtsp = require('rtsp-ffmpeg')\n\nserver.listen(8081, () => {\n    console.log('server listening on 8081')\n})\n\n// uri ä»¥æµ·åº·æ‘„åƒæœºçš„ rtsp åè®®ä¸ºä¾‹\nlet uri = 'rtps://admin:password@ip:port/h264/ch1/sub/av_stream'\nlet stream = new rtsp.FFMpeg({\n    input: uri,\n    resolution: '1080x720',\n    quality: 3\n})\n\nstream.on('start', function () {\n    console.log('stream')\n})\n\nstream.on('stop', function () {\n    console.log('stream stopped')\n})\n\nio.on('connection', socket => {\n    const pipeStream = data => {\n        socket.emit('data', data)\n    }\n    stream.on('data', pipeStream)\n\n    // åˆ‡æ¢æ‘„åƒæœº\n    socket.on('URI', data => {\n        console.log(data)\n        uri = `rtsp://${data.userName}:${data.passWord}@${data.ip}:${data.port}/h264/ch1/sub/av_stream`\n        stream.input = uri\n\n        // é‡å¯\n        stream.restart()\n    })\n\n    socket.on('disconnect' () => {\n        stream.removeListener('data', pipeStream)\n    })\n})\n```\n\nå®¢æˆ·ç«¯\n```html\n<body>\n    <img id='img'>\n<script src='/socket.io/socket.io.js'></script>\n<script>\n\tvar io = io();\n    let img = document.querySelector('#img')\n\tio.on('data', function(data) {\n        let bytes = new Unit8Array(data)\n        img.src = 'data:image/jpeg;base64,' + base64ArrayBuffer(bytes)\n\t\t\t\n\t})\n    // byte æ•°ç»„è½¬ base64 (è¿™æ®µæ˜¯åœ¨å…¶ä»–åœ°æ–¹æŠ„çš„)\n\tfunction base64ArrayBuffer(arrayBuffer) {\n\t\tvar base64    = '';\n\t\tvar encodings = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n\t\tvar bytes         = new Uint8Array(arrayBuffer);\n\t\tvar byteLength    = bytes.byteLength;\n\t\tvar byteRemainder = byteLength % 3;\n\t\tvar mainLength    = byteLength - byteRemainder;\n\t\tvar a, b, c, d;\n\t\tvar chunk;\n\t\t// Main loop deals with bytes in chunks of 3\n\t\tfor (var i = 0; i < mainLength; i = i + 3) {\n\t\t\t// Combine the three bytes into a single integer\n\t\t\tchunk = (bytes[i] << 16) | (bytes[i + 1] << 8) | bytes[i + 2];\n\t\t\t// Use bitmasks to extract 6-bit segments from the triplet\n\t\t\ta = (chunk & 16515072) >> 18; // 16515072 = (2^6 - 1) << 18\n\t\t\tb = (chunk & 258048)   >> 12; // 258048   = (2^6 - 1) << 12\n\t\t\tc = (chunk & 4032)     >>  6; // 4032     = (2^6 - 1) << 6\n\t\t\td = chunk & 63;               // 63       = 2^6 - 1\n\t\t\t// Convert the raw binary segments to the appropriate ASCII encoding\n\t\t\tbase64 += encodings[a] + encodings[b] + encodings[c] + encodings[d];\n\t\t}\n\t\t// Deal with the remaining bytes and padding\n\t\tif (byteRemainder == 1) {\n\t\t\tchunk = bytes[mainLength];\n\t\t\ta = (chunk & 252) >> 2; // 252 = (2^6 - 1) << 2\n\t\t\t// Set the 4 least significant bits to zero\n\t\t\tb = (chunk & 3)   << 4; // 3   = 2^2 - 1\n\t\t\tbase64 += encodings[a] + encodings[b] + '==';\n\t\t} else if (byteRemainder == 2) {\n\t\t\tchunk = (bytes[mainLength] << 8) | bytes[mainLength + 1];\n\t\t\ta = (chunk & 64512) >> 10; // 64512 = (2^6 - 1) << 10\n\t\t\tb = (chunk & 1008)  >>  4; // 1008  = (2^6 - 1) << 4\n\t\t\t// Set the 2 least significant bits to zero\n\t\t\tc = (chunk & 15)    <<  2; // 15    = 2^4 - 1\n\t\t\tbase64 += encodings[a] + encodings[b] + encodings[c] + '=';\n\t\t}\n\t\treturn base64;\n\t}\n</script>\n</body>\n```\n\nè¿™ç§é€šè¿‡ img çš„æ–¹å¼æš´éœ²å‡ºçš„é—®é¢˜æ˜¯éœ€è¦åœ¨å‰ç«¯è§£ç , å¯¼è‡´ä¸‹ä¸€å¸§åˆ°æ¥æ—¶ä¸Šä¸€å¸§çš„ç”»é¢è¿˜æ²¡è§£ç å®Œæˆ. å°±ä¼šæœ‰èŠ±å±ç”šè‡³ç”»é¢åªæ˜¾ç¤ºä¸€åŠçš„é—®é¢˜å’Œå»¶è¿Ÿè¾ƒå¤§ä¸”å»¶è¿Ÿä¼šç´¯ç§¯, åœ¨æ§åˆ¶å°ä¸­ä½ ä¼šçœ‹åˆ°ç–¯ç‹‚åˆ·ä»å†…å­˜æ¥çš„è¯·æ±‚, å¦‚æœä½ æƒ³çœ‹çœ‹ http è¯·æ±‚å¯èƒ½ä¼šç–¯. æ‰€ä»¥è¿™ç§æ–¹å¼è‚¯å®šä¸è¡Œ\n\nè¿™ä¸ª `rtsp-ffmpeg` è¿˜æä¾›ä¸€ç§ canvas çš„æ–¹å¼, åªæ˜¯åœ¨å®¢æˆ·ç«¯åšä¸€äº›ä¿®æ”¹:\n```js\nvar io = io();\n// æŠŠä¹‹å‰çš„ img æ ‡ç­¾æ¢æˆ canvas\nlet canvas = document.querySelector('#canvas')\nio.on('data', data => {\n    var bytes = new Uint8Array(data)\n\t\t\t\t\t\n    var blob = new Blob([bytes], {type: 'application/octet-binary'})\n                    \n    var url = URL.createObjectURL(blob)\n                    \n    var img = new Image\n                    \n    var ctx = canvas.getContext(\"2d\")\n        img.width = img.width * 0.5\n        img.height = img.height * 0.5\n        img.onload = function() {\n            URL.revokeObjectURL(url)\n            ctx.drawImage(img, 0, 0, 1080, 720)\n        };    \n    img.src = url\n})\n```\n\nç”¨ canvas çš„æ–¹æ³•è™½ç„¶æ¯” img çš„æ•ˆæœå¥½ä¸€ç‚¹, ä½†æ˜¯æœ€ç»ˆæ•ˆæœä»ç„¶æ˜¯ä¸å°½äººæ„. å›¾åƒå¾ˆä¸ç¨³å®š, è¡¨ç°ä¸ºä¸€åŠç”»é¢ä¸€åŠç»¿å±, å¦‚æœè§†é¢‘ä¸­å›¾åƒå˜æ¢å‰§çƒˆçš„è¯è¡¨ç°ä¼šæ›´å·®, æ‰€ä»¥è¿™ç§æ–¹æ³•ä¹Ÿä¸å¤ªè¡Œ. å…¶å®åœ¨è¿™ä¸­é—´æˆ‘å¹¶æ²¡æœ‰åšä»€ä¹ˆæ“ä½œåªæ˜¯å°†è¿™ä¸ª demo é›†æˆåœ¨äº† vue ä¸­, å†åŠ ä¸Šå¤šæ‘„åƒæœºçš„åˆ‡æ¢å’Œä¸»æµæ‘„åƒæœºå‚å•†çš„æ”¯æŒ(å› ä¸ºæ¯ä¸ªæ‘„åƒæœºå‚å•†çš„ rtsp åè®®çš„ç»“æ„ä¸ä¸€æ ·)è€Œå·², æ‰€ä»¥ç¬¬ä¸€æƒ³æ³•æ˜¯èƒ½ä¸èƒ½åœ¨è§£ç è¿™å—æ‰¾åˆ°æ›´å¥½è§£å†³åŠæ³•, äºæ˜¯åˆæ‰¾åˆ°äº†å¦ä¸€ä¸ªåº“ [jsmpeg](https://github.com/phoboslab/jsmpeg) æ–¹æ¡ˆäºŒå°±æ¥äº†.\n\n\n### æ–¹æ¡ˆäºŒ: jsmpeg\nè¿™ä¸ªåº“è¿˜ç®—æ¯”è¾ƒä¸é”™çš„äº†, ä¹Ÿæ˜¯é€šè¿‡ websocket æ¥è½¬å‘, çœ‹å®˜æ–¹çš„ä¾‹å­æ˜¯åœ¨ç»ˆç«¯ä¸­å¯åŠ¨ ffmpeg -> websocket -> å®¢æˆ·ç«¯é€šè¿‡ `jsmpeg.min.js` è§£ç åœ¨ canvas ä¸­æ’­æ”¾. å› ä¸ºè¿™é‡Œåªæ˜¯å®ç°äº†æ’­æ”¾, åœ¨è¿™ä¸ªåŸºç¡€ä¸Šæˆ‘ä»¬è¿˜éœ€è¦åœ¨è„šæœ¬ä¸­è‡ªå¯ ffmpeg / åˆ‡æ¢/ é‡å¯, ç„¶ååˆå»æ‰¾äº†ä¸€ä¸ªåŸºäº `jsmpeg` çš„åº“ [node-rtsp-stream](https://github.com/kyriesent/node-rtsp-stream). è¿™ä¸ªåº“åªæ˜¯åšäº†ä¸€äº›å°è£…è®©æˆ‘ä»¬ä¸ç”¨è‡ªå·±åœ¨ç»ˆç«¯ä¸­æ‰‹åŠ¨å¯ç”¨ ffmpeg, åœ¨æ­¤ä¹‹ä¸Šæˆ‘å†åŠ ä¸Šé‡å¯å°±èƒ½æ»¡è¶³ç°åœ¨çš„éœ€æ±‚.\n\nç¤ºä¾‹:\n\n1. æ”¹é€  `node-rtsp-stream`\n\nnode-rtsp-stream/videoStream.js\n```js\n(function() {\n    var Mpeg1Muxer, STREAM_MAGIC_BYTES, VideoStream, events, util, ws;\n\n    ws = require('ws');\n\n    util = require('util');\n\n    events = require('events');\n\n    Mpeg1Muxer = require('./mpeg1muxer');\n\n    STREAM_MAGIC_BYTES = \"jsmp\";\n\n    var child_process = require('child_process');\n\n    VideoStream = function(options) {\n        this.name = options.name;\n        this.streamUrl = options.streamUrl;\n        this.width = options.width;\n        this.height = options.height;\n        this.wsPort = options.wsPort;\n        this.inputStreamStarted = false;\n        this.stream = void 0;\n        this.startMpeg1Stream();\n        this.pipeStreamToSocketServer();\n        return this;\n    };\n\n    util.inherits(VideoStream, events.EventEmitter);\n    // åœæ­¢è§†é¢‘æµ\n    VideoStream.prototype.stop = function () {\n        if (this.mpeg1Muxer) {\n            this.mpeg1Muxer.stream.stop()\n        }\n    }\n    // é‡å¯è§†é¢‘æµ\n    VideoStream.prototype.restart = function() {\n        if (this.mpeg1Muxer) {\n            this.mpeg1Muxer.stream.stop()\n            console.log('ffmpeg is restart')\n            this.inputStreamStarted = false;\n            this.stream = void 0;\n            this.startMpeg1Stream();\n            // ç›‘å¬ ffmpeg è¿›ç¨‹æ˜¯å¦å…³é—­\n            this.mpeg1Muxer.on('ffmpegClose', function(code) {\n                console.log('ffmpeg closed on ' + code)\n            })\n        }\n    }\n\n    VideoStream.prototype.startMpeg1Stream = function() {\n        // çœç•¥æ‰“å¼€æµçš„æ–¹æ³•, è¿™éƒ¨åˆ†æ²¡æœ‰åšæ”¹åŠ¨\n    };\n\n    VideoStream.prototype.pipeStreamToSocketServer = function() {\n        // å°†æµå¡ç»™ socket, åŒæ ·ä¹Ÿæ²¡æ”¹\n    };\n\n    VideoStream.prototype.onSocketConnect = function(socket) {\n        var self, streamHeader;\n        self = this;\n        streamHeader = new Buffer(8);\n        streamHeader.write(STREAM_MAGIC_BYTES);\n        streamHeader.writeUInt16BE(this.width, 4);\n        streamHeader.writeUInt16BE(this.height, 6);\n        socket.send(streamHeader, {\n            binary: true\n        });\n        console.log((\"\" + this.name + \": New WebSocket Connection (\") + this.wsServer.clients.length + \" total)\");\n        return socket.on(\"close\", function(code, message) {\n            return console.log((\"\" + this.name + \": Disconnected WebSocket (\") + self.wsServer.clients.length + \" total)\");\n        });\n    };\n\n    module.exports = VideoStream;\n\n}).call(this);\n```\n\nnode-rtsp-stream/videoStream.js\n```js\n(function() {\n    var Mpeg1Muxer, child_process, events, util;\n\n    child_process = require('child_process');\n\n    util = require('util');\n\n    events = require('events');\n\n    Mpeg1Muxer = function(options) {\n        var self;\n        self = this;\n        this.url = options.url;\n        this.stream = child_process.spawn(\"ffmpeg\", \n            [\n                \"-rtsp_transport\",\n                \"tcp\",\n                \"-i\",\n                this.url,\n                '-s', \n                // å›¾åƒå®½é«˜\n                `${options.width}x${options.height}`, \n                '-f', \n                'mpeg1video', \n                '-b:v', \n                '800k', \n                '-r', \n                '30', \n                '-'\n            ], \n            {\n                detached: false\n            }\n        );\n        this.inputStreamStarted = true;\n        this.stream.stdout.on('data', function(data) {\n            return self.emit('mpeg1data', data);\n        });\n        this.stream.stderr.on('data', function(data) {\n            return self.emit('ffmpegError', data);\n        });\n        // kill ffmpeg\n        this.stream.stop = function() {\n            // console.log(self.stream.pid)\n            self.stream.stdin.pause();\n            self.stream.kill()\n            console.log('ffmpeg is be kill')\n        };\n        // ç›‘å¬ ffmpeg é€€å‡º\n        this.stream.on('exit', function(code) {\n            return self.emit('ffmpegClose', code)\n        })\n        return this;\n    };\n\n    util.inherits(Mpeg1Muxer, events.EventEmitter);\n\n    module.exports = Mpeg1Muxer;\n\n}).call(this);\n```\n\n2. node ç«¯ä½¿ç”¨\n\n```js\nconst app = require('express')()\nconst server = require('http').Server(app)\nconst io = require('socket.io')(server)\n// å¼•å…¥æ”¹é€ åçš„ node-rtsp-stream\nconst Rtsp = require('./node-rtsp-stream')\n\nserver.listen(8081, () => {\n    console.log('server listening on 8081')\n})\n\n// uri ä»¥æµ·åº·æ‘„åƒæœºçš„ rtsp åè®®ä¸ºä¾‹\nlet uri = 'rtps://admin:password@ip:port/h264/ch1/sub/av_stream'\nlet stream = new Rtsp({\n    name: 'rtsp_stream',\n    streamUrl: uri,\n    wsPort: 11111,\n    width: 720,\n    height: 405\n})\n\nstream.on('start', function () {\n    console.log('stream')\n})\n\nstream.on('stop', function () {\n    console.log('stream stopped')\n})\n\nio.on('connection', socket => {\n    const pipeStream = data => {\n        socket.emit('data', data)\n    }\n    stream.on('data', pipeStream)\n\n    // åˆ‡æ¢æ‘„åƒæœº\n    socket.on('URI', data => {\n        console.log(data)\n        uri = `rtsp://${data.userName}:${data.passWord}@${data.ip}:${data.port}/h264/ch1/sub/av_stream`\n        stream.streamUrl = uri;\n        // é‡å¯\n        stream.restart()\n    })\n\n    socket.on('disconnect' () => {\n        stream.removeListener('data', pipeStream)\n    })\n})\n```\n\n3. å®¢æˆ·ç«¯\n\n```html\n<canvas id='can'></canvas>\n<script src='jsmpeg.min.js'></script>\n<script>\n    let canvas = document.querySelector('#can')\n    let ws = new WebSocket('ws://127.0.0.1:11111')\n    let player = new jsmpeg(ws, {\n        canvas: canvas,\n        autoplay: true\n    })\n</script>\n```\n\nè¿™ä¸ªæ–¹æ¡ˆå…¶å®ä½¿ç”¨äº†å¾ˆä¹…ä¸€ç›´éƒ½æ²¡å‘ç°é—®é¢˜, æ˜¯åœ¨ä¸€è·¯æ‘„åƒæœºå®‰ç½®åœ¨å¤©æ¡¥é™„è¿‘äººæµé‡å‰§å¢, ä¸è¿™ä¸ªè§†é¢‘é¢„è§ˆåŒä¸€é¡µé¢è¿˜æœ‰ä¸€ä¸ªäººè„¸å®æ—¶æŠ“æ‹çš„å³æ—¶æ¶ˆæ¯æ¨é€çš„åŠŸèƒ½, å¯¼è‡´åœ¨20 - 30åˆ†é’Ÿæµè§ˆå™¨ç›´æ¥å‡æ­»æˆ–è€…å´©æºƒ.(ç„¶åè¿™ä¸ªæ–¹æ¡ˆåˆå‡‰äº†ğŸ˜‚)\n\n### æ–¹æ¡ˆä¸‰: FFmpeg + Nginx + video.js\næ–¹æ¡ˆä¸‰ä¸‹æ¬¡å†™~\n\n\n\nCreated on 2017/7/26 by Cara\n","slug":"ç½‘ç»œæ‘„åƒæœºç›´æ’­","published":1,"updated":"2018-05-06T12:01:44.018Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjgurolt2001xklu07cne2y1m","content":"<p>å¯¹äºç½‘ç»œæ‘„åƒæœºåšè§†é¢‘é¢„è§ˆè¿™å—, æœ¬èº«å…¶å®æ˜¯éå¸¸é™Œç”Ÿçš„, å½“æ—¶æ¥åˆ°è¿™ä¸ªéœ€æ±‚ä¹Ÿæ˜¯ç›¸å½“çš„å¤´ç–¼(å¯¹äºå½“æ—¶ä¸€å¹´ç»éªŒä¸åˆ°çš„æˆ‘æ¥è¯´).å½“æ—¶æˆ‘ä»¬çš„åº”ç”¨åœºæ™¯æ˜¯: å¤šè·¯ç½‘ç»œæ‘„åƒæœºé€šè¿‡å±€åŸŸç½‘è¿æ¥, PC ç«¯èƒ½å¤Ÿå®æ—¶é¢„è§ˆç›‘æ§ç”»é¢å¹¶ä¸”ç”»è´¨è¾¾åˆ°720p, å»¶è¿Ÿä¸èƒ½è¶…è¿‡10ç§’, å¤šä¸ªæ‘„åƒæœºèƒ½å¤Ÿåˆ‡æ¢æŸ¥çœ‹. ç”±äºåç«¯åªæä¾›ä¸€ä¸ª RTSP çš„ç›´æ’­åè®®, æ‰€ä»¥æ‰€æœ‰çš„æ–¹æ¡ˆéƒ½æ˜¯å›´ç»•ç€ RTSP è¿™ä¸ªå…³é”®è¯. å½“æ—¶æ—¶é—´å¾ˆèµ¶æ‰€ä»¥è¦è‡ªå·±æ…¢æ…¢ç ”ç©¶æ˜¯ä¸å¯èƒ½äº†, åªèƒ½å»æ‰¾ç°æˆçš„åº“.</p>\n<blockquote>\n<p>ç°ç›®å‰ç”¨è¿‡ä¸‰ç§æ–¹æ¡ˆ, éƒ½ä¸å®Œç¾.</p>\n</blockquote>\n<h3 id=\"æ•´ä½“æ€è·¯\"><a href=\"#æ•´ä½“æ€è·¯\" class=\"headerlink\" title=\"æ•´ä½“æ€è·¯\"></a>æ•´ä½“æ€è·¯</h3><p>ç»è¿‡ä¸€æ³¢è°ƒç ”(google)ä¹‹å, çŸ¥é“æµè§ˆå™¨å¯¹ RTSP åè®®å¹¶ä¸å‹å¥½, ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¿…é¡»è¦è‡ªå·±è½¬ç å†æä¾›ç»™æµè§ˆå™¨ä½¿ç”¨, æ‰¾åˆ°çš„è§£å†³æ€è·¯å¤§æ¦‚æ˜¯:</p>\n<ol>\n<li>è½¬ç : <a href=\"https://www.ffmpeg.org/\" target=\"_blank\" rel=\"noopener\">FFmpeg</a> æ˜¯ä¸€ä¸ªè€ç‰Œçš„è½¬ç å·¥å…·, éå¸¸å¼ºå¤§</li>\n<li>Node.js ç”¨ä½œä¸­è½¬ç«™æ¥æ”¶å®¢æˆ·ç«¯å‘æ¥çš„æ‘„åƒæœºä¿¡æ¯åŠæ§åˆ¶ FFmpeg æ¨æµ</li>\n<li>æœ€ç»ˆå®¢æˆ·ç«¯æ¥æ”¶è§†é¢‘æµ</li>\n</ol>\n<p>ä¸‹é¢æˆ‘è¯•è¿‡çš„ä¸‰ç§æ–¹æ¡ˆ, åŸºæœ¬ç»“æ„éƒ½å¦‚æ­¤åªæ˜¯æ¨æµçš„æ–¹å¼å’Œå®¢æˆ·ç«¯çš„æ¥æ”¶æ–¹å¼æœ‰æ‰€ä¸åŒ.</p>\n<h3 id=\"å‡†å¤‡\"><a href=\"#å‡†å¤‡\" class=\"headerlink\" title=\"å‡†å¤‡\"></a>å‡†å¤‡</h3><p><strong>å®‰è£… FFmpeg è½¬ç å·¥å…·</strong></p>\n<ul>\n<li>window å¹³å°</li>\n</ul>\n<ol>\n<li><a href=\"http://ffmpeg.zeranoe.com/builds/\" target=\"_blank\" rel=\"noopener\">ä¸‹è½½ FFmpeg</a> è§£å‹ååº”è¯¥æ˜¯å·²ç»ç¼–è¯‘å¥½çš„æ–‡ä»¶</li>\n<li>å°†è§£å‹å¥½çš„æ–‡ä»¶æ”¾å…¥ C ç›˜æ ¹ç›®å½•(ä¹Ÿå¯ä»¥è‡ªè¡Œæ”¾å…¥å…¶ä»–ç›˜ç¬¦)ä¸‹é‡å‘½åä¸º ffmpeg(æ–¹ä¾¿ä»¥åæ‰¾)</li>\n<li>è®¾ç½®ç¯å¢ƒå˜é‡, æˆ‘çš„ç”µè„‘ -&gt; å±æ€§ -&gt; é«˜çº§ç³»ç»Ÿè®¾ç½® -&gt; ç¯å¢ƒå˜é‡ -&gt; ç³»ç»Ÿå˜é‡ -&gt; æ–°å¢, è·¯å¾„é€‰æ‹©åˆšåˆš C ç›˜ä¸‹çš„ ffmpegæ–‡ä»¶å¤¹ä¸­çš„ bin æ–‡ä»¶å¤¹</li>\n<li>æ³¨é”€æˆ–é‡å¯ç”µè„‘è®©ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ</li>\n<li>æµ‹è¯•, åœ¨ cmd ä¸­è¾“å…¥ <code>ffmpeg -version</code>,  å¦‚æœå‡ºç°ç‰ˆæœ¬å·ä¹‹ç±»çš„ä¸œè¥¿åˆ™æˆåŠŸ.</li>\n</ol>\n<ul>\n<li>Mac å¹³å°<br>Mac ä¸‹å¯ä»¥ç›´æ¥é€šè¿‡ <code>Homebrew</code> å®‰è£…æœ€ä¸ºç®€å•.</li>\n</ul>\n<ol>\n<li>å®‰è£… <code>Homebrew</code>, åœ¨ç»ˆç«¯ä¸­è¾“å…¥ <code>ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;</code></li>\n<li>å®‰è£… FFmpeg, ç›´æ¥åœ¨ç»ˆç«¯ä¸­è¾“å…¥ <code>brew install ffmpeg</code> å³å¯</li>\n<li>æµ‹è¯•, åŒæ ·åœ¨ç»ˆç«¯ä¸­è¾“å…¥ <code>ffmpeg -version</code> æŸ¥çœ‹ç‰ˆæœ¬å·</li>\n</ol>\n<p><strong>å®‰è£… Node.js</strong><br>è¿™ä¸ªå°±ä¸å±•å¼€è¯¦ç»†è¯´äº†, æ¯ä¸ªå‰ç«¯éƒ½æœ‰å§â€¦</p>\n<h3 id=\"æ–¹æ¡ˆä¸€-img-æ ‡ç­¾\"><a href=\"#æ–¹æ¡ˆä¸€-img-æ ‡ç­¾\" class=\"headerlink\" title=\"æ–¹æ¡ˆä¸€: img æ ‡ç­¾\"></a>æ–¹æ¡ˆä¸€: img æ ‡ç­¾</h3><p>å½“æ—¶æƒ³åˆ°çš„ç¬¬ä¸€ç§æ–¹æ¡ˆä¹Ÿæ˜¯æœ€ç®€å•çš„æ–¹æ¡ˆ, æ˜¯å°†è§†é¢‘æµçš„æ¯ä¸€å¸§è½¬åŒ–ä¸º base64 å†é€šè¿‡åŠ¨æ€æ›¿æ¢ <code>&lt;img&gt;</code> çš„ src å±æ€§æ¥è¾¾åˆ°é¢„è§ˆçš„æ•ˆæœ.ä¸­é—´ç”¨åˆ°äº†<a href=\"https://github.com/agsh/rtsp-ffmpeg\" target=\"_blank\" rel=\"noopener\">rtsp-ffmpeg</a>, è¿™ä¸ªåº“çš„æ€è·¯æ˜¯é€šè¿‡ websocket å‘é€æ¯ä¸€å¸§è§†é¢‘çš„ bytes åˆ°å®¢æˆ·ç«¯, å®¢æˆ·ç«¯å¯ä»¥é€šè¿‡ <code>&lt;img&gt;</code> æ ‡ç­¾æ¥å±•ç¤º.</p>\n<p>ç¤ºä¾‹: </p>\n<p>node ç«¯<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> app = <span class=\"built_in\">require</span>(<span class=\"string\">'express'</span>)()</span><br><span class=\"line\"><span class=\"keyword\">const</span> server = <span class=\"built_in\">require</span>(<span class=\"string\">'http'</span>).Server(app)</span><br><span class=\"line\"><span class=\"keyword\">const</span> io = <span class=\"built_in\">require</span>(<span class=\"string\">'socket.io'</span>)(server)</span><br><span class=\"line\"><span class=\"keyword\">const</span> rtsp = <span class=\"built_in\">require</span>(<span class=\"string\">'rtsp-ffmpeg'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">server.listen(<span class=\"number\">8081</span>, () =&gt; &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'server listening on 8081'</span>)</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// uri ä»¥æµ·åº·æ‘„åƒæœºçš„ rtsp åè®®ä¸ºä¾‹</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> uri = <span class=\"string\">'rtps://admin:password@ip:port/h264/ch1/sub/av_stream'</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> stream = <span class=\"keyword\">new</span> rtsp.FFMpeg(&#123;</span><br><span class=\"line\">    input: uri,</span><br><span class=\"line\">    resolution: <span class=\"string\">'1080x720'</span>,</span><br><span class=\"line\">    quality: <span class=\"number\">3</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">stream.on(<span class=\"string\">'start'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'stream'</span>)</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">stream.on(<span class=\"string\">'stop'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'stream stopped'</span>)</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">io.on(<span class=\"string\">'connection'</span>, socket =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> pipeStream = <span class=\"function\"><span class=\"params\">data</span> =&gt;</span> &#123;</span><br><span class=\"line\">        socket.emit(<span class=\"string\">'data'</span>, data)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    stream.on(<span class=\"string\">'data'</span>, pipeStream)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// åˆ‡æ¢æ‘„åƒæœº</span></span><br><span class=\"line\">    socket.on(<span class=\"string\">'URI'</span>, data =&gt; &#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(data)</span><br><span class=\"line\">        uri = <span class=\"string\">`rtsp://<span class=\"subst\">$&#123;data.userName&#125;</span>:<span class=\"subst\">$&#123;data.passWord&#125;</span>@<span class=\"subst\">$&#123;data.ip&#125;</span>:<span class=\"subst\">$&#123;data.port&#125;</span>/h264/ch1/sub/av_stream`</span></span><br><span class=\"line\">        stream.input = uri</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// é‡å¯</span></span><br><span class=\"line\">        stream.restart()</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">    socket.on(<span class=\"string\">'disconnect'</span> () =&gt; &#123;</span><br><span class=\"line\">        stream.removeListener(<span class=\"string\">'data'</span>, pipeStream)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure></p>\n<p>å®¢æˆ·ç«¯<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">id</span>=<span class=\"string\">'img'</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">'/socket.io/socket.io.js'</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">\t<span class=\"keyword\">var</span> io = io();</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"keyword\">let</span> img = <span class=\"built_in\">document</span>.querySelector(<span class=\"string\">'#img'</span>)</span></span><br><span class=\"line\"><span class=\"javascript\">\tio.on(<span class=\"string\">'data'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">data</span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"keyword\">let</span> bytes = <span class=\"keyword\">new</span> Unit8Array(data)</span></span><br><span class=\"line\"><span class=\"javascript\">        img.src = <span class=\"string\">'data:image/jpeg;base64,'</span> + base64ArrayBuffer(bytes)</span></span><br><span class=\"line\"><span class=\"undefined\">\t\t\t</span></span><br><span class=\"line\"><span class=\"undefined\">\t&#125;)</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"comment\">// byte æ•°ç»„è½¬ base64 (è¿™æ®µæ˜¯åœ¨å…¶ä»–åœ°æ–¹æŠ„çš„)</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">base64ArrayBuffer</span>(<span class=\"params\">arrayBuffer</span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t<span class=\"keyword\">var</span> base64    = <span class=\"string\">''</span>;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t<span class=\"keyword\">var</span> encodings = <span class=\"string\">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span>;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t<span class=\"keyword\">var</span> bytes         = <span class=\"keyword\">new</span> <span class=\"built_in\">Uint8Array</span>(arrayBuffer);</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t<span class=\"keyword\">var</span> byteLength    = bytes.byteLength;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t<span class=\"keyword\">var</span> byteRemainder = byteLength % <span class=\"number\">3</span>;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t<span class=\"keyword\">var</span> mainLength    = byteLength - byteRemainder;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t<span class=\"keyword\">var</span> a, b, c, d;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t<span class=\"keyword\">var</span> chunk;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t<span class=\"comment\">// Main loop deals with bytes in chunks of 3</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; mainLength; i = i + <span class=\"number\">3</span>) &#123;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">// Combine the three bytes into a single integer</span></span></span><br><span class=\"line\"><span class=\"undefined\">\t\t\tchunk = (bytes[i] &lt;&lt; 16) | (bytes[i + 1] &lt;&lt; 8) | bytes[i + 2];</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">// Use bitmasks to extract 6-bit segments from the triplet</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\ta = (chunk &amp; <span class=\"number\">16515072</span>) &gt;&gt; <span class=\"number\">18</span>; <span class=\"comment\">// 16515072 = (2^6 - 1) &lt;&lt; 18</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\tb = (chunk &amp; <span class=\"number\">258048</span>)   &gt;&gt; <span class=\"number\">12</span>; <span class=\"comment\">// 258048   = (2^6 - 1) &lt;&lt; 12</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\tc = (chunk &amp; <span class=\"number\">4032</span>)     &gt;&gt;  <span class=\"number\">6</span>; <span class=\"comment\">// 4032     = (2^6 - 1) &lt;&lt; 6</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\td = chunk &amp; <span class=\"number\">63</span>;               <span class=\"comment\">// 63       = 2^6 - 1</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">// Convert the raw binary segments to the appropriate ASCII encoding</span></span></span><br><span class=\"line\"><span class=\"undefined\">\t\t\tbase64 += encodings[a] + encodings[b] + encodings[c] + encodings[d];</span></span><br><span class=\"line\"><span class=\"undefined\">\t\t&#125;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t<span class=\"comment\">// Deal with the remaining bytes and padding</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t<span class=\"keyword\">if</span> (byteRemainder == <span class=\"number\">1</span>) &#123;</span></span><br><span class=\"line\"><span class=\"undefined\">\t\t\tchunk = bytes[mainLength];</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\ta = (chunk &amp; <span class=\"number\">252</span>) &gt;&gt; <span class=\"number\">2</span>; <span class=\"comment\">// 252 = (2^6 - 1) &lt;&lt; 2</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">// Set the 4 least significant bits to zero</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\tb = (chunk &amp; <span class=\"number\">3</span>)   &lt;&lt; <span class=\"number\">4</span>; <span class=\"comment\">// 3   = 2^2 - 1</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\tbase64 += encodings[a] + encodings[b] + <span class=\"string\">'=='</span>;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (byteRemainder == <span class=\"number\">2</span>) &#123;</span></span><br><span class=\"line\"><span class=\"undefined\">\t\t\tchunk = (bytes[mainLength] &lt;&lt; 8) | bytes[mainLength + 1];</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\ta = (chunk &amp; <span class=\"number\">64512</span>) &gt;&gt; <span class=\"number\">10</span>; <span class=\"comment\">// 64512 = (2^6 - 1) &lt;&lt; 10</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\tb = (chunk &amp; <span class=\"number\">1008</span>)  &gt;&gt;  <span class=\"number\">4</span>; <span class=\"comment\">// 1008  = (2^6 - 1) &lt;&lt; 4</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">// Set the 2 least significant bits to zero</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\tc = (chunk &amp; <span class=\"number\">15</span>)    &lt;&lt;  <span class=\"number\">2</span>; <span class=\"comment\">// 15    = 2^4 - 1</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\tbase64 += encodings[a] + encodings[b] + encodings[c] + <span class=\"string\">'='</span>;</span></span><br><span class=\"line\"><span class=\"undefined\">\t\t&#125;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t<span class=\"keyword\">return</span> base64;</span></span><br><span class=\"line\"><span class=\"undefined\">\t&#125;</span></span><br><span class=\"line\"><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br></pre></td></tr></table></figure></p>\n<p>è¿™ç§é€šè¿‡ img çš„æ–¹å¼æš´éœ²å‡ºçš„é—®é¢˜æ˜¯éœ€è¦åœ¨å‰ç«¯è§£ç , å¯¼è‡´ä¸‹ä¸€å¸§åˆ°æ¥æ—¶ä¸Šä¸€å¸§çš„ç”»é¢è¿˜æ²¡è§£ç å®Œæˆ. å°±ä¼šæœ‰èŠ±å±ç”šè‡³ç”»é¢åªæ˜¾ç¤ºä¸€åŠçš„é—®é¢˜å’Œå»¶è¿Ÿè¾ƒå¤§ä¸”å»¶è¿Ÿä¼šç´¯ç§¯, åœ¨æ§åˆ¶å°ä¸­ä½ ä¼šçœ‹åˆ°ç–¯ç‹‚åˆ·ä»å†…å­˜æ¥çš„è¯·æ±‚, å¦‚æœä½ æƒ³çœ‹çœ‹ http è¯·æ±‚å¯èƒ½ä¼šç–¯. æ‰€ä»¥è¿™ç§æ–¹å¼è‚¯å®šä¸è¡Œ</p>\n<p>è¿™ä¸ª <code>rtsp-ffmpeg</code> è¿˜æä¾›ä¸€ç§ canvas çš„æ–¹å¼, åªæ˜¯åœ¨å®¢æˆ·ç«¯åšä¸€äº›ä¿®æ”¹:<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> io = io();</span><br><span class=\"line\"><span class=\"comment\">// æŠŠä¹‹å‰çš„ img æ ‡ç­¾æ¢æˆ canvas</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> canvas = <span class=\"built_in\">document</span>.querySelector(<span class=\"string\">'#canvas'</span>)</span><br><span class=\"line\">io.on(<span class=\"string\">'data'</span>, data =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> bytes = <span class=\"keyword\">new</span> <span class=\"built_in\">Uint8Array</span>(data)</span><br><span class=\"line\">\t\t\t\t\t</span><br><span class=\"line\">    <span class=\"keyword\">var</span> blob = <span class=\"keyword\">new</span> Blob([bytes], &#123;<span class=\"attr\">type</span>: <span class=\"string\">'application/octet-binary'</span>&#125;)</span><br><span class=\"line\">                    </span><br><span class=\"line\">    <span class=\"keyword\">var</span> url = URL.createObjectURL(blob)</span><br><span class=\"line\">                    </span><br><span class=\"line\">    <span class=\"keyword\">var</span> img = <span class=\"keyword\">new</span> Image</span><br><span class=\"line\">                    </span><br><span class=\"line\">    <span class=\"keyword\">var</span> ctx = canvas.getContext(<span class=\"string\">\"2d\"</span>)</span><br><span class=\"line\">        img.width = img.width * <span class=\"number\">0.5</span></span><br><span class=\"line\">        img.height = img.height * <span class=\"number\">0.5</span></span><br><span class=\"line\">        img.onload = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">            URL.revokeObjectURL(url)</span><br><span class=\"line\">            ctx.drawImage(img, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">1080</span>, <span class=\"number\">720</span>)</span><br><span class=\"line\">        &#125;;    </span><br><span class=\"line\">    img.src = url</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure></p>\n<p>ç”¨ canvas çš„æ–¹æ³•è™½ç„¶æ¯” img çš„æ•ˆæœå¥½ä¸€ç‚¹, ä½†æ˜¯æœ€ç»ˆæ•ˆæœä»ç„¶æ˜¯ä¸å°½äººæ„. å›¾åƒå¾ˆä¸ç¨³å®š, è¡¨ç°ä¸ºä¸€åŠç”»é¢ä¸€åŠç»¿å±, å¦‚æœè§†é¢‘ä¸­å›¾åƒå˜æ¢å‰§çƒˆçš„è¯è¡¨ç°ä¼šæ›´å·®, æ‰€ä»¥è¿™ç§æ–¹æ³•ä¹Ÿä¸å¤ªè¡Œ. å…¶å®åœ¨è¿™ä¸­é—´æˆ‘å¹¶æ²¡æœ‰åšä»€ä¹ˆæ“ä½œåªæ˜¯å°†è¿™ä¸ª demo é›†æˆåœ¨äº† vue ä¸­, å†åŠ ä¸Šå¤šæ‘„åƒæœºçš„åˆ‡æ¢å’Œä¸»æµæ‘„åƒæœºå‚å•†çš„æ”¯æŒ(å› ä¸ºæ¯ä¸ªæ‘„åƒæœºå‚å•†çš„ rtsp åè®®çš„ç»“æ„ä¸ä¸€æ ·)è€Œå·², æ‰€ä»¥ç¬¬ä¸€æƒ³æ³•æ˜¯èƒ½ä¸èƒ½åœ¨è§£ç è¿™å—æ‰¾åˆ°æ›´å¥½è§£å†³åŠæ³•, äºæ˜¯åˆæ‰¾åˆ°äº†å¦ä¸€ä¸ªåº“ <a href=\"https://github.com/phoboslab/jsmpeg\" target=\"_blank\" rel=\"noopener\">jsmpeg</a> æ–¹æ¡ˆäºŒå°±æ¥äº†.</p>\n<h3 id=\"æ–¹æ¡ˆäºŒ-jsmpeg\"><a href=\"#æ–¹æ¡ˆäºŒ-jsmpeg\" class=\"headerlink\" title=\"æ–¹æ¡ˆäºŒ: jsmpeg\"></a>æ–¹æ¡ˆäºŒ: jsmpeg</h3><p>è¿™ä¸ªåº“è¿˜ç®—æ¯”è¾ƒä¸é”™çš„äº†, ä¹Ÿæ˜¯é€šè¿‡ websocket æ¥è½¬å‘, çœ‹å®˜æ–¹çš„ä¾‹å­æ˜¯åœ¨ç»ˆç«¯ä¸­å¯åŠ¨ ffmpeg -&gt; websocket -&gt; å®¢æˆ·ç«¯é€šè¿‡ <code>jsmpeg.min.js</code> è§£ç åœ¨ canvas ä¸­æ’­æ”¾. å› ä¸ºè¿™é‡Œåªæ˜¯å®ç°äº†æ’­æ”¾, åœ¨è¿™ä¸ªåŸºç¡€ä¸Šæˆ‘ä»¬è¿˜éœ€è¦åœ¨è„šæœ¬ä¸­è‡ªå¯ ffmpeg / åˆ‡æ¢/ é‡å¯, ç„¶ååˆå»æ‰¾äº†ä¸€ä¸ªåŸºäº <code>jsmpeg</code> çš„åº“ <a href=\"https://github.com/kyriesent/node-rtsp-stream\" target=\"_blank\" rel=\"noopener\">node-rtsp-stream</a>. è¿™ä¸ªåº“åªæ˜¯åšäº†ä¸€äº›å°è£…è®©æˆ‘ä»¬ä¸ç”¨è‡ªå·±åœ¨ç»ˆç«¯ä¸­æ‰‹åŠ¨å¯ç”¨ ffmpeg, åœ¨æ­¤ä¹‹ä¸Šæˆ‘å†åŠ ä¸Šé‡å¯å°±èƒ½æ»¡è¶³ç°åœ¨çš„éœ€æ±‚.</p>\n<p>ç¤ºä¾‹:</p>\n<ol>\n<li>æ”¹é€  <code>node-rtsp-stream</code></li>\n</ol>\n<p>node-rtsp-stream/videoStream.js<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> Mpeg1Muxer, STREAM_MAGIC_BYTES, VideoStream, events, util, ws;</span><br><span class=\"line\"></span><br><span class=\"line\">    ws = <span class=\"built_in\">require</span>(<span class=\"string\">'ws'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    util = <span class=\"built_in\">require</span>(<span class=\"string\">'util'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    events = <span class=\"built_in\">require</span>(<span class=\"string\">'events'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    Mpeg1Muxer = <span class=\"built_in\">require</span>(<span class=\"string\">'./mpeg1muxer'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    STREAM_MAGIC_BYTES = <span class=\"string\">\"jsmp\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> child_process = <span class=\"built_in\">require</span>(<span class=\"string\">'child_process'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    VideoStream = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">options</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.name = options.name;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.streamUrl = options.streamUrl;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.width = options.width;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.height = options.height;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.wsPort = options.wsPort;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.inputStreamStarted = <span class=\"literal\">false</span>;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.stream = <span class=\"keyword\">void</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.startMpeg1Stream();</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.pipeStreamToSocketServer();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    util.inherits(VideoStream, events.EventEmitter);</span><br><span class=\"line\">    <span class=\"comment\">// åœæ­¢è§†é¢‘æµ</span></span><br><span class=\"line\">    VideoStream.prototype.stop = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.mpeg1Muxer) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.mpeg1Muxer.stream.stop()</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// é‡å¯è§†é¢‘æµ</span></span><br><span class=\"line\">    VideoStream.prototype.restart = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.mpeg1Muxer) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.mpeg1Muxer.stream.stop()</span><br><span class=\"line\">            <span class=\"built_in\">console</span>.log(<span class=\"string\">'ffmpeg is restart'</span>)</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.inputStreamStarted = <span class=\"literal\">false</span>;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.stream = <span class=\"keyword\">void</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.startMpeg1Stream();</span><br><span class=\"line\">            <span class=\"comment\">// ç›‘å¬ ffmpeg è¿›ç¨‹æ˜¯å¦å…³é—­</span></span><br><span class=\"line\">            <span class=\"keyword\">this</span>.mpeg1Muxer.on(<span class=\"string\">'ffmpegClose'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">code</span>) </span>&#123;</span><br><span class=\"line\">                <span class=\"built_in\">console</span>.log(<span class=\"string\">'ffmpeg closed on '</span> + code)</span><br><span class=\"line\">            &#125;)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    VideoStream.prototype.startMpeg1Stream = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// çœç•¥æ‰“å¼€æµçš„æ–¹æ³•, è¿™éƒ¨åˆ†æ²¡æœ‰åšæ”¹åŠ¨</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    VideoStream.prototype.pipeStreamToSocketServer = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// å°†æµå¡ç»™ socket, åŒæ ·ä¹Ÿæ²¡æ”¹</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    VideoStream.prototype.onSocketConnect = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">socket</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> self, streamHeader;</span><br><span class=\"line\">        self = <span class=\"keyword\">this</span>;</span><br><span class=\"line\">        streamHeader = <span class=\"keyword\">new</span> Buffer(<span class=\"number\">8</span>);</span><br><span class=\"line\">        streamHeader.write(STREAM_MAGIC_BYTES);</span><br><span class=\"line\">        streamHeader.writeUInt16BE(<span class=\"keyword\">this</span>.width, <span class=\"number\">4</span>);</span><br><span class=\"line\">        streamHeader.writeUInt16BE(<span class=\"keyword\">this</span>.height, <span class=\"number\">6</span>);</span><br><span class=\"line\">        socket.send(streamHeader, &#123;</span><br><span class=\"line\">            binary: <span class=\"literal\">true</span></span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log((<span class=\"string\">\"\"</span> + <span class=\"keyword\">this</span>.name + <span class=\"string\">\": New WebSocket Connection (\"</span>) + <span class=\"keyword\">this</span>.wsServer.clients.length + <span class=\"string\">\" total)\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> socket.on(<span class=\"string\">\"close\"</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">code, message</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">console</span>.log((<span class=\"string\">\"\"</span> + <span class=\"keyword\">this</span>.name + <span class=\"string\">\": Disconnected WebSocket (\"</span>) + self.wsServer.clients.length + <span class=\"string\">\" total)\"</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">module</span>.exports = VideoStream;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;).call(<span class=\"keyword\">this</span>);</span><br></pre></td></tr></table></figure></p>\n<p>node-rtsp-stream/videoStream.js<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> Mpeg1Muxer, child_process, events, util;</span><br><span class=\"line\"></span><br><span class=\"line\">    child_process = <span class=\"built_in\">require</span>(<span class=\"string\">'child_process'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    util = <span class=\"built_in\">require</span>(<span class=\"string\">'util'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    events = <span class=\"built_in\">require</span>(<span class=\"string\">'events'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    Mpeg1Muxer = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">options</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> self;</span><br><span class=\"line\">        self = <span class=\"keyword\">this</span>;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.url = options.url;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.stream = child_process.spawn(<span class=\"string\">\"ffmpeg\"</span>, </span><br><span class=\"line\">            [</span><br><span class=\"line\">                <span class=\"string\">\"-rtsp_transport\"</span>,</span><br><span class=\"line\">                <span class=\"string\">\"tcp\"</span>,</span><br><span class=\"line\">                <span class=\"string\">\"-i\"</span>,</span><br><span class=\"line\">                <span class=\"keyword\">this</span>.url,</span><br><span class=\"line\">                <span class=\"string\">'-s'</span>, </span><br><span class=\"line\">                <span class=\"comment\">// å›¾åƒå®½é«˜</span></span><br><span class=\"line\">                <span class=\"string\">`<span class=\"subst\">$&#123;options.width&#125;</span>x<span class=\"subst\">$&#123;options.height&#125;</span>`</span>, </span><br><span class=\"line\">                <span class=\"string\">'-f'</span>, </span><br><span class=\"line\">                <span class=\"string\">'mpeg1video'</span>, </span><br><span class=\"line\">                <span class=\"string\">'-b:v'</span>, </span><br><span class=\"line\">                <span class=\"string\">'800k'</span>, </span><br><span class=\"line\">                <span class=\"string\">'-r'</span>, </span><br><span class=\"line\">                <span class=\"string\">'30'</span>, </span><br><span class=\"line\">                <span class=\"string\">'-'</span></span><br><span class=\"line\">            ], </span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                detached: <span class=\"literal\">false</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        );</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.inputStreamStarted = <span class=\"literal\">true</span>;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.stream.stdout.on(<span class=\"string\">'data'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">data</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> self.emit(<span class=\"string\">'mpeg1data'</span>, data);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.stream.stderr.on(<span class=\"string\">'data'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">data</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> self.emit(<span class=\"string\">'ffmpegError'</span>, data);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"comment\">// kill ffmpeg</span></span><br><span class=\"line\">        <span class=\"keyword\">this</span>.stream.stop = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"comment\">// console.log(self.stream.pid)</span></span><br><span class=\"line\">            self.stream.stdin.pause();</span><br><span class=\"line\">            self.stream.kill()</span><br><span class=\"line\">            <span class=\"built_in\">console</span>.log(<span class=\"string\">'ffmpeg is be kill'</span>)</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"comment\">// ç›‘å¬ ffmpeg é€€å‡º</span></span><br><span class=\"line\">        <span class=\"keyword\">this</span>.stream.on(<span class=\"string\">'exit'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">code</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> self.emit(<span class=\"string\">'ffmpegClose'</span>, code)</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    util.inherits(Mpeg1Muxer, events.EventEmitter);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">module</span>.exports = Mpeg1Muxer;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;).call(<span class=\"keyword\">this</span>);</span><br></pre></td></tr></table></figure></p>\n<ol start=\"2\">\n<li>node ç«¯ä½¿ç”¨</li>\n</ol>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> app = <span class=\"built_in\">require</span>(<span class=\"string\">'express'</span>)()</span><br><span class=\"line\"><span class=\"keyword\">const</span> server = <span class=\"built_in\">require</span>(<span class=\"string\">'http'</span>).Server(app)</span><br><span class=\"line\"><span class=\"keyword\">const</span> io = <span class=\"built_in\">require</span>(<span class=\"string\">'socket.io'</span>)(server)</span><br><span class=\"line\"><span class=\"comment\">// å¼•å…¥æ”¹é€ åçš„ node-rtsp-stream</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> Rtsp = <span class=\"built_in\">require</span>(<span class=\"string\">'./node-rtsp-stream'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">server.listen(<span class=\"number\">8081</span>, () =&gt; &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'server listening on 8081'</span>)</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// uri ä»¥æµ·åº·æ‘„åƒæœºçš„ rtsp åè®®ä¸ºä¾‹</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> uri = <span class=\"string\">'rtps://admin:password@ip:port/h264/ch1/sub/av_stream'</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> stream = <span class=\"keyword\">new</span> Rtsp(&#123;</span><br><span class=\"line\">    name: <span class=\"string\">'rtsp_stream'</span>,</span><br><span class=\"line\">    streamUrl: uri,</span><br><span class=\"line\">    wsPort: <span class=\"number\">11111</span>,</span><br><span class=\"line\">    width: <span class=\"number\">720</span>,</span><br><span class=\"line\">    height: <span class=\"number\">405</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">stream.on(<span class=\"string\">'start'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'stream'</span>)</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">stream.on(<span class=\"string\">'stop'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'stream stopped'</span>)</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">io.on(<span class=\"string\">'connection'</span>, socket =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> pipeStream = <span class=\"function\"><span class=\"params\">data</span> =&gt;</span> &#123;</span><br><span class=\"line\">        socket.emit(<span class=\"string\">'data'</span>, data)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    stream.on(<span class=\"string\">'data'</span>, pipeStream)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// åˆ‡æ¢æ‘„åƒæœº</span></span><br><span class=\"line\">    socket.on(<span class=\"string\">'URI'</span>, data =&gt; &#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(data)</span><br><span class=\"line\">        uri = <span class=\"string\">`rtsp://<span class=\"subst\">$&#123;data.userName&#125;</span>:<span class=\"subst\">$&#123;data.passWord&#125;</span>@<span class=\"subst\">$&#123;data.ip&#125;</span>:<span class=\"subst\">$&#123;data.port&#125;</span>/h264/ch1/sub/av_stream`</span></span><br><span class=\"line\">        stream.streamUrl = uri;</span><br><span class=\"line\">        <span class=\"comment\">// é‡å¯</span></span><br><span class=\"line\">        stream.restart()</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">    socket.on(<span class=\"string\">'disconnect'</span> () =&gt; &#123;</span><br><span class=\"line\">        stream.removeListener(<span class=\"string\">'data'</span>, pipeStream)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li>å®¢æˆ·ç«¯</li>\n</ol>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">canvas</span> <span class=\"attr\">id</span>=<span class=\"string\">'can'</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">canvas</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">'jsmpeg.min.js'</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"keyword\">let</span> canvas = <span class=\"built_in\">document</span>.querySelector(<span class=\"string\">'#can'</span>)</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"keyword\">let</span> ws = <span class=\"keyword\">new</span> WebSocket(<span class=\"string\">'ws://127.0.0.1:11111'</span>)</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"keyword\">let</span> player = <span class=\"keyword\">new</span> jsmpeg(ws, &#123;</span></span><br><span class=\"line\"><span class=\"undefined\">        canvas: canvas,</span></span><br><span class=\"line\"><span class=\"javascript\">        autoplay: <span class=\"literal\">true</span></span></span><br><span class=\"line\"><span class=\"undefined\">    &#125;)</span></span><br><span class=\"line\"><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>è¿™ä¸ªæ–¹æ¡ˆå…¶å®ä½¿ç”¨äº†å¾ˆä¹…ä¸€ç›´éƒ½æ²¡å‘ç°é—®é¢˜, æ˜¯åœ¨ä¸€è·¯æ‘„åƒæœºå®‰ç½®åœ¨å¤©æ¡¥é™„è¿‘äººæµé‡å‰§å¢, ä¸è¿™ä¸ªè§†é¢‘é¢„è§ˆåŒä¸€é¡µé¢è¿˜æœ‰ä¸€ä¸ªäººè„¸å®æ—¶æŠ“æ‹çš„å³æ—¶æ¶ˆæ¯æ¨é€çš„åŠŸèƒ½, å¯¼è‡´åœ¨20 - 30åˆ†é’Ÿæµè§ˆå™¨ç›´æ¥å‡æ­»æˆ–è€…å´©æºƒ.(ç„¶åè¿™ä¸ªæ–¹æ¡ˆåˆå‡‰äº†ğŸ˜‚)</p>\n<h3 id=\"æ–¹æ¡ˆä¸‰-FFmpeg-Nginx-video-js\"><a href=\"#æ–¹æ¡ˆä¸‰-FFmpeg-Nginx-video-js\" class=\"headerlink\" title=\"æ–¹æ¡ˆä¸‰: FFmpeg + Nginx + video.js\"></a>æ–¹æ¡ˆä¸‰: FFmpeg + Nginx + video.js</h3><p>æ–¹æ¡ˆä¸‰ä¸‹æ¬¡å†™~</p>\n<p>Created on 2017/7/26 by Cara</p>\n","site":{"data":{}},"excerpt":"","more":"<p>å¯¹äºç½‘ç»œæ‘„åƒæœºåšè§†é¢‘é¢„è§ˆè¿™å—, æœ¬èº«å…¶å®æ˜¯éå¸¸é™Œç”Ÿçš„, å½“æ—¶æ¥åˆ°è¿™ä¸ªéœ€æ±‚ä¹Ÿæ˜¯ç›¸å½“çš„å¤´ç–¼(å¯¹äºå½“æ—¶ä¸€å¹´ç»éªŒä¸åˆ°çš„æˆ‘æ¥è¯´).å½“æ—¶æˆ‘ä»¬çš„åº”ç”¨åœºæ™¯æ˜¯: å¤šè·¯ç½‘ç»œæ‘„åƒæœºé€šè¿‡å±€åŸŸç½‘è¿æ¥, PC ç«¯èƒ½å¤Ÿå®æ—¶é¢„è§ˆç›‘æ§ç”»é¢å¹¶ä¸”ç”»è´¨è¾¾åˆ°720p, å»¶è¿Ÿä¸èƒ½è¶…è¿‡10ç§’, å¤šä¸ªæ‘„åƒæœºèƒ½å¤Ÿåˆ‡æ¢æŸ¥çœ‹. ç”±äºåç«¯åªæä¾›ä¸€ä¸ª RTSP çš„ç›´æ’­åè®®, æ‰€ä»¥æ‰€æœ‰çš„æ–¹æ¡ˆéƒ½æ˜¯å›´ç»•ç€ RTSP è¿™ä¸ªå…³é”®è¯. å½“æ—¶æ—¶é—´å¾ˆèµ¶æ‰€ä»¥è¦è‡ªå·±æ…¢æ…¢ç ”ç©¶æ˜¯ä¸å¯èƒ½äº†, åªèƒ½å»æ‰¾ç°æˆçš„åº“.</p>\n<blockquote>\n<p>ç°ç›®å‰ç”¨è¿‡ä¸‰ç§æ–¹æ¡ˆ, éƒ½ä¸å®Œç¾.</p>\n</blockquote>\n<h3 id=\"æ•´ä½“æ€è·¯\"><a href=\"#æ•´ä½“æ€è·¯\" class=\"headerlink\" title=\"æ•´ä½“æ€è·¯\"></a>æ•´ä½“æ€è·¯</h3><p>ç»è¿‡ä¸€æ³¢è°ƒç ”(google)ä¹‹å, çŸ¥é“æµè§ˆå™¨å¯¹ RTSP åè®®å¹¶ä¸å‹å¥½, ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¿…é¡»è¦è‡ªå·±è½¬ç å†æä¾›ç»™æµè§ˆå™¨ä½¿ç”¨, æ‰¾åˆ°çš„è§£å†³æ€è·¯å¤§æ¦‚æ˜¯:</p>\n<ol>\n<li>è½¬ç : <a href=\"https://www.ffmpeg.org/\" target=\"_blank\" rel=\"noopener\">FFmpeg</a> æ˜¯ä¸€ä¸ªè€ç‰Œçš„è½¬ç å·¥å…·, éå¸¸å¼ºå¤§</li>\n<li>Node.js ç”¨ä½œä¸­è½¬ç«™æ¥æ”¶å®¢æˆ·ç«¯å‘æ¥çš„æ‘„åƒæœºä¿¡æ¯åŠæ§åˆ¶ FFmpeg æ¨æµ</li>\n<li>æœ€ç»ˆå®¢æˆ·ç«¯æ¥æ”¶è§†é¢‘æµ</li>\n</ol>\n<p>ä¸‹é¢æˆ‘è¯•è¿‡çš„ä¸‰ç§æ–¹æ¡ˆ, åŸºæœ¬ç»“æ„éƒ½å¦‚æ­¤åªæ˜¯æ¨æµçš„æ–¹å¼å’Œå®¢æˆ·ç«¯çš„æ¥æ”¶æ–¹å¼æœ‰æ‰€ä¸åŒ.</p>\n<h3 id=\"å‡†å¤‡\"><a href=\"#å‡†å¤‡\" class=\"headerlink\" title=\"å‡†å¤‡\"></a>å‡†å¤‡</h3><p><strong>å®‰è£… FFmpeg è½¬ç å·¥å…·</strong></p>\n<ul>\n<li>window å¹³å°</li>\n</ul>\n<ol>\n<li><a href=\"http://ffmpeg.zeranoe.com/builds/\" target=\"_blank\" rel=\"noopener\">ä¸‹è½½ FFmpeg</a> è§£å‹ååº”è¯¥æ˜¯å·²ç»ç¼–è¯‘å¥½çš„æ–‡ä»¶</li>\n<li>å°†è§£å‹å¥½çš„æ–‡ä»¶æ”¾å…¥ C ç›˜æ ¹ç›®å½•(ä¹Ÿå¯ä»¥è‡ªè¡Œæ”¾å…¥å…¶ä»–ç›˜ç¬¦)ä¸‹é‡å‘½åä¸º ffmpeg(æ–¹ä¾¿ä»¥åæ‰¾)</li>\n<li>è®¾ç½®ç¯å¢ƒå˜é‡, æˆ‘çš„ç”µè„‘ -&gt; å±æ€§ -&gt; é«˜çº§ç³»ç»Ÿè®¾ç½® -&gt; ç¯å¢ƒå˜é‡ -&gt; ç³»ç»Ÿå˜é‡ -&gt; æ–°å¢, è·¯å¾„é€‰æ‹©åˆšåˆš C ç›˜ä¸‹çš„ ffmpegæ–‡ä»¶å¤¹ä¸­çš„ bin æ–‡ä»¶å¤¹</li>\n<li>æ³¨é”€æˆ–é‡å¯ç”µè„‘è®©ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ</li>\n<li>æµ‹è¯•, åœ¨ cmd ä¸­è¾“å…¥ <code>ffmpeg -version</code>,  å¦‚æœå‡ºç°ç‰ˆæœ¬å·ä¹‹ç±»çš„ä¸œè¥¿åˆ™æˆåŠŸ.</li>\n</ol>\n<ul>\n<li>Mac å¹³å°<br>Mac ä¸‹å¯ä»¥ç›´æ¥é€šè¿‡ <code>Homebrew</code> å®‰è£…æœ€ä¸ºç®€å•.</li>\n</ul>\n<ol>\n<li>å®‰è£… <code>Homebrew</code>, åœ¨ç»ˆç«¯ä¸­è¾“å…¥ <code>ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;</code></li>\n<li>å®‰è£… FFmpeg, ç›´æ¥åœ¨ç»ˆç«¯ä¸­è¾“å…¥ <code>brew install ffmpeg</code> å³å¯</li>\n<li>æµ‹è¯•, åŒæ ·åœ¨ç»ˆç«¯ä¸­è¾“å…¥ <code>ffmpeg -version</code> æŸ¥çœ‹ç‰ˆæœ¬å·</li>\n</ol>\n<p><strong>å®‰è£… Node.js</strong><br>è¿™ä¸ªå°±ä¸å±•å¼€è¯¦ç»†è¯´äº†, æ¯ä¸ªå‰ç«¯éƒ½æœ‰å§â€¦</p>\n<h3 id=\"æ–¹æ¡ˆä¸€-img-æ ‡ç­¾\"><a href=\"#æ–¹æ¡ˆä¸€-img-æ ‡ç­¾\" class=\"headerlink\" title=\"æ–¹æ¡ˆä¸€: img æ ‡ç­¾\"></a>æ–¹æ¡ˆä¸€: img æ ‡ç­¾</h3><p>å½“æ—¶æƒ³åˆ°çš„ç¬¬ä¸€ç§æ–¹æ¡ˆä¹Ÿæ˜¯æœ€ç®€å•çš„æ–¹æ¡ˆ, æ˜¯å°†è§†é¢‘æµçš„æ¯ä¸€å¸§è½¬åŒ–ä¸º base64 å†é€šè¿‡åŠ¨æ€æ›¿æ¢ <code>&lt;img&gt;</code> çš„ src å±æ€§æ¥è¾¾åˆ°é¢„è§ˆçš„æ•ˆæœ.ä¸­é—´ç”¨åˆ°äº†<a href=\"https://github.com/agsh/rtsp-ffmpeg\" target=\"_blank\" rel=\"noopener\">rtsp-ffmpeg</a>, è¿™ä¸ªåº“çš„æ€è·¯æ˜¯é€šè¿‡ websocket å‘é€æ¯ä¸€å¸§è§†é¢‘çš„ bytes åˆ°å®¢æˆ·ç«¯, å®¢æˆ·ç«¯å¯ä»¥é€šè¿‡ <code>&lt;img&gt;</code> æ ‡ç­¾æ¥å±•ç¤º.</p>\n<p>ç¤ºä¾‹: </p>\n<p>node ç«¯<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> app = <span class=\"built_in\">require</span>(<span class=\"string\">'express'</span>)()</span><br><span class=\"line\"><span class=\"keyword\">const</span> server = <span class=\"built_in\">require</span>(<span class=\"string\">'http'</span>).Server(app)</span><br><span class=\"line\"><span class=\"keyword\">const</span> io = <span class=\"built_in\">require</span>(<span class=\"string\">'socket.io'</span>)(server)</span><br><span class=\"line\"><span class=\"keyword\">const</span> rtsp = <span class=\"built_in\">require</span>(<span class=\"string\">'rtsp-ffmpeg'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">server.listen(<span class=\"number\">8081</span>, () =&gt; &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'server listening on 8081'</span>)</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// uri ä»¥æµ·åº·æ‘„åƒæœºçš„ rtsp åè®®ä¸ºä¾‹</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> uri = <span class=\"string\">'rtps://admin:password@ip:port/h264/ch1/sub/av_stream'</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> stream = <span class=\"keyword\">new</span> rtsp.FFMpeg(&#123;</span><br><span class=\"line\">    input: uri,</span><br><span class=\"line\">    resolution: <span class=\"string\">'1080x720'</span>,</span><br><span class=\"line\">    quality: <span class=\"number\">3</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">stream.on(<span class=\"string\">'start'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'stream'</span>)</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">stream.on(<span class=\"string\">'stop'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'stream stopped'</span>)</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">io.on(<span class=\"string\">'connection'</span>, socket =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> pipeStream = <span class=\"function\"><span class=\"params\">data</span> =&gt;</span> &#123;</span><br><span class=\"line\">        socket.emit(<span class=\"string\">'data'</span>, data)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    stream.on(<span class=\"string\">'data'</span>, pipeStream)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// åˆ‡æ¢æ‘„åƒæœº</span></span><br><span class=\"line\">    socket.on(<span class=\"string\">'URI'</span>, data =&gt; &#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(data)</span><br><span class=\"line\">        uri = <span class=\"string\">`rtsp://<span class=\"subst\">$&#123;data.userName&#125;</span>:<span class=\"subst\">$&#123;data.passWord&#125;</span>@<span class=\"subst\">$&#123;data.ip&#125;</span>:<span class=\"subst\">$&#123;data.port&#125;</span>/h264/ch1/sub/av_stream`</span></span><br><span class=\"line\">        stream.input = uri</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// é‡å¯</span></span><br><span class=\"line\">        stream.restart()</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">    socket.on(<span class=\"string\">'disconnect'</span> () =&gt; &#123;</span><br><span class=\"line\">        stream.removeListener(<span class=\"string\">'data'</span>, pipeStream)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure></p>\n<p>å®¢æˆ·ç«¯<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">id</span>=<span class=\"string\">'img'</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">'/socket.io/socket.io.js'</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">\t<span class=\"keyword\">var</span> io = io();</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"keyword\">let</span> img = <span class=\"built_in\">document</span>.querySelector(<span class=\"string\">'#img'</span>)</span></span><br><span class=\"line\"><span class=\"javascript\">\tio.on(<span class=\"string\">'data'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">data</span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"keyword\">let</span> bytes = <span class=\"keyword\">new</span> Unit8Array(data)</span></span><br><span class=\"line\"><span class=\"javascript\">        img.src = <span class=\"string\">'data:image/jpeg;base64,'</span> + base64ArrayBuffer(bytes)</span></span><br><span class=\"line\"><span class=\"undefined\">\t\t\t</span></span><br><span class=\"line\"><span class=\"undefined\">\t&#125;)</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"comment\">// byte æ•°ç»„è½¬ base64 (è¿™æ®µæ˜¯åœ¨å…¶ä»–åœ°æ–¹æŠ„çš„)</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">base64ArrayBuffer</span>(<span class=\"params\">arrayBuffer</span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t<span class=\"keyword\">var</span> base64    = <span class=\"string\">''</span>;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t<span class=\"keyword\">var</span> encodings = <span class=\"string\">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span>;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t<span class=\"keyword\">var</span> bytes         = <span class=\"keyword\">new</span> <span class=\"built_in\">Uint8Array</span>(arrayBuffer);</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t<span class=\"keyword\">var</span> byteLength    = bytes.byteLength;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t<span class=\"keyword\">var</span> byteRemainder = byteLength % <span class=\"number\">3</span>;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t<span class=\"keyword\">var</span> mainLength    = byteLength - byteRemainder;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t<span class=\"keyword\">var</span> a, b, c, d;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t<span class=\"keyword\">var</span> chunk;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t<span class=\"comment\">// Main loop deals with bytes in chunks of 3</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; mainLength; i = i + <span class=\"number\">3</span>) &#123;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">// Combine the three bytes into a single integer</span></span></span><br><span class=\"line\"><span class=\"undefined\">\t\t\tchunk = (bytes[i] &lt;&lt; 16) | (bytes[i + 1] &lt;&lt; 8) | bytes[i + 2];</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">// Use bitmasks to extract 6-bit segments from the triplet</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\ta = (chunk &amp; <span class=\"number\">16515072</span>) &gt;&gt; <span class=\"number\">18</span>; <span class=\"comment\">// 16515072 = (2^6 - 1) &lt;&lt; 18</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\tb = (chunk &amp; <span class=\"number\">258048</span>)   &gt;&gt; <span class=\"number\">12</span>; <span class=\"comment\">// 258048   = (2^6 - 1) &lt;&lt; 12</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\tc = (chunk &amp; <span class=\"number\">4032</span>)     &gt;&gt;  <span class=\"number\">6</span>; <span class=\"comment\">// 4032     = (2^6 - 1) &lt;&lt; 6</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\td = chunk &amp; <span class=\"number\">63</span>;               <span class=\"comment\">// 63       = 2^6 - 1</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">// Convert the raw binary segments to the appropriate ASCII encoding</span></span></span><br><span class=\"line\"><span class=\"undefined\">\t\t\tbase64 += encodings[a] + encodings[b] + encodings[c] + encodings[d];</span></span><br><span class=\"line\"><span class=\"undefined\">\t\t&#125;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t<span class=\"comment\">// Deal with the remaining bytes and padding</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t<span class=\"keyword\">if</span> (byteRemainder == <span class=\"number\">1</span>) &#123;</span></span><br><span class=\"line\"><span class=\"undefined\">\t\t\tchunk = bytes[mainLength];</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\ta = (chunk &amp; <span class=\"number\">252</span>) &gt;&gt; <span class=\"number\">2</span>; <span class=\"comment\">// 252 = (2^6 - 1) &lt;&lt; 2</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">// Set the 4 least significant bits to zero</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\tb = (chunk &amp; <span class=\"number\">3</span>)   &lt;&lt; <span class=\"number\">4</span>; <span class=\"comment\">// 3   = 2^2 - 1</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\tbase64 += encodings[a] + encodings[b] + <span class=\"string\">'=='</span>;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (byteRemainder == <span class=\"number\">2</span>) &#123;</span></span><br><span class=\"line\"><span class=\"undefined\">\t\t\tchunk = (bytes[mainLength] &lt;&lt; 8) | bytes[mainLength + 1];</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\ta = (chunk &amp; <span class=\"number\">64512</span>) &gt;&gt; <span class=\"number\">10</span>; <span class=\"comment\">// 64512 = (2^6 - 1) &lt;&lt; 10</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\tb = (chunk &amp; <span class=\"number\">1008</span>)  &gt;&gt;  <span class=\"number\">4</span>; <span class=\"comment\">// 1008  = (2^6 - 1) &lt;&lt; 4</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">// Set the 2 least significant bits to zero</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\tc = (chunk &amp; <span class=\"number\">15</span>)    &lt;&lt;  <span class=\"number\">2</span>; <span class=\"comment\">// 15    = 2^4 - 1</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\tbase64 += encodings[a] + encodings[b] + encodings[c] + <span class=\"string\">'='</span>;</span></span><br><span class=\"line\"><span class=\"undefined\">\t\t&#125;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t<span class=\"keyword\">return</span> base64;</span></span><br><span class=\"line\"><span class=\"undefined\">\t&#125;</span></span><br><span class=\"line\"><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br></pre></td></tr></table></figure></p>\n<p>è¿™ç§é€šè¿‡ img çš„æ–¹å¼æš´éœ²å‡ºçš„é—®é¢˜æ˜¯éœ€è¦åœ¨å‰ç«¯è§£ç , å¯¼è‡´ä¸‹ä¸€å¸§åˆ°æ¥æ—¶ä¸Šä¸€å¸§çš„ç”»é¢è¿˜æ²¡è§£ç å®Œæˆ. å°±ä¼šæœ‰èŠ±å±ç”šè‡³ç”»é¢åªæ˜¾ç¤ºä¸€åŠçš„é—®é¢˜å’Œå»¶è¿Ÿè¾ƒå¤§ä¸”å»¶è¿Ÿä¼šç´¯ç§¯, åœ¨æ§åˆ¶å°ä¸­ä½ ä¼šçœ‹åˆ°ç–¯ç‹‚åˆ·ä»å†…å­˜æ¥çš„è¯·æ±‚, å¦‚æœä½ æƒ³çœ‹çœ‹ http è¯·æ±‚å¯èƒ½ä¼šç–¯. æ‰€ä»¥è¿™ç§æ–¹å¼è‚¯å®šä¸è¡Œ</p>\n<p>è¿™ä¸ª <code>rtsp-ffmpeg</code> è¿˜æä¾›ä¸€ç§ canvas çš„æ–¹å¼, åªæ˜¯åœ¨å®¢æˆ·ç«¯åšä¸€äº›ä¿®æ”¹:<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> io = io();</span><br><span class=\"line\"><span class=\"comment\">// æŠŠä¹‹å‰çš„ img æ ‡ç­¾æ¢æˆ canvas</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> canvas = <span class=\"built_in\">document</span>.querySelector(<span class=\"string\">'#canvas'</span>)</span><br><span class=\"line\">io.on(<span class=\"string\">'data'</span>, data =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> bytes = <span class=\"keyword\">new</span> <span class=\"built_in\">Uint8Array</span>(data)</span><br><span class=\"line\">\t\t\t\t\t</span><br><span class=\"line\">    <span class=\"keyword\">var</span> blob = <span class=\"keyword\">new</span> Blob([bytes], &#123;<span class=\"attr\">type</span>: <span class=\"string\">'application/octet-binary'</span>&#125;)</span><br><span class=\"line\">                    </span><br><span class=\"line\">    <span class=\"keyword\">var</span> url = URL.createObjectURL(blob)</span><br><span class=\"line\">                    </span><br><span class=\"line\">    <span class=\"keyword\">var</span> img = <span class=\"keyword\">new</span> Image</span><br><span class=\"line\">                    </span><br><span class=\"line\">    <span class=\"keyword\">var</span> ctx = canvas.getContext(<span class=\"string\">\"2d\"</span>)</span><br><span class=\"line\">        img.width = img.width * <span class=\"number\">0.5</span></span><br><span class=\"line\">        img.height = img.height * <span class=\"number\">0.5</span></span><br><span class=\"line\">        img.onload = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">            URL.revokeObjectURL(url)</span><br><span class=\"line\">            ctx.drawImage(img, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">1080</span>, <span class=\"number\">720</span>)</span><br><span class=\"line\">        &#125;;    </span><br><span class=\"line\">    img.src = url</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure></p>\n<p>ç”¨ canvas çš„æ–¹æ³•è™½ç„¶æ¯” img çš„æ•ˆæœå¥½ä¸€ç‚¹, ä½†æ˜¯æœ€ç»ˆæ•ˆæœä»ç„¶æ˜¯ä¸å°½äººæ„. å›¾åƒå¾ˆä¸ç¨³å®š, è¡¨ç°ä¸ºä¸€åŠç”»é¢ä¸€åŠç»¿å±, å¦‚æœè§†é¢‘ä¸­å›¾åƒå˜æ¢å‰§çƒˆçš„è¯è¡¨ç°ä¼šæ›´å·®, æ‰€ä»¥è¿™ç§æ–¹æ³•ä¹Ÿä¸å¤ªè¡Œ. å…¶å®åœ¨è¿™ä¸­é—´æˆ‘å¹¶æ²¡æœ‰åšä»€ä¹ˆæ“ä½œåªæ˜¯å°†è¿™ä¸ª demo é›†æˆåœ¨äº† vue ä¸­, å†åŠ ä¸Šå¤šæ‘„åƒæœºçš„åˆ‡æ¢å’Œä¸»æµæ‘„åƒæœºå‚å•†çš„æ”¯æŒ(å› ä¸ºæ¯ä¸ªæ‘„åƒæœºå‚å•†çš„ rtsp åè®®çš„ç»“æ„ä¸ä¸€æ ·)è€Œå·², æ‰€ä»¥ç¬¬ä¸€æƒ³æ³•æ˜¯èƒ½ä¸èƒ½åœ¨è§£ç è¿™å—æ‰¾åˆ°æ›´å¥½è§£å†³åŠæ³•, äºæ˜¯åˆæ‰¾åˆ°äº†å¦ä¸€ä¸ªåº“ <a href=\"https://github.com/phoboslab/jsmpeg\" target=\"_blank\" rel=\"noopener\">jsmpeg</a> æ–¹æ¡ˆäºŒå°±æ¥äº†.</p>\n<h3 id=\"æ–¹æ¡ˆäºŒ-jsmpeg\"><a href=\"#æ–¹æ¡ˆäºŒ-jsmpeg\" class=\"headerlink\" title=\"æ–¹æ¡ˆäºŒ: jsmpeg\"></a>æ–¹æ¡ˆäºŒ: jsmpeg</h3><p>è¿™ä¸ªåº“è¿˜ç®—æ¯”è¾ƒä¸é”™çš„äº†, ä¹Ÿæ˜¯é€šè¿‡ websocket æ¥è½¬å‘, çœ‹å®˜æ–¹çš„ä¾‹å­æ˜¯åœ¨ç»ˆç«¯ä¸­å¯åŠ¨ ffmpeg -&gt; websocket -&gt; å®¢æˆ·ç«¯é€šè¿‡ <code>jsmpeg.min.js</code> è§£ç åœ¨ canvas ä¸­æ’­æ”¾. å› ä¸ºè¿™é‡Œåªæ˜¯å®ç°äº†æ’­æ”¾, åœ¨è¿™ä¸ªåŸºç¡€ä¸Šæˆ‘ä»¬è¿˜éœ€è¦åœ¨è„šæœ¬ä¸­è‡ªå¯ ffmpeg / åˆ‡æ¢/ é‡å¯, ç„¶ååˆå»æ‰¾äº†ä¸€ä¸ªåŸºäº <code>jsmpeg</code> çš„åº“ <a href=\"https://github.com/kyriesent/node-rtsp-stream\" target=\"_blank\" rel=\"noopener\">node-rtsp-stream</a>. è¿™ä¸ªåº“åªæ˜¯åšäº†ä¸€äº›å°è£…è®©æˆ‘ä»¬ä¸ç”¨è‡ªå·±åœ¨ç»ˆç«¯ä¸­æ‰‹åŠ¨å¯ç”¨ ffmpeg, åœ¨æ­¤ä¹‹ä¸Šæˆ‘å†åŠ ä¸Šé‡å¯å°±èƒ½æ»¡è¶³ç°åœ¨çš„éœ€æ±‚.</p>\n<p>ç¤ºä¾‹:</p>\n<ol>\n<li>æ”¹é€  <code>node-rtsp-stream</code></li>\n</ol>\n<p>node-rtsp-stream/videoStream.js<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> Mpeg1Muxer, STREAM_MAGIC_BYTES, VideoStream, events, util, ws;</span><br><span class=\"line\"></span><br><span class=\"line\">    ws = <span class=\"built_in\">require</span>(<span class=\"string\">'ws'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    util = <span class=\"built_in\">require</span>(<span class=\"string\">'util'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    events = <span class=\"built_in\">require</span>(<span class=\"string\">'events'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    Mpeg1Muxer = <span class=\"built_in\">require</span>(<span class=\"string\">'./mpeg1muxer'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    STREAM_MAGIC_BYTES = <span class=\"string\">\"jsmp\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> child_process = <span class=\"built_in\">require</span>(<span class=\"string\">'child_process'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    VideoStream = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">options</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.name = options.name;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.streamUrl = options.streamUrl;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.width = options.width;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.height = options.height;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.wsPort = options.wsPort;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.inputStreamStarted = <span class=\"literal\">false</span>;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.stream = <span class=\"keyword\">void</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.startMpeg1Stream();</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.pipeStreamToSocketServer();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    util.inherits(VideoStream, events.EventEmitter);</span><br><span class=\"line\">    <span class=\"comment\">// åœæ­¢è§†é¢‘æµ</span></span><br><span class=\"line\">    VideoStream.prototype.stop = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.mpeg1Muxer) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.mpeg1Muxer.stream.stop()</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// é‡å¯è§†é¢‘æµ</span></span><br><span class=\"line\">    VideoStream.prototype.restart = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.mpeg1Muxer) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.mpeg1Muxer.stream.stop()</span><br><span class=\"line\">            <span class=\"built_in\">console</span>.log(<span class=\"string\">'ffmpeg is restart'</span>)</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.inputStreamStarted = <span class=\"literal\">false</span>;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.stream = <span class=\"keyword\">void</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.startMpeg1Stream();</span><br><span class=\"line\">            <span class=\"comment\">// ç›‘å¬ ffmpeg è¿›ç¨‹æ˜¯å¦å…³é—­</span></span><br><span class=\"line\">            <span class=\"keyword\">this</span>.mpeg1Muxer.on(<span class=\"string\">'ffmpegClose'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">code</span>) </span>&#123;</span><br><span class=\"line\">                <span class=\"built_in\">console</span>.log(<span class=\"string\">'ffmpeg closed on '</span> + code)</span><br><span class=\"line\">            &#125;)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    VideoStream.prototype.startMpeg1Stream = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// çœç•¥æ‰“å¼€æµçš„æ–¹æ³•, è¿™éƒ¨åˆ†æ²¡æœ‰åšæ”¹åŠ¨</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    VideoStream.prototype.pipeStreamToSocketServer = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// å°†æµå¡ç»™ socket, åŒæ ·ä¹Ÿæ²¡æ”¹</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    VideoStream.prototype.onSocketConnect = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">socket</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> self, streamHeader;</span><br><span class=\"line\">        self = <span class=\"keyword\">this</span>;</span><br><span class=\"line\">        streamHeader = <span class=\"keyword\">new</span> Buffer(<span class=\"number\">8</span>);</span><br><span class=\"line\">        streamHeader.write(STREAM_MAGIC_BYTES);</span><br><span class=\"line\">        streamHeader.writeUInt16BE(<span class=\"keyword\">this</span>.width, <span class=\"number\">4</span>);</span><br><span class=\"line\">        streamHeader.writeUInt16BE(<span class=\"keyword\">this</span>.height, <span class=\"number\">6</span>);</span><br><span class=\"line\">        socket.send(streamHeader, &#123;</span><br><span class=\"line\">            binary: <span class=\"literal\">true</span></span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log((<span class=\"string\">\"\"</span> + <span class=\"keyword\">this</span>.name + <span class=\"string\">\": New WebSocket Connection (\"</span>) + <span class=\"keyword\">this</span>.wsServer.clients.length + <span class=\"string\">\" total)\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> socket.on(<span class=\"string\">\"close\"</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">code, message</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">console</span>.log((<span class=\"string\">\"\"</span> + <span class=\"keyword\">this</span>.name + <span class=\"string\">\": Disconnected WebSocket (\"</span>) + self.wsServer.clients.length + <span class=\"string\">\" total)\"</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">module</span>.exports = VideoStream;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;).call(<span class=\"keyword\">this</span>);</span><br></pre></td></tr></table></figure></p>\n<p>node-rtsp-stream/videoStream.js<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> Mpeg1Muxer, child_process, events, util;</span><br><span class=\"line\"></span><br><span class=\"line\">    child_process = <span class=\"built_in\">require</span>(<span class=\"string\">'child_process'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    util = <span class=\"built_in\">require</span>(<span class=\"string\">'util'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    events = <span class=\"built_in\">require</span>(<span class=\"string\">'events'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    Mpeg1Muxer = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">options</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> self;</span><br><span class=\"line\">        self = <span class=\"keyword\">this</span>;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.url = options.url;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.stream = child_process.spawn(<span class=\"string\">\"ffmpeg\"</span>, </span><br><span class=\"line\">            [</span><br><span class=\"line\">                <span class=\"string\">\"-rtsp_transport\"</span>,</span><br><span class=\"line\">                <span class=\"string\">\"tcp\"</span>,</span><br><span class=\"line\">                <span class=\"string\">\"-i\"</span>,</span><br><span class=\"line\">                <span class=\"keyword\">this</span>.url,</span><br><span class=\"line\">                <span class=\"string\">'-s'</span>, </span><br><span class=\"line\">                <span class=\"comment\">// å›¾åƒå®½é«˜</span></span><br><span class=\"line\">                <span class=\"string\">`<span class=\"subst\">$&#123;options.width&#125;</span>x<span class=\"subst\">$&#123;options.height&#125;</span>`</span>, </span><br><span class=\"line\">                <span class=\"string\">'-f'</span>, </span><br><span class=\"line\">                <span class=\"string\">'mpeg1video'</span>, </span><br><span class=\"line\">                <span class=\"string\">'-b:v'</span>, </span><br><span class=\"line\">                <span class=\"string\">'800k'</span>, </span><br><span class=\"line\">                <span class=\"string\">'-r'</span>, </span><br><span class=\"line\">                <span class=\"string\">'30'</span>, </span><br><span class=\"line\">                <span class=\"string\">'-'</span></span><br><span class=\"line\">            ], </span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                detached: <span class=\"literal\">false</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        );</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.inputStreamStarted = <span class=\"literal\">true</span>;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.stream.stdout.on(<span class=\"string\">'data'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">data</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> self.emit(<span class=\"string\">'mpeg1data'</span>, data);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.stream.stderr.on(<span class=\"string\">'data'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">data</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> self.emit(<span class=\"string\">'ffmpegError'</span>, data);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"comment\">// kill ffmpeg</span></span><br><span class=\"line\">        <span class=\"keyword\">this</span>.stream.stop = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"comment\">// console.log(self.stream.pid)</span></span><br><span class=\"line\">            self.stream.stdin.pause();</span><br><span class=\"line\">            self.stream.kill()</span><br><span class=\"line\">            <span class=\"built_in\">console</span>.log(<span class=\"string\">'ffmpeg is be kill'</span>)</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"comment\">// ç›‘å¬ ffmpeg é€€å‡º</span></span><br><span class=\"line\">        <span class=\"keyword\">this</span>.stream.on(<span class=\"string\">'exit'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">code</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> self.emit(<span class=\"string\">'ffmpegClose'</span>, code)</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    util.inherits(Mpeg1Muxer, events.EventEmitter);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">module</span>.exports = Mpeg1Muxer;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;).call(<span class=\"keyword\">this</span>);</span><br></pre></td></tr></table></figure></p>\n<ol start=\"2\">\n<li>node ç«¯ä½¿ç”¨</li>\n</ol>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> app = <span class=\"built_in\">require</span>(<span class=\"string\">'express'</span>)()</span><br><span class=\"line\"><span class=\"keyword\">const</span> server = <span class=\"built_in\">require</span>(<span class=\"string\">'http'</span>).Server(app)</span><br><span class=\"line\"><span class=\"keyword\">const</span> io = <span class=\"built_in\">require</span>(<span class=\"string\">'socket.io'</span>)(server)</span><br><span class=\"line\"><span class=\"comment\">// å¼•å…¥æ”¹é€ åçš„ node-rtsp-stream</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> Rtsp = <span class=\"built_in\">require</span>(<span class=\"string\">'./node-rtsp-stream'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">server.listen(<span class=\"number\">8081</span>, () =&gt; &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'server listening on 8081'</span>)</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// uri ä»¥æµ·åº·æ‘„åƒæœºçš„ rtsp åè®®ä¸ºä¾‹</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> uri = <span class=\"string\">'rtps://admin:password@ip:port/h264/ch1/sub/av_stream'</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> stream = <span class=\"keyword\">new</span> Rtsp(&#123;</span><br><span class=\"line\">    name: <span class=\"string\">'rtsp_stream'</span>,</span><br><span class=\"line\">    streamUrl: uri,</span><br><span class=\"line\">    wsPort: <span class=\"number\">11111</span>,</span><br><span class=\"line\">    width: <span class=\"number\">720</span>,</span><br><span class=\"line\">    height: <span class=\"number\">405</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">stream.on(<span class=\"string\">'start'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'stream'</span>)</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">stream.on(<span class=\"string\">'stop'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'stream stopped'</span>)</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">io.on(<span class=\"string\">'connection'</span>, socket =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> pipeStream = <span class=\"function\"><span class=\"params\">data</span> =&gt;</span> &#123;</span><br><span class=\"line\">        socket.emit(<span class=\"string\">'data'</span>, data)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    stream.on(<span class=\"string\">'data'</span>, pipeStream)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// åˆ‡æ¢æ‘„åƒæœº</span></span><br><span class=\"line\">    socket.on(<span class=\"string\">'URI'</span>, data =&gt; &#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(data)</span><br><span class=\"line\">        uri = <span class=\"string\">`rtsp://<span class=\"subst\">$&#123;data.userName&#125;</span>:<span class=\"subst\">$&#123;data.passWord&#125;</span>@<span class=\"subst\">$&#123;data.ip&#125;</span>:<span class=\"subst\">$&#123;data.port&#125;</span>/h264/ch1/sub/av_stream`</span></span><br><span class=\"line\">        stream.streamUrl = uri;</span><br><span class=\"line\">        <span class=\"comment\">// é‡å¯</span></span><br><span class=\"line\">        stream.restart()</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">    socket.on(<span class=\"string\">'disconnect'</span> () =&gt; &#123;</span><br><span class=\"line\">        stream.removeListener(<span class=\"string\">'data'</span>, pipeStream)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li>å®¢æˆ·ç«¯</li>\n</ol>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">canvas</span> <span class=\"attr\">id</span>=<span class=\"string\">'can'</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">canvas</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">'jsmpeg.min.js'</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"keyword\">let</span> canvas = <span class=\"built_in\">document</span>.querySelector(<span class=\"string\">'#can'</span>)</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"keyword\">let</span> ws = <span class=\"keyword\">new</span> WebSocket(<span class=\"string\">'ws://127.0.0.1:11111'</span>)</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"keyword\">let</span> player = <span class=\"keyword\">new</span> jsmpeg(ws, &#123;</span></span><br><span class=\"line\"><span class=\"undefined\">        canvas: canvas,</span></span><br><span class=\"line\"><span class=\"javascript\">        autoplay: <span class=\"literal\">true</span></span></span><br><span class=\"line\"><span class=\"undefined\">    &#125;)</span></span><br><span class=\"line\"><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>è¿™ä¸ªæ–¹æ¡ˆå…¶å®ä½¿ç”¨äº†å¾ˆä¹…ä¸€ç›´éƒ½æ²¡å‘ç°é—®é¢˜, æ˜¯åœ¨ä¸€è·¯æ‘„åƒæœºå®‰ç½®åœ¨å¤©æ¡¥é™„è¿‘äººæµé‡å‰§å¢, ä¸è¿™ä¸ªè§†é¢‘é¢„è§ˆåŒä¸€é¡µé¢è¿˜æœ‰ä¸€ä¸ªäººè„¸å®æ—¶æŠ“æ‹çš„å³æ—¶æ¶ˆæ¯æ¨é€çš„åŠŸèƒ½, å¯¼è‡´åœ¨20 - 30åˆ†é’Ÿæµè§ˆå™¨ç›´æ¥å‡æ­»æˆ–è€…å´©æºƒ.(ç„¶åè¿™ä¸ªæ–¹æ¡ˆåˆå‡‰äº†ğŸ˜‚)</p>\n<h3 id=\"æ–¹æ¡ˆä¸‰-FFmpeg-Nginx-video-js\"><a href=\"#æ–¹æ¡ˆä¸‰-FFmpeg-Nginx-video-js\" class=\"headerlink\" title=\"æ–¹æ¡ˆä¸‰: FFmpeg + Nginx + video.js\"></a>æ–¹æ¡ˆä¸‰: FFmpeg + Nginx + video.js</h3><p>æ–¹æ¡ˆä¸‰ä¸‹æ¬¡å†™~</p>\n<p>Created on 2017/7/26 by Cara</p>\n"},{"title":"é—­åŒ…å’Œé«˜é˜¶å‡½æ•°","date":"2017-10-26T15:09:00.000Z","_content":"è¿™ä¸€ç¯‡ç¬”è®°æ˜¯ä¸ºæ­£å¼å¼€å§‹å­¦ä¹  javadcript è®¾è®¡æ¨¡å¼åšé“ºå«ï¼Œç”±äºè®¸å¤šè®¾è®¡æ¨¡å¼éƒ½ç”¨åˆ°äº†é—­åŒ…å’Œé«˜é˜¶å‡½æ•°æ¥å®ç°, æ‰€ä»¥äº†è§£è¿™ä¸¤ä¸ªçŸ¥è¯†ç‚¹ä¹Ÿæ˜¯å¿…è¦çš„.\n\n> ### é—­åŒ…\né—­åŒ…ç®€å•çš„æ¥è¯´æ˜¯å‡½æ•°ä¸å‡½æ•°ä¹‹é—´çš„æ¡¥æ¢, è®©ä¸€ä¸ªå‡½æ•°æœ‰æƒè®¿é—®å¦ä¸€ä¸ªå‡½æ•°ä½œç”¨åŸŸé‡Œçš„å˜é‡. å®šä¹‰è¯´èµ·æ¥è¿˜æ˜¯å¾ˆç”Ÿæ¶©çš„, è¦ç†è§£é—­åŒ…æˆ‘ä»¬éœ€è¦å…ˆçŸ¥é“å˜é‡çš„ä½œç”¨åŸŸä»¥åŠå˜é‡çš„ç”Ÿå‘½å‘¨æœŸæ‰è¡Œ.\n\n* å˜é‡çš„ä½œç”¨åŸŸ\nå˜é‡çš„ä½œç”¨åŸŸæŒ‡çš„æ˜¯å˜é‡çš„æœ‰æ•ˆèŒƒå›´. åœ¨å‡½æ•°ä¸­ç”Ÿå‘½å˜é‡æ—¶, å¦‚æœæ²¡æœ‰å…³é”®å­— varã€letåŠconsté‚£ä¹ˆè¿™ä¸ªå˜é‡å°±ä¼šå˜æˆå…¨å±€å˜é‡; å¦‚æœæœ‰è¿™ä¸ªæ—¶å€™çš„å˜é‡å°±æ˜¯å±€éƒ¨å˜é‡, åªæœ‰åœ¨å‡½æ•°å†…éƒ¨æ‰èƒ½å¤Ÿè®¿é—®åˆ°.\n```javascript\nlet fun = function () {\n\tlet a = 1;\n\talert(a)\n}\nfun()\nalert(a) // a is not defined \n```\nå‡½æ•°è¿™ä¸ªæ—¶å€™å°±åƒä¸€å—å•é¢é•œ, é‡Œé¢å¯ä»¥çœ‹è§å¤–é¢, å¤–é¢ä¸èƒ½çœ‹åˆ°é‡Œé¢. å› ä¸ºå‡½æ•°åœ¨æœç´¢ä¸€ä¸ªå˜é‡çš„æ—¶å€™, å¦‚æœå‡½æ•°å†…æ²¡æœ‰è¿™ä¸ªå˜é‡, é‚£ä¹ˆè¿™ä¸ªæœç´¢è¿‡ç¨‹ä¼šéšç€ä»£ç çš„æ‰§è¡Œç¯å¢ƒåˆ›å»ºçš„ä½œç”¨åŸŸé“¾å‘å¤–æœç´¢ç›´è‡³å…¨å±€å¯¹è±¡.\n\n- å˜é‡ç”Ÿå‘½å‘¨æœŸ\nå¯¹äºå…¨å±€å˜é‡æ¥è¯´, å®ƒçš„ç”Ÿå‘½å‘¨æœŸè‡ªç„¶æ˜¯æ°¸ä¹…çš„é™¤éæˆ‘ä»¬æ‰‹åŠ¨é”€æ¯è¿™ä¸ªå˜é‡; å¯¹äºå±€éƒ¨å˜é‡, ä¸€èˆ¬æ¥è¯´å½“å‡½æ•°æ‰§è¡Œå®Œæ¯•ä¹‹åè¯¥å˜é‡å°±ä¼šè·Ÿç€è¢«é”€æ¯. è€Œé—­åŒ…åˆ™å¯ä»¥å»¶ç»­å±€éƒ¨å˜é‡çš„ç”Ÿå‘½å‘¨æœŸ, ä¸¾ä¸ªæ —å­:\n```javascript\nlet func = function () {\n\tlet a = 0;\n\treturn function () {\n\t\ta++;\n\t\talert(a);\n\t}\n}\nlet fn = func();\nfn(); // 1\nfn(); // 2\nfn(); // 3\n```\nè¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° a å˜é‡ä¸ä»…åœ¨å¤–éƒ¨å¯ä»¥è¢«è®¿é—®åˆ°è€Œä¸”è¿˜ä¸€ç›´åœ¨é€’å¢, è¿™æ˜¯å› ä¸º `fn = func()`æ‰§è¡Œæ—¶, fn ä¿å­˜äº† func è¿”å›çš„åŒ¿åå‡½æ•°, è€Œè¿™ä¸ªåŒ¿åå‡½æ•°æ˜¯æœ‰æƒ func() è¢«è°ƒç”¨æ—¶äº§ç”Ÿçš„ç¯å¢ƒ. a å˜é‡å°±åœ¨è¿™ä¸ªç¯å¢ƒä¸­, æ‰€ä»¥æ—¢ç„¶å±€éƒ¨å˜é‡æ‰€åœ¨æ¢çš„ç¯å¢ƒæ²¡æœ‰è¢«é”€æ¯é‚£ä¹ˆ a å˜é‡ä¹Ÿä¸ä¼šè¢«é”€æ¯æ‰, è¿™ä¸ªä¾‹å­å°±äº§ç”Ÿäº†ä¸€ä¸ªé—­åŒ…ç»“æ„.\n\n> #### é—­åŒ…çš„ä½œç”¨\n\n- å°è£…å˜é‡\nä¼—æ‰€å‘¨çŸ¥å…¨å±€å˜é‡æ˜¯éå¸¸å®¹æ˜“å¼•èµ·å‘½åå†²çªçš„, æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨é—­åŒ…æŠŠä¸€äº›ä¸éœ€è¦æš´éœ²åœ¨å…¨å±€çš„å˜é‡å°è£…æˆç§æœ‰å˜é‡.\n\nå‡è®¾æœ‰ä¸€ä¸ªè®¡ç®—ä¹˜ç§¯çš„å‡½æ•°:\n```javascript\nconst mult = (function (){\n\t// ç¼“å­˜(å°è£…èµ·æ¥)\n\tlet cache = {}\n\treturn function () {\n\t\tlet arg = [].join.call(arguments, ',')\n\t\t// å°è£…è®¡ç®—æ–¹æ³•\n\t\tlet calulate = function () {\n\t\t\tlet a = 1;\n\t\t\tfor (let i = 0, len = arguments.length; i < len; i++) {\n\t\t\t\ta = a * arguments[i]\n\t\t\t}\n\t\t}\n\t\t// å­˜åœ¨ç¼“å­˜åˆ™ä¸è®¡ç®—\n\t\tif (arg in cache) return cache[arg]\n\t\treturn cache[arg] = calulate.apply(null, arguments)\n\t}\n})()\n\nconsole.log(mult(2,2,1)); // 4\n```\nå°†å˜é‡ cache å°è£…åœ¨ mult å‡½æ•°ä¸­æ¥ç¼“å­˜å·²ç»è®¡ç®—è¿‡çš„å‚æ•°, ä»¥å‡å°‘é‡å¤è®¡ç®—. è¿™ä¸ªç¼“å­˜æœºåˆ¶æœ¬æ¥æ˜¯å¯ä»¥æ‰”åœ¨å…¨å±€ç¯å¢ƒä¸­çš„.\n\n- å»¶ç»­å±€éƒ¨å˜é‡ç”Ÿå‘½å‘¨æœŸ\nå¹³å¸¸åšåŸ‹ç‚¹ä¼šç”¨åˆ°çš„ image å¯¹è±¡æ¥ä¸ŠæŠ¥æ•°æ®, å¦‚ä¸‹:\n\n```javascript\nconst report = function (src) {\n\tlet img = new Image()\n\timg.src = src\n}\nreport('http://xxxxx.com/xxx')\n```\nè¿™ç§å†™æ³•ä¼šé€ æˆæ•°æ®ä¸¢å¤±, å› ä¸ºåœ¨ HTTP è¿˜æœªç»“æŸæ—¶, report å‡½æ•°å·²ç»æ‰§è¡Œå®Œæ¯•è€Œ img ä¸º report å‡½æ•°ä¸­çš„å±€éƒ¨å˜é‡, åœ¨å‡½æ•°æ‰§è¡Œå®Œæ¯•åå°±ä¼šéšä¹‹é”€æ¯é€ æˆæ•°æ®ä¸¢å¤±çš„æƒ…å†µ. ä¸‹é¢ç”¨é—­åŒ…æŠŠå˜é‡å°è£…èµ·æ¥, æ¥è§£å†³è¿™ä¸€é—®é¢˜:\n```javascript\nconst report = (function () {\n\tlet imgs = []\n\treturn function (src) {\n\t\tlet img = new Image();\n\t\timgs.push(img);\n\t\timg.src = src\n\t}\n})()\nreport('http://xxxxx.com/xxx')\n```\n\n> #### é—­åŒ…å®ç°å‘½ä»¤æ¨¡å¼\n> è¯´äº†è¿™ä¹ˆå¤šå°±æ¥çœ‹çœ‹å…³äºé—­åŒ…çš„è¿ç”¨å§, è¿™é‡Œç”¨é—­åŒ…ç®€å•å®ç°ä¸‹å‘½ä»¤æ¨¡å¼, é¡ºä¾¿é¢„å…ˆäº†è§£ä¸€ä¸‹å‘½ä»¤æ¨¡å¼.\n\n```html\n<button id='open' onclick='execute'>æ‰§è¡Œå‘½ä»¤</button>\n<button id='close' onclick='undo'>æ’¤é”€å‘½ä»¤</button>\n```\n- é¢å‘å¯¹è±¡ç‰ˆ\n```javascript\nconst TV = {\n\topen () {\n\t\tconsole.log('TV is open!')\n\t},\n\tclose () {\n\t\tconsole.log('TV is close!')\n\t}\n}\n// æ¥æ”¶å‘½ä»¤\nconst ReceiveCommand = receiver => {\n\tthis.receiver = receiver\n}\n// æ‰“å¼€ç”µè§†\nReceiveCommand.prototype.execute = function () {\n\tthis.receiver.open()\n}\n// å…³ç”µè§†\nReceiveCommand.prototype.undo = functon () {\n\tthis.receiver.close()\n}\n\n// è®¾ç½®å‘½ä»¤\nconst setCommand = function (command) {\n\tdocument.getElementById('open').onclick = function () {\n\t\tcommand.execute()\n\t}\n\tdocument.getElementById('close').onclick = function () {\n\t\tcommand.undo()\n\t}\n}\n// å°†å‘½ä»¤å‘Šè¯‰æ‰§è¡Œè€…, è®¾ç½®å‘½ä»¤ä¼ å…¥æ‰§è¡Œè€…\nsetCommand(new ReceiveCommand(TV))\n```\nå‘½ä»¤æ¨¡å¼æ˜¯æŠŠè¯·æ±‚å‘èµ·è€…å’Œæ‰§è¡Œå‘½ä»¤(æ‰§è¡Œè€…)åˆ†ç¦»å¼€æ¥, ä»¥è¾¾åˆ°è§£è€¦çš„ç›®çš„. åœ¨æ‰§è¡Œå‘½ä»¤ä¹‹å‰, æŠŠå‘½ä»¤æ”¾å…¥æ‰§è¡Œè€…æ¥å‘Šè¯‰æ‰§è¡Œè€…è¦æ‰§è¡Œä»€ä¹ˆæ ·çš„å‘½ä»¤, å‘½ä»¤æ¨¡å¼å¤§æ¦‚å°±æ˜¯è¿™æ ·å•¦.\n\n- é—­åŒ…ç‰ˆ\n```javascript\nconst TV = {\n\topen () {\n\t\tconsole.log('TV is open!')\n\t},\n\tclose () {\n\t\tconsole.log('TV is close!')\n\t}\n}\n// æ‰§è¡Œè€…\nconst receiveCommand = receiver => {\n\tlet execute = _ => {\n\t\treturn receiver.open()\n\t}\n\tlet undo = _ => {\n\t\treturn receiver.close()\n\t}\n\treturn {\n\t\texecute: execute,\n\t\tundo: undo\n\t}\n}\n// å‘èµ·è€…\nconst setCommand = command => {\n\tdocument.getElementById('open').onclick = _ => {\n\t\texecute.open()\n\t}\n\tdocument.getElementById('close').onclick = _ => {\n\t\tundo.close()\n\t}\n}\nsetCommand(receiveCommand(TV))\n```\né—­åŒ…æ˜æ˜¾æ¸…æ™°æ›´å¤š, ä¹Ÿæ›´ç®€æ´.\n\n> ### é«˜é˜¶å‡½æ•°\nå°†å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’æˆ–è®©å‡½æ•°æ‰§è¡Œç»“æœè¿”å›å¦ä¸€ä¸ªå‡½æ•°, æ»¡è¶³è¿™ä¸¤ä¸ªæ¡ä»¶ä¹‹ä¸€çš„å‡½æ•°éƒ½å¯ä»¥ç§°ä½œä¸ºé«˜é˜¶å‡½æ•°.\n\n#### å°†å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’\nå°†å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’, å°±æ„å‘³ç€æˆ‘ä»¬å¯ä»¥å°†ä¸ä¸šåŠ¡ç›¸å…³çš„é€»è¾‘ä»£ç åˆ†ç¦»å‡ºæ¥, è§£é™¤ä¸šåŠ¡ä»£ç å’Œä¸å˜é€»è¾‘çš„è€¦åˆ, æœ€å¸¸è§çš„å°±æ˜¯æˆ‘ä»¬çš„å›è°ƒå‡½æ•°. å®é™…è¿ç”¨ä¸­ ajax å¼‚æ­¥è¯·æ±‚, å½“æˆ‘ä»¬ä¸çŸ¥é“è¿”å›å€¼åœ¨ä»€ä¹ˆæ—¶å€™è¿”å›å€¼åˆéœ€è¦åœ¨è¿”å›ååšä¸€äº›å¤„ç†, å°±è¦ç”¨åˆ°å›è°ƒå‡½æ•°äº†.\n\n```javascript\nlet getPersonInfo = function (userId, callback) {\n\t$.ajax(`http://xxx/getPersonInfo?${userId}`, function (data) {\n\t\tcallback && callback(data)\n\t})\n}\n// è¿™é‡Œçš„åŒ¿åå‡½æ•°å°±æ˜¯ä¸Šé¢çš„ callback\ngetPersonInfo(\"54332123\", function (data) {\n\tconsole.log(data)\n})\n```\nè¿™ç§æ˜¯æˆ‘ä»¬æ¯”è¾ƒå¸¸è§çš„å›è°ƒå‡½æ•°, åœ¨å…¶ä»–çš„æ–¹é¢, ä¹Ÿå¯ä»¥å°†ä¸€äº›è¯·æ±‚å§”æ‰˜ç»™å¦ä¸€ä¸ªå‡½æ•°ä»£ä¸ºæ‰§è¡Œ, å¦‚:\nå‡å¦‚æˆ‘ä»¬éœ€è¦å…ˆåˆ›å»º100çš„ div èŠ‚ç‚¹, ç„¶åæŠŠå®ƒä»¬éšè—æ‰\n\n```javascript\n// count é»˜è®¤å€¼ä¸º100\nconst appendDiv = count = 100, callback => {\n\tif (count && typeof count === 'number') {\n\t\tfor(let i = 0; i < count; i++){\n\t\t\tlet div = document.createElement('div')\n\t\t\tdiv.innerHTML = i\n\t\t\tdocument.body.appendChild(div)\n\t\t\t// å°†ä¸šåŠ¡ä»£ç å§”æ‰˜æ‰§è¡Œ\n\t\t\tcallback && callback(div)\n\t\t}\n\t}\n} \n// æŠŠæ”¹å˜æ ·å¼çš„ä¸šåŠ¡é€»è¾‘åˆ†ç¦»å‡ºæ¥\nappendDiv(function (el) {\n\tel.style.cssText = `display: none`\n})\n```\nè¿™æ ·æˆ‘ä»¬å°±å°†ä¸šåŠ¡é€»è¾‘åˆ†ç¦»å‡ºæ¥äº†, ä»¥åå¯èƒ½æˆ‘ä»¬æƒ³æ”¹é¢œè‰²å•¦æˆ–è€…ä½ç½®ä»€ä¹ˆçš„ä¹Ÿæ–¹ä¾¿ç»´æŠ¤.\n\n#### å‡½æ•°ä½œä¸ºè¿”å›å€¼ \nç›¸æ¯”æŠŠå‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’, å¯èƒ½å‡½æ•°å½“åšè¿”å›å€¼è¿”å›è¿ç”¨åœºæ™¯æ›´å¤šä¸€äº›, è®©å‡½æ•°è¿”å›å¦ä¸€ä¸ªå¯æ‰§è¡Œå‡½æ•°å°±æ„å‘³ç€è¿ç®—è¿‡ç¨‹å¯å»¶ç»­.ç›´æ¥æ¥çœ‹ä¸€äº›ä¾‹å­å§.\n\n- æ£€æŸ¥ç±»å‹\n\n```javascript\nconst Type = {}\nfor (let i = 0, type; type = ['Array', 'String', 'Number'][i++];) {\n\tType['is' + type] = function (obj) {\n\t\treturn Object.prototype.toString.call(obj) === '[object '+ type +']'\n\t}\n}\n\nconsole.log(Type.isArray([])) // true\nconsole.log(Type.isString('123')) // true\nconsole.log(Type.isNumber(123)) // true\n```\n\n- å•ä¾‹æ¨¡å¼\n\tè¿™é‡Œå…ˆä¸è®¨è®ºå•ä¾‹æ¨¡å¼, åªçœ‹ä»£ç å®ç°\n\n```javascript\n// fn å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’\nconst getSingle = function (fn) {\n\tlet ret;\n\treturn function () {\n\t\t// å¦‚æœ ret ä¸å­˜åœ¨, ret ç­‰äº fn å‡½æ•°\n\t\treturn ret || (ret = fn.apply(this, arguments))\n\t}\n} \n// è°ƒç”¨è¿™ä¸ªé«˜é˜¶å‡½æ•°\nlet getDiv = getSingle(function () {\n\t// å‚æ•°ä¹Ÿä¼šä¸€èµ·ä¼ è¿‡æ¥, è¿™é‡Œè¿”å›['123']\n\tconsole.log(arguments);\n\treturn document.createElement('div');\n\t\n})\ngetDiv('123')\n```\ngetSingle è¿™ä¸ªé«˜é˜¶å‡½æ•°æ—¢å°†å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’, åˆè®©å‡½æ•°æ‰§è¡Œåè¿”å›å¦ä¸€ä¸ªå‡½æ•°.\n\n> JavaScript è®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µè¿˜æœ‰ä¸ªä¾‹å­ä¹Ÿå¾ˆæœ‰æ„æ€\n> å«åš AOP(é¢å‘åˆ‡é¢ç¼–ç¨‹), ä½œç”¨æ˜¯æŠŠä¸ä¸šåŠ¡é€»è¾‘ä¸ç›¸å…³çš„éƒ¨åˆ†æŠ½ç¦»å‡ºæ¥å†é€šè¿‡åŠ¨æ€æ¤å…¥çš„æ–¹å¼åŠ å…¥ä¸šåŠ¡é€»è¾‘çš„æ¨¡å—ä¸­.\n\n```javascript\n// åœ¨åŸå‡½æ•°ä¹‹å‰\nFunction.prototype.before = function (beforeFn) {\n\tlet that = this; // ä¿å­˜åŸå‡½æ•°çš„å¼•ç”¨\n\treturn function () { // A\n\t\t// æ‰§è¡Œæ–°å‡½æ•°å¹¶ä¿®æ­£ this\n\t\tbeforeFn.apply(this, arguments)\n\t\t// æ‰§è¡ŒåŸå‡½æ•°\n\t\treturn that.apply(this, arguments)\n\t}\n}\n// åœ¨åŸå‡½æ•°ä¹‹å\nFunction.prototype.after = function (afterFn) {\n\tlet that = this\n\treturn function () { // B\n\t\t// å…ˆæ‰§è¡Œ before å‡½æ•°\n\t\tthat.apply(this, arguments)\n\t\t// å†æ‰§è¡Œæ–°å‡½æ•°\n\t\treturn afterFn.apply(this, arguments)\n\t}\n}\n\nlet fn = function () {\n\tconsole.log(2)\n}\nfn = fn.before(function() {\n\tconsole.log(1)\n}).after(function() {\n\tconsole.log(3)\n})\n\nfn() // æŒ‰é¡ºåºè¾“å‡º 1 2 3\n```\nä¸Šé¢çš„æ‰§è¡Œé¡ºåºæ˜¯è¿™æ ·çš„:\n\n1. Afterä¸­çš„å›è°ƒå‡½æ•° B\nå› ä¸ºåœ¨æœ€åæ‰§è¡Œ fn å‡½æ•°æ—¶, fn å·²ç»æ˜¯ after å‡½æ•°äº†, å› æ­¤åœ¨ fn() æ‰§è¡Œæ—¶è°ƒç”¨çš„æ˜¯ after ä¸­è¿”å›çš„åŒ¿åå‡½æ•°B.\n2. B ä¸­çš„ that.apply(this, arguments)\næ­¤æ—¶çš„ that æŒ‡å‘ before å‡½æ•°\n3.  æ‰§è¡ŒBeforeä¸­çš„å›è°ƒå‡½æ•° A\n4. A ä¸­çš„ beforeFn.apply(this, arguments)\næ‰§è¡Œ console.log(1)\n5. return that.apply(this, arguments)\næ‰§è¡Œ console.log(2)\n6. å›åˆ° after å‡½æ•°ä¸­æ‰§è¡Œreturn afterFn.apply(this, arguments)\næ‰§è¡Œ console.log(3)\n\n\n#### å‡½æ•°æŸ¯é‡ŒåŒ–\nå‡½æ•°æŸ¯é‡ŒåŒ–å¯ä»¥è¯´æ˜¯é«˜é˜¶å‡½æ•°ç»å…¸ä¸­çš„ç»å…¸äº†, è¯´åˆ°é«˜é˜¶å‡½æ•°åº”è¯¥å¾ˆå¿«å°±ä¼šæƒ³åˆ°ä»–äº†. æˆ‘ç†è§£çš„å‡½æ•°æŸ¯é‡ŒåŒ–æ˜¯: å…ˆå°†å‚æ•°ä¾æ¬¡ç¼“å­˜, åœ¨çœŸæ­£éœ€è¦è®¡ç®—ç»“æœæ—¶, æ‰è¿›è¡Œè®¡ç®—è¿™æ ·å¯ä»¥å‡å°‘è¿ç®—æ¬¡æ•°.\n\n```js\n// é€šç”¨ curring\nconst curring = fn => {\n    let argsArr = []\n    return (...args) => {\n        return [...args].length === 0\n            ? fn.apply(null, argsArr)\n            : [].push.apply(argsArr, [...args])\n    }\n}\n\n// éœ€è¦è®¡ç®—çš„å‡½æ•°\nlet calculate = (() => {\n    let money = 0\n    return (...argsArr) => {\n        argsArr.forEach(item => {\n            money += item\n        })\n        return money\n    }\n})()\n\n// æŸ¯é‡ŒåŒ–\ncalculate = curring(calculate)\n\n// ç¼“å­˜å‚æ•°, å…¶å®å¹¶æ²¡æœ‰è®¡ç®—\ncalculate(20)\ncalculate(40)\ncalculate(20)\n\n// çœŸæ­£è®¡ç®—çš„æ—¶å€™\ncalculate()\n```\n\n#### å‡½æ•°èŠ‚æµ\nåœ¨æŸäº›åœºæ™¯ä¸‹å‡½æ•°æœ‰å¯èƒ½ä¼šè¢«éå¸¸é¢‘ç¹åœ°è°ƒç”¨, ä»è€Œé€ æˆå¾ˆå¤§çš„æ€§èƒ½é—®é¢˜. ä¾‹å¦‚: window.resizeäº‹ä»¶ã€mousemove äº‹ä»¶, å®ƒä»¬è§¦å‘çš„é¢‘ç‡å¤ªé«˜äº†, è€Œç”¨æˆ·å¹¶ä¸éœ€è¦å¦‚æ­¤é«˜é¢‘ç‡çš„ä½¿ç”¨. å› æ­¤å‡½æ•°èŠ‚æµå°±æ˜¯ä¸ºäº†é™åˆ¶å‡½æ•°å‡ºå‘çš„é¢‘ç‡.\n\n```js\n// èŠ‚æµ\nconst throttle = (fn, interval = 800) => {\n    let isFirst = true, timer\n    // ...args => event\n    return (...args) => {\n        let that = this\n        if (isFirst) {\n            fn.apply(that, [...args])\n            return isFirst = false\n        }\n        if (timer) return false\n        timer = setTimeout(() => {\n            clearTimeout(timer)\n            timer = null\n            fn.apply(that, [...args])\n        }, interval)\n    }\n}\n\n// ä¼ å…¥éœ€è¦èŠ‚æµçš„å‡½æ•°å’Œé—´éš”æ—¶é—´\nwindow.onresize = throttle(function () {\n    console.log(1)\n}, 800)\n```\n#### åˆ†æ—¶å‡½æ•°\nä¸Šé¢æˆ‘ä»¬æä¾›äº†ä¸€ç§é™åˆ¶å‡½æ•°è°ƒç”¨é¢‘ç‡çš„è§£å†³æ–¹æ¡ˆ, ç°åœ¨æ˜¯å¦ä¸€ä¸ªé—®é¢˜: æŸäº›å‡½æ•°æ˜¯ç”±ç”¨æˆ·ä¸»åŠ¨å”¤èµ·çš„, ä½†æ˜¯å› ä¸ºä¸€äº›åŸå› å¯¼è‡´å‡½æ•°ä¸¥é‡å½±å“é¡µé¢çš„æ€§èƒ½. åˆ†æ—¶å‡½æ•°å¯ä»¥ä¸ºæˆ‘ä»¬è§£å†³è¿™ä¸ªé—®é¢˜, æˆ‘ç†è§£çš„åˆ†æ—¶å‡½æ•°: å°†è¯·æ±‚åˆ†æ‰¹å¤„ç†, åœ¨ä¸€å®šçš„æ—¶é—´å†…æ‰§è¡Œä¸€éƒ¨åˆ†è¯·æ±‚, ç›´åˆ°è¯·æ±‚å…¨éƒ¨å®Œæˆ.\n\n```js\n// åˆ†æ—¶å‡½æ•°\nconst timeChunk = (data, fn, count = 1) => {\n    let timer, obj\n    const start = () => {\n        for (let i = 0; i < Math.min(count, data.length); i++) {\n            obj = data.shift()\n            fn.apply(null, obj)\n        }\n    }\n    return () => {\n        if (data.length === 0) {\n            clearTimeout(timer)\n            return\n        }\n        timer = setInterval(() => {\n            start()\n        }, 200)\n    }\n}\n\n// æ¨¡æ‹Ÿæ•°æ®\nlet ary = []\nfor (let i = 0; i < 1000; i++) {\n    ary.push(i)\n}\n\n// åˆ†æ—¶åŒ–\nlet renderfriendList = timeChunk(ary, function (n) {\n    let div = document.createElement('div')\n    div.innerHTML = n\n    document.body.appendChild(div)\n}, 10)\n\n// æ¸²æŸ“\nrenderfriendList()\n```\n\n#### æƒ°æ€§åŠ è½½\nä¸¾ä¸ªä¾‹å­, åœ¨ web ä¸­ä¸ºäº†æ»¡è¶³å„æµè§ˆå™¨ä¹‹é—´çš„å·®å¼‚, æˆ‘ä»¬ä¼šåšä¸€äº›å—…æ¢å·¥ä½œ. å¼‚äºå¸¸è§„æ–¹æ¡ˆ, æƒ°æ€§åŠ è½½åœ¨çœŸæ­£éœ€è¦æ—¶æ‰ä½¿ç”¨ä¸”è¿›å…¥æ¡ä»¶åˆ†æ”¯ååœ¨å†…éƒ¨é‡å†™è¯¥å‡½æ•°, è¿™æ ·é‡å†™åçš„å‡½æ•°å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„å‡½æ•°.\n\n```js\nlet addEvent = (el, type, handler) => {\n    if (window.addEventListener) {\n        // é‡å†™å‡½æ•°\n        addEvent = (el, type, handler) => {\n            el.addEventListener(type, handler, false)\n        }\n    } else if (window.attachEvent) {\n        addEvent = (el, type, handler) => {\n            el.attachEvent('on' + type, handler)\n        }\n    }\n    addEvent(el, type, handler)\n}\n\n// ä½¿ç”¨\naddEvent(btn, 'click', function () {\n    console.log('click!')\n})\n```\n\nCreated on 2017-10-26 by Cara","source":"_posts/é—­åŒ…å’Œé«˜é˜¶å‡½æ•°.md","raw":"---\ntitle: 'é—­åŒ…å’Œé«˜é˜¶å‡½æ•°'\ndate: 2017-10-26 23:09:00\ntags:\n- JavaScript\ncategories:\n- ç¬”è®°ğŸ“’\n- JavaScriptè®¾è®¡æ¨¡å¼\n---\nè¿™ä¸€ç¯‡ç¬”è®°æ˜¯ä¸ºæ­£å¼å¼€å§‹å­¦ä¹  javadcript è®¾è®¡æ¨¡å¼åšé“ºå«ï¼Œç”±äºè®¸å¤šè®¾è®¡æ¨¡å¼éƒ½ç”¨åˆ°äº†é—­åŒ…å’Œé«˜é˜¶å‡½æ•°æ¥å®ç°, æ‰€ä»¥äº†è§£è¿™ä¸¤ä¸ªçŸ¥è¯†ç‚¹ä¹Ÿæ˜¯å¿…è¦çš„.\n\n> ### é—­åŒ…\né—­åŒ…ç®€å•çš„æ¥è¯´æ˜¯å‡½æ•°ä¸å‡½æ•°ä¹‹é—´çš„æ¡¥æ¢, è®©ä¸€ä¸ªå‡½æ•°æœ‰æƒè®¿é—®å¦ä¸€ä¸ªå‡½æ•°ä½œç”¨åŸŸé‡Œçš„å˜é‡. å®šä¹‰è¯´èµ·æ¥è¿˜æ˜¯å¾ˆç”Ÿæ¶©çš„, è¦ç†è§£é—­åŒ…æˆ‘ä»¬éœ€è¦å…ˆçŸ¥é“å˜é‡çš„ä½œç”¨åŸŸä»¥åŠå˜é‡çš„ç”Ÿå‘½å‘¨æœŸæ‰è¡Œ.\n\n* å˜é‡çš„ä½œç”¨åŸŸ\nå˜é‡çš„ä½œç”¨åŸŸæŒ‡çš„æ˜¯å˜é‡çš„æœ‰æ•ˆèŒƒå›´. åœ¨å‡½æ•°ä¸­ç”Ÿå‘½å˜é‡æ—¶, å¦‚æœæ²¡æœ‰å…³é”®å­— varã€letåŠconsté‚£ä¹ˆè¿™ä¸ªå˜é‡å°±ä¼šå˜æˆå…¨å±€å˜é‡; å¦‚æœæœ‰è¿™ä¸ªæ—¶å€™çš„å˜é‡å°±æ˜¯å±€éƒ¨å˜é‡, åªæœ‰åœ¨å‡½æ•°å†…éƒ¨æ‰èƒ½å¤Ÿè®¿é—®åˆ°.\n```javascript\nlet fun = function () {\n\tlet a = 1;\n\talert(a)\n}\nfun()\nalert(a) // a is not defined \n```\nå‡½æ•°è¿™ä¸ªæ—¶å€™å°±åƒä¸€å—å•é¢é•œ, é‡Œé¢å¯ä»¥çœ‹è§å¤–é¢, å¤–é¢ä¸èƒ½çœ‹åˆ°é‡Œé¢. å› ä¸ºå‡½æ•°åœ¨æœç´¢ä¸€ä¸ªå˜é‡çš„æ—¶å€™, å¦‚æœå‡½æ•°å†…æ²¡æœ‰è¿™ä¸ªå˜é‡, é‚£ä¹ˆè¿™ä¸ªæœç´¢è¿‡ç¨‹ä¼šéšç€ä»£ç çš„æ‰§è¡Œç¯å¢ƒåˆ›å»ºçš„ä½œç”¨åŸŸé“¾å‘å¤–æœç´¢ç›´è‡³å…¨å±€å¯¹è±¡.\n\n- å˜é‡ç”Ÿå‘½å‘¨æœŸ\nå¯¹äºå…¨å±€å˜é‡æ¥è¯´, å®ƒçš„ç”Ÿå‘½å‘¨æœŸè‡ªç„¶æ˜¯æ°¸ä¹…çš„é™¤éæˆ‘ä»¬æ‰‹åŠ¨é”€æ¯è¿™ä¸ªå˜é‡; å¯¹äºå±€éƒ¨å˜é‡, ä¸€èˆ¬æ¥è¯´å½“å‡½æ•°æ‰§è¡Œå®Œæ¯•ä¹‹åè¯¥å˜é‡å°±ä¼šè·Ÿç€è¢«é”€æ¯. è€Œé—­åŒ…åˆ™å¯ä»¥å»¶ç»­å±€éƒ¨å˜é‡çš„ç”Ÿå‘½å‘¨æœŸ, ä¸¾ä¸ªæ —å­:\n```javascript\nlet func = function () {\n\tlet a = 0;\n\treturn function () {\n\t\ta++;\n\t\talert(a);\n\t}\n}\nlet fn = func();\nfn(); // 1\nfn(); // 2\nfn(); // 3\n```\nè¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° a å˜é‡ä¸ä»…åœ¨å¤–éƒ¨å¯ä»¥è¢«è®¿é—®åˆ°è€Œä¸”è¿˜ä¸€ç›´åœ¨é€’å¢, è¿™æ˜¯å› ä¸º `fn = func()`æ‰§è¡Œæ—¶, fn ä¿å­˜äº† func è¿”å›çš„åŒ¿åå‡½æ•°, è€Œè¿™ä¸ªåŒ¿åå‡½æ•°æ˜¯æœ‰æƒ func() è¢«è°ƒç”¨æ—¶äº§ç”Ÿçš„ç¯å¢ƒ. a å˜é‡å°±åœ¨è¿™ä¸ªç¯å¢ƒä¸­, æ‰€ä»¥æ—¢ç„¶å±€éƒ¨å˜é‡æ‰€åœ¨æ¢çš„ç¯å¢ƒæ²¡æœ‰è¢«é”€æ¯é‚£ä¹ˆ a å˜é‡ä¹Ÿä¸ä¼šè¢«é”€æ¯æ‰, è¿™ä¸ªä¾‹å­å°±äº§ç”Ÿäº†ä¸€ä¸ªé—­åŒ…ç»“æ„.\n\n> #### é—­åŒ…çš„ä½œç”¨\n\n- å°è£…å˜é‡\nä¼—æ‰€å‘¨çŸ¥å…¨å±€å˜é‡æ˜¯éå¸¸å®¹æ˜“å¼•èµ·å‘½åå†²çªçš„, æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨é—­åŒ…æŠŠä¸€äº›ä¸éœ€è¦æš´éœ²åœ¨å…¨å±€çš„å˜é‡å°è£…æˆç§æœ‰å˜é‡.\n\nå‡è®¾æœ‰ä¸€ä¸ªè®¡ç®—ä¹˜ç§¯çš„å‡½æ•°:\n```javascript\nconst mult = (function (){\n\t// ç¼“å­˜(å°è£…èµ·æ¥)\n\tlet cache = {}\n\treturn function () {\n\t\tlet arg = [].join.call(arguments, ',')\n\t\t// å°è£…è®¡ç®—æ–¹æ³•\n\t\tlet calulate = function () {\n\t\t\tlet a = 1;\n\t\t\tfor (let i = 0, len = arguments.length; i < len; i++) {\n\t\t\t\ta = a * arguments[i]\n\t\t\t}\n\t\t}\n\t\t// å­˜åœ¨ç¼“å­˜åˆ™ä¸è®¡ç®—\n\t\tif (arg in cache) return cache[arg]\n\t\treturn cache[arg] = calulate.apply(null, arguments)\n\t}\n})()\n\nconsole.log(mult(2,2,1)); // 4\n```\nå°†å˜é‡ cache å°è£…åœ¨ mult å‡½æ•°ä¸­æ¥ç¼“å­˜å·²ç»è®¡ç®—è¿‡çš„å‚æ•°, ä»¥å‡å°‘é‡å¤è®¡ç®—. è¿™ä¸ªç¼“å­˜æœºåˆ¶æœ¬æ¥æ˜¯å¯ä»¥æ‰”åœ¨å…¨å±€ç¯å¢ƒä¸­çš„.\n\n- å»¶ç»­å±€éƒ¨å˜é‡ç”Ÿå‘½å‘¨æœŸ\nå¹³å¸¸åšåŸ‹ç‚¹ä¼šç”¨åˆ°çš„ image å¯¹è±¡æ¥ä¸ŠæŠ¥æ•°æ®, å¦‚ä¸‹:\n\n```javascript\nconst report = function (src) {\n\tlet img = new Image()\n\timg.src = src\n}\nreport('http://xxxxx.com/xxx')\n```\nè¿™ç§å†™æ³•ä¼šé€ æˆæ•°æ®ä¸¢å¤±, å› ä¸ºåœ¨ HTTP è¿˜æœªç»“æŸæ—¶, report å‡½æ•°å·²ç»æ‰§è¡Œå®Œæ¯•è€Œ img ä¸º report å‡½æ•°ä¸­çš„å±€éƒ¨å˜é‡, åœ¨å‡½æ•°æ‰§è¡Œå®Œæ¯•åå°±ä¼šéšä¹‹é”€æ¯é€ æˆæ•°æ®ä¸¢å¤±çš„æƒ…å†µ. ä¸‹é¢ç”¨é—­åŒ…æŠŠå˜é‡å°è£…èµ·æ¥, æ¥è§£å†³è¿™ä¸€é—®é¢˜:\n```javascript\nconst report = (function () {\n\tlet imgs = []\n\treturn function (src) {\n\t\tlet img = new Image();\n\t\timgs.push(img);\n\t\timg.src = src\n\t}\n})()\nreport('http://xxxxx.com/xxx')\n```\n\n> #### é—­åŒ…å®ç°å‘½ä»¤æ¨¡å¼\n> è¯´äº†è¿™ä¹ˆå¤šå°±æ¥çœ‹çœ‹å…³äºé—­åŒ…çš„è¿ç”¨å§, è¿™é‡Œç”¨é—­åŒ…ç®€å•å®ç°ä¸‹å‘½ä»¤æ¨¡å¼, é¡ºä¾¿é¢„å…ˆäº†è§£ä¸€ä¸‹å‘½ä»¤æ¨¡å¼.\n\n```html\n<button id='open' onclick='execute'>æ‰§è¡Œå‘½ä»¤</button>\n<button id='close' onclick='undo'>æ’¤é”€å‘½ä»¤</button>\n```\n- é¢å‘å¯¹è±¡ç‰ˆ\n```javascript\nconst TV = {\n\topen () {\n\t\tconsole.log('TV is open!')\n\t},\n\tclose () {\n\t\tconsole.log('TV is close!')\n\t}\n}\n// æ¥æ”¶å‘½ä»¤\nconst ReceiveCommand = receiver => {\n\tthis.receiver = receiver\n}\n// æ‰“å¼€ç”µè§†\nReceiveCommand.prototype.execute = function () {\n\tthis.receiver.open()\n}\n// å…³ç”µè§†\nReceiveCommand.prototype.undo = functon () {\n\tthis.receiver.close()\n}\n\n// è®¾ç½®å‘½ä»¤\nconst setCommand = function (command) {\n\tdocument.getElementById('open').onclick = function () {\n\t\tcommand.execute()\n\t}\n\tdocument.getElementById('close').onclick = function () {\n\t\tcommand.undo()\n\t}\n}\n// å°†å‘½ä»¤å‘Šè¯‰æ‰§è¡Œè€…, è®¾ç½®å‘½ä»¤ä¼ å…¥æ‰§è¡Œè€…\nsetCommand(new ReceiveCommand(TV))\n```\nå‘½ä»¤æ¨¡å¼æ˜¯æŠŠè¯·æ±‚å‘èµ·è€…å’Œæ‰§è¡Œå‘½ä»¤(æ‰§è¡Œè€…)åˆ†ç¦»å¼€æ¥, ä»¥è¾¾åˆ°è§£è€¦çš„ç›®çš„. åœ¨æ‰§è¡Œå‘½ä»¤ä¹‹å‰, æŠŠå‘½ä»¤æ”¾å…¥æ‰§è¡Œè€…æ¥å‘Šè¯‰æ‰§è¡Œè€…è¦æ‰§è¡Œä»€ä¹ˆæ ·çš„å‘½ä»¤, å‘½ä»¤æ¨¡å¼å¤§æ¦‚å°±æ˜¯è¿™æ ·å•¦.\n\n- é—­åŒ…ç‰ˆ\n```javascript\nconst TV = {\n\topen () {\n\t\tconsole.log('TV is open!')\n\t},\n\tclose () {\n\t\tconsole.log('TV is close!')\n\t}\n}\n// æ‰§è¡Œè€…\nconst receiveCommand = receiver => {\n\tlet execute = _ => {\n\t\treturn receiver.open()\n\t}\n\tlet undo = _ => {\n\t\treturn receiver.close()\n\t}\n\treturn {\n\t\texecute: execute,\n\t\tundo: undo\n\t}\n}\n// å‘èµ·è€…\nconst setCommand = command => {\n\tdocument.getElementById('open').onclick = _ => {\n\t\texecute.open()\n\t}\n\tdocument.getElementById('close').onclick = _ => {\n\t\tundo.close()\n\t}\n}\nsetCommand(receiveCommand(TV))\n```\né—­åŒ…æ˜æ˜¾æ¸…æ™°æ›´å¤š, ä¹Ÿæ›´ç®€æ´.\n\n> ### é«˜é˜¶å‡½æ•°\nå°†å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’æˆ–è®©å‡½æ•°æ‰§è¡Œç»“æœè¿”å›å¦ä¸€ä¸ªå‡½æ•°, æ»¡è¶³è¿™ä¸¤ä¸ªæ¡ä»¶ä¹‹ä¸€çš„å‡½æ•°éƒ½å¯ä»¥ç§°ä½œä¸ºé«˜é˜¶å‡½æ•°.\n\n#### å°†å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’\nå°†å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’, å°±æ„å‘³ç€æˆ‘ä»¬å¯ä»¥å°†ä¸ä¸šåŠ¡ç›¸å…³çš„é€»è¾‘ä»£ç åˆ†ç¦»å‡ºæ¥, è§£é™¤ä¸šåŠ¡ä»£ç å’Œä¸å˜é€»è¾‘çš„è€¦åˆ, æœ€å¸¸è§çš„å°±æ˜¯æˆ‘ä»¬çš„å›è°ƒå‡½æ•°. å®é™…è¿ç”¨ä¸­ ajax å¼‚æ­¥è¯·æ±‚, å½“æˆ‘ä»¬ä¸çŸ¥é“è¿”å›å€¼åœ¨ä»€ä¹ˆæ—¶å€™è¿”å›å€¼åˆéœ€è¦åœ¨è¿”å›ååšä¸€äº›å¤„ç†, å°±è¦ç”¨åˆ°å›è°ƒå‡½æ•°äº†.\n\n```javascript\nlet getPersonInfo = function (userId, callback) {\n\t$.ajax(`http://xxx/getPersonInfo?${userId}`, function (data) {\n\t\tcallback && callback(data)\n\t})\n}\n// è¿™é‡Œçš„åŒ¿åå‡½æ•°å°±æ˜¯ä¸Šé¢çš„ callback\ngetPersonInfo(\"54332123\", function (data) {\n\tconsole.log(data)\n})\n```\nè¿™ç§æ˜¯æˆ‘ä»¬æ¯”è¾ƒå¸¸è§çš„å›è°ƒå‡½æ•°, åœ¨å…¶ä»–çš„æ–¹é¢, ä¹Ÿå¯ä»¥å°†ä¸€äº›è¯·æ±‚å§”æ‰˜ç»™å¦ä¸€ä¸ªå‡½æ•°ä»£ä¸ºæ‰§è¡Œ, å¦‚:\nå‡å¦‚æˆ‘ä»¬éœ€è¦å…ˆåˆ›å»º100çš„ div èŠ‚ç‚¹, ç„¶åæŠŠå®ƒä»¬éšè—æ‰\n\n```javascript\n// count é»˜è®¤å€¼ä¸º100\nconst appendDiv = count = 100, callback => {\n\tif (count && typeof count === 'number') {\n\t\tfor(let i = 0; i < count; i++){\n\t\t\tlet div = document.createElement('div')\n\t\t\tdiv.innerHTML = i\n\t\t\tdocument.body.appendChild(div)\n\t\t\t// å°†ä¸šåŠ¡ä»£ç å§”æ‰˜æ‰§è¡Œ\n\t\t\tcallback && callback(div)\n\t\t}\n\t}\n} \n// æŠŠæ”¹å˜æ ·å¼çš„ä¸šåŠ¡é€»è¾‘åˆ†ç¦»å‡ºæ¥\nappendDiv(function (el) {\n\tel.style.cssText = `display: none`\n})\n```\nè¿™æ ·æˆ‘ä»¬å°±å°†ä¸šåŠ¡é€»è¾‘åˆ†ç¦»å‡ºæ¥äº†, ä»¥åå¯èƒ½æˆ‘ä»¬æƒ³æ”¹é¢œè‰²å•¦æˆ–è€…ä½ç½®ä»€ä¹ˆçš„ä¹Ÿæ–¹ä¾¿ç»´æŠ¤.\n\n#### å‡½æ•°ä½œä¸ºè¿”å›å€¼ \nç›¸æ¯”æŠŠå‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’, å¯èƒ½å‡½æ•°å½“åšè¿”å›å€¼è¿”å›è¿ç”¨åœºæ™¯æ›´å¤šä¸€äº›, è®©å‡½æ•°è¿”å›å¦ä¸€ä¸ªå¯æ‰§è¡Œå‡½æ•°å°±æ„å‘³ç€è¿ç®—è¿‡ç¨‹å¯å»¶ç»­.ç›´æ¥æ¥çœ‹ä¸€äº›ä¾‹å­å§.\n\n- æ£€æŸ¥ç±»å‹\n\n```javascript\nconst Type = {}\nfor (let i = 0, type; type = ['Array', 'String', 'Number'][i++];) {\n\tType['is' + type] = function (obj) {\n\t\treturn Object.prototype.toString.call(obj) === '[object '+ type +']'\n\t}\n}\n\nconsole.log(Type.isArray([])) // true\nconsole.log(Type.isString('123')) // true\nconsole.log(Type.isNumber(123)) // true\n```\n\n- å•ä¾‹æ¨¡å¼\n\tè¿™é‡Œå…ˆä¸è®¨è®ºå•ä¾‹æ¨¡å¼, åªçœ‹ä»£ç å®ç°\n\n```javascript\n// fn å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’\nconst getSingle = function (fn) {\n\tlet ret;\n\treturn function () {\n\t\t// å¦‚æœ ret ä¸å­˜åœ¨, ret ç­‰äº fn å‡½æ•°\n\t\treturn ret || (ret = fn.apply(this, arguments))\n\t}\n} \n// è°ƒç”¨è¿™ä¸ªé«˜é˜¶å‡½æ•°\nlet getDiv = getSingle(function () {\n\t// å‚æ•°ä¹Ÿä¼šä¸€èµ·ä¼ è¿‡æ¥, è¿™é‡Œè¿”å›['123']\n\tconsole.log(arguments);\n\treturn document.createElement('div');\n\t\n})\ngetDiv('123')\n```\ngetSingle è¿™ä¸ªé«˜é˜¶å‡½æ•°æ—¢å°†å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’, åˆè®©å‡½æ•°æ‰§è¡Œåè¿”å›å¦ä¸€ä¸ªå‡½æ•°.\n\n> JavaScript è®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µè¿˜æœ‰ä¸ªä¾‹å­ä¹Ÿå¾ˆæœ‰æ„æ€\n> å«åš AOP(é¢å‘åˆ‡é¢ç¼–ç¨‹), ä½œç”¨æ˜¯æŠŠä¸ä¸šåŠ¡é€»è¾‘ä¸ç›¸å…³çš„éƒ¨åˆ†æŠ½ç¦»å‡ºæ¥å†é€šè¿‡åŠ¨æ€æ¤å…¥çš„æ–¹å¼åŠ å…¥ä¸šåŠ¡é€»è¾‘çš„æ¨¡å—ä¸­.\n\n```javascript\n// åœ¨åŸå‡½æ•°ä¹‹å‰\nFunction.prototype.before = function (beforeFn) {\n\tlet that = this; // ä¿å­˜åŸå‡½æ•°çš„å¼•ç”¨\n\treturn function () { // A\n\t\t// æ‰§è¡Œæ–°å‡½æ•°å¹¶ä¿®æ­£ this\n\t\tbeforeFn.apply(this, arguments)\n\t\t// æ‰§è¡ŒåŸå‡½æ•°\n\t\treturn that.apply(this, arguments)\n\t}\n}\n// åœ¨åŸå‡½æ•°ä¹‹å\nFunction.prototype.after = function (afterFn) {\n\tlet that = this\n\treturn function () { // B\n\t\t// å…ˆæ‰§è¡Œ before å‡½æ•°\n\t\tthat.apply(this, arguments)\n\t\t// å†æ‰§è¡Œæ–°å‡½æ•°\n\t\treturn afterFn.apply(this, arguments)\n\t}\n}\n\nlet fn = function () {\n\tconsole.log(2)\n}\nfn = fn.before(function() {\n\tconsole.log(1)\n}).after(function() {\n\tconsole.log(3)\n})\n\nfn() // æŒ‰é¡ºåºè¾“å‡º 1 2 3\n```\nä¸Šé¢çš„æ‰§è¡Œé¡ºåºæ˜¯è¿™æ ·çš„:\n\n1. Afterä¸­çš„å›è°ƒå‡½æ•° B\nå› ä¸ºåœ¨æœ€åæ‰§è¡Œ fn å‡½æ•°æ—¶, fn å·²ç»æ˜¯ after å‡½æ•°äº†, å› æ­¤åœ¨ fn() æ‰§è¡Œæ—¶è°ƒç”¨çš„æ˜¯ after ä¸­è¿”å›çš„åŒ¿åå‡½æ•°B.\n2. B ä¸­çš„ that.apply(this, arguments)\næ­¤æ—¶çš„ that æŒ‡å‘ before å‡½æ•°\n3.  æ‰§è¡ŒBeforeä¸­çš„å›è°ƒå‡½æ•° A\n4. A ä¸­çš„ beforeFn.apply(this, arguments)\næ‰§è¡Œ console.log(1)\n5. return that.apply(this, arguments)\næ‰§è¡Œ console.log(2)\n6. å›åˆ° after å‡½æ•°ä¸­æ‰§è¡Œreturn afterFn.apply(this, arguments)\næ‰§è¡Œ console.log(3)\n\n\n#### å‡½æ•°æŸ¯é‡ŒåŒ–\nå‡½æ•°æŸ¯é‡ŒåŒ–å¯ä»¥è¯´æ˜¯é«˜é˜¶å‡½æ•°ç»å…¸ä¸­çš„ç»å…¸äº†, è¯´åˆ°é«˜é˜¶å‡½æ•°åº”è¯¥å¾ˆå¿«å°±ä¼šæƒ³åˆ°ä»–äº†. æˆ‘ç†è§£çš„å‡½æ•°æŸ¯é‡ŒåŒ–æ˜¯: å…ˆå°†å‚æ•°ä¾æ¬¡ç¼“å­˜, åœ¨çœŸæ­£éœ€è¦è®¡ç®—ç»“æœæ—¶, æ‰è¿›è¡Œè®¡ç®—è¿™æ ·å¯ä»¥å‡å°‘è¿ç®—æ¬¡æ•°.\n\n```js\n// é€šç”¨ curring\nconst curring = fn => {\n    let argsArr = []\n    return (...args) => {\n        return [...args].length === 0\n            ? fn.apply(null, argsArr)\n            : [].push.apply(argsArr, [...args])\n    }\n}\n\n// éœ€è¦è®¡ç®—çš„å‡½æ•°\nlet calculate = (() => {\n    let money = 0\n    return (...argsArr) => {\n        argsArr.forEach(item => {\n            money += item\n        })\n        return money\n    }\n})()\n\n// æŸ¯é‡ŒåŒ–\ncalculate = curring(calculate)\n\n// ç¼“å­˜å‚æ•°, å…¶å®å¹¶æ²¡æœ‰è®¡ç®—\ncalculate(20)\ncalculate(40)\ncalculate(20)\n\n// çœŸæ­£è®¡ç®—çš„æ—¶å€™\ncalculate()\n```\n\n#### å‡½æ•°èŠ‚æµ\nåœ¨æŸäº›åœºæ™¯ä¸‹å‡½æ•°æœ‰å¯èƒ½ä¼šè¢«éå¸¸é¢‘ç¹åœ°è°ƒç”¨, ä»è€Œé€ æˆå¾ˆå¤§çš„æ€§èƒ½é—®é¢˜. ä¾‹å¦‚: window.resizeäº‹ä»¶ã€mousemove äº‹ä»¶, å®ƒä»¬è§¦å‘çš„é¢‘ç‡å¤ªé«˜äº†, è€Œç”¨æˆ·å¹¶ä¸éœ€è¦å¦‚æ­¤é«˜é¢‘ç‡çš„ä½¿ç”¨. å› æ­¤å‡½æ•°èŠ‚æµå°±æ˜¯ä¸ºäº†é™åˆ¶å‡½æ•°å‡ºå‘çš„é¢‘ç‡.\n\n```js\n// èŠ‚æµ\nconst throttle = (fn, interval = 800) => {\n    let isFirst = true, timer\n    // ...args => event\n    return (...args) => {\n        let that = this\n        if (isFirst) {\n            fn.apply(that, [...args])\n            return isFirst = false\n        }\n        if (timer) return false\n        timer = setTimeout(() => {\n            clearTimeout(timer)\n            timer = null\n            fn.apply(that, [...args])\n        }, interval)\n    }\n}\n\n// ä¼ å…¥éœ€è¦èŠ‚æµçš„å‡½æ•°å’Œé—´éš”æ—¶é—´\nwindow.onresize = throttle(function () {\n    console.log(1)\n}, 800)\n```\n#### åˆ†æ—¶å‡½æ•°\nä¸Šé¢æˆ‘ä»¬æä¾›äº†ä¸€ç§é™åˆ¶å‡½æ•°è°ƒç”¨é¢‘ç‡çš„è§£å†³æ–¹æ¡ˆ, ç°åœ¨æ˜¯å¦ä¸€ä¸ªé—®é¢˜: æŸäº›å‡½æ•°æ˜¯ç”±ç”¨æˆ·ä¸»åŠ¨å”¤èµ·çš„, ä½†æ˜¯å› ä¸ºä¸€äº›åŸå› å¯¼è‡´å‡½æ•°ä¸¥é‡å½±å“é¡µé¢çš„æ€§èƒ½. åˆ†æ—¶å‡½æ•°å¯ä»¥ä¸ºæˆ‘ä»¬è§£å†³è¿™ä¸ªé—®é¢˜, æˆ‘ç†è§£çš„åˆ†æ—¶å‡½æ•°: å°†è¯·æ±‚åˆ†æ‰¹å¤„ç†, åœ¨ä¸€å®šçš„æ—¶é—´å†…æ‰§è¡Œä¸€éƒ¨åˆ†è¯·æ±‚, ç›´åˆ°è¯·æ±‚å…¨éƒ¨å®Œæˆ.\n\n```js\n// åˆ†æ—¶å‡½æ•°\nconst timeChunk = (data, fn, count = 1) => {\n    let timer, obj\n    const start = () => {\n        for (let i = 0; i < Math.min(count, data.length); i++) {\n            obj = data.shift()\n            fn.apply(null, obj)\n        }\n    }\n    return () => {\n        if (data.length === 0) {\n            clearTimeout(timer)\n            return\n        }\n        timer = setInterval(() => {\n            start()\n        }, 200)\n    }\n}\n\n// æ¨¡æ‹Ÿæ•°æ®\nlet ary = []\nfor (let i = 0; i < 1000; i++) {\n    ary.push(i)\n}\n\n// åˆ†æ—¶åŒ–\nlet renderfriendList = timeChunk(ary, function (n) {\n    let div = document.createElement('div')\n    div.innerHTML = n\n    document.body.appendChild(div)\n}, 10)\n\n// æ¸²æŸ“\nrenderfriendList()\n```\n\n#### æƒ°æ€§åŠ è½½\nä¸¾ä¸ªä¾‹å­, åœ¨ web ä¸­ä¸ºäº†æ»¡è¶³å„æµè§ˆå™¨ä¹‹é—´çš„å·®å¼‚, æˆ‘ä»¬ä¼šåšä¸€äº›å—…æ¢å·¥ä½œ. å¼‚äºå¸¸è§„æ–¹æ¡ˆ, æƒ°æ€§åŠ è½½åœ¨çœŸæ­£éœ€è¦æ—¶æ‰ä½¿ç”¨ä¸”è¿›å…¥æ¡ä»¶åˆ†æ”¯ååœ¨å†…éƒ¨é‡å†™è¯¥å‡½æ•°, è¿™æ ·é‡å†™åçš„å‡½æ•°å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„å‡½æ•°.\n\n```js\nlet addEvent = (el, type, handler) => {\n    if (window.addEventListener) {\n        // é‡å†™å‡½æ•°\n        addEvent = (el, type, handler) => {\n            el.addEventListener(type, handler, false)\n        }\n    } else if (window.attachEvent) {\n        addEvent = (el, type, handler) => {\n            el.attachEvent('on' + type, handler)\n        }\n    }\n    addEvent(el, type, handler)\n}\n\n// ä½¿ç”¨\naddEvent(btn, 'click', function () {\n    console.log('click!')\n})\n```\n\nCreated on 2017-10-26 by Cara","slug":"é—­åŒ…å’Œé«˜é˜¶å‡½æ•°","published":1,"updated":"2018-05-05T09:23:03.683Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjgurolt40020klu0xmy4iinz","content":"<p>è¿™ä¸€ç¯‡ç¬”è®°æ˜¯ä¸ºæ­£å¼å¼€å§‹å­¦ä¹  javadcript è®¾è®¡æ¨¡å¼åšé“ºå«ï¼Œç”±äºè®¸å¤šè®¾è®¡æ¨¡å¼éƒ½ç”¨åˆ°äº†é—­åŒ…å’Œé«˜é˜¶å‡½æ•°æ¥å®ç°, æ‰€ä»¥äº†è§£è¿™ä¸¤ä¸ªçŸ¥è¯†ç‚¹ä¹Ÿæ˜¯å¿…è¦çš„.</p>\n<blockquote>\n<h3 id=\"é—­åŒ…\"><a href=\"#é—­åŒ…\" class=\"headerlink\" title=\"é—­åŒ…\"></a>é—­åŒ…</h3><p>é—­åŒ…ç®€å•çš„æ¥è¯´æ˜¯å‡½æ•°ä¸å‡½æ•°ä¹‹é—´çš„æ¡¥æ¢, è®©ä¸€ä¸ªå‡½æ•°æœ‰æƒè®¿é—®å¦ä¸€ä¸ªå‡½æ•°ä½œç”¨åŸŸé‡Œçš„å˜é‡. å®šä¹‰è¯´èµ·æ¥è¿˜æ˜¯å¾ˆç”Ÿæ¶©çš„, è¦ç†è§£é—­åŒ…æˆ‘ä»¬éœ€è¦å…ˆçŸ¥é“å˜é‡çš„ä½œç”¨åŸŸä»¥åŠå˜é‡çš„ç”Ÿå‘½å‘¨æœŸæ‰è¡Œ.</p>\n</blockquote>\n<ul>\n<li>å˜é‡çš„ä½œç”¨åŸŸ<br>å˜é‡çš„ä½œç”¨åŸŸæŒ‡çš„æ˜¯å˜é‡çš„æœ‰æ•ˆèŒƒå›´. åœ¨å‡½æ•°ä¸­ç”Ÿå‘½å˜é‡æ—¶, å¦‚æœæ²¡æœ‰å…³é”®å­— varã€letåŠconsté‚£ä¹ˆè¿™ä¸ªå˜é‡å°±ä¼šå˜æˆå…¨å±€å˜é‡; å¦‚æœæœ‰è¿™ä¸ªæ—¶å€™çš„å˜é‡å°±æ˜¯å±€éƒ¨å˜é‡, åªæœ‰åœ¨å‡½æ•°å†…éƒ¨æ‰èƒ½å¤Ÿè®¿é—®åˆ°.<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> fun = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">let</span> a = <span class=\"number\">1</span>;</span><br><span class=\"line\">\talert(a)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">fun()</span><br><span class=\"line\">alert(a) <span class=\"comment\">// a is not defined</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>å‡½æ•°è¿™ä¸ªæ—¶å€™å°±åƒä¸€å—å•é¢é•œ, é‡Œé¢å¯ä»¥çœ‹è§å¤–é¢, å¤–é¢ä¸èƒ½çœ‹åˆ°é‡Œé¢. å› ä¸ºå‡½æ•°åœ¨æœç´¢ä¸€ä¸ªå˜é‡çš„æ—¶å€™, å¦‚æœå‡½æ•°å†…æ²¡æœ‰è¿™ä¸ªå˜é‡, é‚£ä¹ˆè¿™ä¸ªæœç´¢è¿‡ç¨‹ä¼šéšç€ä»£ç çš„æ‰§è¡Œç¯å¢ƒåˆ›å»ºçš„ä½œç”¨åŸŸé“¾å‘å¤–æœç´¢ç›´è‡³å…¨å±€å¯¹è±¡.</p>\n<ul>\n<li>å˜é‡ç”Ÿå‘½å‘¨æœŸ<br>å¯¹äºå…¨å±€å˜é‡æ¥è¯´, å®ƒçš„ç”Ÿå‘½å‘¨æœŸè‡ªç„¶æ˜¯æ°¸ä¹…çš„é™¤éæˆ‘ä»¬æ‰‹åŠ¨é”€æ¯è¿™ä¸ªå˜é‡; å¯¹äºå±€éƒ¨å˜é‡, ä¸€èˆ¬æ¥è¯´å½“å‡½æ•°æ‰§è¡Œå®Œæ¯•ä¹‹åè¯¥å˜é‡å°±ä¼šè·Ÿç€è¢«é”€æ¯. è€Œé—­åŒ…åˆ™å¯ä»¥å»¶ç»­å±€éƒ¨å˜é‡çš„ç”Ÿå‘½å‘¨æœŸ, ä¸¾ä¸ªæ —å­:<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> func = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">let</span> a = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t\ta++;</span><br><span class=\"line\">\t\talert(a);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">let</span> fn = func();</span><br><span class=\"line\">fn(); <span class=\"comment\">// 1</span></span><br><span class=\"line\">fn(); <span class=\"comment\">// 2</span></span><br><span class=\"line\">fn(); <span class=\"comment\">// 3</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° a å˜é‡ä¸ä»…åœ¨å¤–éƒ¨å¯ä»¥è¢«è®¿é—®åˆ°è€Œä¸”è¿˜ä¸€ç›´åœ¨é€’å¢, è¿™æ˜¯å› ä¸º <code>fn = func()</code>æ‰§è¡Œæ—¶, fn ä¿å­˜äº† func è¿”å›çš„åŒ¿åå‡½æ•°, è€Œè¿™ä¸ªåŒ¿åå‡½æ•°æ˜¯æœ‰æƒ func() è¢«è°ƒç”¨æ—¶äº§ç”Ÿçš„ç¯å¢ƒ. a å˜é‡å°±åœ¨è¿™ä¸ªç¯å¢ƒä¸­, æ‰€ä»¥æ—¢ç„¶å±€éƒ¨å˜é‡æ‰€åœ¨æ¢çš„ç¯å¢ƒæ²¡æœ‰è¢«é”€æ¯é‚£ä¹ˆ a å˜é‡ä¹Ÿä¸ä¼šè¢«é”€æ¯æ‰, è¿™ä¸ªä¾‹å­å°±äº§ç”Ÿäº†ä¸€ä¸ªé—­åŒ…ç»“æ„.</p>\n<blockquote>\n<h4 id=\"é—­åŒ…çš„ä½œç”¨\"><a href=\"#é—­åŒ…çš„ä½œç”¨\" class=\"headerlink\" title=\"é—­åŒ…çš„ä½œç”¨\"></a>é—­åŒ…çš„ä½œç”¨</h4></blockquote>\n<ul>\n<li>å°è£…å˜é‡<br>ä¼—æ‰€å‘¨çŸ¥å…¨å±€å˜é‡æ˜¯éå¸¸å®¹æ˜“å¼•èµ·å‘½åå†²çªçš„, æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨é—­åŒ…æŠŠä¸€äº›ä¸éœ€è¦æš´éœ²åœ¨å…¨å±€çš„å˜é‡å°è£…æˆç§æœ‰å˜é‡.</li>\n</ul>\n<p>å‡è®¾æœ‰ä¸€ä¸ªè®¡ç®—ä¹˜ç§¯çš„å‡½æ•°:<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> mult = (<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">// ç¼“å­˜(å°è£…èµ·æ¥)</span></span><br><span class=\"line\">\t<span class=\"keyword\">let</span> cache = &#123;&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> arg = [].join.call(<span class=\"built_in\">arguments</span>, <span class=\"string\">','</span>)</span><br><span class=\"line\">\t\t<span class=\"comment\">// å°è£…è®¡ç®—æ–¹æ³•</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> calulate = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">let</span> a = <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>, len = <span class=\"built_in\">arguments</span>.length; i &lt; len; i++) &#123;</span><br><span class=\"line\">\t\t\t\ta = a * <span class=\"built_in\">arguments</span>[i]</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"comment\">// å­˜åœ¨ç¼“å­˜åˆ™ä¸è®¡ç®—</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (arg <span class=\"keyword\">in</span> cache) <span class=\"keyword\">return</span> cache[arg]</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> cache[arg] = calulate.apply(<span class=\"literal\">null</span>, <span class=\"built_in\">arguments</span>)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;)()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(mult(<span class=\"number\">2</span>,<span class=\"number\">2</span>,<span class=\"number\">1</span>)); <span class=\"comment\">// 4</span></span><br></pre></td></tr></table></figure></p>\n<p>å°†å˜é‡ cache å°è£…åœ¨ mult å‡½æ•°ä¸­æ¥ç¼“å­˜å·²ç»è®¡ç®—è¿‡çš„å‚æ•°, ä»¥å‡å°‘é‡å¤è®¡ç®—. è¿™ä¸ªç¼“å­˜æœºåˆ¶æœ¬æ¥æ˜¯å¯ä»¥æ‰”åœ¨å…¨å±€ç¯å¢ƒä¸­çš„.</p>\n<ul>\n<li>å»¶ç»­å±€éƒ¨å˜é‡ç”Ÿå‘½å‘¨æœŸ<br>å¹³å¸¸åšåŸ‹ç‚¹ä¼šç”¨åˆ°çš„ image å¯¹è±¡æ¥ä¸ŠæŠ¥æ•°æ®, å¦‚ä¸‹:</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> report = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">src</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">let</span> img = <span class=\"keyword\">new</span> Image()</span><br><span class=\"line\">\timg.src = src</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">report(<span class=\"string\">'http://xxxxx.com/xxx'</span>)</span><br></pre></td></tr></table></figure>\n<p>è¿™ç§å†™æ³•ä¼šé€ æˆæ•°æ®ä¸¢å¤±, å› ä¸ºåœ¨ HTTP è¿˜æœªç»“æŸæ—¶, report å‡½æ•°å·²ç»æ‰§è¡Œå®Œæ¯•è€Œ img ä¸º report å‡½æ•°ä¸­çš„å±€éƒ¨å˜é‡, åœ¨å‡½æ•°æ‰§è¡Œå®Œæ¯•åå°±ä¼šéšä¹‹é”€æ¯é€ æˆæ•°æ®ä¸¢å¤±çš„æƒ…å†µ. ä¸‹é¢ç”¨é—­åŒ…æŠŠå˜é‡å°è£…èµ·æ¥, æ¥è§£å†³è¿™ä¸€é—®é¢˜:<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> report = (<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">let</span> imgs = []</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">src</span>) </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> img = <span class=\"keyword\">new</span> Image();</span><br><span class=\"line\">\t\timgs.push(img);</span><br><span class=\"line\">\t\timg.src = src</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;)()</span><br><span class=\"line\">report(<span class=\"string\">'http://xxxxx.com/xxx'</span>)</span><br></pre></td></tr></table></figure></p>\n<blockquote>\n<h4 id=\"é—­åŒ…å®ç°å‘½ä»¤æ¨¡å¼\"><a href=\"#é—­åŒ…å®ç°å‘½ä»¤æ¨¡å¼\" class=\"headerlink\" title=\"é—­åŒ…å®ç°å‘½ä»¤æ¨¡å¼\"></a>é—­åŒ…å®ç°å‘½ä»¤æ¨¡å¼</h4><p>è¯´äº†è¿™ä¹ˆå¤šå°±æ¥çœ‹çœ‹å…³äºé—­åŒ…çš„è¿ç”¨å§, è¿™é‡Œç”¨é—­åŒ…ç®€å•å®ç°ä¸‹å‘½ä»¤æ¨¡å¼, é¡ºä¾¿é¢„å…ˆäº†è§£ä¸€ä¸‹å‘½ä»¤æ¨¡å¼.</p>\n</blockquote>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">button</span> <span class=\"attr\">id</span>=<span class=\"string\">'open'</span> <span class=\"attr\">onclick</span>=<span class=\"string\">'execute'</span>&gt;</span>æ‰§è¡Œå‘½ä»¤<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">button</span> <span class=\"attr\">id</span>=<span class=\"string\">'close'</span> <span class=\"attr\">onclick</span>=<span class=\"string\">'undo'</span>&gt;</span>æ’¤é”€å‘½ä»¤<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>é¢å‘å¯¹è±¡ç‰ˆ<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> TV = &#123;</span><br><span class=\"line\">\topen () &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">'TV is open!'</span>)</span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\">\tclose () &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">'TV is close!'</span>)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// æ¥æ”¶å‘½ä»¤</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> ReceiveCommand = <span class=\"function\"><span class=\"params\">receiver</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">this</span>.receiver = receiver</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// æ‰“å¼€ç”µè§†</span></span><br><span class=\"line\">ReceiveCommand.prototype.execute = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">this</span>.receiver.open()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// å…³ç”µè§†</span></span><br><span class=\"line\">ReceiveCommand.prototype.undo = functon () &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">this</span>.receiver.close()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// è®¾ç½®å‘½ä»¤</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> setCommand = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">command</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'open'</span>).onclick = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t\tcommand.execute()</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'close'</span>).onclick = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t\tcommand.undo()</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// å°†å‘½ä»¤å‘Šè¯‰æ‰§è¡Œè€…, è®¾ç½®å‘½ä»¤ä¼ å…¥æ‰§è¡Œè€…</span></span><br><span class=\"line\">setCommand(<span class=\"keyword\">new</span> ReceiveCommand(TV))</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>å‘½ä»¤æ¨¡å¼æ˜¯æŠŠè¯·æ±‚å‘èµ·è€…å’Œæ‰§è¡Œå‘½ä»¤(æ‰§è¡Œè€…)åˆ†ç¦»å¼€æ¥, ä»¥è¾¾åˆ°è§£è€¦çš„ç›®çš„. åœ¨æ‰§è¡Œå‘½ä»¤ä¹‹å‰, æŠŠå‘½ä»¤æ”¾å…¥æ‰§è¡Œè€…æ¥å‘Šè¯‰æ‰§è¡Œè€…è¦æ‰§è¡Œä»€ä¹ˆæ ·çš„å‘½ä»¤, å‘½ä»¤æ¨¡å¼å¤§æ¦‚å°±æ˜¯è¿™æ ·å•¦.</p>\n<ul>\n<li>é—­åŒ…ç‰ˆ<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> TV = &#123;</span><br><span class=\"line\">\topen () &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">'TV is open!'</span>)</span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\">\tclose () &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">'TV is close!'</span>)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// æ‰§è¡Œè€…</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> receiveCommand = <span class=\"function\"><span class=\"params\">receiver</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">let</span> execute = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> receiver.open()</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">let</span> undo = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> receiver.close()</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">\t\texecute: execute,</span><br><span class=\"line\">\t\tundo: undo</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// å‘èµ·è€…</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> setCommand = <span class=\"function\"><span class=\"params\">command</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t<span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'open'</span>).onclick = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t\texecute.open()</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'close'</span>).onclick = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t\tundo.close()</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">setCommand(receiveCommand(TV))</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>é—­åŒ…æ˜æ˜¾æ¸…æ™°æ›´å¤š, ä¹Ÿæ›´ç®€æ´.</p>\n<blockquote>\n<h3 id=\"é«˜é˜¶å‡½æ•°\"><a href=\"#é«˜é˜¶å‡½æ•°\" class=\"headerlink\" title=\"é«˜é˜¶å‡½æ•°\"></a>é«˜é˜¶å‡½æ•°</h3><p>å°†å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’æˆ–è®©å‡½æ•°æ‰§è¡Œç»“æœè¿”å›å¦ä¸€ä¸ªå‡½æ•°, æ»¡è¶³è¿™ä¸¤ä¸ªæ¡ä»¶ä¹‹ä¸€çš„å‡½æ•°éƒ½å¯ä»¥ç§°ä½œä¸ºé«˜é˜¶å‡½æ•°.</p>\n</blockquote>\n<h4 id=\"å°†å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’\"><a href=\"#å°†å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’\" class=\"headerlink\" title=\"å°†å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’\"></a>å°†å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’</h4><p>å°†å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’, å°±æ„å‘³ç€æˆ‘ä»¬å¯ä»¥å°†ä¸ä¸šåŠ¡ç›¸å…³çš„é€»è¾‘ä»£ç åˆ†ç¦»å‡ºæ¥, è§£é™¤ä¸šåŠ¡ä»£ç å’Œä¸å˜é€»è¾‘çš„è€¦åˆ, æœ€å¸¸è§çš„å°±æ˜¯æˆ‘ä»¬çš„å›è°ƒå‡½æ•°. å®é™…è¿ç”¨ä¸­ ajax å¼‚æ­¥è¯·æ±‚, å½“æˆ‘ä»¬ä¸çŸ¥é“è¿”å›å€¼åœ¨ä»€ä¹ˆæ—¶å€™è¿”å›å€¼åˆéœ€è¦åœ¨è¿”å›ååšä¸€äº›å¤„ç†, å°±è¦ç”¨åˆ°å›è°ƒå‡½æ•°äº†.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> getPersonInfo = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">userId, callback</span>) </span>&#123;</span><br><span class=\"line\">\t$.ajax(<span class=\"string\">`http://xxx/getPersonInfo?<span class=\"subst\">$&#123;userId&#125;</span>`</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">data</span>) </span>&#123;</span><br><span class=\"line\">\t\tcallback &amp;&amp; callback(data)</span><br><span class=\"line\">\t&#125;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// è¿™é‡Œçš„åŒ¿åå‡½æ•°å°±æ˜¯ä¸Šé¢çš„ callback</span></span><br><span class=\"line\">getPersonInfo(<span class=\"string\">\"54332123\"</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">data</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">console</span>.log(data)</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p>è¿™ç§æ˜¯æˆ‘ä»¬æ¯”è¾ƒå¸¸è§çš„å›è°ƒå‡½æ•°, åœ¨å…¶ä»–çš„æ–¹é¢, ä¹Ÿå¯ä»¥å°†ä¸€äº›è¯·æ±‚å§”æ‰˜ç»™å¦ä¸€ä¸ªå‡½æ•°ä»£ä¸ºæ‰§è¡Œ, å¦‚:<br>å‡å¦‚æˆ‘ä»¬éœ€è¦å…ˆåˆ›å»º100çš„ div èŠ‚ç‚¹, ç„¶åæŠŠå®ƒä»¬éšè—æ‰</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// count é»˜è®¤å€¼ä¸º100</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> appendDiv = count = <span class=\"number\">100</span>, callback =&gt; &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (count &amp;&amp; <span class=\"keyword\">typeof</span> count === <span class=\"string\">'number'</span>) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; count; i++)&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">let</span> div = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">'div'</span>)</span><br><span class=\"line\">\t\t\tdiv.innerHTML = i</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">document</span>.body.appendChild(div)</span><br><span class=\"line\">\t\t\t<span class=\"comment\">// å°†ä¸šåŠ¡ä»£ç å§”æ‰˜æ‰§è¡Œ</span></span><br><span class=\"line\">\t\t\tcallback &amp;&amp; callback(div)</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125; </span><br><span class=\"line\"><span class=\"comment\">// æŠŠæ”¹å˜æ ·å¼çš„ä¸šåŠ¡é€»è¾‘åˆ†ç¦»å‡ºæ¥</span></span><br><span class=\"line\">appendDiv(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">el</span>) </span>&#123;</span><br><span class=\"line\">\tel.style.cssText = <span class=\"string\">`display: none`</span></span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p>è¿™æ ·æˆ‘ä»¬å°±å°†ä¸šåŠ¡é€»è¾‘åˆ†ç¦»å‡ºæ¥äº†, ä»¥åå¯èƒ½æˆ‘ä»¬æƒ³æ”¹é¢œè‰²å•¦æˆ–è€…ä½ç½®ä»€ä¹ˆçš„ä¹Ÿæ–¹ä¾¿ç»´æŠ¤.</p>\n<h4 id=\"å‡½æ•°ä½œä¸ºè¿”å›å€¼\"><a href=\"#å‡½æ•°ä½œä¸ºè¿”å›å€¼\" class=\"headerlink\" title=\"å‡½æ•°ä½œä¸ºè¿”å›å€¼\"></a>å‡½æ•°ä½œä¸ºè¿”å›å€¼</h4><p>ç›¸æ¯”æŠŠå‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’, å¯èƒ½å‡½æ•°å½“åšè¿”å›å€¼è¿”å›è¿ç”¨åœºæ™¯æ›´å¤šä¸€äº›, è®©å‡½æ•°è¿”å›å¦ä¸€ä¸ªå¯æ‰§è¡Œå‡½æ•°å°±æ„å‘³ç€è¿ç®—è¿‡ç¨‹å¯å»¶ç»­.ç›´æ¥æ¥çœ‹ä¸€äº›ä¾‹å­å§.</p>\n<ul>\n<li>æ£€æŸ¥ç±»å‹</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> Type = &#123;&#125;</span><br><span class=\"line\"><span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>, type; type = [<span class=\"string\">'Array'</span>, <span class=\"string\">'String'</span>, <span class=\"string\">'Number'</span>][i++];) &#123;</span><br><span class=\"line\">\tType[<span class=\"string\">'is'</span> + type] = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">obj</span>) </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"built_in\">Object</span>.prototype.toString.call(obj) === <span class=\"string\">'[object '</span>+ type +<span class=\"string\">']'</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(Type.isArray([])) <span class=\"comment\">// true</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(Type.isString(<span class=\"string\">'123'</span>)) <span class=\"comment\">// true</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(Type.isNumber(<span class=\"number\">123</span>)) <span class=\"comment\">// true</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>å•ä¾‹æ¨¡å¼<br>  è¿™é‡Œå…ˆä¸è®¨è®ºå•ä¾‹æ¨¡å¼, åªçœ‹ä»£ç å®ç°</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// fn å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> getSingle = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">fn</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">let</span> ret;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">// å¦‚æœ ret ä¸å­˜åœ¨, ret ç­‰äº fn å‡½æ•°</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> ret || (ret = fn.apply(<span class=\"keyword\">this</span>, <span class=\"built_in\">arguments</span>))</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125; </span><br><span class=\"line\"><span class=\"comment\">// è°ƒç”¨è¿™ä¸ªé«˜é˜¶å‡½æ•°</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> getDiv = getSingle(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">// å‚æ•°ä¹Ÿä¼šä¸€èµ·ä¼ è¿‡æ¥, è¿™é‡Œè¿”å›['123']</span></span><br><span class=\"line\">\t<span class=\"built_in\">console</span>.log(<span class=\"built_in\">arguments</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"built_in\">document</span>.createElement(<span class=\"string\">'div'</span>);</span><br><span class=\"line\">\t</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">getDiv(<span class=\"string\">'123'</span>)</span><br></pre></td></tr></table></figure>\n<p>getSingle è¿™ä¸ªé«˜é˜¶å‡½æ•°æ—¢å°†å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’, åˆè®©å‡½æ•°æ‰§è¡Œåè¿”å›å¦ä¸€ä¸ªå‡½æ•°.</p>\n<blockquote>\n<p>JavaScript è®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µè¿˜æœ‰ä¸ªä¾‹å­ä¹Ÿå¾ˆæœ‰æ„æ€<br>å«åš AOP(é¢å‘åˆ‡é¢ç¼–ç¨‹), ä½œç”¨æ˜¯æŠŠä¸ä¸šåŠ¡é€»è¾‘ä¸ç›¸å…³çš„éƒ¨åˆ†æŠ½ç¦»å‡ºæ¥å†é€šè¿‡åŠ¨æ€æ¤å…¥çš„æ–¹å¼åŠ å…¥ä¸šåŠ¡é€»è¾‘çš„æ¨¡å—ä¸­.</p>\n</blockquote>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// åœ¨åŸå‡½æ•°ä¹‹å‰</span></span><br><span class=\"line\"><span class=\"built_in\">Function</span>.prototype.before = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">beforeFn</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">let</span> that = <span class=\"keyword\">this</span>; <span class=\"comment\">// ä¿å­˜åŸå‡½æ•°çš„å¼•ç”¨</span></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123; <span class=\"comment\">// A</span></span><br><span class=\"line\">\t\t<span class=\"comment\">// æ‰§è¡Œæ–°å‡½æ•°å¹¶ä¿®æ­£ this</span></span><br><span class=\"line\">\t\tbeforeFn.apply(<span class=\"keyword\">this</span>, <span class=\"built_in\">arguments</span>)</span><br><span class=\"line\">\t\t<span class=\"comment\">// æ‰§è¡ŒåŸå‡½æ•°</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> that.apply(<span class=\"keyword\">this</span>, <span class=\"built_in\">arguments</span>)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// åœ¨åŸå‡½æ•°ä¹‹å</span></span><br><span class=\"line\"><span class=\"built_in\">Function</span>.prototype.after = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">afterFn</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">let</span> that = <span class=\"keyword\">this</span></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123; <span class=\"comment\">// B</span></span><br><span class=\"line\">\t\t<span class=\"comment\">// å…ˆæ‰§è¡Œ before å‡½æ•°</span></span><br><span class=\"line\">\t\tthat.apply(<span class=\"keyword\">this</span>, <span class=\"built_in\">arguments</span>)</span><br><span class=\"line\">\t\t<span class=\"comment\">// å†æ‰§è¡Œæ–°å‡½æ•°</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> afterFn.apply(<span class=\"keyword\">this</span>, <span class=\"built_in\">arguments</span>)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> fn = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">console</span>.log(<span class=\"number\">2</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">fn = fn.before(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">console</span>.log(<span class=\"number\">1</span>)</span><br><span class=\"line\">&#125;).after(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">console</span>.log(<span class=\"number\">3</span>)</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">fn() <span class=\"comment\">// æŒ‰é¡ºåºè¾“å‡º 1 2 3</span></span><br></pre></td></tr></table></figure>\n<p>ä¸Šé¢çš„æ‰§è¡Œé¡ºåºæ˜¯è¿™æ ·çš„:</p>\n<ol>\n<li>Afterä¸­çš„å›è°ƒå‡½æ•° B<br>å› ä¸ºåœ¨æœ€åæ‰§è¡Œ fn å‡½æ•°æ—¶, fn å·²ç»æ˜¯ after å‡½æ•°äº†, å› æ­¤åœ¨ fn() æ‰§è¡Œæ—¶è°ƒç”¨çš„æ˜¯ after ä¸­è¿”å›çš„åŒ¿åå‡½æ•°B.</li>\n<li>B ä¸­çš„ that.apply(this, arguments)<br>æ­¤æ—¶çš„ that æŒ‡å‘ before å‡½æ•°</li>\n<li>æ‰§è¡ŒBeforeä¸­çš„å›è°ƒå‡½æ•° A</li>\n<li>A ä¸­çš„ beforeFn.apply(this, arguments)<br>æ‰§è¡Œ console.log(1)</li>\n<li>return that.apply(this, arguments)<br>æ‰§è¡Œ console.log(2)</li>\n<li>å›åˆ° after å‡½æ•°ä¸­æ‰§è¡Œreturn afterFn.apply(this, arguments)<br>æ‰§è¡Œ console.log(3)</li>\n</ol>\n<h4 id=\"å‡½æ•°æŸ¯é‡ŒåŒ–\"><a href=\"#å‡½æ•°æŸ¯é‡ŒåŒ–\" class=\"headerlink\" title=\"å‡½æ•°æŸ¯é‡ŒåŒ–\"></a>å‡½æ•°æŸ¯é‡ŒåŒ–</h4><p>å‡½æ•°æŸ¯é‡ŒåŒ–å¯ä»¥è¯´æ˜¯é«˜é˜¶å‡½æ•°ç»å…¸ä¸­çš„ç»å…¸äº†, è¯´åˆ°é«˜é˜¶å‡½æ•°åº”è¯¥å¾ˆå¿«å°±ä¼šæƒ³åˆ°ä»–äº†. æˆ‘ç†è§£çš„å‡½æ•°æŸ¯é‡ŒåŒ–æ˜¯: å…ˆå°†å‚æ•°ä¾æ¬¡ç¼“å­˜, åœ¨çœŸæ­£éœ€è¦è®¡ç®—ç»“æœæ—¶, æ‰è¿›è¡Œè®¡ç®—è¿™æ ·å¯ä»¥å‡å°‘è¿ç®—æ¬¡æ•°.</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// é€šç”¨ curring</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> curring = <span class=\"function\"><span class=\"params\">fn</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> argsArr = []</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"function\">(<span class=\"params\">...args</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> [...args].length === <span class=\"number\">0</span></span><br><span class=\"line\">            ? fn.apply(<span class=\"literal\">null</span>, argsArr)</span><br><span class=\"line\">            : [].push.apply(argsArr, [...args])</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// éœ€è¦è®¡ç®—çš„å‡½æ•°</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> calculate = <span class=\"function\">(<span class=\"params\">(</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> money = <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"function\">(<span class=\"params\">...argsArr</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        argsArr.forEach(<span class=\"function\"><span class=\"params\">item</span> =&gt;</span> &#123;</span><br><span class=\"line\">            money += item</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> money</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;)()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æŸ¯é‡ŒåŒ–</span></span><br><span class=\"line\">calculate = curring(calculate)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ç¼“å­˜å‚æ•°, å…¶å®å¹¶æ²¡æœ‰è®¡ç®—</span></span><br><span class=\"line\">calculate(<span class=\"number\">20</span>)</span><br><span class=\"line\">calculate(<span class=\"number\">40</span>)</span><br><span class=\"line\">calculate(<span class=\"number\">20</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// çœŸæ­£è®¡ç®—çš„æ—¶å€™</span></span><br><span class=\"line\">calculate()</span><br></pre></td></tr></table></figure>\n<h4 id=\"å‡½æ•°èŠ‚æµ\"><a href=\"#å‡½æ•°èŠ‚æµ\" class=\"headerlink\" title=\"å‡½æ•°èŠ‚æµ\"></a>å‡½æ•°èŠ‚æµ</h4><p>åœ¨æŸäº›åœºæ™¯ä¸‹å‡½æ•°æœ‰å¯èƒ½ä¼šè¢«éå¸¸é¢‘ç¹åœ°è°ƒç”¨, ä»è€Œé€ æˆå¾ˆå¤§çš„æ€§èƒ½é—®é¢˜. ä¾‹å¦‚: window.resizeäº‹ä»¶ã€mousemove äº‹ä»¶, å®ƒä»¬è§¦å‘çš„é¢‘ç‡å¤ªé«˜äº†, è€Œç”¨æˆ·å¹¶ä¸éœ€è¦å¦‚æ­¤é«˜é¢‘ç‡çš„ä½¿ç”¨. å› æ­¤å‡½æ•°èŠ‚æµå°±æ˜¯ä¸ºäº†é™åˆ¶å‡½æ•°å‡ºå‘çš„é¢‘ç‡.</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// èŠ‚æµ</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> throttle = <span class=\"function\">(<span class=\"params\">fn, interval = <span class=\"number\">800</span></span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> isFirst = <span class=\"literal\">true</span>, timer</span><br><span class=\"line\">    <span class=\"comment\">// ...args =&gt; event</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"function\">(<span class=\"params\">...args</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">let</span> that = <span class=\"keyword\">this</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (isFirst) &#123;</span><br><span class=\"line\">            fn.apply(that, [...args])</span><br><span class=\"line\">            <span class=\"keyword\">return</span> isFirst = <span class=\"literal\">false</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (timer) <span class=\"keyword\">return</span> <span class=\"literal\">false</span></span><br><span class=\"line\">        timer = setTimeout(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">            clearTimeout(timer)</span><br><span class=\"line\">            timer = <span class=\"literal\">null</span></span><br><span class=\"line\">            fn.apply(that, [...args])</span><br><span class=\"line\">        &#125;, interval)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ä¼ å…¥éœ€è¦èŠ‚æµçš„å‡½æ•°å’Œé—´éš”æ—¶é—´</span></span><br><span class=\"line\"><span class=\"built_in\">window</span>.onresize = throttle(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"number\">1</span>)</span><br><span class=\"line\">&#125;, <span class=\"number\">800</span>)</span><br></pre></td></tr></table></figure>\n<h4 id=\"åˆ†æ—¶å‡½æ•°\"><a href=\"#åˆ†æ—¶å‡½æ•°\" class=\"headerlink\" title=\"åˆ†æ—¶å‡½æ•°\"></a>åˆ†æ—¶å‡½æ•°</h4><p>ä¸Šé¢æˆ‘ä»¬æä¾›äº†ä¸€ç§é™åˆ¶å‡½æ•°è°ƒç”¨é¢‘ç‡çš„è§£å†³æ–¹æ¡ˆ, ç°åœ¨æ˜¯å¦ä¸€ä¸ªé—®é¢˜: æŸäº›å‡½æ•°æ˜¯ç”±ç”¨æˆ·ä¸»åŠ¨å”¤èµ·çš„, ä½†æ˜¯å› ä¸ºä¸€äº›åŸå› å¯¼è‡´å‡½æ•°ä¸¥é‡å½±å“é¡µé¢çš„æ€§èƒ½. åˆ†æ—¶å‡½æ•°å¯ä»¥ä¸ºæˆ‘ä»¬è§£å†³è¿™ä¸ªé—®é¢˜, æˆ‘ç†è§£çš„åˆ†æ—¶å‡½æ•°: å°†è¯·æ±‚åˆ†æ‰¹å¤„ç†, åœ¨ä¸€å®šçš„æ—¶é—´å†…æ‰§è¡Œä¸€éƒ¨åˆ†è¯·æ±‚, ç›´åˆ°è¯·æ±‚å…¨éƒ¨å®Œæˆ.</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// åˆ†æ—¶å‡½æ•°</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> timeChunk = <span class=\"function\">(<span class=\"params\">data, fn, count = <span class=\"number\">1</span></span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> timer, obj</span><br><span class=\"line\">    <span class=\"keyword\">const</span> start = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"built_in\">Math</span>.min(count, data.length); i++) &#123;</span><br><span class=\"line\">            obj = data.shift()</span><br><span class=\"line\">            fn.apply(<span class=\"literal\">null</span>, obj)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (data.length === <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            clearTimeout(timer)</span><br><span class=\"line\">            <span class=\"keyword\">return</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        timer = setInterval(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">            start()</span><br><span class=\"line\">        &#125;, <span class=\"number\">200</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æ¨¡æ‹Ÿæ•°æ®</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> ary = []</span><br><span class=\"line\"><span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">1000</span>; i++) &#123;</span><br><span class=\"line\">    ary.push(i)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// åˆ†æ—¶åŒ–</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> renderfriendList = timeChunk(ary, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">n</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> div = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">'div'</span>)</span><br><span class=\"line\">    div.innerHTML = n</span><br><span class=\"line\">    <span class=\"built_in\">document</span>.body.appendChild(div)</span><br><span class=\"line\">&#125;, <span class=\"number\">10</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æ¸²æŸ“</span></span><br><span class=\"line\">renderfriendList()</span><br></pre></td></tr></table></figure>\n<h4 id=\"æƒ°æ€§åŠ è½½\"><a href=\"#æƒ°æ€§åŠ è½½\" class=\"headerlink\" title=\"æƒ°æ€§åŠ è½½\"></a>æƒ°æ€§åŠ è½½</h4><p>ä¸¾ä¸ªä¾‹å­, åœ¨ web ä¸­ä¸ºäº†æ»¡è¶³å„æµè§ˆå™¨ä¹‹é—´çš„å·®å¼‚, æˆ‘ä»¬ä¼šåšä¸€äº›å—…æ¢å·¥ä½œ. å¼‚äºå¸¸è§„æ–¹æ¡ˆ, æƒ°æ€§åŠ è½½åœ¨çœŸæ­£éœ€è¦æ—¶æ‰ä½¿ç”¨ä¸”è¿›å…¥æ¡ä»¶åˆ†æ”¯ååœ¨å†…éƒ¨é‡å†™è¯¥å‡½æ•°, è¿™æ ·é‡å†™åçš„å‡½æ•°å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„å‡½æ•°.</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> addEvent = <span class=\"function\">(<span class=\"params\">el, type, handler</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">window</span>.addEventListener) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// é‡å†™å‡½æ•°</span></span><br><span class=\"line\">        addEvent = <span class=\"function\">(<span class=\"params\">el, type, handler</span>) =&gt;</span> &#123;</span><br><span class=\"line\">            el.addEventListener(type, handler, <span class=\"literal\">false</span>)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"built_in\">window</span>.attachEvent) &#123;</span><br><span class=\"line\">        addEvent = <span class=\"function\">(<span class=\"params\">el, type, handler</span>) =&gt;</span> &#123;</span><br><span class=\"line\">            el.attachEvent(<span class=\"string\">'on'</span> + type, handler)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    addEvent(el, type, handler)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ä½¿ç”¨</span></span><br><span class=\"line\">addEvent(btn, <span class=\"string\">'click'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'click!'</span>)</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p>Created on 2017-10-26 by Cara</p>\n","site":{"data":{}},"excerpt":"","more":"<p>è¿™ä¸€ç¯‡ç¬”è®°æ˜¯ä¸ºæ­£å¼å¼€å§‹å­¦ä¹  javadcript è®¾è®¡æ¨¡å¼åšé“ºå«ï¼Œç”±äºè®¸å¤šè®¾è®¡æ¨¡å¼éƒ½ç”¨åˆ°äº†é—­åŒ…å’Œé«˜é˜¶å‡½æ•°æ¥å®ç°, æ‰€ä»¥äº†è§£è¿™ä¸¤ä¸ªçŸ¥è¯†ç‚¹ä¹Ÿæ˜¯å¿…è¦çš„.</p>\n<blockquote>\n<h3 id=\"é—­åŒ…\"><a href=\"#é—­åŒ…\" class=\"headerlink\" title=\"é—­åŒ…\"></a>é—­åŒ…</h3><p>é—­åŒ…ç®€å•çš„æ¥è¯´æ˜¯å‡½æ•°ä¸å‡½æ•°ä¹‹é—´çš„æ¡¥æ¢, è®©ä¸€ä¸ªå‡½æ•°æœ‰æƒè®¿é—®å¦ä¸€ä¸ªå‡½æ•°ä½œç”¨åŸŸé‡Œçš„å˜é‡. å®šä¹‰è¯´èµ·æ¥è¿˜æ˜¯å¾ˆç”Ÿæ¶©çš„, è¦ç†è§£é—­åŒ…æˆ‘ä»¬éœ€è¦å…ˆçŸ¥é“å˜é‡çš„ä½œç”¨åŸŸä»¥åŠå˜é‡çš„ç”Ÿå‘½å‘¨æœŸæ‰è¡Œ.</p>\n</blockquote>\n<ul>\n<li>å˜é‡çš„ä½œç”¨åŸŸ<br>å˜é‡çš„ä½œç”¨åŸŸæŒ‡çš„æ˜¯å˜é‡çš„æœ‰æ•ˆèŒƒå›´. åœ¨å‡½æ•°ä¸­ç”Ÿå‘½å˜é‡æ—¶, å¦‚æœæ²¡æœ‰å…³é”®å­— varã€letåŠconsté‚£ä¹ˆè¿™ä¸ªå˜é‡å°±ä¼šå˜æˆå…¨å±€å˜é‡; å¦‚æœæœ‰è¿™ä¸ªæ—¶å€™çš„å˜é‡å°±æ˜¯å±€éƒ¨å˜é‡, åªæœ‰åœ¨å‡½æ•°å†…éƒ¨æ‰èƒ½å¤Ÿè®¿é—®åˆ°.<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> fun = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">let</span> a = <span class=\"number\">1</span>;</span><br><span class=\"line\">\talert(a)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">fun()</span><br><span class=\"line\">alert(a) <span class=\"comment\">// a is not defined</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>å‡½æ•°è¿™ä¸ªæ—¶å€™å°±åƒä¸€å—å•é¢é•œ, é‡Œé¢å¯ä»¥çœ‹è§å¤–é¢, å¤–é¢ä¸èƒ½çœ‹åˆ°é‡Œé¢. å› ä¸ºå‡½æ•°åœ¨æœç´¢ä¸€ä¸ªå˜é‡çš„æ—¶å€™, å¦‚æœå‡½æ•°å†…æ²¡æœ‰è¿™ä¸ªå˜é‡, é‚£ä¹ˆè¿™ä¸ªæœç´¢è¿‡ç¨‹ä¼šéšç€ä»£ç çš„æ‰§è¡Œç¯å¢ƒåˆ›å»ºçš„ä½œç”¨åŸŸé“¾å‘å¤–æœç´¢ç›´è‡³å…¨å±€å¯¹è±¡.</p>\n<ul>\n<li>å˜é‡ç”Ÿå‘½å‘¨æœŸ<br>å¯¹äºå…¨å±€å˜é‡æ¥è¯´, å®ƒçš„ç”Ÿå‘½å‘¨æœŸè‡ªç„¶æ˜¯æ°¸ä¹…çš„é™¤éæˆ‘ä»¬æ‰‹åŠ¨é”€æ¯è¿™ä¸ªå˜é‡; å¯¹äºå±€éƒ¨å˜é‡, ä¸€èˆ¬æ¥è¯´å½“å‡½æ•°æ‰§è¡Œå®Œæ¯•ä¹‹åè¯¥å˜é‡å°±ä¼šè·Ÿç€è¢«é”€æ¯. è€Œé—­åŒ…åˆ™å¯ä»¥å»¶ç»­å±€éƒ¨å˜é‡çš„ç”Ÿå‘½å‘¨æœŸ, ä¸¾ä¸ªæ —å­:<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> func = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">let</span> a = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t\ta++;</span><br><span class=\"line\">\t\talert(a);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">let</span> fn = func();</span><br><span class=\"line\">fn(); <span class=\"comment\">// 1</span></span><br><span class=\"line\">fn(); <span class=\"comment\">// 2</span></span><br><span class=\"line\">fn(); <span class=\"comment\">// 3</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° a å˜é‡ä¸ä»…åœ¨å¤–éƒ¨å¯ä»¥è¢«è®¿é—®åˆ°è€Œä¸”è¿˜ä¸€ç›´åœ¨é€’å¢, è¿™æ˜¯å› ä¸º <code>fn = func()</code>æ‰§è¡Œæ—¶, fn ä¿å­˜äº† func è¿”å›çš„åŒ¿åå‡½æ•°, è€Œè¿™ä¸ªåŒ¿åå‡½æ•°æ˜¯æœ‰æƒ func() è¢«è°ƒç”¨æ—¶äº§ç”Ÿçš„ç¯å¢ƒ. a å˜é‡å°±åœ¨è¿™ä¸ªç¯å¢ƒä¸­, æ‰€ä»¥æ—¢ç„¶å±€éƒ¨å˜é‡æ‰€åœ¨æ¢çš„ç¯å¢ƒæ²¡æœ‰è¢«é”€æ¯é‚£ä¹ˆ a å˜é‡ä¹Ÿä¸ä¼šè¢«é”€æ¯æ‰, è¿™ä¸ªä¾‹å­å°±äº§ç”Ÿäº†ä¸€ä¸ªé—­åŒ…ç»“æ„.</p>\n<blockquote>\n<h4 id=\"é—­åŒ…çš„ä½œç”¨\"><a href=\"#é—­åŒ…çš„ä½œç”¨\" class=\"headerlink\" title=\"é—­åŒ…çš„ä½œç”¨\"></a>é—­åŒ…çš„ä½œç”¨</h4></blockquote>\n<ul>\n<li>å°è£…å˜é‡<br>ä¼—æ‰€å‘¨çŸ¥å…¨å±€å˜é‡æ˜¯éå¸¸å®¹æ˜“å¼•èµ·å‘½åå†²çªçš„, æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨é—­åŒ…æŠŠä¸€äº›ä¸éœ€è¦æš´éœ²åœ¨å…¨å±€çš„å˜é‡å°è£…æˆç§æœ‰å˜é‡.</li>\n</ul>\n<p>å‡è®¾æœ‰ä¸€ä¸ªè®¡ç®—ä¹˜ç§¯çš„å‡½æ•°:<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> mult = (<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">// ç¼“å­˜(å°è£…èµ·æ¥)</span></span><br><span class=\"line\">\t<span class=\"keyword\">let</span> cache = &#123;&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> arg = [].join.call(<span class=\"built_in\">arguments</span>, <span class=\"string\">','</span>)</span><br><span class=\"line\">\t\t<span class=\"comment\">// å°è£…è®¡ç®—æ–¹æ³•</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> calulate = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">let</span> a = <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>, len = <span class=\"built_in\">arguments</span>.length; i &lt; len; i++) &#123;</span><br><span class=\"line\">\t\t\t\ta = a * <span class=\"built_in\">arguments</span>[i]</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"comment\">// å­˜åœ¨ç¼“å­˜åˆ™ä¸è®¡ç®—</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (arg <span class=\"keyword\">in</span> cache) <span class=\"keyword\">return</span> cache[arg]</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> cache[arg] = calulate.apply(<span class=\"literal\">null</span>, <span class=\"built_in\">arguments</span>)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;)()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(mult(<span class=\"number\">2</span>,<span class=\"number\">2</span>,<span class=\"number\">1</span>)); <span class=\"comment\">// 4</span></span><br></pre></td></tr></table></figure></p>\n<p>å°†å˜é‡ cache å°è£…åœ¨ mult å‡½æ•°ä¸­æ¥ç¼“å­˜å·²ç»è®¡ç®—è¿‡çš„å‚æ•°, ä»¥å‡å°‘é‡å¤è®¡ç®—. è¿™ä¸ªç¼“å­˜æœºåˆ¶æœ¬æ¥æ˜¯å¯ä»¥æ‰”åœ¨å…¨å±€ç¯å¢ƒä¸­çš„.</p>\n<ul>\n<li>å»¶ç»­å±€éƒ¨å˜é‡ç”Ÿå‘½å‘¨æœŸ<br>å¹³å¸¸åšåŸ‹ç‚¹ä¼šç”¨åˆ°çš„ image å¯¹è±¡æ¥ä¸ŠæŠ¥æ•°æ®, å¦‚ä¸‹:</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> report = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">src</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">let</span> img = <span class=\"keyword\">new</span> Image()</span><br><span class=\"line\">\timg.src = src</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">report(<span class=\"string\">'http://xxxxx.com/xxx'</span>)</span><br></pre></td></tr></table></figure>\n<p>è¿™ç§å†™æ³•ä¼šé€ æˆæ•°æ®ä¸¢å¤±, å› ä¸ºåœ¨ HTTP è¿˜æœªç»“æŸæ—¶, report å‡½æ•°å·²ç»æ‰§è¡Œå®Œæ¯•è€Œ img ä¸º report å‡½æ•°ä¸­çš„å±€éƒ¨å˜é‡, åœ¨å‡½æ•°æ‰§è¡Œå®Œæ¯•åå°±ä¼šéšä¹‹é”€æ¯é€ æˆæ•°æ®ä¸¢å¤±çš„æƒ…å†µ. ä¸‹é¢ç”¨é—­åŒ…æŠŠå˜é‡å°è£…èµ·æ¥, æ¥è§£å†³è¿™ä¸€é—®é¢˜:<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> report = (<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">let</span> imgs = []</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">src</span>) </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> img = <span class=\"keyword\">new</span> Image();</span><br><span class=\"line\">\t\timgs.push(img);</span><br><span class=\"line\">\t\timg.src = src</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;)()</span><br><span class=\"line\">report(<span class=\"string\">'http://xxxxx.com/xxx'</span>)</span><br></pre></td></tr></table></figure></p>\n<blockquote>\n<h4 id=\"é—­åŒ…å®ç°å‘½ä»¤æ¨¡å¼\"><a href=\"#é—­åŒ…å®ç°å‘½ä»¤æ¨¡å¼\" class=\"headerlink\" title=\"é—­åŒ…å®ç°å‘½ä»¤æ¨¡å¼\"></a>é—­åŒ…å®ç°å‘½ä»¤æ¨¡å¼</h4><p>è¯´äº†è¿™ä¹ˆå¤šå°±æ¥çœ‹çœ‹å…³äºé—­åŒ…çš„è¿ç”¨å§, è¿™é‡Œç”¨é—­åŒ…ç®€å•å®ç°ä¸‹å‘½ä»¤æ¨¡å¼, é¡ºä¾¿é¢„å…ˆäº†è§£ä¸€ä¸‹å‘½ä»¤æ¨¡å¼.</p>\n</blockquote>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">button</span> <span class=\"attr\">id</span>=<span class=\"string\">'open'</span> <span class=\"attr\">onclick</span>=<span class=\"string\">'execute'</span>&gt;</span>æ‰§è¡Œå‘½ä»¤<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">button</span> <span class=\"attr\">id</span>=<span class=\"string\">'close'</span> <span class=\"attr\">onclick</span>=<span class=\"string\">'undo'</span>&gt;</span>æ’¤é”€å‘½ä»¤<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>é¢å‘å¯¹è±¡ç‰ˆ<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> TV = &#123;</span><br><span class=\"line\">\topen () &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">'TV is open!'</span>)</span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\">\tclose () &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">'TV is close!'</span>)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// æ¥æ”¶å‘½ä»¤</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> ReceiveCommand = <span class=\"function\"><span class=\"params\">receiver</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">this</span>.receiver = receiver</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// æ‰“å¼€ç”µè§†</span></span><br><span class=\"line\">ReceiveCommand.prototype.execute = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">this</span>.receiver.open()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// å…³ç”µè§†</span></span><br><span class=\"line\">ReceiveCommand.prototype.undo = functon () &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">this</span>.receiver.close()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// è®¾ç½®å‘½ä»¤</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> setCommand = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">command</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'open'</span>).onclick = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t\tcommand.execute()</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'close'</span>).onclick = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t\tcommand.undo()</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// å°†å‘½ä»¤å‘Šè¯‰æ‰§è¡Œè€…, è®¾ç½®å‘½ä»¤ä¼ å…¥æ‰§è¡Œè€…</span></span><br><span class=\"line\">setCommand(<span class=\"keyword\">new</span> ReceiveCommand(TV))</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>å‘½ä»¤æ¨¡å¼æ˜¯æŠŠè¯·æ±‚å‘èµ·è€…å’Œæ‰§è¡Œå‘½ä»¤(æ‰§è¡Œè€…)åˆ†ç¦»å¼€æ¥, ä»¥è¾¾åˆ°è§£è€¦çš„ç›®çš„. åœ¨æ‰§è¡Œå‘½ä»¤ä¹‹å‰, æŠŠå‘½ä»¤æ”¾å…¥æ‰§è¡Œè€…æ¥å‘Šè¯‰æ‰§è¡Œè€…è¦æ‰§è¡Œä»€ä¹ˆæ ·çš„å‘½ä»¤, å‘½ä»¤æ¨¡å¼å¤§æ¦‚å°±æ˜¯è¿™æ ·å•¦.</p>\n<ul>\n<li>é—­åŒ…ç‰ˆ<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> TV = &#123;</span><br><span class=\"line\">\topen () &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">'TV is open!'</span>)</span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\">\tclose () &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">'TV is close!'</span>)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// æ‰§è¡Œè€…</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> receiveCommand = <span class=\"function\"><span class=\"params\">receiver</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">let</span> execute = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> receiver.open()</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">let</span> undo = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> receiver.close()</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">\t\texecute: execute,</span><br><span class=\"line\">\t\tundo: undo</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// å‘èµ·è€…</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> setCommand = <span class=\"function\"><span class=\"params\">command</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t<span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'open'</span>).onclick = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t\texecute.open()</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'close'</span>).onclick = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t\tundo.close()</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">setCommand(receiveCommand(TV))</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>é—­åŒ…æ˜æ˜¾æ¸…æ™°æ›´å¤š, ä¹Ÿæ›´ç®€æ´.</p>\n<blockquote>\n<h3 id=\"é«˜é˜¶å‡½æ•°\"><a href=\"#é«˜é˜¶å‡½æ•°\" class=\"headerlink\" title=\"é«˜é˜¶å‡½æ•°\"></a>é«˜é˜¶å‡½æ•°</h3><p>å°†å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’æˆ–è®©å‡½æ•°æ‰§è¡Œç»“æœè¿”å›å¦ä¸€ä¸ªå‡½æ•°, æ»¡è¶³è¿™ä¸¤ä¸ªæ¡ä»¶ä¹‹ä¸€çš„å‡½æ•°éƒ½å¯ä»¥ç§°ä½œä¸ºé«˜é˜¶å‡½æ•°.</p>\n</blockquote>\n<h4 id=\"å°†å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’\"><a href=\"#å°†å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’\" class=\"headerlink\" title=\"å°†å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’\"></a>å°†å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’</h4><p>å°†å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’, å°±æ„å‘³ç€æˆ‘ä»¬å¯ä»¥å°†ä¸ä¸šåŠ¡ç›¸å…³çš„é€»è¾‘ä»£ç åˆ†ç¦»å‡ºæ¥, è§£é™¤ä¸šåŠ¡ä»£ç å’Œä¸å˜é€»è¾‘çš„è€¦åˆ, æœ€å¸¸è§çš„å°±æ˜¯æˆ‘ä»¬çš„å›è°ƒå‡½æ•°. å®é™…è¿ç”¨ä¸­ ajax å¼‚æ­¥è¯·æ±‚, å½“æˆ‘ä»¬ä¸çŸ¥é“è¿”å›å€¼åœ¨ä»€ä¹ˆæ—¶å€™è¿”å›å€¼åˆéœ€è¦åœ¨è¿”å›ååšä¸€äº›å¤„ç†, å°±è¦ç”¨åˆ°å›è°ƒå‡½æ•°äº†.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> getPersonInfo = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">userId, callback</span>) </span>&#123;</span><br><span class=\"line\">\t$.ajax(<span class=\"string\">`http://xxx/getPersonInfo?<span class=\"subst\">$&#123;userId&#125;</span>`</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">data</span>) </span>&#123;</span><br><span class=\"line\">\t\tcallback &amp;&amp; callback(data)</span><br><span class=\"line\">\t&#125;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// è¿™é‡Œçš„åŒ¿åå‡½æ•°å°±æ˜¯ä¸Šé¢çš„ callback</span></span><br><span class=\"line\">getPersonInfo(<span class=\"string\">\"54332123\"</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">data</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">console</span>.log(data)</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p>è¿™ç§æ˜¯æˆ‘ä»¬æ¯”è¾ƒå¸¸è§çš„å›è°ƒå‡½æ•°, åœ¨å…¶ä»–çš„æ–¹é¢, ä¹Ÿå¯ä»¥å°†ä¸€äº›è¯·æ±‚å§”æ‰˜ç»™å¦ä¸€ä¸ªå‡½æ•°ä»£ä¸ºæ‰§è¡Œ, å¦‚:<br>å‡å¦‚æˆ‘ä»¬éœ€è¦å…ˆåˆ›å»º100çš„ div èŠ‚ç‚¹, ç„¶åæŠŠå®ƒä»¬éšè—æ‰</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// count é»˜è®¤å€¼ä¸º100</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> appendDiv = count = <span class=\"number\">100</span>, callback =&gt; &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (count &amp;&amp; <span class=\"keyword\">typeof</span> count === <span class=\"string\">'number'</span>) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; count; i++)&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">let</span> div = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">'div'</span>)</span><br><span class=\"line\">\t\t\tdiv.innerHTML = i</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">document</span>.body.appendChild(div)</span><br><span class=\"line\">\t\t\t<span class=\"comment\">// å°†ä¸šåŠ¡ä»£ç å§”æ‰˜æ‰§è¡Œ</span></span><br><span class=\"line\">\t\t\tcallback &amp;&amp; callback(div)</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125; </span><br><span class=\"line\"><span class=\"comment\">// æŠŠæ”¹å˜æ ·å¼çš„ä¸šåŠ¡é€»è¾‘åˆ†ç¦»å‡ºæ¥</span></span><br><span class=\"line\">appendDiv(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">el</span>) </span>&#123;</span><br><span class=\"line\">\tel.style.cssText = <span class=\"string\">`display: none`</span></span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p>è¿™æ ·æˆ‘ä»¬å°±å°†ä¸šåŠ¡é€»è¾‘åˆ†ç¦»å‡ºæ¥äº†, ä»¥åå¯èƒ½æˆ‘ä»¬æƒ³æ”¹é¢œè‰²å•¦æˆ–è€…ä½ç½®ä»€ä¹ˆçš„ä¹Ÿæ–¹ä¾¿ç»´æŠ¤.</p>\n<h4 id=\"å‡½æ•°ä½œä¸ºè¿”å›å€¼\"><a href=\"#å‡½æ•°ä½œä¸ºè¿”å›å€¼\" class=\"headerlink\" title=\"å‡½æ•°ä½œä¸ºè¿”å›å€¼\"></a>å‡½æ•°ä½œä¸ºè¿”å›å€¼</h4><p>ç›¸æ¯”æŠŠå‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’, å¯èƒ½å‡½æ•°å½“åšè¿”å›å€¼è¿”å›è¿ç”¨åœºæ™¯æ›´å¤šä¸€äº›, è®©å‡½æ•°è¿”å›å¦ä¸€ä¸ªå¯æ‰§è¡Œå‡½æ•°å°±æ„å‘³ç€è¿ç®—è¿‡ç¨‹å¯å»¶ç»­.ç›´æ¥æ¥çœ‹ä¸€äº›ä¾‹å­å§.</p>\n<ul>\n<li>æ£€æŸ¥ç±»å‹</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> Type = &#123;&#125;</span><br><span class=\"line\"><span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>, type; type = [<span class=\"string\">'Array'</span>, <span class=\"string\">'String'</span>, <span class=\"string\">'Number'</span>][i++];) &#123;</span><br><span class=\"line\">\tType[<span class=\"string\">'is'</span> + type] = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">obj</span>) </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"built_in\">Object</span>.prototype.toString.call(obj) === <span class=\"string\">'[object '</span>+ type +<span class=\"string\">']'</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(Type.isArray([])) <span class=\"comment\">// true</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(Type.isString(<span class=\"string\">'123'</span>)) <span class=\"comment\">// true</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(Type.isNumber(<span class=\"number\">123</span>)) <span class=\"comment\">// true</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>å•ä¾‹æ¨¡å¼<br>  è¿™é‡Œå…ˆä¸è®¨è®ºå•ä¾‹æ¨¡å¼, åªçœ‹ä»£ç å®ç°</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// fn å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> getSingle = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">fn</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">let</span> ret;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">// å¦‚æœ ret ä¸å­˜åœ¨, ret ç­‰äº fn å‡½æ•°</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> ret || (ret = fn.apply(<span class=\"keyword\">this</span>, <span class=\"built_in\">arguments</span>))</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125; </span><br><span class=\"line\"><span class=\"comment\">// è°ƒç”¨è¿™ä¸ªé«˜é˜¶å‡½æ•°</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> getDiv = getSingle(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">// å‚æ•°ä¹Ÿä¼šä¸€èµ·ä¼ è¿‡æ¥, è¿™é‡Œè¿”å›['123']</span></span><br><span class=\"line\">\t<span class=\"built_in\">console</span>.log(<span class=\"built_in\">arguments</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"built_in\">document</span>.createElement(<span class=\"string\">'div'</span>);</span><br><span class=\"line\">\t</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">getDiv(<span class=\"string\">'123'</span>)</span><br></pre></td></tr></table></figure>\n<p>getSingle è¿™ä¸ªé«˜é˜¶å‡½æ•°æ—¢å°†å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’, åˆè®©å‡½æ•°æ‰§è¡Œåè¿”å›å¦ä¸€ä¸ªå‡½æ•°.</p>\n<blockquote>\n<p>JavaScript è®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µè¿˜æœ‰ä¸ªä¾‹å­ä¹Ÿå¾ˆæœ‰æ„æ€<br>å«åš AOP(é¢å‘åˆ‡é¢ç¼–ç¨‹), ä½œç”¨æ˜¯æŠŠä¸ä¸šåŠ¡é€»è¾‘ä¸ç›¸å…³çš„éƒ¨åˆ†æŠ½ç¦»å‡ºæ¥å†é€šè¿‡åŠ¨æ€æ¤å…¥çš„æ–¹å¼åŠ å…¥ä¸šåŠ¡é€»è¾‘çš„æ¨¡å—ä¸­.</p>\n</blockquote>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// åœ¨åŸå‡½æ•°ä¹‹å‰</span></span><br><span class=\"line\"><span class=\"built_in\">Function</span>.prototype.before = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">beforeFn</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">let</span> that = <span class=\"keyword\">this</span>; <span class=\"comment\">// ä¿å­˜åŸå‡½æ•°çš„å¼•ç”¨</span></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123; <span class=\"comment\">// A</span></span><br><span class=\"line\">\t\t<span class=\"comment\">// æ‰§è¡Œæ–°å‡½æ•°å¹¶ä¿®æ­£ this</span></span><br><span class=\"line\">\t\tbeforeFn.apply(<span class=\"keyword\">this</span>, <span class=\"built_in\">arguments</span>)</span><br><span class=\"line\">\t\t<span class=\"comment\">// æ‰§è¡ŒåŸå‡½æ•°</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> that.apply(<span class=\"keyword\">this</span>, <span class=\"built_in\">arguments</span>)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// åœ¨åŸå‡½æ•°ä¹‹å</span></span><br><span class=\"line\"><span class=\"built_in\">Function</span>.prototype.after = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">afterFn</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">let</span> that = <span class=\"keyword\">this</span></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123; <span class=\"comment\">// B</span></span><br><span class=\"line\">\t\t<span class=\"comment\">// å…ˆæ‰§è¡Œ before å‡½æ•°</span></span><br><span class=\"line\">\t\tthat.apply(<span class=\"keyword\">this</span>, <span class=\"built_in\">arguments</span>)</span><br><span class=\"line\">\t\t<span class=\"comment\">// å†æ‰§è¡Œæ–°å‡½æ•°</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> afterFn.apply(<span class=\"keyword\">this</span>, <span class=\"built_in\">arguments</span>)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> fn = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">console</span>.log(<span class=\"number\">2</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">fn = fn.before(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">console</span>.log(<span class=\"number\">1</span>)</span><br><span class=\"line\">&#125;).after(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">console</span>.log(<span class=\"number\">3</span>)</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">fn() <span class=\"comment\">// æŒ‰é¡ºåºè¾“å‡º 1 2 3</span></span><br></pre></td></tr></table></figure>\n<p>ä¸Šé¢çš„æ‰§è¡Œé¡ºåºæ˜¯è¿™æ ·çš„:</p>\n<ol>\n<li>Afterä¸­çš„å›è°ƒå‡½æ•° B<br>å› ä¸ºåœ¨æœ€åæ‰§è¡Œ fn å‡½æ•°æ—¶, fn å·²ç»æ˜¯ after å‡½æ•°äº†, å› æ­¤åœ¨ fn() æ‰§è¡Œæ—¶è°ƒç”¨çš„æ˜¯ after ä¸­è¿”å›çš„åŒ¿åå‡½æ•°B.</li>\n<li>B ä¸­çš„ that.apply(this, arguments)<br>æ­¤æ—¶çš„ that æŒ‡å‘ before å‡½æ•°</li>\n<li>æ‰§è¡ŒBeforeä¸­çš„å›è°ƒå‡½æ•° A</li>\n<li>A ä¸­çš„ beforeFn.apply(this, arguments)<br>æ‰§è¡Œ console.log(1)</li>\n<li>return that.apply(this, arguments)<br>æ‰§è¡Œ console.log(2)</li>\n<li>å›åˆ° after å‡½æ•°ä¸­æ‰§è¡Œreturn afterFn.apply(this, arguments)<br>æ‰§è¡Œ console.log(3)</li>\n</ol>\n<h4 id=\"å‡½æ•°æŸ¯é‡ŒåŒ–\"><a href=\"#å‡½æ•°æŸ¯é‡ŒåŒ–\" class=\"headerlink\" title=\"å‡½æ•°æŸ¯é‡ŒåŒ–\"></a>å‡½æ•°æŸ¯é‡ŒåŒ–</h4><p>å‡½æ•°æŸ¯é‡ŒåŒ–å¯ä»¥è¯´æ˜¯é«˜é˜¶å‡½æ•°ç»å…¸ä¸­çš„ç»å…¸äº†, è¯´åˆ°é«˜é˜¶å‡½æ•°åº”è¯¥å¾ˆå¿«å°±ä¼šæƒ³åˆ°ä»–äº†. æˆ‘ç†è§£çš„å‡½æ•°æŸ¯é‡ŒåŒ–æ˜¯: å…ˆå°†å‚æ•°ä¾æ¬¡ç¼“å­˜, åœ¨çœŸæ­£éœ€è¦è®¡ç®—ç»“æœæ—¶, æ‰è¿›è¡Œè®¡ç®—è¿™æ ·å¯ä»¥å‡å°‘è¿ç®—æ¬¡æ•°.</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// é€šç”¨ curring</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> curring = <span class=\"function\"><span class=\"params\">fn</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> argsArr = []</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"function\">(<span class=\"params\">...args</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> [...args].length === <span class=\"number\">0</span></span><br><span class=\"line\">            ? fn.apply(<span class=\"literal\">null</span>, argsArr)</span><br><span class=\"line\">            : [].push.apply(argsArr, [...args])</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// éœ€è¦è®¡ç®—çš„å‡½æ•°</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> calculate = <span class=\"function\">(<span class=\"params\">(</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> money = <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"function\">(<span class=\"params\">...argsArr</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        argsArr.forEach(<span class=\"function\"><span class=\"params\">item</span> =&gt;</span> &#123;</span><br><span class=\"line\">            money += item</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> money</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;)()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æŸ¯é‡ŒåŒ–</span></span><br><span class=\"line\">calculate = curring(calculate)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ç¼“å­˜å‚æ•°, å…¶å®å¹¶æ²¡æœ‰è®¡ç®—</span></span><br><span class=\"line\">calculate(<span class=\"number\">20</span>)</span><br><span class=\"line\">calculate(<span class=\"number\">40</span>)</span><br><span class=\"line\">calculate(<span class=\"number\">20</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// çœŸæ­£è®¡ç®—çš„æ—¶å€™</span></span><br><span class=\"line\">calculate()</span><br></pre></td></tr></table></figure>\n<h4 id=\"å‡½æ•°èŠ‚æµ\"><a href=\"#å‡½æ•°èŠ‚æµ\" class=\"headerlink\" title=\"å‡½æ•°èŠ‚æµ\"></a>å‡½æ•°èŠ‚æµ</h4><p>åœ¨æŸäº›åœºæ™¯ä¸‹å‡½æ•°æœ‰å¯èƒ½ä¼šè¢«éå¸¸é¢‘ç¹åœ°è°ƒç”¨, ä»è€Œé€ æˆå¾ˆå¤§çš„æ€§èƒ½é—®é¢˜. ä¾‹å¦‚: window.resizeäº‹ä»¶ã€mousemove äº‹ä»¶, å®ƒä»¬è§¦å‘çš„é¢‘ç‡å¤ªé«˜äº†, è€Œç”¨æˆ·å¹¶ä¸éœ€è¦å¦‚æ­¤é«˜é¢‘ç‡çš„ä½¿ç”¨. å› æ­¤å‡½æ•°èŠ‚æµå°±æ˜¯ä¸ºäº†é™åˆ¶å‡½æ•°å‡ºå‘çš„é¢‘ç‡.</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// èŠ‚æµ</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> throttle = <span class=\"function\">(<span class=\"params\">fn, interval = <span class=\"number\">800</span></span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> isFirst = <span class=\"literal\">true</span>, timer</span><br><span class=\"line\">    <span class=\"comment\">// ...args =&gt; event</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"function\">(<span class=\"params\">...args</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">let</span> that = <span class=\"keyword\">this</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (isFirst) &#123;</span><br><span class=\"line\">            fn.apply(that, [...args])</span><br><span class=\"line\">            <span class=\"keyword\">return</span> isFirst = <span class=\"literal\">false</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (timer) <span class=\"keyword\">return</span> <span class=\"literal\">false</span></span><br><span class=\"line\">        timer = setTimeout(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">            clearTimeout(timer)</span><br><span class=\"line\">            timer = <span class=\"literal\">null</span></span><br><span class=\"line\">            fn.apply(that, [...args])</span><br><span class=\"line\">        &#125;, interval)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ä¼ å…¥éœ€è¦èŠ‚æµçš„å‡½æ•°å’Œé—´éš”æ—¶é—´</span></span><br><span class=\"line\"><span class=\"built_in\">window</span>.onresize = throttle(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"number\">1</span>)</span><br><span class=\"line\">&#125;, <span class=\"number\">800</span>)</span><br></pre></td></tr></table></figure>\n<h4 id=\"åˆ†æ—¶å‡½æ•°\"><a href=\"#åˆ†æ—¶å‡½æ•°\" class=\"headerlink\" title=\"åˆ†æ—¶å‡½æ•°\"></a>åˆ†æ—¶å‡½æ•°</h4><p>ä¸Šé¢æˆ‘ä»¬æä¾›äº†ä¸€ç§é™åˆ¶å‡½æ•°è°ƒç”¨é¢‘ç‡çš„è§£å†³æ–¹æ¡ˆ, ç°åœ¨æ˜¯å¦ä¸€ä¸ªé—®é¢˜: æŸäº›å‡½æ•°æ˜¯ç”±ç”¨æˆ·ä¸»åŠ¨å”¤èµ·çš„, ä½†æ˜¯å› ä¸ºä¸€äº›åŸå› å¯¼è‡´å‡½æ•°ä¸¥é‡å½±å“é¡µé¢çš„æ€§èƒ½. åˆ†æ—¶å‡½æ•°å¯ä»¥ä¸ºæˆ‘ä»¬è§£å†³è¿™ä¸ªé—®é¢˜, æˆ‘ç†è§£çš„åˆ†æ—¶å‡½æ•°: å°†è¯·æ±‚åˆ†æ‰¹å¤„ç†, åœ¨ä¸€å®šçš„æ—¶é—´å†…æ‰§è¡Œä¸€éƒ¨åˆ†è¯·æ±‚, ç›´åˆ°è¯·æ±‚å…¨éƒ¨å®Œæˆ.</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// åˆ†æ—¶å‡½æ•°</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> timeChunk = <span class=\"function\">(<span class=\"params\">data, fn, count = <span class=\"number\">1</span></span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> timer, obj</span><br><span class=\"line\">    <span class=\"keyword\">const</span> start = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"built_in\">Math</span>.min(count, data.length); i++) &#123;</span><br><span class=\"line\">            obj = data.shift()</span><br><span class=\"line\">            fn.apply(<span class=\"literal\">null</span>, obj)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (data.length === <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            clearTimeout(timer)</span><br><span class=\"line\">            <span class=\"keyword\">return</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        timer = setInterval(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">            start()</span><br><span class=\"line\">        &#125;, <span class=\"number\">200</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æ¨¡æ‹Ÿæ•°æ®</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> ary = []</span><br><span class=\"line\"><span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">1000</span>; i++) &#123;</span><br><span class=\"line\">    ary.push(i)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// åˆ†æ—¶åŒ–</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> renderfriendList = timeChunk(ary, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">n</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> div = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">'div'</span>)</span><br><span class=\"line\">    div.innerHTML = n</span><br><span class=\"line\">    <span class=\"built_in\">document</span>.body.appendChild(div)</span><br><span class=\"line\">&#125;, <span class=\"number\">10</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æ¸²æŸ“</span></span><br><span class=\"line\">renderfriendList()</span><br></pre></td></tr></table></figure>\n<h4 id=\"æƒ°æ€§åŠ è½½\"><a href=\"#æƒ°æ€§åŠ è½½\" class=\"headerlink\" title=\"æƒ°æ€§åŠ è½½\"></a>æƒ°æ€§åŠ è½½</h4><p>ä¸¾ä¸ªä¾‹å­, åœ¨ web ä¸­ä¸ºäº†æ»¡è¶³å„æµè§ˆå™¨ä¹‹é—´çš„å·®å¼‚, æˆ‘ä»¬ä¼šåšä¸€äº›å—…æ¢å·¥ä½œ. å¼‚äºå¸¸è§„æ–¹æ¡ˆ, æƒ°æ€§åŠ è½½åœ¨çœŸæ­£éœ€è¦æ—¶æ‰ä½¿ç”¨ä¸”è¿›å…¥æ¡ä»¶åˆ†æ”¯ååœ¨å†…éƒ¨é‡å†™è¯¥å‡½æ•°, è¿™æ ·é‡å†™åçš„å‡½æ•°å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„å‡½æ•°.</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> addEvent = <span class=\"function\">(<span class=\"params\">el, type, handler</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">window</span>.addEventListener) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// é‡å†™å‡½æ•°</span></span><br><span class=\"line\">        addEvent = <span class=\"function\">(<span class=\"params\">el, type, handler</span>) =&gt;</span> &#123;</span><br><span class=\"line\">            el.addEventListener(type, handler, <span class=\"literal\">false</span>)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"built_in\">window</span>.attachEvent) &#123;</span><br><span class=\"line\">        addEvent = <span class=\"function\">(<span class=\"params\">el, type, handler</span>) =&gt;</span> &#123;</span><br><span class=\"line\">            el.attachEvent(<span class=\"string\">'on'</span> + type, handler)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    addEvent(el, type, handler)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ä½¿ç”¨</span></span><br><span class=\"line\">addEvent(btn, <span class=\"string\">'click'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'click!'</span>)</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p>Created on 2017-10-26 by Cara</p>\n"}],"PostAsset":[],"PostCategory":[{"post_id":"cjgurolrx0000klu0j8v00hdr","category_id":"cjgurols40003klu02o1j9n49","_id":"cjgurolsc000dklu0l57dzqmn"},{"post_id":"cjgurols80007klu051p1vj2i","category_id":"cjgurols40003klu02o1j9n49","_id":"cjgurolsf000iklu005knbc45"},{"post_id":"cjgurols60005klu0q22caaj0","category_id":"cjgurols90008klu0z44o06zl","_id":"cjgurolsi000mklu0x47vj2ya"},{"post_id":"cjgurols70006klu026z6lakf","category_id":"cjgurols90008klu0z44o06zl","_id":"cjgurolsl000sklu0klcoe8nz"},{"post_id":"cjgurolsj000pklu0tofsng0m","category_id":"cjgurols40003klu02o1j9n49","_id":"cjgurolsp000zklu0bkb2h7cp"},{"post_id":"cjgurolsa000bklu0mpcieva2","category_id":"cjgurols40003klu02o1j9n49","_id":"cjgurolsq0013klu0griq0uma"},{"post_id":"cjgurolsa000bklu0mpcieva2","category_id":"cjgurolsi000lklu0kn8vukl0","_id":"cjgurolsr0016klu0ghsinv9f"},{"post_id":"cjgurolsk000rklu0nd1xop63","category_id":"cjgurols40003klu02o1j9n49","_id":"cjgurolst001aklu015jq9sab"},{"post_id":"cjgurolsm000wklu0gz2f09vg","category_id":"cjgurols40003klu02o1j9n49","_id":"cjgurolsu001eklu01f0tfnrh"},{"post_id":"cjgurolsc000cklu0grv9im7h","category_id":"cjgurols40003klu02o1j9n49","_id":"cjgurolsv001iklu0zvzvqu4z"},{"post_id":"cjgurolsc000cklu0grv9im7h","category_id":"cjgurolsi000lklu0kn8vukl0","_id":"cjgurolsx001lklu04qdhcequ"},{"post_id":"cjgurolsq0012klu08ssdd3n3","category_id":"cjgurols90008klu0z44o06zl","_id":"cjgurolsy001oklu0app45axy"},{"post_id":"cjgurolse000hklu0ne588sj0","category_id":"cjgurols90008klu0z44o06zl","_id":"cjgurolt0001sklu0ef4g61yn"},{"post_id":"cjgurolse000hklu0ne588sj0","category_id":"cjgurolsp0010klu0ba4jc3og","_id":"cjgurolt1001vklu0n8yrp3gk"},{"post_id":"cjgurolsr0015klu00d8fgzcq","category_id":"cjgurols40003klu02o1j9n49","_id":"cjgurolt3001yklu0ti07qyol"},{"post_id":"cjgurolsg000kklu03dfn3foi","category_id":"cjgurols40003klu02o1j9n49","_id":"cjgurolt40021klu06s68o02a"},{"post_id":"cjgurolsg000kklu03dfn3foi","category_id":"cjgurolsi000lklu0kn8vukl0","_id":"cjgurolt50024klu0t5kvnzw7"},{"post_id":"cjgurolst001dklu09raid2so","category_id":"cjgurols90008klu0z44o06zl","_id":"cjgurolt50026klu0hmb4nq0z"},{"post_id":"cjgurolsv001gklu0jygctjsd","category_id":"cjgurols40003klu02o1j9n49","_id":"cjgurolt50028klu0ljflytyb"},{"post_id":"cjgurolsw001kklu0bqcj0dcd","category_id":"cjgurols40003klu02o1j9n49","_id":"cjgurolt6002aklu0fjaw5mdy"},{"post_id":"cjgurolss0019klu0mnha4373","category_id":"cjgurols40003klu02o1j9n49","_id":"cjgurolt6002cklu07iptbrnw"},{"post_id":"cjgurolss0019klu0mnha4373","category_id":"cjgurolsv001hklu0d8gvjlqo","_id":"cjgurolt6002eklu0rmbtne0x"},{"post_id":"cjgurolsx001nklu0joal8sv0","category_id":"cjgurols40003klu02o1j9n49","_id":"cjgurolt6002gklu056hhcnd7"},{"post_id":"cjgurolsz001rklu0ub6gw88t","category_id":"cjgurols90008klu0z44o06zl","_id":"cjgurolt6002iklu0t0bz3e04"},{"post_id":"cjgurolt0001uklu0ol9onrig","category_id":"cjgurols90008klu0z44o06zl","_id":"cjgurolt7002kklu0oe4s52i4"},{"post_id":"cjgurolt2001xklu07cne2y1m","category_id":"cjgurols40003klu02o1j9n49","_id":"cjgurolt7002lklu0zcswbe8t"},{"post_id":"cjgurolt40020klu0xmy4iinz","category_id":"cjgurols40003klu02o1j9n49","_id":"cjgurolt7002mklu04r51rnkw"},{"post_id":"cjgurolt40020klu0xmy4iinz","category_id":"cjgurolsv001hklu0d8gvjlqo","_id":"cjgurolt7002nklu0ec2ow5bf"}],"PostTag":[{"post_id":"cjgurolrx0000klu0j8v00hdr","tag_id":"cjgurols50004klu00koggbr8","_id":"cjgurolsa000aklu0isu2hl1u"},{"post_id":"cjgurolsa000bklu0mpcieva2","tag_id":"cjgurols50004klu00koggbr8","_id":"cjgurolse000gklu0axwg7eb6"},{"post_id":"cjgurols20002klu0u8rvtunj","tag_id":"cjgurols90009klu0jvr3ft08","_id":"cjgurolsg000jklu0uel4uhls"},{"post_id":"cjgurolsc000cklu0grv9im7h","tag_id":"cjgurols50004klu00koggbr8","_id":"cjgurolsj000oklu0q0roh85z"},{"post_id":"cjgurolse000hklu0ne588sj0","tag_id":"cjgurols50004klu00koggbr8","_id":"cjgurolsk000qklu0dfsy4755"},{"post_id":"cjgurols60005klu0q22caaj0","tag_id":"cjgurolsd000fklu0ly8pxjnk","_id":"cjgurolsm000vklu0uh8dtgz5"},{"post_id":"cjgurolsg000kklu03dfn3foi","tag_id":"cjgurols50004klu00koggbr8","_id":"cjgurolso000xklu0c9xy4b0w"},{"post_id":"cjgurolsj000pklu0tofsng0m","tag_id":"cjgurols50004klu00koggbr8","_id":"cjgurolsp0011klu00loree0m"},{"post_id":"cjgurols70006klu026z6lakf","tag_id":"cjgurolsd000fklu0ly8pxjnk","_id":"cjgurolsr0014klu0gxkfk7v4"},{"post_id":"cjgurolsk000rklu0nd1xop63","tag_id":"cjgurols50004klu00koggbr8","_id":"cjgurolss0017klu0vly6t84a"},{"post_id":"cjgurolsm000wklu0gz2f09vg","tag_id":"cjgurols50004klu00koggbr8","_id":"cjgurolst001cklu0445qft7b"},{"post_id":"cjgurols80007klu051p1vj2i","tag_id":"cjgurolsm000uklu0xzwh9xfl","_id":"cjgurolsv001fklu0uhoojqi5"},{"post_id":"cjgurolso000yklu0hc7a26bu","tag_id":"cjgurols50004klu00koggbr8","_id":"cjgurolsw001jklu0y8whqnrj"},{"post_id":"cjgurolsq0012klu08ssdd3n3","tag_id":"cjgurols50004klu00koggbr8","_id":"cjgurolsx001mklu01h2eus60"},{"post_id":"cjgurolss0019klu0mnha4373","tag_id":"cjgurols50004klu00koggbr8","_id":"cjgurolsz001qklu0f112gdlz"},{"post_id":"cjgurolst001dklu09raid2so","tag_id":"cjgurols50004klu00koggbr8","_id":"cjgurolt0001tklu0k3cdc6j7"},{"post_id":"cjgurolsv001gklu0jygctjsd","tag_id":"cjgurols50004klu00koggbr8","_id":"cjgurolt1001wklu0cbon1agm"},{"post_id":"cjgurolsr0015klu00d8fgzcq","tag_id":"cjgurols50004klu00koggbr8","_id":"cjgurolt3001zklu0vj958ii2"},{"post_id":"cjgurolsr0015klu00d8fgzcq","tag_id":"cjgurolst001bklu07cgfjhdc","_id":"cjgurolt50023klu0fnf7xtob"},{"post_id":"cjgurolsx001nklu0joal8sv0","tag_id":"cjgurols50004klu00koggbr8","_id":"cjgurolt50025klu0cfx8nu9o"},{"post_id":"cjgurolsz001rklu0ub6gw88t","tag_id":"cjgurolsd000fklu0ly8pxjnk","_id":"cjgurolt50027klu04u2dpg41"},{"post_id":"cjgurolt0001uklu0ol9onrig","tag_id":"cjgurols50004klu00koggbr8","_id":"cjgurolt60029klu00ehgdaj3"},{"post_id":"cjgurolsw001kklu0bqcj0dcd","tag_id":"cjgurolsz001pklu06bbmvlt8","_id":"cjgurolt6002bklu0hjw4ekhi"},{"post_id":"cjgurolt40020klu0xmy4iinz","tag_id":"cjgurols50004klu00koggbr8","_id":"cjgurolt6002dklu06jhdae89"},{"post_id":"cjgurolt2001xklu07cne2y1m","tag_id":"cjgurols50004klu00koggbr8","_id":"cjgurolt6002fklu0mg9d3wac"},{"post_id":"cjgurolt2001xklu07cne2y1m","tag_id":"cjgurolst001bklu07cgfjhdc","_id":"cjgurolt6002hklu00k3j2tde"},{"post_id":"cjgurolt2001xklu07cne2y1m","tag_id":"cjgurolt40022klu07vffuqj4","_id":"cjgurolt7002jklu04b83phe1"}],"Tag":[{"name":"JavaScript","_id":"cjgurols50004klu00koggbr8"},{"name":"Babel","_id":"cjgurols90009klu0jvr3ft08"},{"name":"CSS","_id":"cjgurolsd000fklu0ly8pxjnk"},{"name":"HTTP","_id":"cjgurolsm000uklu0xzwh9xfl"},{"name":"Node.js","_id":"cjgurolst001bklu07cgfjhdc"},{"name":"hexo","_id":"cjgurolsz001pklu06bbmvlt8"},{"name":"FFmpeg","_id":"cjgurolt40022klu07vffuqj4"}]}}